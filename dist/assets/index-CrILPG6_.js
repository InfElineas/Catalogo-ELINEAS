var RF=Object.defineProperty;var $w=e=>{throw TypeError(e)};var PF=(e,t,r)=>t in e?RF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ud=(e,t,r)=>PF(e,typeof t!="symbol"?t+"":t,r),bm=(e,t,r)=>t.has(e)||$w("Cannot "+r);var H=(e,t,r)=>(bm(e,t,"read from private field"),r?r.call(e):t.get(e)),Fe=(e,t,r)=>t.has(e)?$w("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Se=(e,t,r,n)=>(bm(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),tt=(e,t,r)=>(bm(e,t,"access private method"),r);var $d=(e,t,r,n)=>({set _(a){Se(e,t,a,r)},get _(){return H(e,t,n)}});function jF(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function Zb(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var eS={exports:{}},ap={},tS={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var md=Symbol.for("react.element"),FF=Symbol.for("react.portal"),OF=Symbol.for("react.fragment"),IF=Symbol.for("react.strict_mode"),DF=Symbol.for("react.profiler"),MF=Symbol.for("react.provider"),LF=Symbol.for("react.context"),BF=Symbol.for("react.forward_ref"),UF=Symbol.for("react.suspense"),$F=Symbol.for("react.memo"),WF=Symbol.for("react.lazy"),Ww=Symbol.iterator;function VF(e){return e===null||typeof e!="object"?null:(e=Ww&&e[Ww]||e["@@iterator"],typeof e=="function"?e:null)}var rS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nS=Object.assign,aS={};function Xc(e,t,r){this.props=e,this.context=t,this.refs=aS,this.updater=r||rS}Xc.prototype.isReactComponent={};Xc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function sS(){}sS.prototype=Xc.prototype;function $v(e,t,r){this.props=e,this.context=t,this.refs=aS,this.updater=r||rS}var Wv=$v.prototype=new sS;Wv.constructor=$v;nS(Wv,Xc.prototype);Wv.isPureReactComponent=!0;var Vw=Array.isArray,iS=Object.prototype.hasOwnProperty,Vv={current:null},oS={key:!0,ref:!0,__self:!0,__source:!0};function lS(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)iS.call(t,n)&&!oS.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:md,type:e,key:s,ref:i,props:a,_owner:Vv.current}}function zF(e,t){return{$$typeof:md,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function zv(e){return typeof e=="object"&&e!==null&&e.$$typeof===md}function HF(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var zw=/\/+/g;function Sm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?HF(""+e.key):t.toString(36)}function Rh(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case md:case FF:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Sm(i,0):n,Vw(a)?(r="",e!=null&&(r=e.replace(zw,"$&/")+"/"),Rh(a,t,r,"",function(c){return c})):a!=null&&(zv(a)&&(a=zF(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(zw,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",Vw(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Sm(s,o);i+=Rh(s,t,r,l,a)}else if(l=VF(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Sm(s,o++),i+=Rh(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Wd(e,t,r){if(e==null)return e;var n=[],a=0;return Rh(e,n,"","",function(s){return t.call(r,s,a++)}),n}function GF(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var yn={current:null},Ph={transition:null},KF={ReactCurrentDispatcher:yn,ReactCurrentBatchConfig:Ph,ReactCurrentOwner:Vv};function cS(){throw Error("act(...) is not supported in production builds of React.")}st.Children={map:Wd,forEach:function(e,t,r){Wd(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Wd(e,function(){t++}),t},toArray:function(e){return Wd(e,function(t){return t})||[]},only:function(e){if(!zv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};st.Component=Xc;st.Fragment=OF;st.Profiler=DF;st.PureComponent=$v;st.StrictMode=IF;st.Suspense=UF;st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KF;st.act=cS;st.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=nS({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Vv.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)iS.call(t,l)&&!oS.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:md,type:e.type,key:a,ref:s,props:n,_owner:i}};st.createContext=function(e){return e={$$typeof:LF,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:MF,_context:e},e.Consumer=e};st.createElement=lS;st.createFactory=function(e){var t=lS.bind(null,e);return t.type=e,t};st.createRef=function(){return{current:null}};st.forwardRef=function(e){return{$$typeof:BF,render:e}};st.isValidElement=zv;st.lazy=function(e){return{$$typeof:WF,_payload:{_status:-1,_result:e},_init:GF}};st.memo=function(e,t){return{$$typeof:$F,type:e,compare:t===void 0?null:t}};st.startTransition=function(e){var t=Ph.transition;Ph.transition={};try{e()}finally{Ph.transition=t}};st.unstable_act=cS;st.useCallback=function(e,t){return yn.current.useCallback(e,t)};st.useContext=function(e){return yn.current.useContext(e)};st.useDebugValue=function(){};st.useDeferredValue=function(e){return yn.current.useDeferredValue(e)};st.useEffect=function(e,t){return yn.current.useEffect(e,t)};st.useId=function(){return yn.current.useId()};st.useImperativeHandle=function(e,t,r){return yn.current.useImperativeHandle(e,t,r)};st.useInsertionEffect=function(e,t){return yn.current.useInsertionEffect(e,t)};st.useLayoutEffect=function(e,t){return yn.current.useLayoutEffect(e,t)};st.useMemo=function(e,t){return yn.current.useMemo(e,t)};st.useReducer=function(e,t,r){return yn.current.useReducer(e,t,r)};st.useRef=function(e){return yn.current.useRef(e)};st.useState=function(e){return yn.current.useState(e)};st.useSyncExternalStore=function(e,t,r){return yn.current.useSyncExternalStore(e,t,r)};st.useTransition=function(){return yn.current.useTransition()};st.version="18.3.1";tS.exports=st;var _=tS.exports;const de=Zb(_),sp=jF({__proto__:null,default:de},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qF=_,XF=Symbol.for("react.element"),YF=Symbol.for("react.fragment"),QF=Object.prototype.hasOwnProperty,JF=qF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZF={key:!0,ref:!0,__self:!0,__source:!0};function uS(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)QF.call(t,n)&&!ZF.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:XF,type:e,key:s,ref:i,props:a,_owner:JF.current}}ap.Fragment=YF;ap.jsx=uS;ap.jsxs=uS;eS.exports=ap;var u=eS.exports,fS={exports:{}},Qn={},dS={exports:{}},hS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,A){var ne=K.length;K.push(A);e:for(;0<ne;){var ce=ne-1>>>1,R=K[ce];if(0<a(R,A))K[ce]=A,K[ne]=R,ne=ce;else break e}}function r(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var A=K[0],ne=K.pop();if(ne!==A){K[0]=ne;e:for(var ce=0,R=K.length,z=R>>>1;ce<z;){var U=2*(ce+1)-1,V=K[U],J=U+1,W=K[J];if(0>a(V,ne))J<R&&0>a(W,V)?(K[ce]=W,K[J]=ne,ce=J):(K[ce]=V,K[U]=ne,ce=U);else if(J<R&&0>a(W,ne))K[ce]=W,K[J]=ne,ce=J;else break e}}return A}function a(K,A){var ne=K.sortIndex-A.sortIndex;return ne!==0?ne:K.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,h=3,p=!1,g=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(K){for(var A=r(c);A!==null;){if(A.callback===null)n(c);else if(A.startTime<=K)n(c),A.sortIndex=A.expirationTime,t(l,A);else break;A=r(c)}}function E(K){if(m=!1,w(K),!g)if(r(l)!==null)g=!0,X(b);else{var A=r(c);A!==null&&q(E,A.startTime-K)}}function b(K,A){g=!1,m&&(m=!1,v(T),T=-1),p=!0;var ne=h;try{for(w(A),d=r(l);d!==null&&(!(d.expirationTime>A)||K&&!j());){var ce=d.callback;if(typeof ce=="function"){d.callback=null,h=d.priorityLevel;var R=ce(d.expirationTime<=A);A=e.unstable_now(),typeof R=="function"?d.callback=R:d===r(l)&&n(l),w(A)}else n(l);d=r(l)}if(d!==null)var z=!0;else{var U=r(c);U!==null&&q(E,U.startTime-A),z=!1}return z}finally{d=null,h=ne,p=!1}}var k=!1,S=null,T=-1,N=5,O=-1;function j(){return!(e.unstable_now()-O<N)}function D(){if(S!==null){var K=e.unstable_now();O=K;var A=!0;try{A=S(!0,K)}finally{A?Y():(k=!1,S=null)}}else k=!1}var Y;if(typeof y=="function")Y=function(){y(D)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,G=Q.port2;Q.port1.onmessage=D,Y=function(){G.postMessage(null)}}else Y=function(){x(D,0)};function X(K){S=K,k||(k=!0,Y())}function q(K,A){T=x(function(){K(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,X(b))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(K){switch(h){case 1:case 2:case 3:var A=3;break;default:A=h}var ne=h;h=A;try{return K()}finally{h=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,A){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ne=h;h=K;try{return A()}finally{h=ne}},e.unstable_scheduleCallback=function(K,A,ne){var ce=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ce+ne:ce):ne=ce,K){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=ne+R,K={id:f++,callback:A,priorityLevel:K,startTime:ne,expirationTime:R,sortIndex:-1},ne>ce?(K.sortIndex=ne,t(c,K),r(l)===null&&K===r(c)&&(m?(v(T),T=-1):m=!0,q(E,ne-ce))):(K.sortIndex=R,t(l,K),g||p||(g=!0,X(b))),K},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(K){var A=h;return function(){var ne=h;h=A;try{return K.apply(this,arguments)}finally{h=ne}}}})(hS);dS.exports=hS;var e3=dS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t3=_,Xn=e3;function me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pS=new Set,mf={};function pl(e,t){Pc(e,t),Pc(e+"Capture",t)}function Pc(e,t){for(mf[e]=t,e=0;e<t.length;e++)pS.add(t[e])}var Ks=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lg=Object.prototype.hasOwnProperty,r3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hw={},Gw={};function n3(e){return Lg.call(Gw,e)?!0:Lg.call(Hw,e)?!1:r3.test(e)?Gw[e]=!0:(Hw[e]=!0,!1)}function a3(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function s3(e,t,r,n){if(t===null||typeof t>"u"||a3(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function wn(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Wr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Wr[e]=new wn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Wr[t]=new wn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Wr[e]=new wn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Wr[e]=new wn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Wr[e]=new wn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Wr[e]=new wn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Wr[e]=new wn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Wr[e]=new wn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Wr[e]=new wn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Hv=/[\-:]([a-z])/g;function Gv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Hv,Gv);Wr[t]=new wn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Hv,Gv);Wr[t]=new wn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Hv,Gv);Wr[t]=new wn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Wr[e]=new wn(e,1,!1,e.toLowerCase(),null,!1,!1)});Wr.xlinkHref=new wn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Wr[e]=new wn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Kv(e,t,r,n){var a=Wr.hasOwnProperty(t)?Wr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(s3(t,r,a,n)&&(r=null),n||a===null?n3(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ei=t3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vd=Symbol.for("react.element"),Vl=Symbol.for("react.portal"),zl=Symbol.for("react.fragment"),qv=Symbol.for("react.strict_mode"),Bg=Symbol.for("react.profiler"),mS=Symbol.for("react.provider"),gS=Symbol.for("react.context"),Xv=Symbol.for("react.forward_ref"),Ug=Symbol.for("react.suspense"),$g=Symbol.for("react.suspense_list"),Yv=Symbol.for("react.memo"),gi=Symbol.for("react.lazy"),xS=Symbol.for("react.offscreen"),Kw=Symbol.iterator;function wu(e){return e===null||typeof e!="object"?null:(e=Kw&&e[Kw]||e["@@iterator"],typeof e=="function"?e:null)}var qt=Object.assign,km;function Iu(e){if(km===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);km=t&&t[1]||""}return`
`+km+e}var Cm=!1;function Tm(e,t){if(!e||Cm)return"";Cm=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Cm=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Iu(e):""}function i3(e){switch(e.tag){case 5:return Iu(e.type);case 16:return Iu("Lazy");case 13:return Iu("Suspense");case 19:return Iu("SuspenseList");case 0:case 2:case 15:return e=Tm(e.type,!1),e;case 11:return e=Tm(e.type.render,!1),e;case 1:return e=Tm(e.type,!0),e;default:return""}}function Wg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case zl:return"Fragment";case Vl:return"Portal";case Bg:return"Profiler";case qv:return"StrictMode";case Ug:return"Suspense";case $g:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case gS:return(e.displayName||"Context")+".Consumer";case mS:return(e._context.displayName||"Context")+".Provider";case Xv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Yv:return t=e.displayName||null,t!==null?t:Wg(e.type)||"Memo";case gi:t=e._payload,e=e._init;try{return Wg(e(t))}catch{}}return null}function o3(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wg(t);case 8:return t===qv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Xi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function vS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function l3(e){var t=vS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function zd(e){e._valueTracker||(e._valueTracker=l3(e))}function yS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=vS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Qh(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Vg(e,t){var r=t.checked;return qt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function qw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Xi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function wS(e,t){t=t.checked,t!=null&&Kv(e,"checked",t,!1)}function zg(e,t){wS(e,t);var r=Xi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Hg(e,t.type,r):t.hasOwnProperty("defaultValue")&&Hg(e,t.type,Xi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Xw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Hg(e,t,r){(t!=="number"||Qh(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Du=Array.isArray;function nc(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Xi(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Gg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(me(91));return qt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Yw(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(me(92));if(Du(r)){if(1<r.length)throw Error(me(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Xi(r)}}function _S(e,t){var r=Xi(t.value),n=Xi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Qw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ES(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ES(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Hd,bS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Hd=Hd||document.createElement("div"),Hd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Hd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function gf(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Gu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},c3=["Webkit","ms","Moz","O"];Object.keys(Gu).forEach(function(e){c3.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gu[t]=Gu[e]})});function SS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Gu.hasOwnProperty(e)&&Gu[e]?(""+t).trim():t+"px"}function kS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=SS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var u3=qt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qg(e,t){if(t){if(u3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(me(62))}}function Xg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yg=null;function Qv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qg=null,ac=null,sc=null;function Jw(e){if(e=vd(e)){if(typeof Qg!="function")throw Error(me(280));var t=e.stateNode;t&&(t=up(t),Qg(e.stateNode,e.type,t))}}function CS(e){ac?sc?sc.push(e):sc=[e]:ac=e}function TS(){if(ac){var e=ac,t=sc;if(sc=ac=null,Jw(e),t)for(e=0;e<t.length;e++)Jw(t[e])}}function NS(e,t){return e(t)}function AS(){}var Nm=!1;function RS(e,t,r){if(Nm)return e(t,r);Nm=!0;try{return NS(e,t,r)}finally{Nm=!1,(ac!==null||sc!==null)&&(AS(),TS())}}function xf(e,t){var r=e.stateNode;if(r===null)return null;var n=up(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(me(231,t,typeof r));return r}var Jg=!1;if(Ks)try{var _u={};Object.defineProperty(_u,"passive",{get:function(){Jg=!0}}),window.addEventListener("test",_u,_u),window.removeEventListener("test",_u,_u)}catch{Jg=!1}function f3(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var Ku=!1,Jh=null,Zh=!1,Zg=null,d3={onError:function(e){Ku=!0,Jh=e}};function h3(e,t,r,n,a,s,i,o,l){Ku=!1,Jh=null,f3.apply(d3,arguments)}function p3(e,t,r,n,a,s,i,o,l){if(h3.apply(this,arguments),Ku){if(Ku){var c=Jh;Ku=!1,Jh=null}else throw Error(me(198));Zh||(Zh=!0,Zg=c)}}function ml(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function PS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Zw(e){if(ml(e)!==e)throw Error(me(188))}function m3(e){var t=e.alternate;if(!t){if(t=ml(e),t===null)throw Error(me(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Zw(a),e;if(s===n)return Zw(a),t;s=s.sibling}throw Error(me(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(me(189))}}if(r.alternate!==n)throw Error(me(190))}if(r.tag!==3)throw Error(me(188));return r.stateNode.current===r?e:t}function jS(e){return e=m3(e),e!==null?FS(e):null}function FS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=FS(e);if(t!==null)return t;e=e.sibling}return null}var OS=Xn.unstable_scheduleCallback,e_=Xn.unstable_cancelCallback,g3=Xn.unstable_shouldYield,x3=Xn.unstable_requestPaint,ar=Xn.unstable_now,v3=Xn.unstable_getCurrentPriorityLevel,Jv=Xn.unstable_ImmediatePriority,IS=Xn.unstable_UserBlockingPriority,e0=Xn.unstable_NormalPriority,y3=Xn.unstable_LowPriority,DS=Xn.unstable_IdlePriority,ip=null,vs=null;function w3(e){if(vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(ip,e,void 0,(e.current.flags&128)===128)}catch{}}var Va=Math.clz32?Math.clz32:b3,_3=Math.log,E3=Math.LN2;function b3(e){return e>>>=0,e===0?32:31-(_3(e)/E3|0)|0}var Gd=64,Kd=4194304;function Mu(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function t0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Mu(o):(s&=i,s!==0&&(n=Mu(s)))}else i=r&~a,i!==0?n=Mu(i):s!==0&&(n=Mu(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Va(t),a=1<<r,n|=e[r],t&=~a;return n}function S3(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function k3(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Va(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=S3(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function ex(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function MS(){var e=Gd;return Gd<<=1,!(Gd&4194240)&&(Gd=64),e}function Am(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function gd(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Va(t),e[t]=r}function C3(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Va(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function Zv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Va(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var _t=0;function LS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var BS,e1,US,$S,WS,tx=!1,qd=[],Mi=null,Li=null,Bi=null,vf=new Map,yf=new Map,yi=[],T3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function t_(e,t){switch(e){case"focusin":case"focusout":Mi=null;break;case"dragenter":case"dragleave":Li=null;break;case"mouseover":case"mouseout":Bi=null;break;case"pointerover":case"pointerout":vf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":yf.delete(t.pointerId)}}function Eu(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=vd(t),t!==null&&e1(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function N3(e,t,r,n,a){switch(t){case"focusin":return Mi=Eu(Mi,e,t,r,n,a),!0;case"dragenter":return Li=Eu(Li,e,t,r,n,a),!0;case"mouseover":return Bi=Eu(Bi,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return vf.set(s,Eu(vf.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,yf.set(s,Eu(yf.get(s)||null,e,t,r,n,a)),!0}return!1}function VS(e){var t=bo(e.target);if(t!==null){var r=ml(t);if(r!==null){if(t=r.tag,t===13){if(t=PS(r),t!==null){e.blockedOn=t,WS(e.priority,function(){US(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function jh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=rx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Yg=n,r.target.dispatchEvent(n),Yg=null}else return t=vd(r),t!==null&&e1(t),e.blockedOn=r,!1;t.shift()}return!0}function r_(e,t,r){jh(e)&&r.delete(t)}function A3(){tx=!1,Mi!==null&&jh(Mi)&&(Mi=null),Li!==null&&jh(Li)&&(Li=null),Bi!==null&&jh(Bi)&&(Bi=null),vf.forEach(r_),yf.forEach(r_)}function bu(e,t){e.blockedOn===t&&(e.blockedOn=null,tx||(tx=!0,Xn.unstable_scheduleCallback(Xn.unstable_NormalPriority,A3)))}function wf(e){function t(a){return bu(a,e)}if(0<qd.length){bu(qd[0],e);for(var r=1;r<qd.length;r++){var n=qd[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Mi!==null&&bu(Mi,e),Li!==null&&bu(Li,e),Bi!==null&&bu(Bi,e),vf.forEach(t),yf.forEach(t),r=0;r<yi.length;r++)n=yi[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<yi.length&&(r=yi[0],r.blockedOn===null);)VS(r),r.blockedOn===null&&yi.shift()}var ic=ei.ReactCurrentBatchConfig,r0=!0;function R3(e,t,r,n){var a=_t,s=ic.transition;ic.transition=null;try{_t=1,t1(e,t,r,n)}finally{_t=a,ic.transition=s}}function P3(e,t,r,n){var a=_t,s=ic.transition;ic.transition=null;try{_t=4,t1(e,t,r,n)}finally{_t=a,ic.transition=s}}function t1(e,t,r,n){if(r0){var a=rx(e,t,r,n);if(a===null)Bm(e,t,n,n0,r),t_(e,n);else if(N3(a,e,t,r,n))n.stopPropagation();else if(t_(e,n),t&4&&-1<T3.indexOf(e)){for(;a!==null;){var s=vd(a);if(s!==null&&BS(s),s=rx(e,t,r,n),s===null&&Bm(e,t,n,n0,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Bm(e,t,n,null,r)}}var n0=null;function rx(e,t,r,n){if(n0=null,e=Qv(n),e=bo(e),e!==null)if(t=ml(e),t===null)e=null;else if(r=t.tag,r===13){if(e=PS(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return n0=e,null}function zS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(v3()){case Jv:return 1;case IS:return 4;case e0:case y3:return 16;case DS:return 536870912;default:return 16}default:return 16}}var Pi=null,r1=null,Fh=null;function HS(){if(Fh)return Fh;var e,t=r1,r=t.length,n,a="value"in Pi?Pi.value:Pi.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Fh=a.slice(e,1<n?1-n:void 0)}function Oh(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Xd(){return!0}function n_(){return!1}function Jn(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Xd:n_,this.isPropagationStopped=n_,this}return qt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Xd)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Xd)},persist:function(){},isPersistent:Xd}),t}var Yc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},n1=Jn(Yc),xd=qt({},Yc,{view:0,detail:0}),j3=Jn(xd),Rm,Pm,Su,op=qt({},xd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Su&&(Su&&e.type==="mousemove"?(Rm=e.screenX-Su.screenX,Pm=e.screenY-Su.screenY):Pm=Rm=0,Su=e),Rm)},movementY:function(e){return"movementY"in e?e.movementY:Pm}}),a_=Jn(op),F3=qt({},op,{dataTransfer:0}),O3=Jn(F3),I3=qt({},xd,{relatedTarget:0}),jm=Jn(I3),D3=qt({},Yc,{animationName:0,elapsedTime:0,pseudoElement:0}),M3=Jn(D3),L3=qt({},Yc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),B3=Jn(L3),U3=qt({},Yc,{data:0}),s_=Jn(U3),$3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function z3(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=V3[e])?!!t[e]:!1}function a1(){return z3}var H3=qt({},xd,{key:function(e){if(e.key){var t=$3[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Oh(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?W3[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a1,charCode:function(e){return e.type==="keypress"?Oh(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Oh(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),G3=Jn(H3),K3=qt({},op,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i_=Jn(K3),q3=qt({},xd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a1}),X3=Jn(q3),Y3=qt({},Yc,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q3=Jn(Y3),J3=qt({},op,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Z3=Jn(J3),eO=[9,13,27,32],s1=Ks&&"CompositionEvent"in window,qu=null;Ks&&"documentMode"in document&&(qu=document.documentMode);var tO=Ks&&"TextEvent"in window&&!qu,GS=Ks&&(!s1||qu&&8<qu&&11>=qu),o_=" ",l_=!1;function KS(e,t){switch(e){case"keyup":return eO.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Hl=!1;function rO(e,t){switch(e){case"compositionend":return qS(t);case"keypress":return t.which!==32?null:(l_=!0,o_);case"textInput":return e=t.data,e===o_&&l_?null:e;default:return null}}function nO(e,t){if(Hl)return e==="compositionend"||!s1&&KS(e,t)?(e=HS(),Fh=r1=Pi=null,Hl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return GS&&t.locale!=="ko"?null:t.data;default:return null}}var aO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function c_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!aO[e.type]:t==="textarea"}function XS(e,t,r,n){CS(n),t=a0(t,"onChange"),0<t.length&&(r=new n1("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xu=null,_f=null;function sO(e){ik(e,0)}function lp(e){var t=ql(e);if(yS(t))return e}function iO(e,t){if(e==="change")return t}var YS=!1;if(Ks){var Fm;if(Ks){var Om="oninput"in document;if(!Om){var u_=document.createElement("div");u_.setAttribute("oninput","return;"),Om=typeof u_.oninput=="function"}Fm=Om}else Fm=!1;YS=Fm&&(!document.documentMode||9<document.documentMode)}function f_(){Xu&&(Xu.detachEvent("onpropertychange",QS),_f=Xu=null)}function QS(e){if(e.propertyName==="value"&&lp(_f)){var t=[];XS(t,_f,e,Qv(e)),RS(sO,t)}}function oO(e,t,r){e==="focusin"?(f_(),Xu=t,_f=r,Xu.attachEvent("onpropertychange",QS)):e==="focusout"&&f_()}function lO(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lp(_f)}function cO(e,t){if(e==="click")return lp(t)}function uO(e,t){if(e==="input"||e==="change")return lp(t)}function fO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qa=typeof Object.is=="function"?Object.is:fO;function Ef(e,t){if(Qa(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Lg.call(t,a)||!Qa(e[a],t[a]))return!1}return!0}function d_(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function h_(e,t){var r=d_(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=d_(r)}}function JS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?JS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ZS(){for(var e=window,t=Qh();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Qh(e.document)}return t}function i1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function dO(e){var t=ZS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&JS(r.ownerDocument.documentElement,r)){if(n!==null&&i1(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=h_(r,s);var i=h_(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hO=Ks&&"documentMode"in document&&11>=document.documentMode,Gl=null,nx=null,Yu=null,ax=!1;function p_(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ax||Gl==null||Gl!==Qh(n)||(n=Gl,"selectionStart"in n&&i1(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yu&&Ef(Yu,n)||(Yu=n,n=a0(nx,"onSelect"),0<n.length&&(t=new n1("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Gl)))}function Yd(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Kl={animationend:Yd("Animation","AnimationEnd"),animationiteration:Yd("Animation","AnimationIteration"),animationstart:Yd("Animation","AnimationStart"),transitionend:Yd("Transition","TransitionEnd")},Im={},ek={};Ks&&(ek=document.createElement("div").style,"AnimationEvent"in window||(delete Kl.animationend.animation,delete Kl.animationiteration.animation,delete Kl.animationstart.animation),"TransitionEvent"in window||delete Kl.transitionend.transition);function cp(e){if(Im[e])return Im[e];if(!Kl[e])return e;var t=Kl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in ek)return Im[e]=t[r];return e}var tk=cp("animationend"),rk=cp("animationiteration"),nk=cp("animationstart"),ak=cp("transitionend"),sk=new Map,m_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function no(e,t){sk.set(e,t),pl(t,[e])}for(var Dm=0;Dm<m_.length;Dm++){var Mm=m_[Dm],pO=Mm.toLowerCase(),mO=Mm[0].toUpperCase()+Mm.slice(1);no(pO,"on"+mO)}no(tk,"onAnimationEnd");no(rk,"onAnimationIteration");no(nk,"onAnimationStart");no("dblclick","onDoubleClick");no("focusin","onFocus");no("focusout","onBlur");no(ak,"onTransitionEnd");Pc("onMouseEnter",["mouseout","mouseover"]);Pc("onMouseLeave",["mouseout","mouseover"]);Pc("onPointerEnter",["pointerout","pointerover"]);Pc("onPointerLeave",["pointerout","pointerover"]);pl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pl("onBeforeInput",["compositionend","keypress","textInput","paste"]);pl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gO=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lu));function g_(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,p3(n,t,void 0,e),e.currentTarget=null}function ik(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;g_(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;g_(a,o,c),s=l}}}if(Zh)throw e=Zg,Zh=!1,Zg=null,e}function Rt(e,t){var r=t[cx];r===void 0&&(r=t[cx]=new Set);var n=e+"__bubble";r.has(n)||(ok(t,e,2,!1),r.add(n))}function Lm(e,t,r){var n=0;t&&(n|=4),ok(r,e,n,t)}var Qd="_reactListening"+Math.random().toString(36).slice(2);function bf(e){if(!e[Qd]){e[Qd]=!0,pS.forEach(function(r){r!=="selectionchange"&&(gO.has(r)||Lm(r,!1,e),Lm(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Qd]||(t[Qd]=!0,Lm("selectionchange",!1,t))}}function ok(e,t,r,n){switch(zS(t)){case 1:var a=R3;break;case 4:a=P3;break;default:a=t1}r=a.bind(null,t,r,e),a=void 0,!Jg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Bm(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=bo(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}RS(function(){var c=s,f=Qv(r),d=[];e:{var h=sk.get(e);if(h!==void 0){var p=n1,g=e;switch(e){case"keypress":if(Oh(r)===0)break e;case"keydown":case"keyup":p=G3;break;case"focusin":g="focus",p=jm;break;case"focusout":g="blur",p=jm;break;case"beforeblur":case"afterblur":p=jm;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=a_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=O3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=X3;break;case tk:case rk:case nk:p=M3;break;case ak:p=Q3;break;case"scroll":p=j3;break;case"wheel":p=Z3;break;case"copy":case"cut":case"paste":p=B3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=i_}var m=(t&4)!==0,x=!m&&e==="scroll",v=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,w;y!==null;){w=y;var E=w.stateNode;if(w.tag===5&&E!==null&&(w=E,v!==null&&(E=xf(y,v),E!=null&&m.push(Sf(y,E,w)))),x)break;y=y.return}0<m.length&&(h=new p(h,g,null,r,f),d.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Yg&&(g=r.relatedTarget||r.fromElement)&&(bo(g)||g[qs]))break e;if((p||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=c,g=g?bo(g):null,g!==null&&(x=ml(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=c),p!==g)){if(m=a_,E="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=i_,E="onPointerLeave",v="onPointerEnter",y="pointer"),x=p==null?h:ql(p),w=g==null?h:ql(g),h=new m(E,y+"leave",p,r,f),h.target=x,h.relatedTarget=w,E=null,bo(f)===c&&(m=new m(v,y+"enter",g,r,f),m.target=w,m.relatedTarget=x,E=m),x=E,p&&g)t:{for(m=p,v=g,y=0,w=m;w;w=Cl(w))y++;for(w=0,E=v;E;E=Cl(E))w++;for(;0<y-w;)m=Cl(m),y--;for(;0<w-y;)v=Cl(v),w--;for(;y--;){if(m===v||v!==null&&m===v.alternate)break t;m=Cl(m),v=Cl(v)}m=null}else m=null;p!==null&&x_(d,h,p,m,!1),g!==null&&x!==null&&x_(d,x,g,m,!0)}}e:{if(h=c?ql(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var b=iO;else if(c_(h))if(YS)b=uO;else{b=lO;var k=oO}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=cO);if(b&&(b=b(e,c))){XS(d,b,r,f);break e}k&&k(e,h,c),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Hg(h,"number",h.value)}switch(k=c?ql(c):window,e){case"focusin":(c_(k)||k.contentEditable==="true")&&(Gl=k,nx=c,Yu=null);break;case"focusout":Yu=nx=Gl=null;break;case"mousedown":ax=!0;break;case"contextmenu":case"mouseup":case"dragend":ax=!1,p_(d,r,f);break;case"selectionchange":if(hO)break;case"keydown":case"keyup":p_(d,r,f)}var S;if(s1)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Hl?KS(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(GS&&r.locale!=="ko"&&(Hl||T!=="onCompositionStart"?T==="onCompositionEnd"&&Hl&&(S=HS()):(Pi=f,r1="value"in Pi?Pi.value:Pi.textContent,Hl=!0)),k=a0(c,T),0<k.length&&(T=new s_(T,e,null,r,f),d.push({event:T,listeners:k}),S?T.data=S:(S=qS(r),S!==null&&(T.data=S)))),(S=tO?rO(e,r):nO(e,r))&&(c=a0(c,"onBeforeInput"),0<c.length&&(f=new s_("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:c}),f.data=S))}ik(d,t)})}function Sf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function a0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=xf(e,r),s!=null&&n.unshift(Sf(e,s,a)),s=xf(e,t),s!=null&&n.push(Sf(e,s,a))),e=e.return}return n}function Cl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function x_(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=xf(r,s),l!=null&&i.unshift(Sf(r,l,o))):a||(l=xf(r,s),l!=null&&i.push(Sf(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var xO=/\r\n?/g,vO=/\u0000|\uFFFD/g;function v_(e){return(typeof e=="string"?e:""+e).replace(xO,`
`).replace(vO,"")}function Jd(e,t,r){if(t=v_(t),v_(e)!==t&&r)throw Error(me(425))}function s0(){}var sx=null,ix=null;function ox(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var lx=typeof setTimeout=="function"?setTimeout:void 0,yO=typeof clearTimeout=="function"?clearTimeout:void 0,y_=typeof Promise=="function"?Promise:void 0,wO=typeof queueMicrotask=="function"?queueMicrotask:typeof y_<"u"?function(e){return y_.resolve(null).then(e).catch(_O)}:lx;function _O(e){setTimeout(function(){throw e})}function Um(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),wf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);wf(t)}function Ui(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function w_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Qc=Math.random().toString(36).slice(2),ds="__reactFiber$"+Qc,kf="__reactProps$"+Qc,qs="__reactContainer$"+Qc,cx="__reactEvents$"+Qc,EO="__reactListeners$"+Qc,bO="__reactHandles$"+Qc;function bo(e){var t=e[ds];if(t)return t;for(var r=e.parentNode;r;){if(t=r[qs]||r[ds]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=w_(e);e!==null;){if(r=e[ds])return r;e=w_(e)}return t}e=r,r=e.parentNode}return null}function vd(e){return e=e[ds]||e[qs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ql(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(me(33))}function up(e){return e[kf]||null}var ux=[],Xl=-1;function ao(e){return{current:e}}function jt(e){0>Xl||(e.current=ux[Xl],ux[Xl]=null,Xl--)}function Tt(e,t){Xl++,ux[Xl]=e.current,e.current=t}var Yi={},en=ao(Yi),An=ao(!1),Ho=Yi;function jc(e,t){var r=e.type.contextTypes;if(!r)return Yi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Rn(e){return e=e.childContextTypes,e!=null}function i0(){jt(An),jt(en)}function __(e,t,r){if(en.current!==Yi)throw Error(me(168));Tt(en,t),Tt(An,r)}function lk(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(me(108,o3(e)||"Unknown",a));return qt({},r,n)}function o0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Yi,Ho=en.current,Tt(en,e),Tt(An,An.current),!0}function E_(e,t,r){var n=e.stateNode;if(!n)throw Error(me(169));r?(e=lk(e,t,Ho),n.__reactInternalMemoizedMergedChildContext=e,jt(An),jt(en),Tt(en,e)):jt(An),Tt(An,r)}var Os=null,fp=!1,$m=!1;function ck(e){Os===null?Os=[e]:Os.push(e)}function SO(e){fp=!0,ck(e)}function so(){if(!$m&&Os!==null){$m=!0;var e=0,t=_t;try{var r=Os;for(_t=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Os=null,fp=!1}catch(a){throw Os!==null&&(Os=Os.slice(e+1)),OS(Jv,so),a}finally{_t=t,$m=!1}}return null}var Yl=[],Ql=0,l0=null,c0=0,fa=[],da=0,Go=null,Bs=1,Us="";function go(e,t){Yl[Ql++]=c0,Yl[Ql++]=l0,l0=e,c0=t}function uk(e,t,r){fa[da++]=Bs,fa[da++]=Us,fa[da++]=Go,Go=e;var n=Bs;e=Us;var a=32-Va(n)-1;n&=~(1<<a),r+=1;var s=32-Va(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Bs=1<<32-Va(t)+a|r<<a|n,Us=s+e}else Bs=1<<s|r<<a|n,Us=e}function o1(e){e.return!==null&&(go(e,1),uk(e,1,0))}function l1(e){for(;e===l0;)l0=Yl[--Ql],Yl[Ql]=null,c0=Yl[--Ql],Yl[Ql]=null;for(;e===Go;)Go=fa[--da],fa[da]=null,Us=fa[--da],fa[da]=null,Bs=fa[--da],fa[da]=null}var Kn=null,Gn=null,It=!1,La=null;function fk(e,t){var r=ha(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function b_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Kn=e,Gn=Ui(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Kn=e,Gn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Go!==null?{id:Bs,overflow:Us}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ha(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Kn=e,Gn=null,!0):!1;default:return!1}}function fx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function dx(e){if(It){var t=Gn;if(t){var r=t;if(!b_(e,t)){if(fx(e))throw Error(me(418));t=Ui(r.nextSibling);var n=Kn;t&&b_(e,t)?fk(n,r):(e.flags=e.flags&-4097|2,It=!1,Kn=e)}}else{if(fx(e))throw Error(me(418));e.flags=e.flags&-4097|2,It=!1,Kn=e}}}function S_(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Kn=e}function Zd(e){if(e!==Kn)return!1;if(!It)return S_(e),It=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ox(e.type,e.memoizedProps)),t&&(t=Gn)){if(fx(e))throw dk(),Error(me(418));for(;t;)fk(e,t),t=Ui(t.nextSibling)}if(S_(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Gn=Ui(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Gn=null}}else Gn=Kn?Ui(e.stateNode.nextSibling):null;return!0}function dk(){for(var e=Gn;e;)e=Ui(e.nextSibling)}function Fc(){Gn=Kn=null,It=!1}function c1(e){La===null?La=[e]:La.push(e)}var kO=ei.ReactCurrentBatchConfig;function ku(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(me(309));var n=r.stateNode}if(!n)throw Error(me(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(me(284));if(!r._owner)throw Error(me(290,e))}return e}function eh(e,t){throw e=Object.prototype.toString.call(t),Error(me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function k_(e){var t=e._init;return t(e._payload)}function hk(e){function t(v,y){if(e){var w=v.deletions;w===null?(v.deletions=[y],v.flags|=16):w.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function n(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=zi(v,y),v.index=0,v.sibling=null,v}function s(v,y,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<y?(v.flags|=2,y):w):(v.flags|=2,y)):(v.flags|=1048576,y)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,y,w,E){return y===null||y.tag!==6?(y=qm(w,v.mode,E),y.return=v,y):(y=a(y,w),y.return=v,y)}function l(v,y,w,E){var b=w.type;return b===zl?f(v,y,w.props.children,E,w.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===gi&&k_(b)===y.type)?(E=a(y,w.props),E.ref=ku(v,y,w),E.return=v,E):(E=$h(w.type,w.key,w.props,null,v.mode,E),E.ref=ku(v,y,w),E.return=v,E)}function c(v,y,w,E){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=Xm(w,v.mode,E),y.return=v,y):(y=a(y,w.children||[]),y.return=v,y)}function f(v,y,w,E,b){return y===null||y.tag!==7?(y=Bo(w,v.mode,E,b),y.return=v,y):(y=a(y,w),y.return=v,y)}function d(v,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=qm(""+y,v.mode,w),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Vd:return w=$h(y.type,y.key,y.props,null,v.mode,w),w.ref=ku(v,null,y),w.return=v,w;case Vl:return y=Xm(y,v.mode,w),y.return=v,y;case gi:var E=y._init;return d(v,E(y._payload),w)}if(Du(y)||wu(y))return y=Bo(y,v.mode,w,null),y.return=v,y;eh(v,y)}return null}function h(v,y,w,E){var b=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return b!==null?null:o(v,y,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Vd:return w.key===b?l(v,y,w,E):null;case Vl:return w.key===b?c(v,y,w,E):null;case gi:return b=w._init,h(v,y,b(w._payload),E)}if(Du(w)||wu(w))return b!==null?null:f(v,y,w,E,null);eh(v,w)}return null}function p(v,y,w,E,b){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(w)||null,o(y,v,""+E,b);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Vd:return v=v.get(E.key===null?w:E.key)||null,l(y,v,E,b);case Vl:return v=v.get(E.key===null?w:E.key)||null,c(y,v,E,b);case gi:var k=E._init;return p(v,y,w,k(E._payload),b)}if(Du(E)||wu(E))return v=v.get(w)||null,f(y,v,E,b,null);eh(y,E)}return null}function g(v,y,w,E){for(var b=null,k=null,S=y,T=y=0,N=null;S!==null&&T<w.length;T++){S.index>T?(N=S,S=null):N=S.sibling;var O=h(v,S,w[T],E);if(O===null){S===null&&(S=N);break}e&&S&&O.alternate===null&&t(v,S),y=s(O,y,T),k===null?b=O:k.sibling=O,k=O,S=N}if(T===w.length)return r(v,S),It&&go(v,T),b;if(S===null){for(;T<w.length;T++)S=d(v,w[T],E),S!==null&&(y=s(S,y,T),k===null?b=S:k.sibling=S,k=S);return It&&go(v,T),b}for(S=n(v,S);T<w.length;T++)N=p(S,v,T,w[T],E),N!==null&&(e&&N.alternate!==null&&S.delete(N.key===null?T:N.key),y=s(N,y,T),k===null?b=N:k.sibling=N,k=N);return e&&S.forEach(function(j){return t(v,j)}),It&&go(v,T),b}function m(v,y,w,E){var b=wu(w);if(typeof b!="function")throw Error(me(150));if(w=b.call(w),w==null)throw Error(me(151));for(var k=b=null,S=y,T=y=0,N=null,O=w.next();S!==null&&!O.done;T++,O=w.next()){S.index>T?(N=S,S=null):N=S.sibling;var j=h(v,S,O.value,E);if(j===null){S===null&&(S=N);break}e&&S&&j.alternate===null&&t(v,S),y=s(j,y,T),k===null?b=j:k.sibling=j,k=j,S=N}if(O.done)return r(v,S),It&&go(v,T),b;if(S===null){for(;!O.done;T++,O=w.next())O=d(v,O.value,E),O!==null&&(y=s(O,y,T),k===null?b=O:k.sibling=O,k=O);return It&&go(v,T),b}for(S=n(v,S);!O.done;T++,O=w.next())O=p(S,v,T,O.value,E),O!==null&&(e&&O.alternate!==null&&S.delete(O.key===null?T:O.key),y=s(O,y,T),k===null?b=O:k.sibling=O,k=O);return e&&S.forEach(function(D){return t(v,D)}),It&&go(v,T),b}function x(v,y,w,E){if(typeof w=="object"&&w!==null&&w.type===zl&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Vd:e:{for(var b=w.key,k=y;k!==null;){if(k.key===b){if(b=w.type,b===zl){if(k.tag===7){r(v,k.sibling),y=a(k,w.props.children),y.return=v,v=y;break e}}else if(k.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===gi&&k_(b)===k.type){r(v,k.sibling),y=a(k,w.props),y.ref=ku(v,k,w),y.return=v,v=y;break e}r(v,k);break}else t(v,k);k=k.sibling}w.type===zl?(y=Bo(w.props.children,v.mode,E,w.key),y.return=v,v=y):(E=$h(w.type,w.key,w.props,null,v.mode,E),E.ref=ku(v,y,w),E.return=v,v=E)}return i(v);case Vl:e:{for(k=w.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){r(v,y.sibling),y=a(y,w.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=Xm(w,v.mode,E),y.return=v,v=y}return i(v);case gi:return k=w._init,x(v,y,k(w._payload),E)}if(Du(w))return g(v,y,w,E);if(wu(w))return m(v,y,w,E);eh(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,w),y.return=v,v=y):(r(v,y),y=qm(w,v.mode,E),y.return=v,v=y),i(v)):r(v,y)}return x}var Oc=hk(!0),pk=hk(!1),u0=ao(null),f0=null,Jl=null,u1=null;function f1(){u1=Jl=f0=null}function d1(e){var t=u0.current;jt(u0),e._currentValue=t}function hx(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function oc(e,t){f0=e,u1=Jl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Nn=!0),e.firstContext=null)}function _a(e){var t=e._currentValue;if(u1!==e)if(e={context:e,memoizedValue:t,next:null},Jl===null){if(f0===null)throw Error(me(308));Jl=e,f0.dependencies={lanes:0,firstContext:e}}else Jl=Jl.next=e;return t}var So=null;function h1(e){So===null?So=[e]:So.push(e)}function mk(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,h1(t)):(r.next=a.next,a.next=r),t.interleaved=r,Xs(e,n)}function Xs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var xi=!1;function p1(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ws(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function $i(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ct&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Xs(e,r)}return a=n.interleaved,a===null?(t.next=t,h1(n)):(t.next=a.next,a.next=t),n.interleaved=t,Xs(e,r)}function Ih(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Zv(e,r)}}function C_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function d0(e,t,r,n){var a=e.updateQueue;xi=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,f=c=l=null,o=s;do{var h=o.lane,p=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(h=t,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){d=g.call(p,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(p,d,h):g,h==null)break e;d=qt({},d,h);break e;case 2:xi=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=d):f=f.next=p,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);qo|=i,e.lanes=i,e.memoizedState=d}}function T_(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(me(191,a));a.call(n)}}}var yd={},ys=ao(yd),Cf=ao(yd),Tf=ao(yd);function ko(e){if(e===yd)throw Error(me(174));return e}function m1(e,t){switch(Tt(Tf,t),Tt(Cf,e),Tt(ys,yd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Kg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Kg(t,e)}jt(ys),Tt(ys,t)}function Ic(){jt(ys),jt(Cf),jt(Tf)}function xk(e){ko(Tf.current);var t=ko(ys.current),r=Kg(t,e.type);t!==r&&(Tt(Cf,e),Tt(ys,r))}function g1(e){Cf.current===e&&(jt(ys),jt(Cf))}var Vt=ao(0);function h0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Wm=[];function x1(){for(var e=0;e<Wm.length;e++)Wm[e]._workInProgressVersionPrimary=null;Wm.length=0}var Dh=ei.ReactCurrentDispatcher,Vm=ei.ReactCurrentBatchConfig,Ko=0,Kt=null,gr=null,Cr=null,p0=!1,Qu=!1,Nf=0,CO=0;function Hr(){throw Error(me(321))}function v1(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Qa(e[r],t[r]))return!1;return!0}function y1(e,t,r,n,a,s){if(Ko=s,Kt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Dh.current=e===null||e.memoizedState===null?RO:PO,e=r(n,a),Qu){s=0;do{if(Qu=!1,Nf=0,25<=s)throw Error(me(301));s+=1,Cr=gr=null,t.updateQueue=null,Dh.current=jO,e=r(n,a)}while(Qu)}if(Dh.current=m0,t=gr!==null&&gr.next!==null,Ko=0,Cr=gr=Kt=null,p0=!1,t)throw Error(me(300));return e}function w1(){var e=Nf!==0;return Nf=0,e}function ls(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cr===null?Kt.memoizedState=Cr=e:Cr=Cr.next=e,Cr}function Ea(){if(gr===null){var e=Kt.alternate;e=e!==null?e.memoizedState:null}else e=gr.next;var t=Cr===null?Kt.memoizedState:Cr.next;if(t!==null)Cr=t,gr=e;else{if(e===null)throw Error(me(310));gr=e,e={memoizedState:gr.memoizedState,baseState:gr.baseState,baseQueue:gr.baseQueue,queue:gr.queue,next:null},Cr===null?Kt.memoizedState=Cr=e:Cr=Cr.next=e}return Cr}function Af(e,t){return typeof t=="function"?t(e):t}function zm(e){var t=Ea(),r=t.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=e;var n=gr,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var f=c.lane;if((Ko&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,Kt.lanes|=f,qo|=f}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,Qa(n,t.memoizedState)||(Nn=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,Kt.lanes|=s,qo|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Hm(e){var t=Ea(),r=t.queue;if(r===null)throw Error(me(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);Qa(s,t.memoizedState)||(Nn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function vk(){}function yk(e,t){var r=Kt,n=Ea(),a=t(),s=!Qa(n.memoizedState,a);if(s&&(n.memoizedState=a,Nn=!0),n=n.queue,_1(Ek.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Cr!==null&&Cr.memoizedState.tag&1){if(r.flags|=2048,Rf(9,_k.bind(null,r,n,a,t),void 0,null),Rr===null)throw Error(me(349));Ko&30||wk(r,t,a)}return a}function wk(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Kt.updateQueue,t===null?(t={lastEffect:null,stores:null},Kt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function _k(e,t,r,n){t.value=r,t.getSnapshot=n,bk(t)&&Sk(e)}function Ek(e,t,r){return r(function(){bk(t)&&Sk(e)})}function bk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qa(e,r)}catch{return!0}}function Sk(e){var t=Xs(e,1);t!==null&&za(t,e,1,-1)}function N_(e){var t=ls();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Af,lastRenderedState:e},t.queue=e,e=e.dispatch=AO.bind(null,Kt,e),[t.memoizedState,e]}function Rf(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Kt.updateQueue,t===null?(t={lastEffect:null,stores:null},Kt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function kk(){return Ea().memoizedState}function Mh(e,t,r,n){var a=ls();Kt.flags|=e,a.memoizedState=Rf(1|t,r,void 0,n===void 0?null:n)}function dp(e,t,r,n){var a=Ea();n=n===void 0?null:n;var s=void 0;if(gr!==null){var i=gr.memoizedState;if(s=i.destroy,n!==null&&v1(n,i.deps)){a.memoizedState=Rf(t,r,s,n);return}}Kt.flags|=e,a.memoizedState=Rf(1|t,r,s,n)}function A_(e,t){return Mh(8390656,8,e,t)}function _1(e,t){return dp(2048,8,e,t)}function Ck(e,t){return dp(4,2,e,t)}function Tk(e,t){return dp(4,4,e,t)}function Nk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ak(e,t,r){return r=r!=null?r.concat([e]):null,dp(4,4,Nk.bind(null,t,e),r)}function E1(){}function Rk(e,t){var r=Ea();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&v1(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Pk(e,t){var r=Ea();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&v1(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function jk(e,t,r){return Ko&21?(Qa(r,t)||(r=MS(),Kt.lanes|=r,qo|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Nn=!0),e.memoizedState=r)}function TO(e,t){var r=_t;_t=r!==0&&4>r?r:4,e(!0);var n=Vm.transition;Vm.transition={};try{e(!1),t()}finally{_t=r,Vm.transition=n}}function Fk(){return Ea().memoizedState}function NO(e,t,r){var n=Vi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ok(e))Ik(t,r);else if(r=mk(e,t,r,n),r!==null){var a=xn();za(r,e,n,a),Dk(r,t,n)}}function AO(e,t,r){var n=Vi(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ok(e))Ik(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,Qa(o,i)){var l=t.interleaved;l===null?(a.next=a,h1(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=mk(e,t,a,n),r!==null&&(a=xn(),za(r,e,n,a),Dk(r,t,n))}}function Ok(e){var t=e.alternate;return e===Kt||t!==null&&t===Kt}function Ik(e,t){Qu=p0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Dk(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Zv(e,r)}}var m0={readContext:_a,useCallback:Hr,useContext:Hr,useEffect:Hr,useImperativeHandle:Hr,useInsertionEffect:Hr,useLayoutEffect:Hr,useMemo:Hr,useReducer:Hr,useRef:Hr,useState:Hr,useDebugValue:Hr,useDeferredValue:Hr,useTransition:Hr,useMutableSource:Hr,useSyncExternalStore:Hr,useId:Hr,unstable_isNewReconciler:!1},RO={readContext:_a,useCallback:function(e,t){return ls().memoizedState=[e,t===void 0?null:t],e},useContext:_a,useEffect:A_,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Mh(4194308,4,Nk.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mh(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mh(4,2,e,t)},useMemo:function(e,t){var r=ls();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ls();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=NO.bind(null,Kt,e),[n.memoizedState,e]},useRef:function(e){var t=ls();return e={current:e},t.memoizedState=e},useState:N_,useDebugValue:E1,useDeferredValue:function(e){return ls().memoizedState=e},useTransition:function(){var e=N_(!1),t=e[0];return e=TO.bind(null,e[1]),ls().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Kt,a=ls();if(It){if(r===void 0)throw Error(me(407));r=r()}else{if(r=t(),Rr===null)throw Error(me(349));Ko&30||wk(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,A_(Ek.bind(null,n,s,e),[e]),n.flags|=2048,Rf(9,_k.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=ls(),t=Rr.identifierPrefix;if(It){var r=Us,n=Bs;r=(n&~(1<<32-Va(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Nf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=CO++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},PO={readContext:_a,useCallback:Rk,useContext:_a,useEffect:_1,useImperativeHandle:Ak,useInsertionEffect:Ck,useLayoutEffect:Tk,useMemo:Pk,useReducer:zm,useRef:kk,useState:function(){return zm(Af)},useDebugValue:E1,useDeferredValue:function(e){var t=Ea();return jk(t,gr.memoizedState,e)},useTransition:function(){var e=zm(Af)[0],t=Ea().memoizedState;return[e,t]},useMutableSource:vk,useSyncExternalStore:yk,useId:Fk,unstable_isNewReconciler:!1},jO={readContext:_a,useCallback:Rk,useContext:_a,useEffect:_1,useImperativeHandle:Ak,useInsertionEffect:Ck,useLayoutEffect:Tk,useMemo:Pk,useReducer:Hm,useRef:kk,useState:function(){return Hm(Af)},useDebugValue:E1,useDeferredValue:function(e){var t=Ea();return gr===null?t.memoizedState=e:jk(t,gr.memoizedState,e)},useTransition:function(){var e=Hm(Af)[0],t=Ea().memoizedState;return[e,t]},useMutableSource:vk,useSyncExternalStore:yk,useId:Fk,unstable_isNewReconciler:!1};function ja(e,t){if(e&&e.defaultProps){t=qt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function px(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:qt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var hp={isMounted:function(e){return(e=e._reactInternals)?ml(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=xn(),a=Vi(e),s=Ws(n,a);s.payload=t,r!=null&&(s.callback=r),t=$i(e,s,a),t!==null&&(za(t,e,a,n),Ih(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=xn(),a=Vi(e),s=Ws(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=$i(e,s,a),t!==null&&(za(t,e,a,n),Ih(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=xn(),n=Vi(e),a=Ws(r,n);a.tag=2,t!=null&&(a.callback=t),t=$i(e,a,n),t!==null&&(za(t,e,n,r),Ih(t,e,n))}};function R_(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!Ef(r,n)||!Ef(a,s):!0}function Mk(e,t,r){var n=!1,a=Yi,s=t.contextType;return typeof s=="object"&&s!==null?s=_a(s):(a=Rn(t)?Ho:en.current,n=t.contextTypes,s=(n=n!=null)?jc(e,a):Yi),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=hp,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function P_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&hp.enqueueReplaceState(t,t.state,null)}function mx(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},p1(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=_a(s):(s=Rn(t)?Ho:en.current,a.context=jc(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(px(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&hp.enqueueReplaceState(a,a.state,null),d0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Dc(e,t){try{var r="",n=t;do r+=i3(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Gm(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function gx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var FO=typeof WeakMap=="function"?WeakMap:Map;function Lk(e,t,r){r=Ws(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){x0||(x0=!0,Cx=n),gx(e,t)},r}function Bk(e,t,r){r=Ws(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){gx(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){gx(e,t),typeof n!="function"&&(Wi===null?Wi=new Set([this]):Wi.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function j_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new FO;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=KO.bind(null,e,t,r),t.then(e,e))}function F_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function O_(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ws(-1,1),t.tag=2,$i(r,t,1))),r.lanes|=1),e)}var OO=ei.ReactCurrentOwner,Nn=!1;function un(e,t,r,n){t.child=e===null?pk(t,null,r,n):Oc(t,e.child,r,n)}function I_(e,t,r,n,a){r=r.render;var s=t.ref;return oc(t,a),n=y1(e,t,r,n,s,a),r=w1(),e!==null&&!Nn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ys(e,t,a)):(It&&r&&o1(t),t.flags|=1,un(e,t,n,a),t.child)}function D_(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!R1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Uk(e,t,s,n,a)):(e=$h(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:Ef,r(i,n)&&e.ref===t.ref)return Ys(e,t,a)}return t.flags|=1,e=zi(s,n),e.ref=t.ref,e.return=t,t.child=e}function Uk(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Ef(s,n)&&e.ref===t.ref)if(Nn=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Nn=!0);else return t.lanes=e.lanes,Ys(e,t,a)}return xx(e,t,r,n,a)}function $k(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(ec,Ln),Ln|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Tt(ec,Ln),Ln|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Tt(ec,Ln),Ln|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Tt(ec,Ln),Ln|=n;return un(e,t,a,r),t.child}function Wk(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function xx(e,t,r,n,a){var s=Rn(r)?Ho:en.current;return s=jc(t,s),oc(t,a),r=y1(e,t,r,n,s,a),n=w1(),e!==null&&!Nn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ys(e,t,a)):(It&&n&&o1(t),t.flags|=1,un(e,t,r,a),t.child)}function M_(e,t,r,n,a){if(Rn(r)){var s=!0;o0(t)}else s=!1;if(oc(t,a),t.stateNode===null)Lh(e,t),Mk(t,r,n),mx(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=_a(c):(c=Rn(r)?Ho:en.current,c=jc(t,c));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&P_(t,i,n,c),xi=!1;var h=t.memoizedState;i.state=h,d0(t,n,i,a),l=t.memoizedState,o!==n||h!==l||An.current||xi?(typeof f=="function"&&(px(t,r,f,n),l=t.memoizedState),(o=xi||R_(t,r,o,n,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,gk(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:ja(t.type,o),i.props=c,d=t.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=_a(l):(l=Rn(r)?Ho:en.current,l=jc(t,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==l)&&P_(t,i,n,l),xi=!1,h=t.memoizedState,i.state=h,d0(t,n,i,a);var g=t.memoizedState;o!==d||h!==g||An.current||xi?(typeof p=="function"&&(px(t,r,p,n),g=t.memoizedState),(c=xi||R_(t,r,c,n,h,g,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return vx(e,t,r,n,s,a)}function vx(e,t,r,n,a,s){Wk(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&E_(t,r,!1),Ys(e,t,s);n=t.stateNode,OO.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Oc(t,e.child,null,s),t.child=Oc(t,null,o,s)):un(e,t,o,s),t.memoizedState=n.state,a&&E_(t,r,!0),t.child}function Vk(e){var t=e.stateNode;t.pendingContext?__(e,t.pendingContext,t.pendingContext!==t.context):t.context&&__(e,t.context,!1),m1(e,t.containerInfo)}function L_(e,t,r,n,a){return Fc(),c1(a),t.flags|=256,un(e,t,r,n),t.child}var yx={dehydrated:null,treeContext:null,retryLane:0};function wx(e){return{baseLanes:e,cachePool:null,transitions:null}}function zk(e,t,r){var n=t.pendingProps,a=Vt.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Tt(Vt,a&1),e===null)return dx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=gp(i,n,0,null),e=Bo(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=wx(r),t.memoizedState=yx,e):b1(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return IO(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=zi(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=zi(o,s):(s=Bo(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?wx(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=yx,n}return s=e.child,e=s.sibling,n=zi(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function b1(e,t){return t=gp({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function th(e,t,r,n){return n!==null&&c1(n),Oc(t,e.child,null,r),e=b1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function IO(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Gm(Error(me(422))),th(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=gp({mode:"visible",children:n.children},a,0,null),s=Bo(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Oc(t,e.child,null,i),t.child.memoizedState=wx(i),t.memoizedState=yx,s);if(!(t.mode&1))return th(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(me(419)),n=Gm(s,n,void 0),th(e,t,i,n)}if(o=(i&e.childLanes)!==0,Nn||o){if(n=Rr,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Xs(e,a),za(n,e,a,-1))}return A1(),n=Gm(Error(me(421))),th(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=qO.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Gn=Ui(a.nextSibling),Kn=t,It=!0,La=null,e!==null&&(fa[da++]=Bs,fa[da++]=Us,fa[da++]=Go,Bs=e.id,Us=e.overflow,Go=t),t=b1(t,n.children),t.flags|=4096,t)}function B_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),hx(e.return,t,r)}function Km(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Hk(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(un(e,t,n.children,r),n=Vt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&B_(e,r,t);else if(e.tag===19)B_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Tt(Vt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&h0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Km(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&h0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Km(t,!0,r,null,s);break;case"together":Km(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Lh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ys(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),qo|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(me(153));if(t.child!==null){for(e=t.child,r=zi(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=zi(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function DO(e,t,r){switch(t.tag){case 3:Vk(t),Fc();break;case 5:xk(t);break;case 1:Rn(t.type)&&o0(t);break;case 4:m1(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Tt(u0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Tt(Vt,Vt.current&1),t.flags|=128,null):r&t.child.childLanes?zk(e,t,r):(Tt(Vt,Vt.current&1),e=Ys(e,t,r),e!==null?e.sibling:null);Tt(Vt,Vt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Hk(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Tt(Vt,Vt.current),n)break;return null;case 22:case 23:return t.lanes=0,$k(e,t,r)}return Ys(e,t,r)}var Gk,_x,Kk,qk;Gk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};_x=function(){};Kk=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,ko(ys.current);var s=null;switch(r){case"input":a=Vg(e,a),n=Vg(e,n),s=[];break;case"select":a=qt({},a,{value:void 0}),n=qt({},n,{value:void 0}),s=[];break;case"textarea":a=Gg(e,a),n=Gg(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=s0)}qg(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(mf.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(mf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Rt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};qk=function(e,t,r,n){r!==n&&(t.flags|=4)};function Cu(e,t){if(!It)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Gr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function MO(e,t,r){var n=t.pendingProps;switch(l1(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gr(t),null;case 1:return Rn(t.type)&&i0(),Gr(t),null;case 3:return n=t.stateNode,Ic(),jt(An),jt(en),x1(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Zd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,La!==null&&(Ax(La),La=null))),_x(e,t),Gr(t),null;case 5:g1(t);var a=ko(Tf.current);if(r=t.type,e!==null&&t.stateNode!=null)Kk(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(me(166));return Gr(t),null}if(e=ko(ys.current),Zd(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[ds]=t,n[kf]=s,e=(t.mode&1)!==0,r){case"dialog":Rt("cancel",n),Rt("close",n);break;case"iframe":case"object":case"embed":Rt("load",n);break;case"video":case"audio":for(a=0;a<Lu.length;a++)Rt(Lu[a],n);break;case"source":Rt("error",n);break;case"img":case"image":case"link":Rt("error",n),Rt("load",n);break;case"details":Rt("toggle",n);break;case"input":qw(n,s),Rt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Rt("invalid",n);break;case"textarea":Yw(n,s),Rt("invalid",n)}qg(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Jd(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Jd(n.textContent,o,e),a=["children",""+o]):mf.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Rt("scroll",n)}switch(r){case"input":zd(n),Xw(n,s,!0);break;case"textarea":zd(n),Qw(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=s0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ES(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ds]=t,e[kf]=n,Gk(e,t,!1,!1),t.stateNode=e;e:{switch(i=Xg(r,n),r){case"dialog":Rt("cancel",e),Rt("close",e),a=n;break;case"iframe":case"object":case"embed":Rt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Lu.length;a++)Rt(Lu[a],e);a=n;break;case"source":Rt("error",e),a=n;break;case"img":case"image":case"link":Rt("error",e),Rt("load",e),a=n;break;case"details":Rt("toggle",e),a=n;break;case"input":qw(e,n),a=Vg(e,n),Rt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=qt({},n,{value:void 0}),Rt("invalid",e);break;case"textarea":Yw(e,n),a=Gg(e,n),Rt("invalid",e);break;default:a=n}qg(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?kS(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&bS(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&gf(e,l):typeof l=="number"&&gf(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(mf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Rt("scroll",e):l!=null&&Kv(e,s,l,i))}switch(r){case"input":zd(e),Xw(e,n,!1);break;case"textarea":zd(e),Qw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Xi(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?nc(e,!!n.multiple,s,!1):n.defaultValue!=null&&nc(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=s0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Gr(t),null;case 6:if(e&&t.stateNode!=null)qk(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(me(166));if(r=ko(Tf.current),ko(ys.current),Zd(t)){if(n=t.stateNode,r=t.memoizedProps,n[ds]=t,(s=n.nodeValue!==r)&&(e=Kn,e!==null))switch(e.tag){case 3:Jd(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Jd(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ds]=t,t.stateNode=n}return Gr(t),null;case 13:if(jt(Vt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(It&&Gn!==null&&t.mode&1&&!(t.flags&128))dk(),Fc(),t.flags|=98560,s=!1;else if(s=Zd(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(me(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(me(317));s[ds]=t}else Fc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Gr(t),s=!1}else La!==null&&(Ax(La),La=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Vt.current&1?_r===0&&(_r=3):A1())),t.updateQueue!==null&&(t.flags|=4),Gr(t),null);case 4:return Ic(),_x(e,t),e===null&&bf(t.stateNode.containerInfo),Gr(t),null;case 10:return d1(t.type._context),Gr(t),null;case 17:return Rn(t.type)&&i0(),Gr(t),null;case 19:if(jt(Vt),s=t.memoizedState,s===null)return Gr(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)Cu(s,!1);else{if(_r!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=h0(e),i!==null){for(t.flags|=128,Cu(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Tt(Vt,Vt.current&1|2),t.child}e=e.sibling}s.tail!==null&&ar()>Mc&&(t.flags|=128,n=!0,Cu(s,!1),t.lanes=4194304)}else{if(!n)if(e=h0(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Cu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!It)return Gr(t),null}else 2*ar()-s.renderingStartTime>Mc&&r!==1073741824&&(t.flags|=128,n=!0,Cu(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ar(),t.sibling=null,r=Vt.current,Tt(Vt,n?r&1|2:r&1),t):(Gr(t),null);case 22:case 23:return N1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ln&1073741824&&(Gr(t),t.subtreeFlags&6&&(t.flags|=8192)):Gr(t),null;case 24:return null;case 25:return null}throw Error(me(156,t.tag))}function LO(e,t){switch(l1(t),t.tag){case 1:return Rn(t.type)&&i0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ic(),jt(An),jt(en),x1(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return g1(t),null;case 13:if(jt(Vt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(me(340));Fc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return jt(Vt),null;case 4:return Ic(),null;case 10:return d1(t.type._context),null;case 22:case 23:return N1(),null;case 24:return null;default:return null}}var rh=!1,Yr=!1,BO=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function Zl(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Qt(e,t,n)}else r.current=null}function Ex(e,t,r){try{r()}catch(n){Qt(e,t,n)}}var U_=!1;function UO(e,t){if(sx=r0,e=ZS(),i1(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,d=e,h=null;t:for(;;){for(var p;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===e)break t;if(h===r&&++c===a&&(o=i),h===s&&++f===n&&(l=i),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ix={focusedElem:e,selectionRange:r},r0=!1,Ne=t;Ne!==null;)if(t=Ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ne=e;else for(;Ne!==null;){t=Ne;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,x=g.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:ja(t.type,m),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(me(163))}}catch(E){Qt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,Ne=e;break}Ne=t.return}return g=U_,U_=!1,g}function Ju(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Ex(t,r,s)}a=a.next}while(a!==n)}}function pp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function bx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Xk(e){var t=e.alternate;t!==null&&(e.alternate=null,Xk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ds],delete t[kf],delete t[cx],delete t[EO],delete t[bO])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Yk(e){return e.tag===5||e.tag===3||e.tag===4}function $_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Yk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Sx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=s0));else if(n!==4&&(e=e.child,e!==null))for(Sx(e,t,r),e=e.sibling;e!==null;)Sx(e,t,r),e=e.sibling}function kx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(kx(e,t,r),e=e.sibling;e!==null;)kx(e,t,r),e=e.sibling}var Dr=null,Da=!1;function ui(e,t,r){for(r=r.child;r!==null;)Qk(e,t,r),r=r.sibling}function Qk(e,t,r){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(ip,r)}catch{}switch(r.tag){case 5:Yr||Zl(r,t);case 6:var n=Dr,a=Da;Dr=null,ui(e,t,r),Dr=n,Da=a,Dr!==null&&(Da?(e=Dr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Dr.removeChild(r.stateNode));break;case 18:Dr!==null&&(Da?(e=Dr,r=r.stateNode,e.nodeType===8?Um(e.parentNode,r):e.nodeType===1&&Um(e,r),wf(e)):Um(Dr,r.stateNode));break;case 4:n=Dr,a=Da,Dr=r.stateNode.containerInfo,Da=!0,ui(e,t,r),Dr=n,Da=a;break;case 0:case 11:case 14:case 15:if(!Yr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Ex(r,t,i),a=a.next}while(a!==n)}ui(e,t,r);break;case 1:if(!Yr&&(Zl(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Qt(r,t,o)}ui(e,t,r);break;case 21:ui(e,t,r);break;case 22:r.mode&1?(Yr=(n=Yr)||r.memoizedState!==null,ui(e,t,r),Yr=n):ui(e,t,r);break;default:ui(e,t,r)}}function W_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new BO),t.forEach(function(n){var a=XO.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ta(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:Dr=o.stateNode,Da=!1;break e;case 3:Dr=o.stateNode.containerInfo,Da=!0;break e;case 4:Dr=o.stateNode.containerInfo,Da=!0;break e}o=o.return}if(Dr===null)throw Error(me(160));Qk(s,i,a),Dr=null,Da=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Qt(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Jk(t,e),t=t.sibling}function Jk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ta(t,e),as(e),n&4){try{Ju(3,e,e.return),pp(3,e)}catch(m){Qt(e,e.return,m)}try{Ju(5,e,e.return)}catch(m){Qt(e,e.return,m)}}break;case 1:Ta(t,e),as(e),n&512&&r!==null&&Zl(r,r.return);break;case 5:if(Ta(t,e),as(e),n&512&&r!==null&&Zl(r,r.return),e.flags&32){var a=e.stateNode;try{gf(a,"")}catch(m){Qt(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&wS(a,s),Xg(o,i);var c=Xg(o,s);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?kS(a,d):f==="dangerouslySetInnerHTML"?bS(a,d):f==="children"?gf(a,d):Kv(a,f,d,c)}switch(o){case"input":zg(a,s);break;case"textarea":_S(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?nc(a,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?nc(a,!!s.multiple,s.defaultValue,!0):nc(a,!!s.multiple,s.multiple?[]:"",!1))}a[kf]=s}catch(m){Qt(e,e.return,m)}}break;case 6:if(Ta(t,e),as(e),n&4){if(e.stateNode===null)throw Error(me(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){Qt(e,e.return,m)}}break;case 3:if(Ta(t,e),as(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{wf(t.containerInfo)}catch(m){Qt(e,e.return,m)}break;case 4:Ta(t,e),as(e);break;case 13:Ta(t,e),as(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(C1=ar())),n&4&&W_(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Yr=(c=Yr)||f,Ta(t,e),Yr=c):Ta(t,e),as(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(Ne=e,f=e.child;f!==null;){for(d=Ne=f;Ne!==null;){switch(h=Ne,p=h.child,h.tag){case 0:case 11:case 14:case 15:Ju(4,h,h.return);break;case 1:Zl(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Qt(n,r,m)}}break;case 5:Zl(h,h.return);break;case 22:if(h.memoizedState!==null){z_(d);continue}}p!==null?(p.return=h,Ne=p):z_(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=SS("display",i))}catch(m){Qt(e,e.return,m)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Qt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ta(t,e),as(e),n&4&&W_(e);break;case 21:break;default:Ta(t,e),as(e)}}function as(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Yk(r)){var n=r;break e}r=r.return}throw Error(me(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(gf(a,""),n.flags&=-33);var s=$_(e);kx(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=$_(e);Sx(e,o,i);break;default:throw Error(me(161))}}catch(l){Qt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $O(e,t,r){Ne=e,Zk(e)}function Zk(e,t,r){for(var n=(e.mode&1)!==0;Ne!==null;){var a=Ne,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||rh;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Yr;o=rh;var c=Yr;if(rh=i,(Yr=l)&&!c)for(Ne=a;Ne!==null;)i=Ne,l=i.child,i.tag===22&&i.memoizedState!==null?H_(a):l!==null?(l.return=i,Ne=l):H_(a);for(;s!==null;)Ne=s,Zk(s),s=s.sibling;Ne=a,rh=o,Yr=c}V_(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Ne=s):V_(e)}}function V_(e){for(;Ne!==null;){var t=Ne;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Yr||pp(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Yr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ja(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&T_(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}T_(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&wf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(me(163))}Yr||t.flags&512&&bx(t)}catch(h){Qt(t,t.return,h)}}if(t===e){Ne=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function z_(e){for(;Ne!==null;){var t=Ne;if(t===e){Ne=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ne=r;break}Ne=t.return}}function H_(e){for(;Ne!==null;){var t=Ne;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{pp(4,t)}catch(l){Qt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Qt(t,a,l)}}var s=t.return;try{bx(t)}catch(l){Qt(t,s,l)}break;case 5:var i=t.return;try{bx(t)}catch(l){Qt(t,i,l)}}}catch(l){Qt(t,t.return,l)}if(t===e){Ne=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ne=o;break}Ne=t.return}}var WO=Math.ceil,g0=ei.ReactCurrentDispatcher,S1=ei.ReactCurrentOwner,ga=ei.ReactCurrentBatchConfig,ct=0,Rr=null,hr=null,$r=0,Ln=0,ec=ao(0),_r=0,Pf=null,qo=0,mp=0,k1=0,Zu=null,Tn=null,C1=0,Mc=1/0,js=null,x0=!1,Cx=null,Wi=null,nh=!1,ji=null,v0=0,ef=0,Tx=null,Bh=-1,Uh=0;function xn(){return ct&6?ar():Bh!==-1?Bh:Bh=ar()}function Vi(e){return e.mode&1?ct&2&&$r!==0?$r&-$r:kO.transition!==null?(Uh===0&&(Uh=MS()),Uh):(e=_t,e!==0||(e=window.event,e=e===void 0?16:zS(e.type)),e):1}function za(e,t,r,n){if(50<ef)throw ef=0,Tx=null,Error(me(185));gd(e,r,n),(!(ct&2)||e!==Rr)&&(e===Rr&&(!(ct&2)&&(mp|=r),_r===4&&wi(e,$r)),Pn(e,n),r===1&&ct===0&&!(t.mode&1)&&(Mc=ar()+500,fp&&so()))}function Pn(e,t){var r=e.callbackNode;k3(e,t);var n=t0(e,e===Rr?$r:0);if(n===0)r!==null&&e_(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&e_(r),t===1)e.tag===0?SO(G_.bind(null,e)):ck(G_.bind(null,e)),wO(function(){!(ct&6)&&so()}),r=null;else{switch(LS(n)){case 1:r=Jv;break;case 4:r=IS;break;case 16:r=e0;break;case 536870912:r=DS;break;default:r=e0}r=oC(r,eC.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function eC(e,t){if(Bh=-1,Uh=0,ct&6)throw Error(me(327));var r=e.callbackNode;if(lc()&&e.callbackNode!==r)return null;var n=t0(e,e===Rr?$r:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=y0(e,n);else{t=n;var a=ct;ct|=2;var s=rC();(Rr!==e||$r!==t)&&(js=null,Mc=ar()+500,Lo(e,t));do try{HO();break}catch(o){tC(e,o)}while(!0);f1(),g0.current=s,ct=a,hr!==null?t=0:(Rr=null,$r=0,t=_r)}if(t!==0){if(t===2&&(a=ex(e),a!==0&&(n=a,t=Nx(e,a))),t===1)throw r=Pf,Lo(e,0),wi(e,n),Pn(e,ar()),r;if(t===6)wi(e,n);else{if(a=e.current.alternate,!(n&30)&&!VO(a)&&(t=y0(e,n),t===2&&(s=ex(e),s!==0&&(n=s,t=Nx(e,s))),t===1))throw r=Pf,Lo(e,0),wi(e,n),Pn(e,ar()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(me(345));case 2:xo(e,Tn,js);break;case 3:if(wi(e,n),(n&130023424)===n&&(t=C1+500-ar(),10<t)){if(t0(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){xn(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=lx(xo.bind(null,e,Tn,js),t);break}xo(e,Tn,js);break;case 4:if(wi(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Va(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=ar()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*WO(n/1960))-n,10<n){e.timeoutHandle=lx(xo.bind(null,e,Tn,js),n);break}xo(e,Tn,js);break;case 5:xo(e,Tn,js);break;default:throw Error(me(329))}}}return Pn(e,ar()),e.callbackNode===r?eC.bind(null,e):null}function Nx(e,t){var r=Zu;return e.current.memoizedState.isDehydrated&&(Lo(e,t).flags|=256),e=y0(e,t),e!==2&&(t=Tn,Tn=r,t!==null&&Ax(t)),e}function Ax(e){Tn===null?Tn=e:Tn.push.apply(Tn,e)}function VO(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!Qa(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function wi(e,t){for(t&=~k1,t&=~mp,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Va(t),n=1<<r;e[r]=-1,t&=~n}}function G_(e){if(ct&6)throw Error(me(327));lc();var t=t0(e,0);if(!(t&1))return Pn(e,ar()),null;var r=y0(e,t);if(e.tag!==0&&r===2){var n=ex(e);n!==0&&(t=n,r=Nx(e,n))}if(r===1)throw r=Pf,Lo(e,0),wi(e,t),Pn(e,ar()),r;if(r===6)throw Error(me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xo(e,Tn,js),Pn(e,ar()),null}function T1(e,t){var r=ct;ct|=1;try{return e(t)}finally{ct=r,ct===0&&(Mc=ar()+500,fp&&so())}}function Xo(e){ji!==null&&ji.tag===0&&!(ct&6)&&lc();var t=ct;ct|=1;var r=ga.transition,n=_t;try{if(ga.transition=null,_t=1,e)return e()}finally{_t=n,ga.transition=r,ct=t,!(ct&6)&&so()}}function N1(){Ln=ec.current,jt(ec)}function Lo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,yO(r)),hr!==null)for(r=hr.return;r!==null;){var n=r;switch(l1(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&i0();break;case 3:Ic(),jt(An),jt(en),x1();break;case 5:g1(n);break;case 4:Ic();break;case 13:jt(Vt);break;case 19:jt(Vt);break;case 10:d1(n.type._context);break;case 22:case 23:N1()}r=r.return}if(Rr=e,hr=e=zi(e.current,null),$r=Ln=t,_r=0,Pf=null,k1=mp=qo=0,Tn=Zu=null,So!==null){for(t=0;t<So.length;t++)if(r=So[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}So=null}return e}function tC(e,t){do{var r=hr;try{if(f1(),Dh.current=m0,p0){for(var n=Kt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}p0=!1}if(Ko=0,Cr=gr=Kt=null,Qu=!1,Nf=0,S1.current=null,r===null||r.return===null){_r=1,Pf=t,hr=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=$r,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=F_(i);if(p!==null){p.flags&=-257,O_(p,i,o,s,t),p.mode&1&&j_(s,c,t),t=p,l=c;var g=t.updateQueue;if(g===null){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}else{if(!(t&1)){j_(s,c,t),A1();break e}l=Error(me(426))}}else if(It&&o.mode&1){var x=F_(i);if(x!==null){!(x.flags&65536)&&(x.flags|=256),O_(x,i,o,s,t),c1(Dc(l,o));break e}}s=l=Dc(l,o),_r!==4&&(_r=2),Zu===null?Zu=[s]:Zu.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=Lk(s,l,t);C_(s,v);break e;case 1:o=l;var y=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Wi===null||!Wi.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=Bk(s,o,t);C_(s,E);break e}}s=s.return}while(s!==null)}aC(r)}catch(b){t=b,hr===r&&r!==null&&(hr=r=r.return);continue}break}while(!0)}function rC(){var e=g0.current;return g0.current=m0,e===null?m0:e}function A1(){(_r===0||_r===3||_r===2)&&(_r=4),Rr===null||!(qo&268435455)&&!(mp&268435455)||wi(Rr,$r)}function y0(e,t){var r=ct;ct|=2;var n=rC();(Rr!==e||$r!==t)&&(js=null,Lo(e,t));do try{zO();break}catch(a){tC(e,a)}while(!0);if(f1(),ct=r,g0.current=n,hr!==null)throw Error(me(261));return Rr=null,$r=0,_r}function zO(){for(;hr!==null;)nC(hr)}function HO(){for(;hr!==null&&!g3();)nC(hr)}function nC(e){var t=iC(e.alternate,e,Ln);e.memoizedProps=e.pendingProps,t===null?aC(e):hr=t,S1.current=null}function aC(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=LO(r,t),r!==null){r.flags&=32767,hr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_r=6,hr=null;return}}else if(r=MO(r,t,Ln),r!==null){hr=r;return}if(t=t.sibling,t!==null){hr=t;return}hr=t=e}while(t!==null);_r===0&&(_r=5)}function xo(e,t,r){var n=_t,a=ga.transition;try{ga.transition=null,_t=1,GO(e,t,r,n)}finally{ga.transition=a,_t=n}return null}function GO(e,t,r,n){do lc();while(ji!==null);if(ct&6)throw Error(me(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(me(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(C3(e,s),e===Rr&&(hr=Rr=null,$r=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||nh||(nh=!0,oC(e0,function(){return lc(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ga.transition,ga.transition=null;var i=_t;_t=1;var o=ct;ct|=4,S1.current=null,UO(e,r),Jk(r,e),dO(ix),r0=!!sx,ix=sx=null,e.current=r,$O(r),x3(),ct=o,_t=i,ga.transition=s}else e.current=r;if(nh&&(nh=!1,ji=e,v0=a),s=e.pendingLanes,s===0&&(Wi=null),w3(r.stateNode),Pn(e,ar()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(x0)throw x0=!1,e=Cx,Cx=null,e;return v0&1&&e.tag!==0&&lc(),s=e.pendingLanes,s&1?e===Tx?ef++:(ef=0,Tx=e):ef=0,so(),null}function lc(){if(ji!==null){var e=LS(v0),t=ga.transition,r=_t;try{if(ga.transition=null,_t=16>e?16:e,ji===null)var n=!1;else{if(e=ji,ji=null,v0=0,ct&6)throw Error(me(331));var a=ct;for(ct|=4,Ne=e.current;Ne!==null;){var s=Ne,i=s.child;if(Ne.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ne=c;Ne!==null;){var f=Ne;switch(f.tag){case 0:case 11:case 15:Ju(8,f,s)}var d=f.child;if(d!==null)d.return=f,Ne=d;else for(;Ne!==null;){f=Ne;var h=f.sibling,p=f.return;if(Xk(f),f===c){Ne=null;break}if(h!==null){h.return=p,Ne=h;break}Ne=p}}}var g=s.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}Ne=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Ne=i;else e:for(;Ne!==null;){if(s=Ne,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ju(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Ne=v;break e}Ne=s.return}}var y=e.current;for(Ne=y;Ne!==null;){i=Ne;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Ne=w;else e:for(i=y;Ne!==null;){if(o=Ne,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:pp(9,o)}}catch(b){Qt(o,o.return,b)}if(o===i){Ne=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,Ne=E;break e}Ne=o.return}}if(ct=a,so(),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(ip,e)}catch{}n=!0}return n}finally{_t=r,ga.transition=t}}return!1}function K_(e,t,r){t=Dc(r,t),t=Lk(e,t,1),e=$i(e,t,1),t=xn(),e!==null&&(gd(e,1,t),Pn(e,t))}function Qt(e,t,r){if(e.tag===3)K_(e,e,r);else for(;t!==null;){if(t.tag===3){K_(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Wi===null||!Wi.has(n))){e=Dc(r,e),e=Bk(t,e,1),t=$i(t,e,1),e=xn(),t!==null&&(gd(t,1,e),Pn(t,e));break}}t=t.return}}function KO(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=xn(),e.pingedLanes|=e.suspendedLanes&r,Rr===e&&($r&r)===r&&(_r===4||_r===3&&($r&130023424)===$r&&500>ar()-C1?Lo(e,0):k1|=r),Pn(e,t)}function sC(e,t){t===0&&(e.mode&1?(t=Kd,Kd<<=1,!(Kd&130023424)&&(Kd=4194304)):t=1);var r=xn();e=Xs(e,t),e!==null&&(gd(e,t,r),Pn(e,r))}function qO(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),sC(e,r)}function XO(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(me(314))}n!==null&&n.delete(t),sC(e,r)}var iC;iC=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||An.current)Nn=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Nn=!1,DO(e,t,r);Nn=!!(e.flags&131072)}else Nn=!1,It&&t.flags&1048576&&uk(t,c0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Lh(e,t),e=t.pendingProps;var a=jc(t,en.current);oc(t,r),a=y1(null,t,n,e,a,r);var s=w1();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rn(n)?(s=!0,o0(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,p1(t),a.updater=hp,t.stateNode=a,a._reactInternals=t,mx(t,n,e,r),t=vx(null,t,n,!0,s,r)):(t.tag=0,It&&s&&o1(t),un(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Lh(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=QO(n),e=ja(n,e),a){case 0:t=xx(null,t,n,e,r);break e;case 1:t=M_(null,t,n,e,r);break e;case 11:t=I_(null,t,n,e,r);break e;case 14:t=D_(null,t,n,ja(n.type,e),r);break e}throw Error(me(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ja(n,a),xx(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ja(n,a),M_(e,t,n,a,r);case 3:e:{if(Vk(t),e===null)throw Error(me(387));n=t.pendingProps,s=t.memoizedState,a=s.element,gk(e,t),d0(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Dc(Error(me(423)),t),t=L_(e,t,n,r,a);break e}else if(n!==a){a=Dc(Error(me(424)),t),t=L_(e,t,n,r,a);break e}else for(Gn=Ui(t.stateNode.containerInfo.firstChild),Kn=t,It=!0,La=null,r=pk(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Fc(),n===a){t=Ys(e,t,r);break e}un(e,t,n,r)}t=t.child}return t;case 5:return xk(t),e===null&&dx(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,ox(n,a)?i=null:s!==null&&ox(n,s)&&(t.flags|=32),Wk(e,t),un(e,t,i,r),t.child;case 6:return e===null&&dx(t),null;case 13:return zk(e,t,r);case 4:return m1(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Oc(t,null,n,r):un(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ja(n,a),I_(e,t,n,a,r);case 7:return un(e,t,t.pendingProps,r),t.child;case 8:return un(e,t,t.pendingProps.children,r),t.child;case 12:return un(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Tt(u0,n._currentValue),n._currentValue=i,s!==null)if(Qa(s.value,i)){if(s.children===a.children&&!An.current){t=Ys(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Ws(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),hx(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(me(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),hx(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}un(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,oc(t,r),a=_a(a),n=n(a),t.flags|=1,un(e,t,n,r),t.child;case 14:return n=t.type,a=ja(n,t.pendingProps),a=ja(n.type,a),D_(e,t,n,a,r);case 15:return Uk(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:ja(n,a),Lh(e,t),t.tag=1,Rn(n)?(e=!0,o0(t)):e=!1,oc(t,r),Mk(t,n,a),mx(t,n,a,r),vx(null,t,n,!0,e,r);case 19:return Hk(e,t,r);case 22:return $k(e,t,r)}throw Error(me(156,t.tag))};function oC(e,t){return OS(e,t)}function YO(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ha(e,t,r,n){return new YO(e,t,r,n)}function R1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function QO(e){if(typeof e=="function")return R1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xv)return 11;if(e===Yv)return 14}return 2}function zi(e,t){var r=e.alternate;return r===null?(r=ha(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function $h(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")R1(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case zl:return Bo(r.children,a,s,t);case qv:i=8,a|=8;break;case Bg:return e=ha(12,r,t,a|2),e.elementType=Bg,e.lanes=s,e;case Ug:return e=ha(13,r,t,a),e.elementType=Ug,e.lanes=s,e;case $g:return e=ha(19,r,t,a),e.elementType=$g,e.lanes=s,e;case xS:return gp(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case mS:i=10;break e;case gS:i=9;break e;case Xv:i=11;break e;case Yv:i=14;break e;case gi:i=16,n=null;break e}throw Error(me(130,e==null?e:typeof e,""))}return t=ha(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Bo(e,t,r,n){return e=ha(7,e,n,t),e.lanes=r,e}function gp(e,t,r,n){return e=ha(22,e,n,t),e.elementType=xS,e.lanes=r,e.stateNode={isHidden:!1},e}function qm(e,t,r){return e=ha(6,e,null,t),e.lanes=r,e}function Xm(e,t,r){return t=ha(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function JO(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Am(0),this.expirationTimes=Am(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Am(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function P1(e,t,r,n,a,s,i,o,l){return e=new JO(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=ha(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},p1(s),e}function ZO(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function lC(e){if(!e)return Yi;e=e._reactInternals;e:{if(ml(e)!==e||e.tag!==1)throw Error(me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(me(171))}if(e.tag===1){var r=e.type;if(Rn(r))return lk(e,r,t)}return t}function cC(e,t,r,n,a,s,i,o,l){return e=P1(r,n,!0,e,a,s,i,o,l),e.context=lC(null),r=e.current,n=xn(),a=Vi(r),s=Ws(n,a),s.callback=t??null,$i(r,s,a),e.current.lanes=a,gd(e,a,n),Pn(e,n),e}function xp(e,t,r,n){var a=t.current,s=xn(),i=Vi(a);return r=lC(r),t.context===null?t.context=r:t.pendingContext=r,t=Ws(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=$i(a,t,i),e!==null&&(za(e,a,i,s),Ih(e,a,i)),i}function w0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function q_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function j1(e,t){q_(e,t),(e=e.alternate)&&q_(e,t)}function eI(){return null}var uC=typeof reportError=="function"?reportError:function(e){console.error(e)};function F1(e){this._internalRoot=e}vp.prototype.render=F1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(me(409));xp(e,t,null,null)};vp.prototype.unmount=F1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Xo(function(){xp(null,e,null,null)}),t[qs]=null}};function vp(e){this._internalRoot=e}vp.prototype.unstable_scheduleHydration=function(e){if(e){var t=$S();e={blockedOn:null,target:e,priority:t};for(var r=0;r<yi.length&&t!==0&&t<yi[r].priority;r++);yi.splice(r,0,e),r===0&&VS(e)}};function O1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function yp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function X_(){}function tI(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=w0(i);s.call(c)}}var i=cC(t,n,e,0,null,!1,!1,"",X_);return e._reactRootContainer=i,e[qs]=i.current,bf(e.nodeType===8?e.parentNode:e),Xo(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=w0(l);o.call(c)}}var l=P1(e,0,!1,null,null,!1,!1,"",X_);return e._reactRootContainer=l,e[qs]=l.current,bf(e.nodeType===8?e.parentNode:e),Xo(function(){xp(t,l,r,n)}),l}function wp(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=w0(i);o.call(l)}}xp(t,i,e,a)}else i=tI(r,t,e,a,n);return w0(i)}BS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Mu(t.pendingLanes);r!==0&&(Zv(t,r|1),Pn(t,ar()),!(ct&6)&&(Mc=ar()+500,so()))}break;case 13:Xo(function(){var n=Xs(e,1);if(n!==null){var a=xn();za(n,e,1,a)}}),j1(e,1)}};e1=function(e){if(e.tag===13){var t=Xs(e,134217728);if(t!==null){var r=xn();za(t,e,134217728,r)}j1(e,134217728)}};US=function(e){if(e.tag===13){var t=Vi(e),r=Xs(e,t);if(r!==null){var n=xn();za(r,e,t,n)}j1(e,t)}};$S=function(){return _t};WS=function(e,t){var r=_t;try{return _t=e,t()}finally{_t=r}};Qg=function(e,t,r){switch(t){case"input":if(zg(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=up(n);if(!a)throw Error(me(90));yS(n),zg(n,a)}}}break;case"textarea":_S(e,r);break;case"select":t=r.value,t!=null&&nc(e,!!r.multiple,t,!1)}};NS=T1;AS=Xo;var rI={usingClientEntryPoint:!1,Events:[vd,ql,up,CS,TS,T1]},Tu={findFiberByHostInstance:bo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nI={bundleType:Tu.bundleType,version:Tu.version,rendererPackageName:Tu.rendererPackageName,rendererConfig:Tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ei.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=jS(e),e===null?null:e.stateNode},findFiberByHostInstance:Tu.findFiberByHostInstance||eI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ah=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ah.isDisabled&&ah.supportsFiber)try{ip=ah.inject(nI),vs=ah}catch{}}Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rI;Qn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O1(t))throw Error(me(200));return ZO(e,t,null,r)};Qn.createRoot=function(e,t){if(!O1(e))throw Error(me(299));var r=!1,n="",a=uC;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=P1(e,1,!1,null,null,r,!1,n,a),e[qs]=t.current,bf(e.nodeType===8?e.parentNode:e),new F1(t)};Qn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(me(188)):(e=Object.keys(e).join(","),Error(me(268,e)));return e=jS(t),e=e===null?null:e.stateNode,e};Qn.flushSync=function(e){return Xo(e)};Qn.hydrate=function(e,t,r){if(!yp(t))throw Error(me(200));return wp(null,e,t,!0,r)};Qn.hydrateRoot=function(e,t,r){if(!O1(e))throw Error(me(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=uC;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=cC(t,null,e,1,r??null,a,!1,s,i),e[qs]=t.current,bf(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new vp(t)};Qn.render=function(e,t,r){if(!yp(t))throw Error(me(200));return wp(null,e,t,!1,r)};Qn.unmountComponentAtNode=function(e){if(!yp(e))throw Error(me(40));return e._reactRootContainer?(Xo(function(){wp(null,null,e,!1,function(){e._reactRootContainer=null,e[qs]=null})}),!0):!1};Qn.unstable_batchedUpdates=T1;Qn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!yp(r))throw Error(me(200));if(e==null||e._reactInternals===void 0)throw Error(me(38));return wp(e,t,r,!1,n)};Qn.version="18.3.1-next-f1338f8080-20240426";function fC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fC)}catch(e){console.error(e)}}fC(),fS.exports=Qn;var gl=fS.exports;const dC=Zb(gl);var hC,Y_=gl;hC=Y_.createRoot,Y_.hydrateRoot;const aI=1,sI=1e6;let Ym=0;function iI(){return Ym=(Ym+1)%Number.MAX_SAFE_INTEGER,Ym.toString()}const Qm=new Map,Q_=e=>{if(Qm.has(e))return;const t=setTimeout(()=>{Qm.delete(e),tf({type:"REMOVE_TOAST",toastId:e})},sI);Qm.set(e,t)},oI=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,aI)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?Q_(r):e.toasts.forEach(n=>{Q_(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Wh=[];let Vh={toasts:[]};function tf(e){Vh=oI(Vh,e),Wh.forEach(t=>{t(Vh)})}function lI({...e}){const t=iI(),r=a=>tf({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>tf({type:"DISMISS_TOAST",toastId:t});return tf({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function cI(){const[e,t]=_.useState(Vh);return _.useEffect(()=>(Wh.push(t),()=>{const r=Wh.indexOf(t);r>-1&&Wh.splice(r,1)}),[e]),{...e,toast:lI,dismiss:r=>tf({type:"DISMISS_TOAST",toastId:r})}}function ge(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function J_(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function ti(...e){return t=>{let r=!1;const n=e.map(a=>{const s=J_(a,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let a=0;a<n.length;a++){const s=n[a];typeof s=="function"?s():J_(e[a],null)}}}}function Ke(...e){return _.useCallback(ti(...e),e)}function uI(e,t){const r=_.createContext(t),n=s=>{const{children:i,...o}=s,l=_.useMemo(()=>o,Object.values(o));return u.jsx(r.Provider,{value:l,children:i})};n.displayName=e+"Provider";function a(s){const i=_.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[n,a]}function rn(e,t=[]){let r=[];function n(s,i){const o=_.createContext(i),l=r.length;r=[...r,i];const c=d=>{var v;const{scope:h,children:p,...g}=d,m=((v=h==null?void 0:h[e])==null?void 0:v[l])||o,x=_.useMemo(()=>g,Object.values(g));return u.jsx(m.Provider,{value:x,children:p})};c.displayName=s+"Provider";function f(d,h){var m;const p=((m=h==null?void 0:h[e])==null?void 0:m[l])||o,g=_.useContext(p);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,f]}const a=()=>{const s=r.map(i=>_.createContext(i));return function(o){const l=(o==null?void 0:o[e])||s;return _.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return a.scopeName=e,[n,fI(a,...t)]}function fI(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const i=n.reduce((o,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...o,...d}},{});return _.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}function Z_(e){const t=dI(e),r=_.forwardRef((n,a)=>{const{children:s,...i}=n,o=_.Children.toArray(s),l=o.find(pI);if(l){const c=l.props.children,f=o.map(d=>d===l?_.Children.count(c)>1?_.Children.only(null):_.isValidElement(c)?c.props.children:null:d);return u.jsx(t,{...i,ref:a,children:_.isValidElement(c)?_.cloneElement(c,void 0,f):null})}return u.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}function dI(e){const t=_.forwardRef((r,n)=>{const{children:a,...s}=r;if(_.isValidElement(a)){const i=gI(a),o=mI(s,a.props);return a.type!==_.Fragment&&(o.ref=n?ti(n,i):i),_.cloneElement(a,o)}return _.Children.count(a)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var hI=Symbol("radix.slottable");function pI(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===hI}function mI(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function gI(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function wd(e){const t=e+"CollectionProvider",[r,n]=rn(t),[a,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=m=>{const{scope:x,children:v}=m,y=de.useRef(null),w=de.useRef(new Map).current;return u.jsx(a,{scope:x,itemMap:w,collectionRef:y,children:v})};i.displayName=t;const o=e+"CollectionSlot",l=Z_(o),c=de.forwardRef((m,x)=>{const{scope:v,children:y}=m,w=s(o,v),E=Ke(x,w.collectionRef);return u.jsx(l,{ref:E,children:y})});c.displayName=o;const f=e+"CollectionItemSlot",d="data-radix-collection-item",h=Z_(f),p=de.forwardRef((m,x)=>{const{scope:v,children:y,...w}=m,E=de.useRef(null),b=Ke(x,E),k=s(f,v);return de.useEffect(()=>(k.itemMap.set(E,{ref:E,...w}),()=>void k.itemMap.delete(E))),u.jsx(h,{[d]:"",ref:b,children:y})});p.displayName=f;function g(m){const x=s(e+"CollectionConsumer",m);return de.useCallback(()=>{const y=x.collectionRef.current;if(!y)return[];const w=Array.from(y.querySelectorAll(`[${d}]`));return Array.from(x.itemMap.values()).sort((k,S)=>w.indexOf(k.ref.current)-w.indexOf(S.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:i,Slot:c,ItemSlot:p},g,n]}function xI(e){const t=vI(e),r=_.forwardRef((n,a)=>{const{children:s,...i}=n,o=_.Children.toArray(s),l=o.find(wI);if(l){const c=l.props.children,f=o.map(d=>d===l?_.Children.count(c)>1?_.Children.only(null):_.isValidElement(c)?c.props.children:null:d);return u.jsx(t,{...i,ref:a,children:_.isValidElement(c)?_.cloneElement(c,void 0,f):null})}return u.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}function vI(e){const t=_.forwardRef((r,n)=>{const{children:a,...s}=r;if(_.isValidElement(a)){const i=EI(a),o=_I(s,a.props);return a.type!==_.Fragment&&(o.ref=n?ti(n,i):i),_.cloneElement(a,o)}return _.Children.count(a)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var yI=Symbol("radix.slottable");function wI(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===yI}function _I(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function EI(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var bI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ae=bI.reduce((e,t)=>{const r=xI(`Primitive.${t}`),n=_.forwardRef((a,s)=>{const{asChild:i,...o}=a,l=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function I1(e,t){e&&gl.flushSync(()=>e.dispatchEvent(t))}function sr(e){const t=_.useRef(e);return _.useEffect(()=>{t.current=e}),_.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function SI(e,t=globalThis==null?void 0:globalThis.document){const r=sr(e);_.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var kI="DismissableLayer",Rx="dismissableLayer.update",CI="dismissableLayer.pointerDownOutside",TI="dismissableLayer.focusOutside",e2,pC=_.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Jc=_.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:i,onDismiss:o,...l}=e,c=_.useContext(pC),[f,d]=_.useState(null),h=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=_.useState({}),g=Ke(t,S=>d(S)),m=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=m.indexOf(x),y=f?m.indexOf(f):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,E=y>=v,b=AI(S=>{const T=S.target,N=[...c.branches].some(O=>O.contains(T));!E||N||(a==null||a(S),i==null||i(S),S.defaultPrevented||o==null||o())},h),k=RI(S=>{const T=S.target;[...c.branches].some(O=>O.contains(T))||(s==null||s(S),i==null||i(S),S.defaultPrevented||o==null||o())},h);return SI(S=>{y===c.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&o&&(S.preventDefault(),o()))},h),_.useEffect(()=>{if(f)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(e2=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(f)),c.layers.add(f),t2(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=e2)}},[f,h,r,c]),_.useEffect(()=>()=>{f&&(c.layers.delete(f),c.layersWithOutsidePointerEventsDisabled.delete(f),t2())},[f,c]),_.useEffect(()=>{const S=()=>p({});return document.addEventListener(Rx,S),()=>document.removeEventListener(Rx,S)},[]),u.jsx(Ae.div,{...l,ref:g,style:{pointerEvents:w?E?"auto":"none":void 0,...e.style},onFocusCapture:ge(e.onFocusCapture,k.onFocusCapture),onBlurCapture:ge(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:ge(e.onPointerDownCapture,b.onPointerDownCapture)})});Jc.displayName=kI;var NI="DismissableLayerBranch",mC=_.forwardRef((e,t)=>{const r=_.useContext(pC),n=_.useRef(null),a=Ke(t,n);return _.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),u.jsx(Ae.div,{...e,ref:a})});mC.displayName=NI;function AI(e,t=globalThis==null?void 0:globalThis.document){const r=sr(e),n=_.useRef(!1),a=_.useRef(()=>{});return _.useEffect(()=>{const s=o=>{if(o.target&&!n.current){let l=function(){gC(CI,r,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=l,t.addEventListener("click",a.current,{once:!0})):l()}else t.removeEventListener("click",a.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function RI(e,t=globalThis==null?void 0:globalThis.document){const r=sr(e),n=_.useRef(!1);return _.useEffect(()=>{const a=s=>{s.target&&!n.current&&gC(TI,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function t2(){const e=new CustomEvent(Rx);document.dispatchEvent(e)}function gC(e,t,r,{discrete:n}){const a=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?I1(a,s):a.dispatchEvent(s)}var PI=Jc,jI=mC,Er=globalThis!=null&&globalThis.document?_.useLayoutEffect:()=>{},FI="Portal",_d=_.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[a,s]=_.useState(!1);Er(()=>s(!0),[]);const i=r||a&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return i?dC.createPortal(u.jsx(Ae.div,{...n,ref:t}),i):null});_d.displayName=FI;function OI(e,t){return _.useReducer((r,n)=>t[r][n]??r,e)}var Vr=e=>{const{present:t,children:r}=e,n=II(t),a=typeof r=="function"?r({present:n.isPresent}):_.Children.only(r),s=Ke(n.ref,DI(a));return typeof r=="function"||n.isPresent?_.cloneElement(a,{ref:s}):null};Vr.displayName="Presence";function II(e){const[t,r]=_.useState(),n=_.useRef(null),a=_.useRef(e),s=_.useRef("none"),i=e?"mounted":"unmounted",[o,l]=OI(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return _.useEffect(()=>{const c=sh(n.current);s.current=o==="mounted"?c:"none"},[o]),Er(()=>{const c=n.current,f=a.current;if(f!==e){const h=s.current,p=sh(c);e?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(f&&h!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,l]),Er(()=>{if(t){let c;const f=t.ownerDocument.defaultView??window,d=p=>{const m=sh(n.current).includes(CSS.escape(p.animationName));if(p.target===t&&m&&(l("ANIMATION_END"),!a.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",c=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},h=p=>{p.target===t&&(s.current=sh(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{f.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:_.useCallback(c=>{n.current=c?getComputedStyle(c):null,r(c)},[])}}function sh(e){return(e==null?void 0:e.animationName)||"none"}function DI(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var MI=sp[" useInsertionEffect ".trim().toString()]||Er;function ba({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,s,i]=LI({defaultProp:t,onChange:r}),o=e!==void 0,l=o?e:a;{const f=_.useRef(e!==void 0);_.useEffect(()=>{const d=f.current;d!==o&&console.warn(`${n} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=o},[o,n])}const c=_.useCallback(f=>{var d;if(o){const h=BI(f)?f(e):f;h!==e&&((d=i.current)==null||d.call(i,h))}else s(f)},[o,e,s,i]);return[l,c]}function LI({defaultProp:e,onChange:t}){const[r,n]=_.useState(e),a=_.useRef(r),s=_.useRef(t);return MI(()=>{s.current=t},[t]),_.useEffect(()=>{var i;a.current!==r&&((i=s.current)==null||i.call(s,r),a.current=r)},[r,a]),[r,n,s]}function BI(e){return typeof e=="function"}var xC=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),UI="VisuallyHidden",_p=_.forwardRef((e,t)=>u.jsx(Ae.span,{...e,ref:t,style:{...xC,...e.style}}));_p.displayName=UI;var $I=_p,D1="ToastProvider",[M1,WI,VI]=wd("Toast"),[vC]=rn("Toast",[VI]),[zI,Ep]=vC(D1),yC=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:s=50,children:i}=e,[o,l]=_.useState(null),[c,f]=_.useState(0),d=_.useRef(!1),h=_.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${D1}\`. Expected non-empty \`string\`.`),u.jsx(M1.Provider,{scope:t,children:u.jsx(zI,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:s,toastCount:c,viewport:o,onViewportChange:l,onToastAdd:_.useCallback(()=>f(p=>p+1),[]),onToastRemove:_.useCallback(()=>f(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:i})})};yC.displayName=D1;var wC="ToastViewport",HI=["F8"],Px="toast.viewportPause",jx="toast.viewportResume",_C=_.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=HI,label:a="Notifications ({hotkey})",...s}=e,i=Ep(wC,r),o=WI(r),l=_.useRef(null),c=_.useRef(null),f=_.useRef(null),d=_.useRef(null),h=Ke(t,d,i.onViewportChange),p=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=i.toastCount>0;_.useEffect(()=>{const x=v=>{var w;n.length!==0&&n.every(E=>v[E]||v.code===E)&&((w=d.current)==null||w.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[n]),_.useEffect(()=>{const x=l.current,v=d.current;if(g&&x&&v){const y=()=>{if(!i.isClosePausedRef.current){const k=new CustomEvent(Px);v.dispatchEvent(k),i.isClosePausedRef.current=!0}},w=()=>{if(i.isClosePausedRef.current){const k=new CustomEvent(jx);v.dispatchEvent(k),i.isClosePausedRef.current=!1}},E=k=>{!x.contains(k.relatedTarget)&&w()},b=()=>{x.contains(document.activeElement)||w()};return x.addEventListener("focusin",y),x.addEventListener("focusout",E),x.addEventListener("pointermove",y),x.addEventListener("pointerleave",b),window.addEventListener("blur",y),window.addEventListener("focus",w),()=>{x.removeEventListener("focusin",y),x.removeEventListener("focusout",E),x.removeEventListener("pointermove",y),x.removeEventListener("pointerleave",b),window.removeEventListener("blur",y),window.removeEventListener("focus",w)}}},[g,i.isClosePausedRef]);const m=_.useCallback(({tabbingDirection:x})=>{const y=o().map(w=>{const E=w.ref.current,b=[E,...aD(E)];return x==="forwards"?b:b.reverse()});return(x==="forwards"?y.reverse():y).flat()},[o]);return _.useEffect(()=>{const x=d.current;if(x){const v=y=>{var b,k,S;const w=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!w){const T=document.activeElement,N=y.shiftKey;if(y.target===x&&N){(b=c.current)==null||b.focus();return}const D=m({tabbingDirection:N?"backwards":"forwards"}),Y=D.findIndex(Q=>Q===T);Jm(D.slice(Y+1))?y.preventDefault():N?(k=c.current)==null||k.focus():(S=f.current)==null||S.focus()}};return x.addEventListener("keydown",v),()=>x.removeEventListener("keydown",v)}},[o,m]),u.jsxs(jI,{ref:l,role:"region","aria-label":a.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&u.jsx(Fx,{ref:c,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"forwards"});Jm(x)}}),u.jsx(M1.Slot,{scope:r,children:u.jsx(Ae.ol,{tabIndex:-1,...s,ref:h})}),g&&u.jsx(Fx,{ref:f,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"backwards"});Jm(x)}})]})});_C.displayName=wC;var EC="ToastFocusProxy",Fx=_.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,s=Ep(EC,r);return u.jsx(_p,{tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:i=>{var c;const o=i.relatedTarget;!((c=s.viewport)!=null&&c.contains(o))&&n()}})});Fx.displayName=EC;var Ed="Toast",GI="toast.swipeStart",KI="toast.swipeMove",qI="toast.swipeCancel",XI="toast.swipeEnd",bC=_.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:s,...i}=e,[o,l]=ba({prop:n,defaultProp:a??!0,onChange:s,caller:Ed});return u.jsx(Vr,{present:r||o,children:u.jsx(JI,{open:o,...i,ref:t,onClose:()=>l(!1),onPause:sr(e.onPause),onResume:sr(e.onResume),onSwipeStart:ge(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ge(e.onSwipeMove,c=>{const{x:f,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:ge(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ge(e.onSwipeEnd,c=>{const{x:f,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});bC.displayName=Ed;var[YI,QI]=vC(Ed,{onClose(){}}),JI=_.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:s,onClose:i,onEscapeKeyDown:o,onPause:l,onResume:c,onSwipeStart:f,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:p,...g}=e,m=Ep(Ed,r),[x,v]=_.useState(null),y=Ke(t,Q=>v(Q)),w=_.useRef(null),E=_.useRef(null),b=a||m.duration,k=_.useRef(0),S=_.useRef(b),T=_.useRef(0),{onToastAdd:N,onToastRemove:O}=m,j=sr(()=>{var G;(x==null?void 0:x.contains(document.activeElement))&&((G=m.viewport)==null||G.focus()),i()}),D=_.useCallback(Q=>{!Q||Q===1/0||(window.clearTimeout(T.current),k.current=new Date().getTime(),T.current=window.setTimeout(j,Q))},[j]);_.useEffect(()=>{const Q=m.viewport;if(Q){const G=()=>{D(S.current),c==null||c()},X=()=>{const q=new Date().getTime()-k.current;S.current=S.current-q,window.clearTimeout(T.current),l==null||l()};return Q.addEventListener(Px,X),Q.addEventListener(jx,G),()=>{Q.removeEventListener(Px,X),Q.removeEventListener(jx,G)}}},[m.viewport,b,l,c,D]),_.useEffect(()=>{s&&!m.isClosePausedRef.current&&D(b)},[s,b,m.isClosePausedRef,D]),_.useEffect(()=>(N(),()=>O()),[N,O]);const Y=_.useMemo(()=>x?RC(x):null,[x]);return m.viewport?u.jsxs(u.Fragment,{children:[Y&&u.jsx(ZI,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:Y}),u.jsx(YI,{scope:r,onClose:j,children:gl.createPortal(u.jsx(M1.ItemSlot,{scope:r,children:u.jsx(PI,{asChild:!0,onEscapeKeyDown:ge(o,()=>{m.isFocusedToastEscapeKeyDownRef.current||j(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:u.jsx(Ae.li,{tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":m.swipeDirection,...g,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:ge(e.onKeyDown,Q=>{Q.key==="Escape"&&(o==null||o(Q.nativeEvent),Q.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,j()))}),onPointerDown:ge(e.onPointerDown,Q=>{Q.button===0&&(w.current={x:Q.clientX,y:Q.clientY})}),onPointerMove:ge(e.onPointerMove,Q=>{if(!w.current)return;const G=Q.clientX-w.current.x,X=Q.clientY-w.current.y,q=!!E.current,K=["left","right"].includes(m.swipeDirection),A=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,ne=K?A(0,G):0,ce=K?0:A(0,X),R=Q.pointerType==="touch"?10:2,z={x:ne,y:ce},U={originalEvent:Q,delta:z};q?(E.current=z,ih(KI,d,U,{discrete:!1})):r2(z,m.swipeDirection,R)?(E.current=z,ih(GI,f,U,{discrete:!1}),Q.target.setPointerCapture(Q.pointerId)):(Math.abs(G)>R||Math.abs(X)>R)&&(w.current=null)}),onPointerUp:ge(e.onPointerUp,Q=>{const G=E.current,X=Q.target;if(X.hasPointerCapture(Q.pointerId)&&X.releasePointerCapture(Q.pointerId),E.current=null,w.current=null,G){const q=Q.currentTarget,K={originalEvent:Q,delta:G};r2(G,m.swipeDirection,m.swipeThreshold)?ih(XI,p,K,{discrete:!0}):ih(qI,h,K,{discrete:!0}),q.addEventListener("click",A=>A.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),ZI=e=>{const{__scopeToast:t,children:r,...n}=e,a=Ep(Ed,t),[s,i]=_.useState(!1),[o,l]=_.useState(!1);return rD(()=>i(!0)),_.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),o?null:u.jsx(_d,{asChild:!0,children:u.jsx(_p,{...n,children:s&&u.jsxs(u.Fragment,{children:[a.label," ",r]})})})},eD="ToastTitle",SC=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return u.jsx(Ae.div,{...n,ref:t})});SC.displayName=eD;var tD="ToastDescription",kC=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return u.jsx(Ae.div,{...n,ref:t})});kC.displayName=tD;var CC="ToastAction",TC=_.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?u.jsx(AC,{altText:r,asChild:!0,children:u.jsx(L1,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${CC}\`. Expected non-empty \`string\`.`),null)});TC.displayName=CC;var NC="ToastClose",L1=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=QI(NC,r);return u.jsx(AC,{asChild:!0,children:u.jsx(Ae.button,{type:"button",...n,ref:t,onClick:ge(e.onClick,a.onClose)})})});L1.displayName=NC;var AC=_.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return u.jsx(Ae.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function RC(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),nD(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",s=n.dataset.radixToastAnnounceExclude==="";if(!a)if(s){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...RC(n))}}),t}function ih(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?I1(a,s):a.dispatchEvent(s)}var r2=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),s=n>a;return t==="left"||t==="right"?s&&n>r:!s&&a>r};function rD(e=()=>{}){const t=sr(e);Er(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function nD(e){return e.nodeType===e.ELEMENT_NODE}function aD(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function Jm(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var sD=yC,PC=_C,jC=bC,FC=SC,OC=kC,IC=TC,DC=L1;function MC(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=MC(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function LC(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=MC(e))&&(n&&(n+=" "),n+=t);return n}const n2=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,a2=LC,bp=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return a2(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:s}=t,i=Object.keys(a).map(c=>{const f=r==null?void 0:r[c],d=s==null?void 0:s[c];if(f===null)return null;const h=n2(f)||n2(d);return a[c][h]}),o=r&&Object.entries(r).reduce((c,f)=>{let[d,h]=f;return h===void 0||(c[d]=h),c},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((c,f)=>{let{class:d,className:h,...p}=f;return Object.entries(p).every(g=>{let[m,x]=g;return Array.isArray(x)?x.includes({...s,...o}[m]):{...s,...o}[m]===x})?[...c,d,h]:c},[]);return a2(e,i,l,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),BC=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var oD={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=_.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...o},l)=>_.createElement("svg",{ref:l,...oD,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:BC("lucide",a),...o},[...i.map(([c,f])=>_.createElement(c,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=(e,t)=>{const r=_.forwardRef(({className:n,...a},s)=>_.createElement(lD,{ref:s,iconNode:t,className:BC(`lucide-${iD(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=We("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=We("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uD=We("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=We("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=We("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=We("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=We("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dD=We("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ff=We("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=We("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hD=We("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pD=We("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mD=We("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=We("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gD=We("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=We("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=We("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=We("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=We("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xD=We("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vD=We("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yD=We("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wD=We("ImageOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=We("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _D=We("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=We("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ED=We("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bD=We("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SD=We("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=We("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s2=We("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=We("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=We("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=We("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=We("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kD=We("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=We("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=We("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=We("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Of=We("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CD=We("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=We("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=We("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TD=We("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ND=We("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AD=We("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=We("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RD=We("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=We("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),W1="-",PD=e=>{const t=FD(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{const o=i.split(W1);return o[0]===""&&o.length!==1&&o.shift(),VC(o,t)||jD(i)},getConflictingClassGroupIds:(i,o)=>{const l=r[i]||[];return o&&n[i]?[...l,...n[i]]:l}}},VC=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?VC(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const s=e.join(W1);return(i=t.validators.find(({validator:o})=>o(s)))==null?void 0:i.classGroupId},i2=/^\[(.+)\]$/,jD=e=>{if(i2.test(e)){const t=i2.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},FD=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return ID(Object.entries(e.classGroups),r).forEach(([s,i])=>{Ox(i,n,s,t)}),n},Ox=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const s=a===""?t:o2(t,a);s.classGroupId=r;return}if(typeof a=="function"){if(OD(a)){Ox(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([s,i])=>{Ox(i,o2(t,s),r,n)})})},o2=(e,t)=>{let r=e;return t.split(W1).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},OD=e=>e.isThemeGetter,ID=(e,t)=>t?e.map(([r,n])=>{const a=n.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([i,o])=>[t+i,o])):s);return[r,a]}):e,DD=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(s,i)=>{r.set(s,i),t++,t>e&&(t=0,n=r,r=new Map)};return{get(s){let i=r.get(s);if(i!==void 0)return i;if((i=n.get(s))!==void 0)return a(s,i),i},set(s,i){r.has(s)?r.set(s,i):a(s,i)}}},zC="!",MD=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],s=t.length,i=o=>{const l=[];let c=0,f=0,d;for(let x=0;x<o.length;x++){let v=o[x];if(c===0){if(v===a&&(n||o.slice(x,x+s)===t)){l.push(o.slice(f,x)),f=x+s;continue}if(v==="/"){d=x;continue}}v==="["?c++:v==="]"&&c--}const h=l.length===0?o:o.substring(f),p=h.startsWith(zC),g=p?h.substring(1):h,m=d&&d>f?d-f:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:m}};return r?o=>r({className:o,parseClassName:i}):i},LD=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},BD=e=>({cache:DD(e.cacheSize),parseClassName:MD(e),...PD(e)}),UD=/\s+/,$D=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,s=[],i=e.trim().split(UD);let o="";for(let l=i.length-1;l>=0;l-=1){const c=i[l],{modifiers:f,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:p}=r(c);let g=!!p,m=n(g?h.substring(0,p):h);if(!m){if(!g){o=c+(o.length>0?" "+o:o);continue}if(m=n(h),!m){o=c+(o.length>0?" "+o:o);continue}g=!1}const x=LD(f).join(":"),v=d?x+zC:x,y=v+m;if(s.includes(y))continue;s.push(y);const w=a(m,g);for(let E=0;E<w.length;++E){const b=w[E];s.push(v+b)}o=c+(o.length>0?" "+o:o)}return o};function WD(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=HC(t))&&(n&&(n+=" "),n+=r);return n}const HC=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=HC(e[n]))&&(r&&(r+=" "),r+=t);return r};function VD(e,...t){let r,n,a,s=i;function i(l){const c=t.reduce((f,d)=>d(f),e());return r=BD(c),n=r.cache.get,a=r.cache.set,s=o,o(l)}function o(l){const c=n(l);if(c)return c;const f=$D(l,r);return a(l,f),f}return function(){return s(WD.apply(null,arguments))}}const At=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},GC=/^\[(?:([a-z-]+):)?(.+)\]$/i,zD=/^\d+\/\d+$/,HD=new Set(["px","full","screen"]),GD=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,KD=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,qD=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,XD=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,YD=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,As=e=>cc(e)||HD.has(e)||zD.test(e),fi=e=>Zc(e,"length",a8),cc=e=>!!e&&!Number.isNaN(Number(e)),eg=e=>Zc(e,"number",cc),Nu=e=>!!e&&Number.isInteger(Number(e)),QD=e=>e.endsWith("%")&&cc(e.slice(0,-1)),Je=e=>GC.test(e),di=e=>GD.test(e),JD=new Set(["length","size","percentage"]),ZD=e=>Zc(e,JD,KC),e8=e=>Zc(e,"position",KC),t8=new Set(["image","url"]),r8=e=>Zc(e,t8,i8),n8=e=>Zc(e,"",s8),Au=()=>!0,Zc=(e,t,r)=>{const n=GC.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},a8=e=>KD.test(e)&&!qD.test(e),KC=()=>!1,s8=e=>XD.test(e),i8=e=>YD.test(e),o8=()=>{const e=At("colors"),t=At("spacing"),r=At("blur"),n=At("brightness"),a=At("borderColor"),s=At("borderRadius"),i=At("borderSpacing"),o=At("borderWidth"),l=At("contrast"),c=At("grayscale"),f=At("hueRotate"),d=At("invert"),h=At("gap"),p=At("gradientColorStops"),g=At("gradientColorStopPositions"),m=At("inset"),x=At("margin"),v=At("opacity"),y=At("padding"),w=At("saturate"),E=At("scale"),b=At("sepia"),k=At("skew"),S=At("space"),T=At("translate"),N=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],j=()=>["auto",Je,t],D=()=>[Je,t],Y=()=>["",As,fi],Q=()=>["auto",cc,Je],G=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>["start","end","center","between","around","evenly","stretch"],A=()=>["","0",Je],ne=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ce=()=>[cc,Je];return{cacheSize:500,separator:":",theme:{colors:[Au],spacing:[As,fi],blur:["none","",di,Je],brightness:ce(),borderColor:[e],borderRadius:["none","","full",di,Je],borderSpacing:D(),borderWidth:Y(),contrast:ce(),grayscale:A(),hueRotate:ce(),invert:A(),gap:D(),gradientColorStops:[e],gradientColorStopPositions:[QD,fi],inset:j(),margin:j(),opacity:ce(),padding:D(),saturate:ce(),scale:ce(),sepia:A(),skew:ce(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",Je]}],container:["container"],columns:[{columns:[di]}],"break-after":[{"break-after":ne()}],"break-before":[{"break-before":ne()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...G(),Je]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Nu,Je]}],basis:[{basis:j()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Je]}],grow:[{grow:A()}],shrink:[{shrink:A()}],order:[{order:["first","last","none",Nu,Je]}],"grid-cols":[{"grid-cols":[Au]}],"col-start-end":[{col:["auto",{span:["full",Nu,Je]},Je]}],"col-start":[{"col-start":Q()}],"col-end":[{"col-end":Q()}],"grid-rows":[{"grid-rows":[Au]}],"row-start-end":[{row:["auto",{span:[Nu,Je]},Je]}],"row-start":[{"row-start":Q()}],"row-end":[{"row-end":Q()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Je]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Je]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...K()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...K(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...K(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Je,t]}],"min-w":[{"min-w":[Je,t,"min","max","fit"]}],"max-w":[{"max-w":[Je,t,"none","full","min","max","fit","prose",{screen:[di]},di]}],h:[{h:[Je,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Je,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Je,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Je,t,"auto","min","max","fit"]}],"font-size":[{text:["base",di,fi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",eg]}],"font-family":[{font:[Au]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Je]}],"line-clamp":[{"line-clamp":["none",cc,eg]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",As,Je]}],"list-image":[{"list-image":["none",Je]}],"list-style-type":[{list:["none","disc","decimal",Je]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",As,fi]}],"underline-offset":[{"underline-offset":["auto",As,Je]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Je]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Je]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...G(),e8]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ZD]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},r8]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:X()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[As,Je]}],"outline-w":[{outline:[As,fi]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:Y()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[As,fi]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",di,n8]}],"shadow-color":[{shadow:[Au]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",di,Je]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[d]}],saturate:[{saturate:[w]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Je]}],duration:[{duration:ce()}],ease:[{ease:["linear","in","out","in-out",Je]}],delay:[{delay:ce()}],animate:[{animate:["none","spin","ping","pulse","bounce",Je]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[E]}],"scale-x":[{"scale-x":[E]}],"scale-y":[{"scale-y":[E]}],rotate:[{rotate:[Nu,Je]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Je]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Je]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Je]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[As,fi,eg]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},l8=VD(o8);function he(...e){return l8(LC(e))}const c8=sD,qC=_.forwardRef(({className:e,...t},r)=>u.jsx(PC,{ref:r,className:he("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));qC.displayName=PC.displayName;const u8=bp("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),XC=_.forwardRef(({className:e,variant:t,...r},n)=>u.jsx(jC,{ref:n,className:he(u8({variant:t}),e),...r}));XC.displayName=jC.displayName;const f8=_.forwardRef(({className:e,...t},r)=>u.jsx(IC,{ref:r,className:he("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));f8.displayName=IC.displayName;const YC=_.forwardRef(({className:e,...t},r)=>u.jsx(DC,{ref:r,className:he("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:u.jsx(Sd,{className:"h-4 w-4"})}));YC.displayName=DC.displayName;const QC=_.forwardRef(({className:e,...t},r)=>u.jsx(FC,{ref:r,className:he("text-sm font-semibold",e),...t}));QC.displayName=FC.displayName;const JC=_.forwardRef(({className:e,...t},r)=>u.jsx(OC,{ref:r,className:he("text-sm opacity-90",e),...t}));JC.displayName=OC.displayName;function d8(){const{toasts:e}=cI();return u.jsxs(c8,{children:[e.map(function({id:t,title:r,description:n,action:a,...s}){return u.jsxs(XC,{...s,children:[u.jsxs("div",{className:"grid gap-1",children:[r&&u.jsx(QC,{children:r}),n&&u.jsx(JC,{children:n})]}),a,u.jsx(YC,{})]},t)}),u.jsx(qC,{})]})}var l2=["light","dark"],h8="(prefers-color-scheme: dark)",p8=_.createContext(void 0),m8={setTheme:e=>{},themes:[]},g8=()=>{var e;return(e=_.useContext(p8))!=null?e:m8};_.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:s,value:i,attrs:o,nonce:l})=>{let c=s==="system",f=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${o.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,d=a?l2.includes(s)&&s?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${s}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(g,m=!1,x=!0)=>{let v=i?i[g]:g,y=m?g+"|| ''":`'${v}'`,w="";return a&&x&&!m&&l2.includes(g)&&(w+=`d.style.colorScheme = '${g}';`),r==="class"?m||v?w+=`c.add(${y})`:w+="null":v&&(w+=`d[s](n,${y})`),w},p=e?`!function(){${f}${h(e)}}()`:n?`!function(){try{${f}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${c})){var t='${h8}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${h(i?"x[e]":"e",!0)}}${c?"":"else{"+h(s,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${f}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${h(i?"x[e]":"e",!0)}}else{${h(s,!1,!1)};}${d}}catch(t){}}();`;return _.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})});var x8=e=>{switch(e){case"success":return w8;case"info":return E8;case"warning":return _8;case"error":return b8;default:return null}},v8=Array(12).fill(0),y8=({visible:e,className:t})=>de.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},de.createElement("div",{className:"sonner-spinner"},v8.map((r,n)=>de.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),w8=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},de.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),_8=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},de.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),E8=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},de.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),b8=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},de.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),S8=de.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},de.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),de.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),k8=()=>{let[e,t]=de.useState(document.hidden);return de.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},Ix=1,C8=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:Ix++,s=this.toasts.find(o=>o.id===a),i=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(o=>o.id===a?(this.publish({...o,...e,id:a,title:r}),{...o,...e,id:a,dismissible:i,title:r}):o):this.addToast({title:r,...n,dismissible:i,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),a=r!==void 0,s,i=n.then(async l=>{if(s=["resolve",l],de.isValidElement(l))a=!1,this.create({id:r,type:"default",message:l});else if(N8(l)&&!l.ok){a=!1;let c=typeof t.error=="function"?await t.error(`HTTP error! status: ${l.status}`):t.error,f=typeof t.description=="function"?await t.description(`HTTP error! status: ${l.status}`):t.description;this.create({id:r,type:"error",message:c,description:f})}else if(t.success!==void 0){a=!1;let c=typeof t.success=="function"?await t.success(l):t.success,f=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"success",message:c,description:f})}}).catch(async l=>{if(s=["reject",l],t.error!==void 0){a=!1;let c=typeof t.error=="function"?await t.error(l):t.error,f=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"error",message:c,description:f})}}).finally(()=>{var l;a&&(this.dismiss(r),r=void 0),(l=t.finally)==null||l.call(t)}),o=()=>new Promise((l,c)=>i.then(()=>s[0]==="reject"?c(s[1]):l(s[1])).catch(c));return typeof r!="string"&&typeof r!="number"?{unwrap:o}:Object.assign(r,{unwrap:o})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||Ix++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},kn=new C8,T8=(e,t)=>{let r=(t==null?void 0:t.id)||Ix++;return kn.addToast({title:e,...t,id:r}),r},N8=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",A8=T8,R8=()=>kn.toasts,P8=()=>kn.getActiveToasts(),Pe=Object.assign(A8,{success:kn.success,info:kn.info,warning:kn.warning,error:kn.error,custom:kn.custom,message:kn.message,promise:kn.promise,dismiss:kn.dismiss,loading:kn.loading},{getHistory:R8,getToasts:P8});function j8(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}j8(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function oh(e){return e.label!==void 0}var F8=3,O8="32px",I8="16px",c2=4e3,D8=356,M8=14,L8=20,B8=200;function Na(...e){return e.filter(Boolean).join(" ")}function U8(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var $8=e=>{var t,r,n,a,s,i,o,l,c,f,d;let{invert:h,toast:p,unstyled:g,interacting:m,setHeights:x,visibleToasts:v,heights:y,index:w,toasts:E,expanded:b,removeToast:k,defaultRichColors:S,closeButton:T,style:N,cancelButtonStyle:O,actionButtonStyle:j,className:D="",descriptionClassName:Y="",duration:Q,position:G,gap:X,loadingIcon:q,expandByDefault:K,classNames:A,icons:ne,closeButtonAriaLabel:ce="Close toast",pauseWhenPageIsHidden:R}=e,[z,U]=de.useState(null),[V,J]=de.useState(null),[W,se]=de.useState(!1),[ie,ae]=de.useState(!1),[be,I]=de.useState(!1),[He,Ue]=de.useState(!1),[at,Ve]=de.useState(!1),[ve,xt]=de.useState(0),[fe,Re]=de.useState(0),lt=de.useRef(p.duration||Q||c2),pr=de.useRef(null),Nt=de.useRef(null),qe=w===0,rr=w+1<=v,Mt=p.type,ea=p.dismissible!==!1,jr=p.className||"",ta=p.descriptionClassName||"",Xe=de.useMemo(()=>y.findIndex(Ge=>Ge.toastId===p.id)||0,[y,p.id]),Lt=de.useMemo(()=>{var Ge;return(Ge=p.closeButton)!=null?Ge:T},[p.closeButton,T]),sn=de.useMemo(()=>p.duration||Q||c2,[p.duration,Q]),Bt=de.useRef(0),En=de.useRef(0),hu=de.useRef(0),ci=de.useRef(null),[ym,Bd]=G.split("-"),pu=de.useMemo(()=>y.reduce((Ge,ht,St)=>St>=Xe?Ge:Ge+ht.height,0),[y,Xe]),mu=k8(),wm=p.invert||h,gu=Mt==="loading";En.current=de.useMemo(()=>Xe*X+pu,[Xe,pu]),de.useEffect(()=>{lt.current=sn},[sn]),de.useEffect(()=>{se(!0)},[]),de.useEffect(()=>{let Ge=Nt.current;if(Ge){let ht=Ge.getBoundingClientRect().height;return Re(ht),x(St=>[{toastId:p.id,height:ht,position:p.position},...St]),()=>x(St=>St.filter(In=>In.toastId!==p.id))}},[x,p.id]),de.useLayoutEffect(()=>{if(!W)return;let Ge=Nt.current,ht=Ge.style.height;Ge.style.height="auto";let St=Ge.getBoundingClientRect().height;Ge.style.height=ht,Re(St),x(In=>In.find(Dn=>Dn.toastId===p.id)?In.map(Dn=>Dn.toastId===p.id?{...Dn,height:St}:Dn):[{toastId:p.id,height:St,position:p.position},...In])},[W,p.title,p.description,x,p.id]);let On=de.useCallback(()=>{ae(!0),xt(En.current),x(Ge=>Ge.filter(ht=>ht.toastId!==p.id)),setTimeout(()=>{k(p)},B8)},[p,k,x,En]);de.useEffect(()=>{if(p.promise&&Mt==="loading"||p.duration===1/0||p.type==="loading")return;let Ge;return b||m||R&&mu?(()=>{if(hu.current<Bt.current){let ht=new Date().getTime()-Bt.current;lt.current=lt.current-ht}hu.current=new Date().getTime()})():lt.current!==1/0&&(Bt.current=new Date().getTime(),Ge=setTimeout(()=>{var ht;(ht=p.onAutoClose)==null||ht.call(p,p),On()},lt.current)),()=>clearTimeout(Ge)},[b,m,p,Mt,R,mu,On]),de.useEffect(()=>{p.delete&&On()},[On,p.delete]);function _m(){var Ge,ht,St;return ne!=null&&ne.loading?de.createElement("div",{className:Na(A==null?void 0:A.loader,(Ge=p==null?void 0:p.classNames)==null?void 0:Ge.loader,"sonner-loader"),"data-visible":Mt==="loading"},ne.loading):q?de.createElement("div",{className:Na(A==null?void 0:A.loader,(ht=p==null?void 0:p.classNames)==null?void 0:ht.loader,"sonner-loader"),"data-visible":Mt==="loading"},q):de.createElement(y8,{className:Na(A==null?void 0:A.loader,(St=p==null?void 0:p.classNames)==null?void 0:St.loader),visible:Mt==="loading"})}return de.createElement("li",{tabIndex:0,ref:Nt,className:Na(D,jr,A==null?void 0:A.toast,(t=p==null?void 0:p.classNames)==null?void 0:t.toast,A==null?void 0:A.default,A==null?void 0:A[Mt],(r=p==null?void 0:p.classNames)==null?void 0:r[Mt]),"data-sonner-toast":"","data-rich-colors":(n=p.richColors)!=null?n:S,"data-styled":!(p.jsx||p.unstyled||g),"data-mounted":W,"data-promise":!!p.promise,"data-swiped":at,"data-removed":ie,"data-visible":rr,"data-y-position":ym,"data-x-position":Bd,"data-index":w,"data-front":qe,"data-swiping":be,"data-dismissible":ea,"data-type":Mt,"data-invert":wm,"data-swipe-out":He,"data-swipe-direction":V,"data-expanded":!!(b||K&&W),style:{"--index":w,"--toasts-before":w,"--z-index":E.length-w,"--offset":`${ie?ve:En.current}px`,"--initial-height":K?"auto":`${fe}px`,...N,...p.style},onDragEnd:()=>{I(!1),U(null),ci.current=null},onPointerDown:Ge=>{gu||!ea||(pr.current=new Date,xt(En.current),Ge.target.setPointerCapture(Ge.pointerId),Ge.target.tagName!=="BUTTON"&&(I(!0),ci.current={x:Ge.clientX,y:Ge.clientY}))},onPointerUp:()=>{var Ge,ht,St,In;if(He||!ea)return;ci.current=null;let Dn=Number(((Ge=Nt.current)==null?void 0:Ge.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),rs=Number(((ht=Nt.current)==null?void 0:ht.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ts=new Date().getTime()-((St=pr.current)==null?void 0:St.getTime()),on=z==="x"?Dn:rs,ns=Math.abs(on)/Ts;if(Math.abs(on)>=L8||ns>.11){xt(En.current),(In=p.onDismiss)==null||In.call(p,p),J(z==="x"?Dn>0?"right":"left":rs>0?"down":"up"),On(),Ue(!0),Ve(!1);return}I(!1),U(null)},onPointerMove:Ge=>{var ht,St,In,Dn;if(!ci.current||!ea||((ht=window.getSelection())==null?void 0:ht.toString().length)>0)return;let rs=Ge.clientY-ci.current.y,Ts=Ge.clientX-ci.current.x,on=(St=e.swipeDirections)!=null?St:U8(G);!z&&(Math.abs(Ts)>1||Math.abs(rs)>1)&&U(Math.abs(Ts)>Math.abs(rs)?"x":"y");let ns={x:0,y:0};z==="y"?(on.includes("top")||on.includes("bottom"))&&(on.includes("top")&&rs<0||on.includes("bottom")&&rs>0)&&(ns.y=rs):z==="x"&&(on.includes("left")||on.includes("right"))&&(on.includes("left")&&Ts<0||on.includes("right")&&Ts>0)&&(ns.x=Ts),(Math.abs(ns.x)>0||Math.abs(ns.y)>0)&&Ve(!0),(In=Nt.current)==null||In.style.setProperty("--swipe-amount-x",`${ns.x}px`),(Dn=Nt.current)==null||Dn.style.setProperty("--swipe-amount-y",`${ns.y}px`)}},Lt&&!p.jsx?de.createElement("button",{"aria-label":ce,"data-disabled":gu,"data-close-button":!0,onClick:gu||!ea?()=>{}:()=>{var Ge;On(),(Ge=p.onDismiss)==null||Ge.call(p,p)},className:Na(A==null?void 0:A.closeButton,(a=p==null?void 0:p.classNames)==null?void 0:a.closeButton)},(s=ne==null?void 0:ne.close)!=null?s:S8):null,p.jsx||_.isValidElement(p.title)?p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title:de.createElement(de.Fragment,null,Mt||p.icon||p.promise?de.createElement("div",{"data-icon":"",className:Na(A==null?void 0:A.icon,(i=p==null?void 0:p.classNames)==null?void 0:i.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||_m():null,p.type!=="loading"?p.icon||(ne==null?void 0:ne[Mt])||x8(Mt):null):null,de.createElement("div",{"data-content":"",className:Na(A==null?void 0:A.content,(o=p==null?void 0:p.classNames)==null?void 0:o.content)},de.createElement("div",{"data-title":"",className:Na(A==null?void 0:A.title,(l=p==null?void 0:p.classNames)==null?void 0:l.title)},typeof p.title=="function"?p.title():p.title),p.description?de.createElement("div",{"data-description":"",className:Na(Y,ta,A==null?void 0:A.description,(c=p==null?void 0:p.classNames)==null?void 0:c.description)},typeof p.description=="function"?p.description():p.description):null),_.isValidElement(p.cancel)?p.cancel:p.cancel&&oh(p.cancel)?de.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||O,onClick:Ge=>{var ht,St;oh(p.cancel)&&ea&&((St=(ht=p.cancel).onClick)==null||St.call(ht,Ge),On())},className:Na(A==null?void 0:A.cancelButton,(f=p==null?void 0:p.classNames)==null?void 0:f.cancelButton)},p.cancel.label):null,_.isValidElement(p.action)?p.action:p.action&&oh(p.action)?de.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||j,onClick:Ge=>{var ht,St;oh(p.action)&&((St=(ht=p.action).onClick)==null||St.call(ht,Ge),!Ge.defaultPrevented&&On())},className:Na(A==null?void 0:A.actionButton,(d=p==null?void 0:p.classNames)==null?void 0:d.actionButton)},p.action.label):null))};function u2(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function W8(e,t){let r={};return[e,t].forEach((n,a)=>{let s=a===1,i=s?"--mobile-offset":"--offset",o=s?I8:O8;function l(c){["top","right","bottom","left"].forEach(f=>{r[`${i}-${f}`]=typeof c=="number"?`${c}px`:c})}typeof n=="number"||typeof n=="string"?l(n):typeof n=="object"?["top","right","bottom","left"].forEach(c=>{n[c]===void 0?r[`${i}-${c}`]=o:r[`${i}-${c}`]=typeof n[c]=="number"?`${n[c]}px`:n[c]}):l(o)}),r}var V8=_.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:i,className:o,offset:l,mobileOffset:c,theme:f="light",richColors:d,duration:h,style:p,visibleToasts:g=F8,toastOptions:m,dir:x=u2(),gap:v=M8,loadingIcon:y,icons:w,containerAriaLabel:E="Notifications",pauseWhenPageIsHidden:b}=e,[k,S]=de.useState([]),T=de.useMemo(()=>Array.from(new Set([n].concat(k.filter(R=>R.position).map(R=>R.position)))),[k,n]),[N,O]=de.useState([]),[j,D]=de.useState(!1),[Y,Q]=de.useState(!1),[G,X]=de.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),q=de.useRef(null),K=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),A=de.useRef(null),ne=de.useRef(!1),ce=de.useCallback(R=>{S(z=>{var U;return(U=z.find(V=>V.id===R.id))!=null&&U.delete||kn.dismiss(R.id),z.filter(({id:V})=>V!==R.id)})},[]);return de.useEffect(()=>kn.subscribe(R=>{if(R.dismiss){S(z=>z.map(U=>U.id===R.id?{...U,delete:!0}:U));return}setTimeout(()=>{dC.flushSync(()=>{S(z=>{let U=z.findIndex(V=>V.id===R.id);return U!==-1?[...z.slice(0,U),{...z[U],...R},...z.slice(U+1)]:[R,...z]})})})}),[]),de.useEffect(()=>{if(f!=="system"){X(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?X("dark"):X("light")),typeof window>"u")return;let R=window.matchMedia("(prefers-color-scheme: dark)");try{R.addEventListener("change",({matches:z})=>{X(z?"dark":"light")})}catch{R.addListener(({matches:U})=>{try{X(U?"dark":"light")}catch(V){console.error(V)}})}},[f]),de.useEffect(()=>{k.length<=1&&D(!1)},[k]),de.useEffect(()=>{let R=z=>{var U,V;a.every(J=>z[J]||z.code===J)&&(D(!0),(U=q.current)==null||U.focus()),z.code==="Escape"&&(document.activeElement===q.current||(V=q.current)!=null&&V.contains(document.activeElement))&&D(!1)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[a]),de.useEffect(()=>{if(q.current)return()=>{A.current&&(A.current.focus({preventScroll:!0}),A.current=null,ne.current=!1)}},[q.current]),de.createElement("section",{ref:t,"aria-label":`${E} ${K}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},T.map((R,z)=>{var U;let[V,J]=R.split("-");return k.length?de.createElement("ol",{key:R,dir:x==="auto"?u2():x,tabIndex:-1,ref:q,className:o,"data-sonner-toaster":!0,"data-theme":G,"data-y-position":V,"data-lifted":j&&k.length>1&&!s,"data-x-position":J,style:{"--front-toast-height":`${((U=N[0])==null?void 0:U.height)||0}px`,"--width":`${D8}px`,"--gap":`${v}px`,...p,...W8(l,c)},onBlur:W=>{ne.current&&!W.currentTarget.contains(W.relatedTarget)&&(ne.current=!1,A.current&&(A.current.focus({preventScroll:!0}),A.current=null))},onFocus:W=>{W.target instanceof HTMLElement&&W.target.dataset.dismissible==="false"||ne.current||(ne.current=!0,A.current=W.relatedTarget)},onMouseEnter:()=>D(!0),onMouseMove:()=>D(!0),onMouseLeave:()=>{Y||D(!1)},onDragEnd:()=>D(!1),onPointerDown:W=>{W.target instanceof HTMLElement&&W.target.dataset.dismissible==="false"||Q(!0)},onPointerUp:()=>Q(!1)},k.filter(W=>!W.position&&z===0||W.position===R).map((W,se)=>{var ie,ae;return de.createElement($8,{key:W.id,icons:w,index:se,toast:W,defaultRichColors:d,duration:(ie=m==null?void 0:m.duration)!=null?ie:h,className:m==null?void 0:m.className,descriptionClassName:m==null?void 0:m.descriptionClassName,invert:r,visibleToasts:g,closeButton:(ae=m==null?void 0:m.closeButton)!=null?ae:i,interacting:Y,position:R,style:m==null?void 0:m.style,unstyled:m==null?void 0:m.unstyled,classNames:m==null?void 0:m.classNames,cancelButtonStyle:m==null?void 0:m.cancelButtonStyle,actionButtonStyle:m==null?void 0:m.actionButtonStyle,removeToast:ce,toasts:k.filter(be=>be.position==W.position),heights:N.filter(be=>be.position==W.position),setHeights:O,expandByDefault:s,gap:v,loadingIcon:y,expanded:j,pauseWhenPageIsHidden:b,swipeDirections:e.swipeDirections})})):null}))});const z8=({...e})=>{const{theme:t="system"}=g8();return u.jsx(V8,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var H8=sp[" useId ".trim().toString()]||(()=>{}),G8=0;function xa(e){const[t,r]=_.useState(H8());return Er(()=>{r(n=>n??String(G8++))},[e]),t?`radix-${t}`:""}const K8=["top","right","bottom","left"],Qi=Math.min,Bn=Math.max,b0=Math.round,lh=Math.floor,_s=e=>({x:e,y:e}),q8={left:"right",right:"left",bottom:"top",top:"bottom"},X8={start:"end",end:"start"};function Dx(e,t,r){return Bn(e,Qi(t,r))}function Qs(e,t){return typeof e=="function"?e(t):e}function Js(e){return e.split("-")[0]}function eu(e){return e.split("-")[1]}function V1(e){return e==="x"?"y":"x"}function z1(e){return e==="y"?"height":"width"}const Y8=new Set(["top","bottom"]);function gs(e){return Y8.has(Js(e))?"y":"x"}function H1(e){return V1(gs(e))}function Q8(e,t,r){r===void 0&&(r=!1);const n=eu(e),a=H1(e),s=z1(a);let i=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=S0(i)),[i,S0(i)]}function J8(e){const t=S0(e);return[Mx(e),t,Mx(t)]}function Mx(e){return e.replace(/start|end/g,t=>X8[t])}const f2=["left","right"],d2=["right","left"],Z8=["top","bottom"],eM=["bottom","top"];function tM(e,t,r){switch(e){case"top":case"bottom":return r?t?d2:f2:t?f2:d2;case"left":case"right":return t?Z8:eM;default:return[]}}function rM(e,t,r,n){const a=eu(e);let s=tM(Js(e),r==="start",n);return a&&(s=s.map(i=>i+"-"+a),t&&(s=s.concat(s.map(Mx)))),s}function S0(e){return e.replace(/left|right|bottom|top/g,t=>q8[t])}function nM(e){return{top:0,right:0,bottom:0,left:0,...e}}function ZC(e){return typeof e!="number"?nM(e):{top:e,right:e,bottom:e,left:e}}function k0(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function h2(e,t,r){let{reference:n,floating:a}=e;const s=gs(t),i=H1(t),o=z1(i),l=Js(t),c=s==="y",f=n.x+n.width/2-a.width/2,d=n.y+n.height/2-a.height/2,h=n[o]/2-a[o]/2;let p;switch(l){case"top":p={x:f,y:n.y-a.height};break;case"bottom":p={x:f,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:d};break;case"left":p={x:n.x-a.width,y:d};break;default:p={x:n.x,y:n.y}}switch(eu(t)){case"start":p[i]-=h*(r&&c?-1:1);break;case"end":p[i]+=h*(r&&c?-1:1);break}return p}const aM=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:s=[],platform:i}=r,o=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(t));let c=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:f,y:d}=h2(c,n,l),h=n,p={},g=0;for(let m=0;m<o.length;m++){const{name:x,fn:v}=o[m],{x:y,y:w,data:E,reset:b}=await v({x:f,y:d,initialPlacement:n,placement:h,strategy:a,middlewareData:p,rects:c,platform:i,elements:{reference:e,floating:t}});f=y??f,d=w??d,p={...p,[x]:{...p[x],...E}},b&&g<=50&&(g++,typeof b=="object"&&(b.placement&&(h=b.placement),b.rects&&(c=b.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):b.rects),{x:f,y:d}=h2(c,h,l)),m=-1)}return{x:f,y:d,placement:h,strategy:a,middlewareData:p}};async function Mf(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:s,rects:i,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=Qs(t,e),g=ZC(p),x=o[h?d==="floating"?"reference":"floating":d],v=k0(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(x)))==null||r?x:x.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:f,strategy:l})),y=d==="floating"?{x:n,y:a,width:i.floating.width,height:i.floating.height}:i.reference,w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),E=await(s.isElement==null?void 0:s.isElement(w))?await(s.getScale==null?void 0:s.getScale(w))||{x:1,y:1}:{x:1,y:1},b=k0(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:y,offsetParent:w,strategy:l}):y);return{top:(v.top-b.top+g.top)/E.y,bottom:(b.bottom-v.bottom+g.bottom)/E.y,left:(v.left-b.left+g.left)/E.x,right:(b.right-v.right+g.right)/E.x}}const sM=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:s,platform:i,elements:o,middlewareData:l}=t,{element:c,padding:f=0}=Qs(e,t)||{};if(c==null)return{};const d=ZC(f),h={x:r,y:n},p=H1(a),g=z1(p),m=await i.getDimensions(c),x=p==="y",v=x?"top":"left",y=x?"bottom":"right",w=x?"clientHeight":"clientWidth",E=s.reference[g]+s.reference[p]-h[p]-s.floating[g],b=h[p]-s.reference[p],k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c));let S=k?k[w]:0;(!S||!await(i.isElement==null?void 0:i.isElement(k)))&&(S=o.floating[w]||s.floating[g]);const T=E/2-b/2,N=S/2-m[g]/2-1,O=Qi(d[v],N),j=Qi(d[y],N),D=O,Y=S-m[g]-j,Q=S/2-m[g]/2+T,G=Dx(D,Q,Y),X=!l.arrow&&eu(a)!=null&&Q!==G&&s.reference[g]/2-(Q<D?O:j)-m[g]/2<0,q=X?Q<D?Q-D:Q-Y:0;return{[p]:h[p]+q,data:{[p]:G,centerOffset:Q-G-q,...X&&{alignmentOffset:q}},reset:X}}}),iM=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:s,rects:i,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:f=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:m=!0,...x}=Qs(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const v=Js(a),y=gs(o),w=Js(o)===o,E=await(l.isRTL==null?void 0:l.isRTL(c.floating)),b=h||(w||!m?[S0(o)]:J8(o)),k=g!=="none";!h&&k&&b.push(...rM(o,m,g,E));const S=[o,...b],T=await Mf(t,x),N=[];let O=((n=s.flip)==null?void 0:n.overflows)||[];if(f&&N.push(T[v]),d){const Q=Q8(a,i,E);N.push(T[Q[0]],T[Q[1]])}if(O=[...O,{placement:a,overflows:N}],!N.every(Q=>Q<=0)){var j,D;const Q=(((j=s.flip)==null?void 0:j.index)||0)+1,G=S[Q];if(G&&(!(d==="alignment"?y!==gs(G):!1)||O.every(K=>gs(K.placement)===y?K.overflows[0]>0:!0)))return{data:{index:Q,overflows:O},reset:{placement:G}};let X=(D=O.filter(q=>q.overflows[0]<=0).sort((q,K)=>q.overflows[1]-K.overflows[1])[0])==null?void 0:D.placement;if(!X)switch(p){case"bestFit":{var Y;const q=(Y=O.filter(K=>{if(k){const A=gs(K.placement);return A===y||A==="y"}return!0}).map(K=>[K.placement,K.overflows.filter(A=>A>0).reduce((A,ne)=>A+ne,0)]).sort((K,A)=>K[1]-A[1])[0])==null?void 0:Y[0];q&&(X=q);break}case"initialPlacement":X=o;break}if(a!==X)return{reset:{placement:X}}}return{}}}};function p2(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function m2(e){return K8.some(t=>e[t]>=0)}const oM=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=Qs(e,t);switch(n){case"referenceHidden":{const s=await Mf(t,{...a,elementContext:"reference"}),i=p2(s,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:m2(i)}}}case"escaped":{const s=await Mf(t,{...a,altBoundary:!0}),i=p2(s,r.floating);return{data:{escapedOffsets:i,escaped:m2(i)}}}default:return{}}}}},eT=new Set(["left","top"]);async function lM(e,t){const{placement:r,platform:n,elements:a}=e,s=await(n.isRTL==null?void 0:n.isRTL(a.floating)),i=Js(r),o=eu(r),l=gs(r)==="y",c=eT.has(i)?-1:1,f=s&&l?-1:1,d=Qs(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:g}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof g=="number"&&(p=o==="end"?g*-1:g),l?{x:p*f,y:h*c}:{x:h*c,y:p*f}}const cM=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:s,placement:i,middlewareData:o}=t,l=await lM(t,e);return i===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:a+l.x,y:s+l.y,data:{...l,placement:i}}}}},uM=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:o={fn:x=>{let{x:v,y}=x;return{x:v,y}}},...l}=Qs(e,t),c={x:r,y:n},f=await Mf(t,l),d=gs(Js(a)),h=V1(d);let p=c[h],g=c[d];if(s){const x=h==="y"?"top":"left",v=h==="y"?"bottom":"right",y=p+f[x],w=p-f[v];p=Dx(y,p,w)}if(i){const x=d==="y"?"top":"left",v=d==="y"?"bottom":"right",y=g+f[x],w=g-f[v];g=Dx(y,g,w)}const m=o.fn({...t,[h]:p,[d]:g});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[h]:s,[d]:i}}}}}},fM=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:s,middlewareData:i}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Qs(e,t),f={x:r,y:n},d=gs(a),h=V1(d);let p=f[h],g=f[d];const m=Qs(o,t),x=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const w=h==="y"?"height":"width",E=s.reference[h]-s.floating[w]+x.mainAxis,b=s.reference[h]+s.reference[w]-x.mainAxis;p<E?p=E:p>b&&(p=b)}if(c){var v,y;const w=h==="y"?"width":"height",E=eT.has(Js(a)),b=s.reference[d]-s.floating[w]+(E&&((v=i.offset)==null?void 0:v[d])||0)+(E?0:x.crossAxis),k=s.reference[d]+s.reference[w]+(E?0:((y=i.offset)==null?void 0:y[d])||0)-(E?x.crossAxis:0);g<b?g=b:g>k&&(g=k)}return{[h]:p,[d]:g}}}},dM=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:s,platform:i,elements:o}=t,{apply:l=()=>{},...c}=Qs(e,t),f=await Mf(t,c),d=Js(a),h=eu(a),p=gs(a)==="y",{width:g,height:m}=s.floating;let x,v;d==="top"||d==="bottom"?(x=d,v=h===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(v=d,x=h==="end"?"top":"bottom");const y=m-f.top-f.bottom,w=g-f.left-f.right,E=Qi(m-f[x],y),b=Qi(g-f[v],w),k=!t.middlewareData.shift;let S=E,T=b;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(T=w),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(S=y),k&&!h){const O=Bn(f.left,0),j=Bn(f.right,0),D=Bn(f.top,0),Y=Bn(f.bottom,0);p?T=g-2*(O!==0||j!==0?O+j:Bn(f.left,f.right)):S=m-2*(D!==0||Y!==0?D+Y:Bn(f.top,f.bottom))}await l({...t,availableWidth:T,availableHeight:S});const N=await i.getDimensions(o.floating);return g!==N.width||m!==N.height?{reset:{rects:!0}}:{}}}};function Tp(){return typeof window<"u"}function tu(e){return tT(e)?(e.nodeName||"").toLowerCase():"#document"}function qn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function bs(e){var t;return(t=(tT(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function tT(e){return Tp()?e instanceof Node||e instanceof qn(e).Node:!1}function Ja(e){return Tp()?e instanceof Element||e instanceof qn(e).Element:!1}function Es(e){return Tp()?e instanceof HTMLElement||e instanceof qn(e).HTMLElement:!1}function g2(e){return!Tp()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof qn(e).ShadowRoot}const hM=new Set(["inline","contents"]);function kd(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=Za(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!hM.has(a)}const pM=new Set(["table","td","th"]);function mM(e){return pM.has(tu(e))}const gM=[":popover-open",":modal"];function Np(e){return gM.some(t=>{try{return e.matches(t)}catch{return!1}})}const xM=["transform","translate","scale","rotate","perspective"],vM=["transform","translate","scale","rotate","perspective","filter"],yM=["paint","layout","strict","content"];function G1(e){const t=K1(),r=Ja(e)?Za(e):e;return xM.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||vM.some(n=>(r.willChange||"").includes(n))||yM.some(n=>(r.contain||"").includes(n))}function wM(e){let t=Ji(e);for(;Es(t)&&!Bc(t);){if(G1(t))return t;if(Np(t))return null;t=Ji(t)}return null}function K1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const _M=new Set(["html","body","#document"]);function Bc(e){return _M.has(tu(e))}function Za(e){return qn(e).getComputedStyle(e)}function Ap(e){return Ja(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ji(e){if(tu(e)==="html")return e;const t=e.assignedSlot||e.parentNode||g2(e)&&e.host||bs(e);return g2(t)?t.host:t}function rT(e){const t=Ji(e);return Bc(t)?e.ownerDocument?e.ownerDocument.body:e.body:Es(t)&&kd(t)?t:rT(t)}function Lf(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=rT(e),s=a===((n=e.ownerDocument)==null?void 0:n.body),i=qn(a);if(s){const o=Lx(i);return t.concat(i,i.visualViewport||[],kd(a)?a:[],o&&r?Lf(o):[])}return t.concat(a,Lf(a,[],r))}function Lx(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function nT(e){const t=Za(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Es(e),s=a?e.offsetWidth:r,i=a?e.offsetHeight:n,o=b0(r)!==s||b0(n)!==i;return o&&(r=s,n=i),{width:r,height:n,$:o}}function q1(e){return Ja(e)?e:e.contextElement}function uc(e){const t=q1(e);if(!Es(t))return _s(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:s}=nT(t);let i=(s?b0(r.width):r.width)/n,o=(s?b0(r.height):r.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const EM=_s(0);function aT(e){const t=qn(e);return!K1()||!t.visualViewport?EM:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function bM(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==qn(e)?!1:t}function Yo(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),s=q1(e);let i=_s(1);t&&(n?Ja(n)&&(i=uc(n)):i=uc(e));const o=bM(s,r,n)?aT(s):_s(0);let l=(a.left+o.x)/i.x,c=(a.top+o.y)/i.y,f=a.width/i.x,d=a.height/i.y;if(s){const h=qn(s),p=n&&Ja(n)?qn(n):n;let g=h,m=Lx(g);for(;m&&n&&p!==g;){const x=uc(m),v=m.getBoundingClientRect(),y=Za(m),w=v.left+(m.clientLeft+parseFloat(y.paddingLeft))*x.x,E=v.top+(m.clientTop+parseFloat(y.paddingTop))*x.y;l*=x.x,c*=x.y,f*=x.x,d*=x.y,l+=w,c+=E,g=qn(m),m=Lx(g)}}return k0({width:f,height:d,x:l,y:c})}function Rp(e,t){const r=Ap(e).scrollLeft;return t?t.left+r:Yo(bs(e)).left+r}function sT(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-Rp(e,r),a=r.top+t.scrollTop;return{x:n,y:a}}function SM(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const s=a==="fixed",i=bs(n),o=t?Np(t.floating):!1;if(n===i||o&&s)return r;let l={scrollLeft:0,scrollTop:0},c=_s(1);const f=_s(0),d=Es(n);if((d||!d&&!s)&&((tu(n)!=="body"||kd(i))&&(l=Ap(n)),Es(n))){const p=Yo(n);c=uc(n),f.x=p.x+n.clientLeft,f.y=p.y+n.clientTop}const h=i&&!d&&!s?sT(i,l):_s(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+f.x+h.x,y:r.y*c.y-l.scrollTop*c.y+f.y+h.y}}function kM(e){return Array.from(e.getClientRects())}function CM(e){const t=bs(e),r=Ap(e),n=e.ownerDocument.body,a=Bn(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=Bn(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+Rp(e);const o=-r.scrollTop;return Za(n).direction==="rtl"&&(i+=Bn(t.clientWidth,n.clientWidth)-a),{width:a,height:s,x:i,y:o}}const x2=25;function TM(e,t){const r=qn(e),n=bs(e),a=r.visualViewport;let s=n.clientWidth,i=n.clientHeight,o=0,l=0;if(a){s=a.width,i=a.height;const f=K1();(!f||f&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}const c=Rp(n);if(c<=0){const f=n.ownerDocument,d=f.body,h=getComputedStyle(d),p=f.compatMode==="CSS1Compat"&&parseFloat(h.marginLeft)+parseFloat(h.marginRight)||0,g=Math.abs(n.clientWidth-d.clientWidth-p);g<=x2&&(s-=g)}else c<=x2&&(s+=c);return{width:s,height:i,x:o,y:l}}const NM=new Set(["absolute","fixed"]);function AM(e,t){const r=Yo(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,s=Es(e)?uc(e):_s(1),i=e.clientWidth*s.x,o=e.clientHeight*s.y,l=a*s.x,c=n*s.y;return{width:i,height:o,x:l,y:c}}function v2(e,t,r){let n;if(t==="viewport")n=TM(e,r);else if(t==="document")n=CM(bs(e));else if(Ja(t))n=AM(t,r);else{const a=aT(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return k0(n)}function iT(e,t){const r=Ji(e);return r===t||!Ja(r)||Bc(r)?!1:Za(r).position==="fixed"||iT(r,t)}function RM(e,t){const r=t.get(e);if(r)return r;let n=Lf(e,[],!1).filter(o=>Ja(o)&&tu(o)!=="body"),a=null;const s=Za(e).position==="fixed";let i=s?Ji(e):e;for(;Ja(i)&&!Bc(i);){const o=Za(i),l=G1(i);!l&&o.position==="fixed"&&(a=null),(s?!l&&!a:!l&&o.position==="static"&&!!a&&NM.has(a.position)||kd(i)&&!l&&iT(e,i))?n=n.filter(f=>f!==i):a=o,i=Ji(i)}return t.set(e,n),n}function PM(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const i=[...r==="clippingAncestors"?Np(t)?[]:RM(t,this._c):[].concat(r),n],o=i[0],l=i.reduce((c,f)=>{const d=v2(t,f,a);return c.top=Bn(d.top,c.top),c.right=Qi(d.right,c.right),c.bottom=Qi(d.bottom,c.bottom),c.left=Bn(d.left,c.left),c},v2(t,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function jM(e){const{width:t,height:r}=nT(e);return{width:t,height:r}}function FM(e,t,r){const n=Es(t),a=bs(t),s=r==="fixed",i=Yo(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=_s(0);function c(){l.x=Rp(a)}if(n||!n&&!s)if((tu(t)!=="body"||kd(a))&&(o=Ap(t)),n){const p=Yo(t,!0,s,t);l.x=p.x+t.clientLeft,l.y=p.y+t.clientTop}else a&&c();s&&!n&&a&&c();const f=a&&!n&&!s?sT(a,o):_s(0),d=i.left+o.scrollLeft-l.x-f.x,h=i.top+o.scrollTop-l.y-f.y;return{x:d,y:h,width:i.width,height:i.height}}function tg(e){return Za(e).position==="static"}function y2(e,t){if(!Es(e)||Za(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return bs(e)===r&&(r=r.ownerDocument.body),r}function oT(e,t){const r=qn(e);if(Np(e))return r;if(!Es(e)){let a=Ji(e);for(;a&&!Bc(a);){if(Ja(a)&&!tg(a))return a;a=Ji(a)}return r}let n=y2(e,t);for(;n&&mM(n)&&tg(n);)n=y2(n,t);return n&&Bc(n)&&tg(n)&&!G1(n)?r:n||wM(e)||r}const OM=async function(e){const t=this.getOffsetParent||oT,r=this.getDimensions,n=await r(e.floating);return{reference:FM(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function IM(e){return Za(e).direction==="rtl"}const DM={convertOffsetParentRelativeRectToViewportRelativeRect:SM,getDocumentElement:bs,getClippingRect:PM,getOffsetParent:oT,getElementRects:OM,getClientRects:kM,getDimensions:jM,getScale:uc,isElement:Ja,isRTL:IM};function lT(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function MM(e,t){let r=null,n;const a=bs(e);function s(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function i(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:f,top:d,width:h,height:p}=c;if(o||t(),!h||!p)return;const g=lh(d),m=lh(a.clientWidth-(f+h)),x=lh(a.clientHeight-(d+p)),v=lh(f),w={rootMargin:-g+"px "+-m+"px "+-x+"px "+-v+"px",threshold:Bn(0,Qi(1,l))||1};let E=!0;function b(k){const S=k[0].intersectionRatio;if(S!==l){if(!E)return i();S?i(!1,S):n=setTimeout(()=>{i(!1,1e-7)},1e3)}S===1&&!lT(c,e.getBoundingClientRect())&&i(),E=!1}try{r=new IntersectionObserver(b,{...w,root:a.ownerDocument})}catch{r=new IntersectionObserver(b,w)}r.observe(e)}return i(!0),s}function LM(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=q1(e),f=a||s?[...c?Lf(c):[],...Lf(t)]:[];f.forEach(v=>{a&&v.addEventListener("scroll",r,{passive:!0}),s&&v.addEventListener("resize",r)});const d=c&&o?MM(c,r):null;let h=-1,p=null;i&&(p=new ResizeObserver(v=>{let[y]=v;y&&y.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(t)})),r()}),c&&!l&&p.observe(c),p.observe(t));let g,m=l?Yo(e):null;l&&x();function x(){const v=Yo(e);m&&!lT(m,v)&&r(),m=v,g=requestAnimationFrame(x)}return r(),()=>{var v;f.forEach(y=>{a&&y.removeEventListener("scroll",r),s&&y.removeEventListener("resize",r)}),d==null||d(),(v=p)==null||v.disconnect(),p=null,l&&cancelAnimationFrame(g)}}const BM=cM,UM=uM,$M=iM,WM=dM,VM=oM,w2=sM,zM=fM,HM=(e,t,r)=>{const n=new Map,a={platform:DM,...r},s={...a.platform,_c:n};return aM(e,t,{...a,platform:s})};var GM=typeof document<"u",KM=function(){},zh=GM?_.useLayoutEffect:KM;function C0(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!C0(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const s=a[n];if(!(s==="_owner"&&e.$$typeof)&&!C0(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function cT(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function _2(e,t){const r=cT(e);return Math.round(t*r)/r}function rg(e){const t=_.useRef(e);return zh(()=>{t.current=e}),t}function qM(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:s,floating:i}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[f,d]=_.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=_.useState(n);C0(h,n)||p(n);const[g,m]=_.useState(null),[x,v]=_.useState(null),y=_.useCallback(K=>{K!==k.current&&(k.current=K,m(K))},[]),w=_.useCallback(K=>{K!==S.current&&(S.current=K,v(K))},[]),E=s||g,b=i||x,k=_.useRef(null),S=_.useRef(null),T=_.useRef(f),N=l!=null,O=rg(l),j=rg(a),D=rg(c),Y=_.useCallback(()=>{if(!k.current||!S.current)return;const K={placement:t,strategy:r,middleware:h};j.current&&(K.platform=j.current),HM(k.current,S.current,K).then(A=>{const ne={...A,isPositioned:D.current!==!1};Q.current&&!C0(T.current,ne)&&(T.current=ne,gl.flushSync(()=>{d(ne)}))})},[h,t,r,j,D]);zh(()=>{c===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d(K=>({...K,isPositioned:!1})))},[c]);const Q=_.useRef(!1);zh(()=>(Q.current=!0,()=>{Q.current=!1}),[]),zh(()=>{if(E&&(k.current=E),b&&(S.current=b),E&&b){if(O.current)return O.current(E,b,Y);Y()}},[E,b,Y,O,N]);const G=_.useMemo(()=>({reference:k,floating:S,setReference:y,setFloating:w}),[y,w]),X=_.useMemo(()=>({reference:E,floating:b}),[E,b]),q=_.useMemo(()=>{const K={position:r,left:0,top:0};if(!X.floating)return K;const A=_2(X.floating,f.x),ne=_2(X.floating,f.y);return o?{...K,transform:"translate("+A+"px, "+ne+"px)",...cT(X.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:A,top:ne}},[r,o,X.floating,f.x,f.y]);return _.useMemo(()=>({...f,update:Y,refs:G,elements:X,floatingStyles:q}),[f,Y,G,X,q])}const XM=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?w2({element:n.current,padding:a}).fn(r):{}:n?w2({element:n,padding:a}).fn(r):{}}}},YM=(e,t)=>({...BM(e),options:[e,t]}),QM=(e,t)=>({...UM(e),options:[e,t]}),JM=(e,t)=>({...zM(e),options:[e,t]}),ZM=(e,t)=>({...$M(e),options:[e,t]}),e5=(e,t)=>({...WM(e),options:[e,t]}),t5=(e,t)=>({...VM(e),options:[e,t]}),r5=(e,t)=>({...XM(e),options:[e,t]});var n5="Arrow",uT=_.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...s}=e;return u.jsx(Ae.svg,{...s,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:u.jsx("polygon",{points:"0,0 30,0 15,10"})})});uT.displayName=n5;var a5=uT;function X1(e){const[t,r]=_.useState(void 0);return Er(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const s=a[0];let i,o;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;i=c.inlineSize,o=c.blockSize}else i=e.offsetWidth,o=e.offsetHeight;r({width:i,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var Y1="Popper",[fT,ru]=rn(Y1),[s5,dT]=fT(Y1),hT=e=>{const{__scopePopper:t,children:r}=e,[n,a]=_.useState(null);return u.jsx(s5,{scope:t,anchor:n,onAnchorChange:a,children:r})};hT.displayName=Y1;var pT="PopperAnchor",mT=_.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,s=dT(pT,r),i=_.useRef(null),o=Ke(t,i),l=_.useRef(null);return _.useEffect(()=>{const c=l.current;l.current=(n==null?void 0:n.current)||i.current,c!==l.current&&s.onAnchorChange(l.current)}),n?null:u.jsx(Ae.div,{...a,ref:o})});mT.displayName=pT;var Q1="PopperContent",[i5,o5]=fT(Q1),gT=_.forwardRef((e,t)=>{var W,se,ie,ae,be,I;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:s="center",alignOffset:i=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:f=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:g,...m}=e,x=dT(Q1,r),[v,y]=_.useState(null),w=Ke(t,He=>y(He)),[E,b]=_.useState(null),k=X1(E),S=(k==null?void 0:k.width)??0,T=(k==null?void 0:k.height)??0,N=n+(s!=="center"?"-"+s:""),O=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},j=Array.isArray(c)?c:[c],D=j.length>0,Y={padding:O,boundary:j.filter(c5),altBoundary:D},{refs:Q,floatingStyles:G,placement:X,isPositioned:q,middlewareData:K}=qM({strategy:"fixed",placement:N,whileElementsMounted:(...He)=>LM(...He,{animationFrame:p==="always"}),elements:{reference:x.anchor},middleware:[YM({mainAxis:a+T,alignmentAxis:i}),l&&QM({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?JM():void 0,...Y}),l&&ZM({...Y}),e5({...Y,apply:({elements:He,rects:Ue,availableWidth:at,availableHeight:Ve})=>{const{width:ve,height:xt}=Ue.reference,fe=He.floating.style;fe.setProperty("--radix-popper-available-width",`${at}px`),fe.setProperty("--radix-popper-available-height",`${Ve}px`),fe.setProperty("--radix-popper-anchor-width",`${ve}px`),fe.setProperty("--radix-popper-anchor-height",`${xt}px`)}}),E&&r5({element:E,padding:o}),u5({arrowWidth:S,arrowHeight:T}),h&&t5({strategy:"referenceHidden",...Y})]}),[A,ne]=yT(X),ce=sr(g);Er(()=>{q&&(ce==null||ce())},[q,ce]);const R=(W=K.arrow)==null?void 0:W.x,z=(se=K.arrow)==null?void 0:se.y,U=((ie=K.arrow)==null?void 0:ie.centerOffset)!==0,[V,J]=_.useState();return Er(()=>{v&&J(window.getComputedStyle(v).zIndex)},[v]),u.jsx("div",{ref:Q.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:q?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:V,"--radix-popper-transform-origin":[(ae=K.transformOrigin)==null?void 0:ae.x,(be=K.transformOrigin)==null?void 0:be.y].join(" "),...((I=K.hide)==null?void 0:I.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:u.jsx(i5,{scope:r,placedSide:A,onArrowChange:b,arrowX:R,arrowY:z,shouldHideArrow:U,children:u.jsx(Ae.div,{"data-side":A,"data-align":ne,...m,ref:w,style:{...m.style,animation:q?void 0:"none"}})})})});gT.displayName=Q1;var xT="PopperArrow",l5={top:"bottom",right:"left",bottom:"top",left:"right"},vT=_.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,s=o5(xT,n),i=l5[s.placedSide];return u.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:u.jsx(a5,{...a,ref:r,style:{...a.style,display:"block"}})})});vT.displayName=xT;function c5(e){return e!==null}var u5=e=>({name:"transformOrigin",options:e,fn(t){var x,v,y;const{placement:r,rects:n,middlewareData:a}=t,i=((x=a.arrow)==null?void 0:x.centerOffset)!==0,o=i?0:e.arrowWidth,l=i?0:e.arrowHeight,[c,f]=yT(r),d={start:"0%",center:"50%",end:"100%"}[f],h=(((v=a.arrow)==null?void 0:v.x)??0)+o/2,p=(((y=a.arrow)==null?void 0:y.y)??0)+l/2;let g="",m="";return c==="bottom"?(g=i?d:`${h}px`,m=`${-l}px`):c==="top"?(g=i?d:`${h}px`,m=`${n.floating.height+l}px`):c==="right"?(g=`${-l}px`,m=i?d:`${p}px`):c==="left"&&(g=`${n.floating.width+l}px`,m=i?d:`${p}px`),{data:{x:g,y:m}}}});function yT(e){const[t,r="center"]=e.split("-");return[t,r]}var wT=hT,J1=mT,Z1=gT,ey=vT,f5=Symbol("radix.slottable");function d5(e){const t=({children:r})=>u.jsx(u.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=f5,t}var[Pp]=rn("Tooltip",[ru]),ty=ru(),_T="TooltipProvider",h5=700,E2="tooltip.open",[p5,ET]=Pp(_T),bT=e=>{const{__scopeTooltip:t,delayDuration:r=h5,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:s}=e,i=_.useRef(!0),o=_.useRef(!1),l=_.useRef(0);return _.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),u.jsx(p5,{scope:t,isOpenDelayedRef:i,delayDuration:r,onOpen:_.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:_.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,n)},[n]),isPointerInTransitRef:o,onPointerInTransitChange:_.useCallback(c=>{o.current=c},[]),disableHoverableContent:a,children:s})};bT.displayName=_T;var ST="Tooltip",[gae,jp]=Pp(ST),Bx="TooltipTrigger",m5=_.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=jp(Bx,r),s=ET(Bx,r),i=ty(r),o=_.useRef(null),l=Ke(t,o,a.onTriggerChange),c=_.useRef(!1),f=_.useRef(!1),d=_.useCallback(()=>c.current=!1,[]);return _.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),u.jsx(J1,{asChild:!0,...i,children:u.jsx(Ae.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:l,onPointerMove:ge(e.onPointerMove,h=>{h.pointerType!=="touch"&&!f.current&&!s.isPointerInTransitRef.current&&(a.onTriggerEnter(),f.current=!0)}),onPointerLeave:ge(e.onPointerLeave,()=>{a.onTriggerLeave(),f.current=!1}),onPointerDown:ge(e.onPointerDown,()=>{a.open&&a.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:ge(e.onFocus,()=>{c.current||a.onOpen()}),onBlur:ge(e.onBlur,a.onClose),onClick:ge(e.onClick,a.onClose)})})});m5.displayName=Bx;var g5="TooltipPortal",[xae,x5]=Pp(g5,{forceMount:void 0}),Uc="TooltipContent",kT=_.forwardRef((e,t)=>{const r=x5(Uc,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...s}=e,i=jp(Uc,e.__scopeTooltip);return u.jsx(Vr,{present:n||i.open,children:i.disableHoverableContent?u.jsx(CT,{side:a,...s,ref:t}):u.jsx(v5,{side:a,...s,ref:t})})}),v5=_.forwardRef((e,t)=>{const r=jp(Uc,e.__scopeTooltip),n=ET(Uc,e.__scopeTooltip),a=_.useRef(null),s=Ke(t,a),[i,o]=_.useState(null),{trigger:l,onClose:c}=r,f=a.current,{onPointerInTransitChange:d}=n,h=_.useCallback(()=>{o(null),d(!1)},[d]),p=_.useCallback((g,m)=>{const x=g.currentTarget,v={x:g.clientX,y:g.clientY},y=b5(v,x.getBoundingClientRect()),w=S5(v,y),E=k5(m.getBoundingClientRect()),b=T5([...w,...E]);o(b),d(!0)},[d]);return _.useEffect(()=>()=>h(),[h]),_.useEffect(()=>{if(l&&f){const g=x=>p(x,f),m=x=>p(x,l);return l.addEventListener("pointerleave",g),f.addEventListener("pointerleave",m),()=>{l.removeEventListener("pointerleave",g),f.removeEventListener("pointerleave",m)}}},[l,f,p,h]),_.useEffect(()=>{if(i){const g=m=>{const x=m.target,v={x:m.clientX,y:m.clientY},y=(l==null?void 0:l.contains(x))||(f==null?void 0:f.contains(x)),w=!C5(v,i);y?h():w&&(h(),c())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[l,f,i,c,h]),u.jsx(CT,{...e,ref:s})}),[y5,w5]=Pp(ST,{isInside:!1}),_5=d5("TooltipContent"),CT=_.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:s,onPointerDownOutside:i,...o}=e,l=jp(Uc,r),c=ty(r),{onClose:f}=l;return _.useEffect(()=>(document.addEventListener(E2,f),()=>document.removeEventListener(E2,f)),[f]),_.useEffect(()=>{if(l.trigger){const d=h=>{const p=h.target;p!=null&&p.contains(l.trigger)&&f()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,f]),u.jsx(Jc,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:f,children:u.jsxs(Z1,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[u.jsx(_5,{children:n}),u.jsx(y5,{scope:r,isInside:!0,children:u.jsx($I,{id:l.contentId,role:"tooltip",children:a||n})})]})})});kT.displayName=Uc;var TT="TooltipArrow",E5=_.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=ty(r);return w5(TT,r).isInside?null:u.jsx(ey,{...a,...n,ref:t})});E5.displayName=TT;function b5(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(r,n,a,s)){case s:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function S5(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function k5(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function C5(e,t){const{x:r,y:n}=e;let a=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const o=t[s],l=t[i],c=o.x,f=o.y,d=l.x,h=l.y;f>n!=h>n&&r<(d-c)*(n-f)/(h-f)+c&&(a=!a)}return a}function T5(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),N5(t)}function N5(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const s=t[t.length-1],i=t[t.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const s=r[r.length-1],i=r[r.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var A5=bT,NT=kT;const R5=A5,P5=_.forwardRef(({className:e,sideOffset:t=4,...r},n)=>u.jsx(NT,{ref:n,sideOffset:t,className:he("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));P5.displayName=NT.displayName;var nu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},j5={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Ei,Uv,Wb,F5=(Wb=class{constructor(){Fe(this,Ei,j5);Fe(this,Uv,!1)}setTimeoutProvider(e){Se(this,Ei,e)}setTimeout(e,t){return H(this,Ei).setTimeout(e,t)}clearTimeout(e){H(this,Ei).clearTimeout(e)}setInterval(e,t){return H(this,Ei).setInterval(e,t)}clearInterval(e){H(this,Ei).clearInterval(e)}},Ei=new WeakMap,Uv=new WeakMap,Wb),Co=new F5;function O5(e){setTimeout(e,0)}var Qo=typeof window>"u"||"Deno"in globalThis;function fn(){}function I5(e,t){return typeof e=="function"?e(t):e}function Ux(e){return typeof e=="number"&&e>=0&&e!==1/0}function AT(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Gi(e,t){return typeof e=="function"?e(t):e}function ua(e,t){return typeof e=="function"?e(t):e}function b2(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:s,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==ry(i,t.options))return!1}else if(!Bf(t.queryKey,i))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||s&&!s(t))}function S2(e,t){const{exact:r,status:n,predicate:a,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(Jo(t.options.mutationKey)!==Jo(s))return!1}else if(!Bf(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function ry(e,t){return((t==null?void 0:t.queryKeyHashFn)||Jo)(e)}function Jo(e){return JSON.stringify(e,(t,r)=>$x(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function Bf(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Bf(e[r],t[r])):!1}var D5=Object.prototype.hasOwnProperty;function RT(e,t,r=0){if(e===t)return e;if(r>500)return t;const n=k2(e)&&k2(t);if(!n&&!($x(e)&&$x(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let f=0;f<o;f++){const d=n?f:i[f],h=e[d],p=t[d];if(h===p){l[d]=h,(n?f<s:D5.call(e,d))&&c++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){l[d]=p;continue}const g=RT(h,p,r+1);l[d]=g,g===h&&c++}return s===o&&c===s?e:l}function T0(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function k2(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function $x(e){if(!C2(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!C2(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function C2(e){return Object.prototype.toString.call(e)==="[object Object]"}function M5(e){return new Promise(t=>{Co.setTimeout(t,e)})}function Wx(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?RT(e,t):t}function L5(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function B5(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var ny=Symbol();function PT(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ny?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function ay(e,t){return typeof e=="function"?e(...t):!!e}function U5(e,t,r){let n=!1,a;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(a??(a=t()),n||(n=!0,a.aborted?r():a.addEventListener("abort",r,{once:!0})),a)}),e}var Ao,bi,yc,Vb,$5=(Vb=class extends nu{constructor(){super();Fe(this,Ao);Fe(this,bi);Fe(this,yc);Se(this,yc,t=>{if(!Qo&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){H(this,bi)||this.setEventListener(H(this,yc))}onUnsubscribe(){var t;this.hasListeners()||((t=H(this,bi))==null||t.call(this),Se(this,bi,void 0))}setEventListener(t){var r;Se(this,yc,t),(r=H(this,bi))==null||r.call(this),Se(this,bi,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){H(this,Ao)!==t&&(Se(this,Ao,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof H(this,Ao)=="boolean"?H(this,Ao):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ao=new WeakMap,bi=new WeakMap,yc=new WeakMap,Vb),sy=new $5;function Vx(){let e,t;const r=new Promise((a,s)=>{e=a,t=s});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}var W5=O5;function V5(){let e=[],t=0,r=o=>{o()},n=o=>{o()},a=W5;const s=o=>{t?e.push(o):a(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||i()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var vr=V5(),wc,Si,_c,zb,z5=(zb=class extends nu{constructor(){super();Fe(this,wc,!0);Fe(this,Si);Fe(this,_c);Se(this,_c,t=>{if(!Qo&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){H(this,Si)||this.setEventListener(H(this,_c))}onUnsubscribe(){var t;this.hasListeners()||((t=H(this,Si))==null||t.call(this),Se(this,Si,void 0))}setEventListener(t){var r;Se(this,_c,t),(r=H(this,Si))==null||r.call(this),Se(this,Si,t(this.setOnline.bind(this)))}setOnline(t){H(this,wc)!==t&&(Se(this,wc,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return H(this,wc)}},wc=new WeakMap,Si=new WeakMap,_c=new WeakMap,zb),N0=new z5;function H5(e){return Math.min(1e3*2**e,3e4)}function jT(e){return(e??"online")==="online"?N0.isOnline():!0}var zx=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function FT(e){let t=!1,r=0,n;const a=Vx(),s=()=>a.status!=="pending",i=m=>{var x;if(!s()){const v=new zx(m);h(v),(x=e.onCancel)==null||x.call(e,v)}},o=()=>{t=!0},l=()=>{t=!1},c=()=>sy.isFocused()&&(e.networkMode==="always"||N0.isOnline())&&e.canRun(),f=()=>jT(e.networkMode)&&e.canRun(),d=m=>{s()||(n==null||n(),a.resolve(m))},h=m=>{s()||(n==null||n(),a.reject(m))},p=()=>new Promise(m=>{var x;n=v=>{(s()||c())&&m(v)},(x=e.onPause)==null||x.call(e)}).then(()=>{var m;n=void 0,s()||(m=e.onContinue)==null||m.call(e)}),g=()=>{if(s())return;let m;const x=r===0?e.initialPromise:void 0;try{m=x??e.fn()}catch(v){m=Promise.reject(v)}Promise.resolve(m).then(d).catch(v=>{var k;if(s())return;const y=e.retry??(Qo?0:3),w=e.retryDelay??H5,E=typeof w=="function"?w(r,v):w,b=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,v);if(t||!b){h(v);return}r++,(k=e.onFail)==null||k.call(e,r,v),M5(E).then(()=>c()?void 0:p()).then(()=>{t?h(v):g()})})};return{promise:a,status:()=>a.status,cancel:i,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:l,canStart:f,start:()=>(f()?g():p().then(g),a)}}var Ro,Hb,OT=(Hb=class{constructor(){Fe(this,Ro)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ux(this.gcTime)&&Se(this,Ro,Co.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Qo?1/0:5*60*1e3))}clearGcTimeout(){H(this,Ro)&&(Co.clearTimeout(H(this,Ro)),Se(this,Ro,void 0))}},Ro=new WeakMap,Hb),Po,Ec,la,jo,Sr,ud,Fo,Oa,Ps,Gb,G5=(Gb=class extends OT{constructor(t){super();Fe(this,Oa);Fe(this,Po);Fe(this,Ec);Fe(this,la);Fe(this,jo);Fe(this,Sr);Fe(this,ud);Fe(this,Fo);Se(this,Fo,!1),Se(this,ud,t.defaultOptions),this.setOptions(t.options),this.observers=[],Se(this,jo,t.client),Se(this,la,H(this,jo).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Se(this,Po,N2(this.options)),this.state=t.state??H(this,Po),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=H(this,Sr))==null?void 0:t.promise}setOptions(t){if(this.options={...H(this,ud),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=N2(this.options);r.data!==void 0&&(this.setState(T2(r.data,r.dataUpdatedAt)),Se(this,Po,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&H(this,la).remove(this)}setData(t,r){const n=Wx(this.state.data,t,this.options);return tt(this,Oa,Ps).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){tt(this,Oa,Ps).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=H(this,Sr))==null?void 0:n.promise;return(a=H(this,Sr))==null||a.cancel(t),r?r.then(fn).catch(fn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(H(this,Po))}isActive(){return this.observers.some(t=>ua(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ny||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Gi(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!AT(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=H(this,Sr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=H(this,Sr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),H(this,la).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(H(this,Sr)&&(H(this,Fo)?H(this,Sr).cancel({revert:!0}):H(this,Sr).cancelRetry()),this.scheduleGc()),H(this,la).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||tt(this,Oa,Ps).call(this,{type:"invalidate"})}async fetch(t,r){var l,c,f,d,h,p,g,m,x,v,y,w;if(this.state.fetchStatus!=="idle"&&((l=H(this,Sr))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(H(this,Sr))return H(this,Sr).continueRetry(),H(this,Sr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const E=this.observers.find(b=>b.options.queryFn);E&&this.setOptions(E.options)}const n=new AbortController,a=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(Se(this,Fo,!0),n.signal)})},s=()=>{const E=PT(this.options,r),k=(()=>{const S={client:H(this,jo),queryKey:this.queryKey,meta:this.meta};return a(S),S})();return Se(this,Fo,!1),this.options.persister?this.options.persister(E,k,this):E(k)},o=(()=>{const E={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:H(this,jo),state:this.state,fetchFn:s};return a(E),E})();(c=this.options.behavior)==null||c.onFetch(o,this),Se(this,Ec,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=o.fetchOptions)==null?void 0:f.meta))&&tt(this,Oa,Ps).call(this,{type:"fetch",meta:(d=o.fetchOptions)==null?void 0:d.meta}),Se(this,Sr,FT({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:E=>{E instanceof zx&&E.revert&&this.setState({...H(this,Ec),fetchStatus:"idle"}),n.abort()},onFail:(E,b)=>{tt(this,Oa,Ps).call(this,{type:"failed",failureCount:E,error:b})},onPause:()=>{tt(this,Oa,Ps).call(this,{type:"pause"})},onContinue:()=>{tt(this,Oa,Ps).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const E=await H(this,Sr).start();if(E===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(E),(p=(h=H(this,la).config).onSuccess)==null||p.call(h,E,this),(m=(g=H(this,la).config).onSettled)==null||m.call(g,E,this.state.error,this),E}catch(E){if(E instanceof zx){if(E.silent)return H(this,Sr).promise;if(E.revert){if(this.state.data===void 0)throw E;return this.state.data}}throw tt(this,Oa,Ps).call(this,{type:"error",error:E}),(v=(x=H(this,la).config).onError)==null||v.call(x,E,this),(w=(y=H(this,la).config).onSettled)==null||w.call(y,this.state.data,E,this),E}finally{this.scheduleGc()}}},Po=new WeakMap,Ec=new WeakMap,la=new WeakMap,jo=new WeakMap,Sr=new WeakMap,ud=new WeakMap,Fo=new WeakMap,Oa=new WeakSet,Ps=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...IT(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,...T2(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Se(this,Ec,t.manual?a:void 0),a;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),vr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),H(this,la).notify({query:this,type:"updated",action:t})})},Gb);function IT(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:jT(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function T2(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function N2(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var bn,it,fd,ln,Oo,bc,Is,ki,dd,Sc,kc,Io,Do,Ci,Cc,gt,Bu,Hx,Gx,Kx,qx,Xx,Yx,Qx,DT,Kb,K5=(Kb=class extends nu{constructor(t,r){super();Fe(this,gt);Fe(this,bn);Fe(this,it);Fe(this,fd);Fe(this,ln);Fe(this,Oo);Fe(this,bc);Fe(this,Is);Fe(this,ki);Fe(this,dd);Fe(this,Sc);Fe(this,kc);Fe(this,Io);Fe(this,Do);Fe(this,Ci);Fe(this,Cc,new Set);this.options=r,Se(this,bn,t),Se(this,ki,null),Se(this,Is,Vx()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(H(this,it).addObserver(this),A2(H(this,it),this.options)?tt(this,gt,Bu).call(this):this.updateResult(),tt(this,gt,qx).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Jx(H(this,it),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Jx(H(this,it),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,tt(this,gt,Xx).call(this),tt(this,gt,Yx).call(this),H(this,it).removeObserver(this)}setOptions(t){const r=this.options,n=H(this,it);if(this.options=H(this,bn).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ua(this.options.enabled,H(this,it))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");tt(this,gt,Qx).call(this),H(this,it).setOptions(this.options),r._defaulted&&!T0(this.options,r)&&H(this,bn).getQueryCache().notify({type:"observerOptionsUpdated",query:H(this,it),observer:this});const a=this.hasListeners();a&&R2(H(this,it),n,this.options,r)&&tt(this,gt,Bu).call(this),this.updateResult(),a&&(H(this,it)!==n||ua(this.options.enabled,H(this,it))!==ua(r.enabled,H(this,it))||Gi(this.options.staleTime,H(this,it))!==Gi(r.staleTime,H(this,it)))&&tt(this,gt,Hx).call(this);const s=tt(this,gt,Gx).call(this);a&&(H(this,it)!==n||ua(this.options.enabled,H(this,it))!==ua(r.enabled,H(this,it))||s!==H(this,Ci))&&tt(this,gt,Kx).call(this,s)}getOptimisticResult(t){const r=H(this,bn).getQueryCache().build(H(this,bn),t),n=this.createResult(r,t);return X5(this,n)&&(Se(this,ln,n),Se(this,bc,this.options),Se(this,Oo,H(this,it).state)),n}getCurrentResult(){return H(this,ln)}trackResult(t,r){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),r==null||r(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&H(this,Is).status==="pending"&&H(this,Is).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,a))})}trackProp(t){H(this,Cc).add(t)}getCurrentQuery(){return H(this,it)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=H(this,bn).defaultQueryOptions(t),n=H(this,bn).getQueryCache().build(H(this,bn),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return tt(this,gt,Bu).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),H(this,ln)))}createResult(t,r){var N;const n=H(this,it),a=this.options,s=H(this,ln),i=H(this,Oo),o=H(this,bc),c=t!==n?t.state:H(this,fd),{state:f}=t;let d={...f},h=!1,p;if(r._optimisticResults){const O=this.hasListeners(),j=!O&&A2(t,r),D=O&&R2(t,n,r,a);(j||D)&&(d={...d,...IT(f.data,t.options)}),r._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:g,errorUpdatedAt:m,status:x}=d;p=d.data;let v=!1;if(r.placeholderData!==void 0&&p===void 0&&x==="pending"){let O;s!=null&&s.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(O=s.data,v=!0):O=typeof r.placeholderData=="function"?r.placeholderData((N=H(this,kc))==null?void 0:N.state.data,H(this,kc)):r.placeholderData,O!==void 0&&(x="success",p=Wx(s==null?void 0:s.data,O,r),h=!0)}if(r.select&&p!==void 0&&!v)if(s&&p===(i==null?void 0:i.data)&&r.select===H(this,dd))p=H(this,Sc);else try{Se(this,dd,r.select),p=r.select(p),p=Wx(s==null?void 0:s.data,p,r),Se(this,Sc,p),Se(this,ki,null)}catch(O){Se(this,ki,O)}H(this,ki)&&(g=H(this,ki),p=H(this,Sc),m=Date.now(),x="error");const y=d.fetchStatus==="fetching",w=x==="pending",E=x==="error",b=w&&y,k=p!==void 0,T={status:x,fetchStatus:d.fetchStatus,isPending:w,isSuccess:x==="success",isError:E,isInitialLoading:b,isLoading:b,data:p,dataUpdatedAt:d.dataUpdatedAt,error:g,errorUpdatedAt:m,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:y,isRefetching:y&&!w,isLoadingError:E&&!k,isPaused:d.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:E&&k,isStale:iy(t,r),refetch:this.refetch,promise:H(this,Is),isEnabled:ua(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const O=Y=>{T.status==="error"?Y.reject(T.error):T.data!==void 0&&Y.resolve(T.data)},j=()=>{const Y=Se(this,Is,T.promise=Vx());O(Y)},D=H(this,Is);switch(D.status){case"pending":t.queryHash===n.queryHash&&O(D);break;case"fulfilled":(T.status==="error"||T.data!==D.value)&&j();break;case"rejected":(T.status!=="error"||T.error!==D.reason)&&j();break}}return T}updateResult(){const t=H(this,ln),r=this.createResult(H(this,it),this.options);if(Se(this,Oo,H(this,it).state),Se(this,bc,this.options),H(this,Oo).data!==void 0&&Se(this,kc,H(this,it)),T0(r,t))return;Se(this,ln,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,s=typeof a=="function"?a():a;if(s==="all"||!s&&!H(this,Cc).size)return!0;const i=new Set(s??H(this,Cc));return this.options.throwOnError&&i.add("error"),Object.keys(H(this,ln)).some(o=>{const l=o;return H(this,ln)[l]!==t[l]&&i.has(l)})};tt(this,gt,DT).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&tt(this,gt,qx).call(this)}},bn=new WeakMap,it=new WeakMap,fd=new WeakMap,ln=new WeakMap,Oo=new WeakMap,bc=new WeakMap,Is=new WeakMap,ki=new WeakMap,dd=new WeakMap,Sc=new WeakMap,kc=new WeakMap,Io=new WeakMap,Do=new WeakMap,Ci=new WeakMap,Cc=new WeakMap,gt=new WeakSet,Bu=function(t){tt(this,gt,Qx).call(this);let r=H(this,it).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(fn)),r},Hx=function(){tt(this,gt,Xx).call(this);const t=Gi(this.options.staleTime,H(this,it));if(Qo||H(this,ln).isStale||!Ux(t))return;const n=AT(H(this,ln).dataUpdatedAt,t)+1;Se(this,Io,Co.setTimeout(()=>{H(this,ln).isStale||this.updateResult()},n))},Gx=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(H(this,it)):this.options.refetchInterval)??!1},Kx=function(t){tt(this,gt,Yx).call(this),Se(this,Ci,t),!(Qo||ua(this.options.enabled,H(this,it))===!1||!Ux(H(this,Ci))||H(this,Ci)===0)&&Se(this,Do,Co.setInterval(()=>{(this.options.refetchIntervalInBackground||sy.isFocused())&&tt(this,gt,Bu).call(this)},H(this,Ci)))},qx=function(){tt(this,gt,Hx).call(this),tt(this,gt,Kx).call(this,tt(this,gt,Gx).call(this))},Xx=function(){H(this,Io)&&(Co.clearTimeout(H(this,Io)),Se(this,Io,void 0))},Yx=function(){H(this,Do)&&(Co.clearInterval(H(this,Do)),Se(this,Do,void 0))},Qx=function(){const t=H(this,bn).getQueryCache().build(H(this,bn),this.options);if(t===H(this,it))return;const r=H(this,it);Se(this,it,t),Se(this,fd,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},DT=function(t){vr.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(H(this,ln))}),H(this,bn).getQueryCache().notify({query:H(this,it),type:"observerResultsUpdated"})})},Kb);function q5(e,t){return ua(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function A2(e,t){return q5(e,t)||e.state.data!==void 0&&Jx(e,t,t.refetchOnMount)}function Jx(e,t,r){if(ua(t.enabled,e)!==!1&&Gi(t.staleTime,e)!=="static"){const n=typeof r=="function"?r(e):r;return n==="always"||n!==!1&&iy(e,t)}return!1}function R2(e,t,r,n){return(e!==t||ua(n.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&iy(e,r)}function iy(e,t){return ua(t.enabled,e)!==!1&&e.isStaleByTime(Gi(t.staleTime,e))}function X5(e,t){return!T0(e.getCurrentResult(),t)}function P2(e){return{onFetch:(t,r)=>{var f,d,h,p,g;const n=t.options,a=(h=(d=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,s=((p=t.state.data)==null?void 0:p.pages)||[],i=((g=t.state.data)==null?void 0:g.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let m=!1;const x=w=>{U5(w,()=>t.signal,()=>m=!0)},v=PT(t.options,t.fetchOptions),y=async(w,E,b)=>{if(m)return Promise.reject();if(E==null&&w.pages.length)return Promise.resolve(w);const S=(()=>{const j={client:t.client,queryKey:t.queryKey,pageParam:E,direction:b?"backward":"forward",meta:t.options.meta};return x(j),j})(),T=await v(S),{maxPages:N}=t.options,O=b?B5:L5;return{pages:O(w.pages,T,N),pageParams:O(w.pageParams,E,N)}};if(a&&s.length){const w=a==="backward",E=w?Y5:j2,b={pages:s,pageParams:i},k=E(n,b);o=await y(b,k,w)}else{const w=e??s.length;do{const E=l===0?i[0]??n.initialPageParam:j2(n,o);if(l>0&&E==null)break;o=await y(o,E),l++}while(l<w)}return o};t.options.persister?t.fetchFn=()=>{var m,x;return(x=(m=t.options).persister)==null?void 0:x.call(m,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function j2(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function Y5(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var hd,cs,cn,Mo,us,pi,qb,Q5=(qb=class extends OT{constructor(t){super();Fe(this,us);Fe(this,hd);Fe(this,cs);Fe(this,cn);Fe(this,Mo);Se(this,hd,t.client),this.mutationId=t.mutationId,Se(this,cn,t.mutationCache),Se(this,cs,[]),this.state=t.state||MT(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){H(this,cs).includes(t)||(H(this,cs).push(t),this.clearGcTimeout(),H(this,cn).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Se(this,cs,H(this,cs).filter(r=>r!==t)),this.scheduleGc(),H(this,cn).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){H(this,cs).length||(this.state.status==="pending"?this.scheduleGc():H(this,cn).remove(this))}continue(){var t;return((t=H(this,Mo))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,l,c,f,d,h,p,g,m,x,v,y,w,E,b,k,S,T,N;const r=()=>{tt(this,us,pi).call(this,{type:"continue"})},n={client:H(this,hd),meta:this.options.meta,mutationKey:this.options.mutationKey};Se(this,Mo,FT({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(O,j)=>{tt(this,us,pi).call(this,{type:"failed",failureCount:O,error:j})},onPause:()=>{tt(this,us,pi).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>H(this,cn).canRun(this)}));const a=this.state.status==="pending",s=!H(this,Mo).canStart();try{if(a)r();else{tt(this,us,pi).call(this,{type:"pending",variables:t,isPaused:s}),await((o=(i=H(this,cn).config).onMutate)==null?void 0:o.call(i,t,this,n));const j=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t,n));j!==this.state.context&&tt(this,us,pi).call(this,{type:"pending",context:j,variables:t,isPaused:s})}const O=await H(this,Mo).start();return await((d=(f=H(this,cn).config).onSuccess)==null?void 0:d.call(f,O,t,this.state.context,this,n)),await((p=(h=this.options).onSuccess)==null?void 0:p.call(h,O,t,this.state.context,n)),await((m=(g=H(this,cn).config).onSettled)==null?void 0:m.call(g,O,null,this.state.variables,this.state.context,this,n)),await((v=(x=this.options).onSettled)==null?void 0:v.call(x,O,null,t,this.state.context,n)),tt(this,us,pi).call(this,{type:"success",data:O}),O}catch(O){try{await((w=(y=H(this,cn).config).onError)==null?void 0:w.call(y,O,t,this.state.context,this,n))}catch(j){Promise.reject(j)}try{await((b=(E=this.options).onError)==null?void 0:b.call(E,O,t,this.state.context,n))}catch(j){Promise.reject(j)}try{await((S=(k=H(this,cn).config).onSettled)==null?void 0:S.call(k,void 0,O,this.state.variables,this.state.context,this,n))}catch(j){Promise.reject(j)}try{await((N=(T=this.options).onSettled)==null?void 0:N.call(T,void 0,O,t,this.state.context,n))}catch(j){Promise.reject(j)}throw tt(this,us,pi).call(this,{type:"error",error:O}),O}finally{H(this,cn).runNext(this)}}},hd=new WeakMap,cs=new WeakMap,cn=new WeakMap,Mo=new WeakMap,us=new WeakSet,pi=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),vr.batch(()=>{H(this,cs).forEach(n=>{n.onMutationUpdate(t)}),H(this,cn).notify({mutation:this,type:"updated",action:t})})},qb);function MT(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ds,Ia,pd,Xb,J5=(Xb=class extends nu{constructor(t={}){super();Fe(this,Ds);Fe(this,Ia);Fe(this,pd);this.config=t,Se(this,Ds,new Set),Se(this,Ia,new Map),Se(this,pd,0)}build(t,r,n){const a=new Q5({client:t,mutationCache:this,mutationId:++$d(this,pd)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){H(this,Ds).add(t);const r=ch(t);if(typeof r=="string"){const n=H(this,Ia).get(r);n?n.push(t):H(this,Ia).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(H(this,Ds).delete(t)){const r=ch(t);if(typeof r=="string"){const n=H(this,Ia).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&H(this,Ia).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=ch(t);if(typeof r=="string"){const n=H(this,Ia).get(r),a=n==null?void 0:n.find(s=>s.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=ch(t);if(typeof r=="string"){const a=(n=H(this,Ia).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){vr.batch(()=>{H(this,Ds).forEach(t=>{this.notify({type:"removed",mutation:t})}),H(this,Ds).clear(),H(this,Ia).clear()})}getAll(){return Array.from(H(this,Ds))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>S2(r,n))}findAll(t={}){return this.getAll().filter(r=>S2(t,r))}notify(t){vr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return vr.batch(()=>Promise.all(t.map(r=>r.continue().catch(fn))))}},Ds=new WeakMap,Ia=new WeakMap,pd=new WeakMap,Xb);function ch(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Ms,Ti,Sn,Ls,Gs,Hh,Zx,Yb,Z5=(Yb=class extends nu{constructor(r,n){super();Fe(this,Gs);Fe(this,Ms);Fe(this,Ti);Fe(this,Sn);Fe(this,Ls);Se(this,Ms,r),this.setOptions(n),this.bindMethods(),tt(this,Gs,Hh).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=H(this,Ms).defaultMutationOptions(r),T0(this.options,n)||H(this,Ms).getMutationCache().notify({type:"observerOptionsUpdated",mutation:H(this,Sn),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Jo(n.mutationKey)!==Jo(this.options.mutationKey)?this.reset():((a=H(this,Sn))==null?void 0:a.state.status)==="pending"&&H(this,Sn).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=H(this,Sn))==null||r.removeObserver(this)}onMutationUpdate(r){tt(this,Gs,Hh).call(this),tt(this,Gs,Zx).call(this,r)}getCurrentResult(){return H(this,Ti)}reset(){var r;(r=H(this,Sn))==null||r.removeObserver(this),Se(this,Sn,void 0),tt(this,Gs,Hh).call(this),tt(this,Gs,Zx).call(this)}mutate(r,n){var a;return Se(this,Ls,n),(a=H(this,Sn))==null||a.removeObserver(this),Se(this,Sn,H(this,Ms).getMutationCache().build(H(this,Ms),this.options)),H(this,Sn).addObserver(this),H(this,Sn).execute(r)}},Ms=new WeakMap,Ti=new WeakMap,Sn=new WeakMap,Ls=new WeakMap,Gs=new WeakSet,Hh=function(){var n;const r=((n=H(this,Sn))==null?void 0:n.state)??MT();Se(this,Ti,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},Zx=function(r){vr.batch(()=>{var n,a,s,i,o,l,c,f;if(H(this,Ls)&&this.hasListeners()){const d=H(this,Ti).variables,h=H(this,Ti).context,p={client:H(this,Ms),meta:this.options.meta,mutationKey:this.options.mutationKey};if((r==null?void 0:r.type)==="success"){try{(a=(n=H(this,Ls)).onSuccess)==null||a.call(n,r.data,d,h,p)}catch(g){Promise.reject(g)}try{(i=(s=H(this,Ls)).onSettled)==null||i.call(s,r.data,null,d,h,p)}catch(g){Promise.reject(g)}}else if((r==null?void 0:r.type)==="error"){try{(l=(o=H(this,Ls)).onError)==null||l.call(o,r.error,d,h,p)}catch(g){Promise.reject(g)}try{(f=(c=H(this,Ls)).onSettled)==null||f.call(c,void 0,r.error,d,h,p)}catch(g){Promise.reject(g)}}}this.listeners.forEach(d=>{d(H(this,Ti))})})},Yb),fs,Qb,e6=(Qb=class extends nu{constructor(t={}){super();Fe(this,fs);this.config=t,Se(this,fs,new Map)}build(t,r,n){const a=r.queryKey,s=r.queryHash??ry(a,r);let i=this.get(s);return i||(i=new G5({client:t,queryKey:a,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(i)),i}add(t){H(this,fs).has(t.queryHash)||(H(this,fs).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=H(this,fs).get(t.queryHash);r&&(t.destroy(),r===t&&H(this,fs).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){vr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return H(this,fs).get(t)}getAll(){return[...H(this,fs).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>b2(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>b2(t,n)):r}notify(t){vr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){vr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){vr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},fs=new WeakMap,Qb),Xt,Ni,Ai,Tc,Nc,Ri,Ac,Rc,Jb,t6=(Jb=class{constructor(e={}){Fe(this,Xt);Fe(this,Ni);Fe(this,Ai);Fe(this,Tc);Fe(this,Nc);Fe(this,Ri);Fe(this,Ac);Fe(this,Rc);Se(this,Xt,e.queryCache||new e6),Se(this,Ni,e.mutationCache||new J5),Se(this,Ai,e.defaultOptions||{}),Se(this,Tc,new Map),Se(this,Nc,new Map),Se(this,Ri,0)}mount(){$d(this,Ri)._++,H(this,Ri)===1&&(Se(this,Ac,sy.subscribe(async e=>{e&&(await this.resumePausedMutations(),H(this,Xt).onFocus())})),Se(this,Rc,N0.subscribe(async e=>{e&&(await this.resumePausedMutations(),H(this,Xt).onOnline())})))}unmount(){var e,t;$d(this,Ri)._--,H(this,Ri)===0&&((e=H(this,Ac))==null||e.call(this),Se(this,Ac,void 0),(t=H(this,Rc))==null||t.call(this),Se(this,Rc,void 0))}isFetching(e){return H(this,Xt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return H(this,Ni).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=H(this,Xt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=H(this,Xt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Gi(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return H(this,Xt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=H(this,Xt).get(n.queryHash),s=a==null?void 0:a.state.data,i=I5(t,s);if(i!==void 0)return H(this,Xt).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return vr.batch(()=>H(this,Xt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=H(this,Xt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=H(this,Xt);vr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=H(this,Xt);return vr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=vr.batch(()=>H(this,Xt).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(fn).catch(fn)}invalidateQueries(e,t={}){return vr.batch(()=>(H(this,Xt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=vr.batch(()=>H(this,Xt).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let s=a.fetch(void 0,r);return r.throwOnError||(s=s.catch(fn)),a.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(fn)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=H(this,Xt).build(this,t);return r.isStaleByTime(Gi(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(fn).catch(fn)}fetchInfiniteQuery(e){return e.behavior=P2(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(fn).catch(fn)}ensureInfiniteQueryData(e){return e.behavior=P2(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return N0.isOnline()?H(this,Ni).resumePausedMutations():Promise.resolve()}getQueryCache(){return H(this,Xt)}getMutationCache(){return H(this,Ni)}getDefaultOptions(){return H(this,Ai)}setDefaultOptions(e){Se(this,Ai,e)}setQueryDefaults(e,t){H(this,Tc).set(Jo(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...H(this,Tc).values()],r={};return t.forEach(n=>{Bf(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){H(this,Nc).set(Jo(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...H(this,Nc).values()],r={};return t.forEach(n=>{Bf(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...H(this,Ai).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ry(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ny&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...H(this,Ai).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){H(this,Xt).clear(),H(this,Ni).clear()}},Xt=new WeakMap,Ni=new WeakMap,Ai=new WeakMap,Tc=new WeakMap,Nc=new WeakMap,Ri=new WeakMap,Ac=new WeakMap,Rc=new WeakMap,Jb),LT=_.createContext(void 0),Pr=e=>{const t=_.useContext(LT);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},r6=({client:e,children:t})=>(_.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),u.jsx(LT.Provider,{value:e,children:t})),BT=_.createContext(!1),n6=()=>_.useContext(BT);BT.Provider;function a6(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var s6=_.createContext(a6()),i6=()=>_.useContext(s6),o6=(e,t,r)=>{const n=r!=null&&r.state.error&&typeof e.throwOnError=="function"?ay(e.throwOnError,[r.state.error,r]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||n)&&(t.isReset()||(e.retryOnMount=!1))},l6=e=>{_.useEffect(()=>{e.clearReset()},[e])},c6=({result:e,errorResetBoundary:t,throwOnError:r,query:n,suspense:a})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&(a&&e.data===void 0||ay(r,[e.error,n])),u6=e=>{if(e.suspense){const r=a=>a==="static"?a:Math.max(a??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...a)=>r(n(...a)):r(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},f6=(e,t)=>e.isLoading&&e.isFetching&&!t,d6=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,F2=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function h6(e,t,r){var h,p,g,m;const n=n6(),a=i6(),s=Pr(),i=s.defaultQueryOptions(e);(p=(h=s.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,i);const o=s.getQueryCache().get(i.queryHash);i._optimisticResults=n?"isRestoring":"optimistic",u6(i),o6(i,a,o),l6(a);const l=!s.getQueryCache().get(i.queryHash),[c]=_.useState(()=>new t(s,i)),f=c.getOptimisticResult(i),d=!n&&e.subscribed!==!1;if(_.useSyncExternalStore(_.useCallback(x=>{const v=d?c.subscribe(vr.batchCalls(x)):fn;return c.updateResult(),v},[c,d]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),_.useEffect(()=>{c.setOptions(i)},[i,c]),d6(i,f))throw F2(i,c,a);if(c6({result:f,errorResetBoundary:a,throwOnError:i.throwOnError,query:o,suspense:i.suspense}))throw f.error;if((m=(g=s.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||m.call(g,i,f),i.experimental_prefetchInRender&&!Qo&&f6(f,n)){const x=l?F2(i,c,a):o==null?void 0:o.promise;x==null||x.catch(fn).finally(()=>{c.updateResult()})}return i.notifyOnChangeProps?f:c.trackResult(f)}function Zn(e,t){return h6(e,K5)}function nn(e,t){const r=Pr(),[n]=_.useState(()=>new Z5(r,e));_.useEffect(()=>{n.setOptions(e)},[n,e]);const a=_.useSyncExternalStore(_.useCallback(i=>n.subscribe(vr.batchCalls(i)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),s=_.useCallback((i,o)=>{n.mutate(i,o).catch(fn)},[n]);if(a.error&&ay(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:s,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uf(){return Uf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uf.apply(this,arguments)}var Oi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Oi||(Oi={}));const O2="popstate";function p6(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return ev("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:A0(a)}return g6(t,r,null,e)}function ir(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function oy(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function m6(){return Math.random().toString(36).substr(2,8)}function I2(e,t){return{usr:e.state,key:e.key,idx:t}}function ev(e,t,r,n){return r===void 0&&(r=null),Uf({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?au(t):t,{state:r,key:t&&t.key||n||m6()})}function A0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function au(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function g6(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o=Oi.Pop,l=null,c=f();c==null&&(c=0,i.replaceState(Uf({},i.state,{idx:c}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=Oi.Pop;let x=f(),v=x==null?null:x-c;c=x,l&&l({action:o,location:m.location,delta:v})}function h(x,v){o=Oi.Push;let y=ev(m.location,x,v);c=f()+1;let w=I2(y,c),E=m.createHref(y);try{i.pushState(w,"",E)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;a.location.assign(E)}s&&l&&l({action:o,location:m.location,delta:1})}function p(x,v){o=Oi.Replace;let y=ev(m.location,x,v);c=f();let w=I2(y,c),E=m.createHref(y);i.replaceState(w,"",E),s&&l&&l({action:o,location:m.location,delta:0})}function g(x){let v=a.location.origin!=="null"?a.location.origin:a.location.href,y=typeof x=="string"?x:A0(x);return y=y.replace(/ $/,"%20"),ir(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let m={get action(){return o},get location(){return e(a,i)},listen(x){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(O2,d),l=x,()=>{a.removeEventListener(O2,d),l=null}},createHref(x){return t(a,x)},createURL:g,encodeLocation(x){let v=g(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:h,replace:p,go(x){return i.go(x)}};return m}var D2;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(D2||(D2={}));function x6(e,t,r){return r===void 0&&(r="/"),v6(e,t,r)}function v6(e,t,r,n){let a=typeof t=="string"?au(t):t,s=ly(a.pathname||"/",r);if(s==null)return null;let i=UT(e);y6(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=P6(s);o=N6(i[l],c)}return o}function UT(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,i,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(ir(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Ki([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(ir(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),UT(s.children,t,f,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:C6(c,s.index),routesMeta:f})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let l of $T(s.path))a(s,i,l)}),t}function $T(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=$T(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function y6(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:T6(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const w6=/^:[\w-]+$/,_6=3,E6=2,b6=1,S6=10,k6=-2,M2=e=>e==="*";function C6(e,t){let r=e.split("/"),n=r.length;return r.some(M2)&&(n+=k6),t&&(n+=E6),r.filter(a=>!M2(a)).reduce((a,s)=>a+(w6.test(s)?_6:s===""?b6:S6),n)}function T6(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function N6(e,t,r){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",d=A6({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),h=l.route;if(!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Ki([s,d.pathname]),pathnameBase:D6(Ki([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Ki([s,d.pathnameBase]))}return i}function A6(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=R6(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,f,d)=>{let{paramName:h,isOptional:p}=f;if(h==="*"){let m=o[d]||"";i=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[d];return p&&!g?c[h]=void 0:c[h]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function R6(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),oy(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function P6(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return oy(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ly(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const j6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,F6=e=>j6.test(e);function O6(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?au(e):e,s;if(r)if(F6(r))s=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),oy(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?s=L2(r.substring(1),"/"):s=L2(r,t)}else s=t;return{pathname:s,search:M6(n),hash:L6(a)}}function L2(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function ng(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function I6(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function cy(e,t){let r=I6(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function uy(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=au(e):(a=Uf({},e),ir(!a.pathname||!a.pathname.includes("?"),ng("?","pathname","search",a)),ir(!a.pathname||!a.pathname.includes("#"),ng("#","pathname","hash",a)),ir(!a.search||!a.search.includes("#"),ng("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}o=d>=0?t[d]:"/"}let l=O6(a,o),c=i&&i!=="/"&&i.endsWith("/"),f=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}const Ki=e=>e.join("/").replace(/\/\/+/g,"/"),D6=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),M6=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,L6=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function B6(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const WT=["post","put","patch","delete"];new Set(WT);const U6=["get",...WT];new Set(U6);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $f(){return $f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$f.apply(this,arguments)}const fy=_.createContext(null),$6=_.createContext(null),io=_.createContext(null),Fp=_.createContext(null),ri=_.createContext({outlet:null,matches:[],isDataRoute:!1}),VT=_.createContext(null);function W6(e,t){let{relative:r}=t===void 0?{}:t;su()||ir(!1);let{basename:n,navigator:a}=_.useContext(io),{hash:s,pathname:i,search:o}=HT(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:Ki([n,i])),a.createHref({pathname:l,search:o,hash:s})}function su(){return _.useContext(Fp)!=null}function ni(){return su()||ir(!1),_.useContext(Fp).location}function zT(e){_.useContext(io).static||_.useLayoutEffect(e)}function xl(){let{isDataRoute:e}=_.useContext(ri);return e?rL():V6()}function V6(){su()||ir(!1);let e=_.useContext(fy),{basename:t,future:r,navigator:n}=_.useContext(io),{matches:a}=_.useContext(ri),{pathname:s}=ni(),i=JSON.stringify(cy(a,r.v7_relativeSplatPath)),o=_.useRef(!1);return zT(()=>{o.current=!0}),_.useCallback(function(c,f){if(f===void 0&&(f={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=uy(c,JSON.parse(i),s,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Ki([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,s,e])}function z6(){let{matches:e}=_.useContext(ri),t=e[e.length-1];return t?t.params:{}}function HT(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=_.useContext(io),{matches:a}=_.useContext(ri),{pathname:s}=ni(),i=JSON.stringify(cy(a,n.v7_relativeSplatPath));return _.useMemo(()=>uy(e,JSON.parse(i),s,r==="path"),[e,i,s,r])}function H6(e,t){return G6(e,t)}function G6(e,t,r,n){su()||ir(!1);let{navigator:a}=_.useContext(io),{matches:s}=_.useContext(ri),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let c=ni(),f;if(t){var d;let x=typeof t=="string"?au(t):t;l==="/"||(d=x.pathname)!=null&&d.startsWith(l)||ir(!1),f=x}else f=c;let h=f.pathname||"/",p=h;if(l!=="/"){let x=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=x6(e,{pathname:p}),m=Q6(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:Ki([l,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:Ki([l,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,r,n);return t&&m?_.createElement(Fp.Provider,{value:{location:$f({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Oi.Pop}},m):m}function K6(){let e=tL(),t=B6(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},t),r?_.createElement("pre",{style:a},r):null,null)}const q6=_.createElement(K6,null);class X6 extends _.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?_.createElement(ri.Provider,{value:this.props.routeContext},_.createElement(VT.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Y6(e){let{routeContext:t,match:r,children:n}=e,a=_.useContext(fy);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),_.createElement(ri.Provider,{value:t},n)}function Q6(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||ir(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:h,errors:p}=r,g=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||g){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((f,d,h)=>{let p,g=!1,m=null,x=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,m=d.route.errorElement||q6,l&&(c<0&&h===0?(nL("route-fallback"),g=!0,x=null):c===h&&(g=!0,x=d.route.hydrateFallbackElement||null)));let v=t.concat(i.slice(0,h+1)),y=()=>{let w;return p?w=m:g?w=x:d.route.Component?w=_.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=f,_.createElement(Y6,{match:d,routeContext:{outlet:f,matches:v,isDataRoute:r!=null},children:w})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?_.createElement(X6,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var GT=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(GT||{}),KT=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(KT||{});function J6(e){let t=_.useContext(fy);return t||ir(!1),t}function Z6(e){let t=_.useContext($6);return t||ir(!1),t}function eL(e){let t=_.useContext(ri);return t||ir(!1),t}function qT(e){let t=eL(),r=t.matches[t.matches.length-1];return r.route.id||ir(!1),r.route.id}function tL(){var e;let t=_.useContext(VT),r=Z6(),n=qT();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function rL(){let{router:e}=J6(GT.UseNavigateStable),t=qT(KT.UseNavigateStable),r=_.useRef(!1);return zT(()=>{r.current=!0}),_.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,$f({fromRouteId:t},s)))},[e,t])}const B2={};function nL(e,t,r){B2[e]||(B2[e]=!0)}function aL(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function ag(e){let{to:t,replace:r,state:n,relative:a}=e;su()||ir(!1);let{future:s,static:i}=_.useContext(io),{matches:o}=_.useContext(ri),{pathname:l}=ni(),c=xl(),f=uy(t,cy(o,s.v7_relativeSplatPath),l,a==="path"),d=JSON.stringify(f);return _.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:a}),[c,d,a,r,n]),null}function na(e){ir(!1)}function sL(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Oi.Pop,navigator:s,static:i=!1,future:o}=e;su()&&ir(!1);let l=t.replace(/^\/*/,"/"),c=_.useMemo(()=>({basename:l,navigator:s,static:i,future:$f({v7_relativeSplatPath:!1},o)}),[l,o,s,i]);typeof n=="string"&&(n=au(n));let{pathname:f="/",search:d="",hash:h="",state:p=null,key:g="default"}=n,m=_.useMemo(()=>{let x=ly(f,l);return x==null?null:{location:{pathname:x,search:d,hash:h,state:p,key:g},navigationType:a}},[l,f,d,h,p,g,a]);return m==null?null:_.createElement(io.Provider,{value:c},_.createElement(Fp.Provider,{children:r,value:m}))}function iL(e){let{children:t,location:r}=e;return H6(tv(t),r)}new Promise(()=>{});function tv(e,t){t===void 0&&(t=[]);let r=[];return _.Children.forEach(e,(n,a)=>{if(!_.isValidElement(n))return;let s=[...t,a];if(n.type===_.Fragment){r.push.apply(r,tv(n.props.children,s));return}n.type!==na&&ir(!1),!n.props.index||!n.props.children||ir(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=tv(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rv(){return rv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rv.apply(this,arguments)}function oL(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function lL(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function cL(e,t){return e.button===0&&(!t||t==="_self")&&!lL(e)}function nv(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function uL(e,t){let r=nv(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(s=>{r.append(a,s)})}),r}const fL=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],dL="6";try{window.__reactRouterVersion=dL}catch{}const hL="startTransition",U2=sp[hL];function pL(e){let{basename:t,children:r,future:n,window:a}=e,s=_.useRef();s.current==null&&(s.current=p6({window:a,v5Compat:!0}));let i=s.current,[o,l]=_.useState({action:i.action,location:i.location}),{v7_startTransition:c}=n||{},f=_.useCallback(d=>{c&&U2?U2(()=>l(d)):l(d)},[l,c]);return _.useLayoutEffect(()=>i.listen(f),[i,f]),_.useEffect(()=>aL(n),[n]),_.createElement(sL,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const mL=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xr=_.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:i,state:o,target:l,to:c,preventScrollReset:f,viewTransition:d}=t,h=oL(t,fL),{basename:p}=_.useContext(io),g,m=!1;if(typeof c=="string"&&gL.test(c)&&(g=c,mL))try{let w=new URL(window.location.href),E=c.startsWith("//")?new URL(w.protocol+c):new URL(c),b=ly(E.pathname,p);E.origin===w.origin&&b!=null?c=b+E.search+E.hash:m=!0}catch{}let x=W6(c,{relative:a}),v=xL(c,{replace:i,state:o,target:l,preventScrollReset:f,relative:a,viewTransition:d});function y(w){n&&n(w),w.defaultPrevented||v(w)}return _.createElement("a",rv({},h,{href:g||x,onClick:m||s?n:y,ref:r,target:l}))});var $2;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})($2||($2={}));var W2;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(W2||(W2={}));function xL(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:i,viewTransition:o}=t===void 0?{}:t,l=xl(),c=ni(),f=HT(e,{relative:i});return _.useCallback(d=>{if(cL(d,r)){d.preventDefault();let h=n!==void 0?n:A0(c)===A0(f);l(e,{replace:h,state:a,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,f,n,a,r,e,s,i,o])}function vL(e){let t=_.useRef(nv(e)),r=_.useRef(!1),n=ni(),a=_.useMemo(()=>uL(n.search,r.current?null:t.current),[n.search]),s=xl(),i=_.useCallback((o,l)=>{const c=nv(typeof o=="function"?o(a):o);r.current=!0,s("?"+c,l)},[s,a]);return[a,i]}var hs=function(){return hs=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},hs.apply(this,arguments)};function iu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function yL(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})}function wL(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}const _L=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class dy extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class EL extends dy{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class V2 extends dy{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class z2 extends dy{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var av;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(av||(av={}));class bL{constructor(t,{headers:r={},customFetch:n,region:a=av.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=_L(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return yL(this,arguments,void 0,function*(r,n={}){var a;let s,i;try{const{headers:o,method:l,body:c,signal:f,timeout:d}=n;let h={},{region:p}=n;p||(p=this.region);const g=new URL(`${this.url}/${r}`);p&&p!=="any"&&(h["x-region"]=p,g.searchParams.set("forceFunctionRegion",p));let m;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",m=c):typeof c=="string"?(h["Content-Type"]="text/plain",m=c):typeof FormData<"u"&&c instanceof FormData?m=c:(h["Content-Type"]="application/json",m=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?m=JSON.stringify(c):m=c;let x=f;d&&(i=new AbortController,s=setTimeout(()=>i.abort(),d),f?(x=i.signal,f.addEventListener("abort",()=>i.abort())):x=i.signal);const v=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:m,signal:x}).catch(b=>{throw new EL(b)}),y=v.headers.get("x-relay-error");if(y&&y==="true")throw new V2(v);if(!v.ok)throw new z2(v);let w=((a=v.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),E;return w==="application/json"?E=yield v.json():w==="application/octet-stream"||w==="application/pdf"?E=yield v.blob():w==="text/event-stream"?E=v:w==="multipart/form-data"?E=yield v.formData():E=yield v.text(),{data:E,error:null,response:v}}catch(o){return{data:null,error:o,response:o instanceof z2||o instanceof V2?o.context:void 0}}finally{s&&clearTimeout(s)}})}}var SL=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},kL=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let i=null,o=null,l=null,c=s.status,f=s.statusText;if(s.ok){var d,h;if(r.method!=="HEAD"){var p;const v=await s.text();v===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((p=r.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?o=v:o=JSON.parse(v))}const m=(d=r.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),x=(h=s.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");m&&x&&x.length>1&&(l=parseInt(x[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,c=406,f="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var g;const m=await s.text();try{i=JSON.parse(m),Array.isArray(i)&&s.status===404&&(o=[],i=null,c=200,f="OK")}catch{s.status===404&&m===""?(c=204,f="No Content"):i={message:m}}if(i&&r.isMaybeSingle&&(!(i==null||(g=i.details)===null||g===void 0)&&g.includes("0 rows"))&&(i=null,c=200,f="OK"),i&&r.shouldThrowOnError)throw new SL(i)}return{error:i,data:o,count:l,status:c,statusText:f}});return this.shouldThrowOnError||(a=a.catch(s=>{var i;let o="";const l=s==null?void 0:s.cause;if(l){var c,f,d,h;const g=(c=l==null?void 0:l.message)!==null&&c!==void 0?c:"",m=(f=l==null?void 0:l.code)!==null&&f!==void 0?f:"";o=`${(d=s==null?void 0:s.name)!==null&&d!==void 0?d:"FetchError"}: ${s==null?void 0:s.message}`,o+=`

Caused by: ${(h=l==null?void 0:l.name)!==null&&h!==void 0?h:"Error"}: ${g}`,m&&(o+=` (${m})`),l!=null&&l.stack&&(o+=`
${l.stack}`)}else{var p;o=(p=s==null?void 0:s.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},CL=class extends kL{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const s=a?`${a}.order`:"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:s="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const H2=new RegExp("[,()]");var Bl=class extends CL{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&H2.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&H2.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},TL=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},a=r?"HEAD":"GET";let s=!1;const i=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",i),n&&l.append("Prefer",`count=${n}`),new Bl({method:a,url:o,headers:l,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const a="POST",{url:s,headers:i}=this.cloneRequestState();if(t&&i.append("Prefer",`count=${t}`),r||i.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);s.searchParams.set("columns",l.join(","))}}return new Bl({method:a,url:s,headers:i,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){var s;const i="POST",{url:o,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&l.append("Prefer",`count=${n}`),a||l.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(c.length>0){const f=[...new Set(c)].map(d=>`"${d}"`);o.searchParams.set("columns",f.join(","))}}return new Bl({method:i,url:o,headers:l,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:a,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Bl({method:n,url:a,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new Bl({method:r,url:n,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},NL=class XT{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new TL(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new XT(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const l=new URL(`${this.url}/rpc/${t}`);let c;const f=p=>p!==null&&typeof p=="object"&&(!Array.isArray(p)||p.some(f)),d=n&&Object.values(r).some(f);d?(o="POST",c=r):n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([p,g])=>g!==void 0).map(([p,g])=>[p,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([p,g])=>{l.searchParams.append(p,g)})):(o="POST",c=r);const h=new Headers(this.headers);return d?h.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&h.set("Prefer",`count=${s}`),new Bl({method:o,url:l,headers:h,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class AL{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const a=n.node,s=parseInt(a.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const RL="2.90.1",PL=`realtime-js/${RL}`,YT="1.0.0",jL="2.0.0",G2=YT,sv=1e4,FL=1e3,OL=100;var vi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(vi||(vi={}));var mr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(mr||(mr={}));var Ma;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ma||(Ma={}));var iv;(function(e){e.websocket="websocket"})(iv||(iv={}));var wo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(wo||(wo={}));class IL{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},i=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(t,r,n){var a,s;const i=t.topic,o=(a=t.ref)!==null&&a!==void 0?a:"",l=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,f=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},d=Object.keys(f).length===0?"":JSON.stringify(f);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+i.length+c.length+d.length,p=new ArrayBuffer(this.HEADER_LENGTH+h);let g=new DataView(p),m=0;g.setUint8(m++,this.KINDS.userBroadcastPush),g.setUint8(m++,l.length),g.setUint8(m++,o.length),g.setUint8(m++,i.length),g.setUint8(m++,c.length),g.setUint8(m++,d.length),g.setUint8(m++,r),Array.from(l,v=>g.setUint8(m++,v.charCodeAt(0))),Array.from(o,v=>g.setUint8(m++,v.charCodeAt(0))),Array.from(i,v=>g.setUint8(m++,v.charCodeAt(0))),Array.from(c,v=>g.setUint8(m++,v.charCodeAt(0))),Array.from(d,v=>g.setUint8(m++,v.charCodeAt(0)));var x=new Uint8Array(p.byteLength+n.byteLength);return x.set(new Uint8Array(p),0),x.set(new Uint8Array(n),p.byteLength),x.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,s,i,o,l]=n;return r({join_ref:a,ref:s,topic:i,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2),i=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(t.slice(l,l+a));l=l+a;const f=n.decode(t.slice(l,l+s));l=l+s;const d=n.decode(t.slice(l,l+i));l=l+i;const h=t.slice(l,t.byteLength),p=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,g={type:this.BROADCAST_EVENT,event:f,payload:p};return i>0&&(g.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:g}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class QT{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var kt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(kt||(kt={}));const K2=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,i)=>(s[i]=DL(i,e,t,a),s),{}):{}},DL=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?JT(s,i):ov(i)},JT=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return UL(t,r)}switch(e){case kt.bool:return ML(t);case kt.float4:case kt.float8:case kt.int2:case kt.int4:case kt.int8:case kt.numeric:case kt.oid:return LL(t);case kt.json:case kt.jsonb:return BL(t);case kt.timestamp:return $L(t);case kt.abstime:case kt.date:case kt.daterange:case kt.int4range:case kt.int8range:case kt.money:case kt.reltime:case kt.text:case kt.time:case kt.timestamptz:case kt.timetz:case kt.tsrange:case kt.tstzrange:return ov(t);default:return ov(t)}},ov=e=>e,ML=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},LL=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},BL=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},UL=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>JT(t,o))}return e},$L=e=>typeof e=="string"?e.replace(" ","T"):e,ZT=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class sg{constructor(t,r,n={},a=sv){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var q2;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(q2||(q2={}));class nf{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=nf.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=nf.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=nf.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,f)=>{i[c]||(l[c]=f)}),this.map(i,(c,f)=>{const d=s[c];if(d){const h=f.map(x=>x.presence_ref),p=d.map(x=>x.presence_ref),g=f.filter(x=>p.indexOf(x.presence_ref)<0),m=d.filter(x=>h.indexOf(x.presence_ref)<0);g.length>0&&(o[c]=g),m.length>0&&(l[c]=m)}else o[c]=f}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const f=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),f.length>0){const d=t[o].map(p=>p.presence_ref),h=f.filter(p=>d.indexOf(p.presence_ref)<0);t[o].unshift(...h)}n(o,f,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const f=l.map(d=>d.presence_ref);c=c.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var X2;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(X2||(X2={}));var af;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(af||(af={}));var Fs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Fs||(Fs={}));class tc{constructor(t,r={config:{}},n){var a,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=mr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new sg(this,Ma.join,this.params,this.timeout),this.rejoinTimer=new QT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=mr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=mr.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=mr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=mr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=mr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ma.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new nf(this),this.broadcastEndpointURL=ZT(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==mr.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&a!==void 0?a:[],f=!!this.bindings[af.PRESENCE]&&this.bindings[af.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,d={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(Fs.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Fs.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){t==null||t(Fs.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,x=(g=m==null?void 0:m.length)!==null&&g!==void 0?g:0,v=[];for(let y=0;y<x;y++){const w=m[y],{filter:{event:E,schema:b,table:k,filter:S}}=w,T=p&&p[y];if(T&&T.event===E&&tc.isFilterValueEqual(T.schema,b)&&tc.isFilterValueEqual(T.table,k)&&tc.isFilterValueEqual(T.filter,S))v.push(Object.assign(Object.assign({},w),{id:T.id}));else{this.unsubscribe(),this.state=mr.errored,t==null||t(Fs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Fs.SUBSCRIBED);return}}).receive("error",p=>{this.state=mr.errored,t==null||t(Fs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Fs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===mr.joined&&t===af.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const c=await o.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:i}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=mr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ma.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new sg(this,Ma.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=mr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new sg(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>OL){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:f}=Ma;if(n&&[o,l,c,f].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var g,m,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(m=p.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===i}).map(p=>p.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(p=>{var g,m,x,v,y,w,E,b;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const k=p.id,S=(g=p.filter)===null||g===void 0?void 0:g.event;return k&&((m=r.ids)===null||m===void 0?void 0:m.includes(k))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))&&(!(!((v=p.filter)===null||v===void 0)&&v.table)||p.filter.table===((y=r.data)===null||y===void 0?void 0:y.table))}else{const k=(E=(w=p==null?void 0:p.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return k==="*"||k===((b=r==null?void 0:r.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:x,commit_timestamp:v,type:y,errors:w}=g;h=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:v,eventType:y,new:{},old:{},errors:w}),this._getPayloadRecords(g))}p.callback(h,n)})}_isClosed(){return this.state===mr.closed}_isJoined(){return this.state===mr.joined}_isJoining(){return this.state===mr.joining}_isLeaving(){return this.state===mr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&tc.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ma.close,{},t)}_onError(t){this._on(Ma.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=mr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=K2(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=K2(t.columns,t.old_record)),r}}const ig=()=>{},uh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},WL=[1e3,2e3,5e3,1e4],VL=1e4,zL=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class HL{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=sv,this.transport=null,this.heartbeatIntervalMs=uh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ig,this.ref=0,this.reconnectTimer=null,this.vsn=G2,this.logger=ig,this.conn=null,this.sendBuffer=[],this.serializer=new IL,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...s)=>a(...s):(...s)=>fetch(...s),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${iv.websocket}`,this.httpEndpoint=ZT(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=AL.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case vi.connecting:return wo.Connecting;case vi.open:return wo.Open;case vi.closing:return wo.Closing;default:return wo.Closed}}isConnected(){return this.connectionState()===wo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new tc(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(FL,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},uh.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(f){this.log("error","error in heartbeat callback",f)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${a} ${o}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===vi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===vi.open||this.conn.readyState===vi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ma.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([zL],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const s={access_token:r,version:PL};r&&a.updateJoinPayload(s),a.joinedOnce&&a._isJoined()&&a._push(Ma.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new QT(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},uh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,l,c,f,d,h,p;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:sv,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:uh.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:ig,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:G2,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:g=>WL[g-1]||VL,this.vsn){case YT:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:(g,m)=>m(JSON.stringify(g)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:(g,m)=>m(JSON.parse(g));break;case jL:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(p=t==null?void 0:t.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Wf=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function GL(e,t,r){const n=new URL(t,e);if(r)for(const[a,s]of Object.entries(r))s!==void 0&&n.searchParams.set(a,s);return n.toString()}async function KL(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function qL(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:s,headers:i}){const o=GL(e.baseUrl,n,a),l=await KL(e.auth),c=await t(o,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...i},body:s?JSON.stringify(s):void 0}),f=await c.text(),d=(c.headers.get("content-type")||"").includes("application/json"),h=d&&f?JSON.parse(f):f;if(!c.ok){const p=d?h:void 0,g=p==null?void 0:p.error;throw new Wf((g==null?void 0:g.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:g==null?void 0:g.type,icebergCode:g==null?void 0:g.code,details:p})}return{status:c.status,headers:c.headers,data:h}}}}function fh(e){return e.join("")}var XL=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:fh(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${fh(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${fh(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${fh(e.namespace)}`}),!0}catch(t){if(t instanceof Wf&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Wf&&r.status===409)return;throw r}}};function Tl(e){return e.join("")}var YL=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Tl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Wf&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Wf&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},QL=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=qL({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new XL(this.client,t),this.tableOps=new YL(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Op=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Wt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var JL=class extends Op{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},lv=class extends Op{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const hy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ZL=()=>Response,cv=e=>{if(Array.isArray(e))return e.map(r=>cv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=cv(n)}),t},eB=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},tB=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Vf(e){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(e)}function rB(e,t){if(Vf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nB(e){var t=rB(e,"string");return Vf(t)=="symbol"?t:t+""}function aB(e,t,r){return(t=nB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y2(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Me(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y2(Object(r),!0).forEach(function(n){aB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y2(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const og=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},sB=async(e,t,r)=>{e instanceof await ZL()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,s=(n==null?void 0:n.statusCode)||a+"";t(new JL(og(n),a,s))}).catch(n=>{t(new lv(og(n),n))}):t(new lv(og(e),e))},iB=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(eB(n)?(a.headers=Me({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Me(Me({},a),r))};async function Cd(e,t,r,n,a,s){return new Promise((i,o)=>{e(r,iB(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>sB(l,o,n))})}async function zf(e,t,r,n){return Cd(e,"GET",t,r,n)}async function Fa(e,t,r,n,a){return Cd(e,"POST",t,n,a,r)}async function uv(e,t,r,n,a){return Cd(e,"PUT",t,n,a,r)}async function oB(e,t,r,n){return Cd(e,"HEAD",t,Me(Me({},r),{},{noResolveJson:!0}),n)}async function py(e,t,r,n,a){return Cd(e,"DELETE",t,n,a,r)}var lB=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}}};let eN;eN=Symbol.toStringTag;var cB=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[eN]="BlobDownloadBuilder",this.promise=null}asStream(){return new lB(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}}};const uB={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Q2={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var fB=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=hy(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var a=this;try{let s;const i=Me(Me({},Q2),n);let o=Me(Me({},a.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",a.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",i.cacheControl),l&&!s.has("metadata")&&s.append("metadata",a.encodeMetadata(l))):(s=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=a.toBase64(a.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(o=Me(Me({},o),n.headers));const c=a._removeEmptyFolders(t),f=a._getFinalPath(c),d=await(e=="PUT"?uv:Fa)(a.fetch,`${a.url}/object/${f}`,s,Me({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(s){if(a.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var a=this;const s=a._removeEmptyFolders(e),i=a._getFinalPath(s),o=new URL(a.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let l;const c=Me({upsert:Q2.upsert},n),f=Me(Me({},a.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType),{data:{path:s,fullPath:(await uv(a.fetch,o.toString(),l,{headers:f})).Key},error:null}}catch(l){if(a.shouldThrowOnError)throw l;if(Wt(l))return{data:null,error:l};throw l}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const a=Me({},r.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const s=await Fa(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(r.url+s.url),o=i.searchParams.get("token");if(!o)throw new Op("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await Fa(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}}async copy(e,t,r){var n=this;try{return{data:{path:(await Fa(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var n=this;try{let a=n._getFinalPath(e),s=await Fa(n.fetch,`${n.url}/object/sign/${a}`,Me({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${n.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var n=this;try{const a=await Fa(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(i=>Me(Me({},i),{},{signedUrl:i.signedURL?encodeURI(`${n.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=n?`?${n}`:"",s=this._getFinalPath(e),i=()=>zf(this.fetch,`${this.url}/${r}/${s}${a}`,{headers:this.headers,noResolveJson:!0});return new cB(i,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:cv(await zf(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await oB(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Wt(n)&&n instanceof lv){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const s=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});i!==""&&n.push(i);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}async remove(e){var t=this;try{return{data:await py(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const a=Me(Me(Me({},uB),t),{},{prefix:e||""});return{data:await Fa(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},r),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const n=Me({},e);return{data:await Fa(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const tN="2.90.1",rN={"X-Client-Info":`storage-js/${tN}`};var dB=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Me(Me({},rN),t),this.fetch=hy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await zf(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await zf(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Fa(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await uv(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await Fa(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await py(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},hB=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Me(Me({},rN),t),this.fetch=hy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Fa(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),a=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await zf(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await py(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!tB(e))throw new Op("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new QL({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(a,s){const i=a[s];return typeof i!="function"?i:async(...o)=>{try{return{data:await i.apply(a,o),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}};const my={"X-Client-Info":`storage-js/${tN}`,"Content-Type":"application/json"};var nN=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Wn(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var lg=class extends nN{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},pB=class extends nN{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const gy=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),mB=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},J2=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),gB=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(s=>{const i=(s==null?void 0:s.statusCode)||(s==null?void 0:s.code)||n+"";t(new lg(J2(s),n,i))}).catch(()=>{const s=n+"";t(new lg(a.statusText||`HTTP ${n} error`,n,s))});else{const s=n+"";t(new lg(a.statusText||`HTTP ${n} error`,n,s))}}else t(new pB(J2(e),e))},xB=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(mB(n)?(a.headers=Me({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Me(Me({},a),r)):a};async function vB(e,t,r,n,a,s){return new Promise((i,o)=>{e(r,xB(t,n,a,s)).then(l=>{if(!l.ok)throw l;if(n!=null&&n.noResolveJson)return l;const c=l.headers.get("content-type");return!c||!c.includes("application/json")?{}:l.json()}).then(l=>i(l)).catch(l=>gB(l,o,n))})}async function Vn(e,t,r,n,a){return vB(e,"POST",t,n,a,r)}var yB=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Me(Me({},my),t),this.fetch=gy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Vn(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Vn(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await Vn(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Vn(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Wn(n))return{data:null,error:n};throw n}}},wB=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Me(Me({},my),t),this.fetch=gy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Vn(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Vn(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Vn(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Vn(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Vn(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}},_B=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Me(Me({},my),t),this.fetch=gy(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Vn(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Vn(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Vn(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Vn(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Wn(r))return{data:null,error:r};throw r}}},EB=class extends _B{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new bB(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},bB=class extends yB{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new SB(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},SB=class extends wB{constructor(e,t,r,n,a){super(e,t,a),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Me(Me({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},kB=class extends dB{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new fB(this.url,this.headers,e,this.fetch)}get vectors(){return new EB(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new hB(this.url+"/iceberg",this.headers,this.fetch)}};const aN="2.90.1",Ul=30*1e3,fv=3,cg=fv*Ul,CB="http://localhost:9999",TB="supabase.auth.token",NB={"X-Client-Info":`gotrue-js/${aN}`},dv="X-Supabase-Api-Version",sN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},AB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,RB=10*60*1e3;class Hf extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function je(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class PB extends Hf{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function jB(e){return je(e)&&e.name==="AuthApiError"}class _o extends Hf{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ai extends Hf{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Mn extends ai{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function FB(e){return je(e)&&e.name==="AuthSessionMissingError"}class Nl extends ai{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class dh extends ai{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class hh extends ai{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function OB(e){return je(e)&&e.name==="AuthImplicitGrantRedirectError"}class Z2 extends ai{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class IB extends ai{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class hv extends ai{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ug(e){return je(e)&&e.name==="AuthRetryableFetchError"}class eE extends ai{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class pv extends ai{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const R0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),tE=` 	
\r=`.split(""),DB=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<tE.length;t+=1)e[tE[t].charCodeAt(0)]=-2;for(let t=0;t<R0.length;t+=1)e[R0[t].charCodeAt(0)]=t;return e})();function rE(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(R0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(R0[n]),t.queuedBits-=6}}function iN(e,t,r){const n=DB[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function nE(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{BB(i,n,r)};for(let i=0;i<e.length;i+=1)iN(e.charCodeAt(i),a,s);return t.join("")}function MB(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function LB(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}MB(n,t)}}function BB(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function fc(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)iN(e.charCodeAt(a),r,n);return new Uint8Array(t)}function UB(e){const t=[];return LB(e,r=>t.push(r)),new Uint8Array(t)}function To(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>rE(a,r,n)),rE(null,r,n),t.join("")}function $B(e){return Math.round(Date.now()/1e3)+e}function WB(){return Symbol("auth-callback")}const Or=()=>typeof window<"u"&&typeof document<"u",po={tested:!1,writable:!1},oN=()=>{if(!Or())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(po.tested)return po.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),po.tested=!0,po.writable=!0}catch{po.tested=!0,po.writable=!1}return po.writable};function VB(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const lN=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),zB=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",$l=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},mo=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Fr=async(e,t)=>{await e.removeItem(t)};class Ip{constructor(){this.promise=new Ip.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Ip.promiseConstructor=Promise;function fg(e){const t=e.split(".");if(t.length!==3)throw new pv("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!AB.test(t[n]))throw new pv("JWT not in base64url format");return{header:JSON.parse(nE(t[0])),payload:JSON.parse(nE(t[1])),signature:fc(t[2]),raw:{header:t[0],payload:t[1]}}}async function HB(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function GB(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function KB(e){return("0"+e.toString(16)).substr(-2)}function qB(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,KB).join("")}async function XB(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function YB(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await XB(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Al(e,t,r=!1){const n=qB();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await $l(e,`${t}-code-verifier`,a);const s=await YB(n);return[s,n===s?"plain":"s256"]}const QB=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function JB(e){const t=e.headers.get(dv);if(!t||!t.match(QB))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function ZB(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function e7(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const t7=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Rl(e){if(!t7.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function dg(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function r7(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function aE(e){return JSON.parse(JSON.stringify(e))}const vo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),n7=[502,503,504];async function sE(e){var t;if(!zB(e))throw new hv(vo(e),0);if(n7.includes(e.status))throw new hv(vo(e),e.status);let r;try{r=await e.json()}catch(s){throw new _o(vo(s),s)}let n;const a=JB(e);if(a&&a.getTime()>=sN["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new eE(vo(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Mn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new eE(vo(r),e.status,r.weak_password.reasons);throw new PB(vo(r),e.status||500,n)}const a7=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function De(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[dv]||(s[dv]=sN["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await s7(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function s7(e,t,r,n,a,s){const i=a7(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new hv(vo(l),0)}if(o.ok||await sE(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await sE(l)}}function Ra(e){var t;let r=null;l7(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=$B(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function iE(e){const t=Ra(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function _i(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function i7(e){return{data:e,error:null}}function o7(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=iu(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function oE(e){return e}function l7(e){return e.access_token&&e.refresh_token&&e.expires_in}const hg=["global","local","others"];class c7{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=lN(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=hg[0]){if(hg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${hg.join(", ")}`);try{return await De(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(je(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await De(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:_i})}catch(n){if(je(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=iu(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await De(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:o7,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(je(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await De(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:_i})}catch(r){if(je(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},f=await De(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:oE});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);c[`${x}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(je(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Rl(t);try{return await De(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:_i})}catch(r){if(je(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Rl(t);try{return await De(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:_i})}catch(n){if(je(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Rl(t);try{return await De(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:_i})}catch(n){if(je(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Rl(t.userId);try{const{data:r,error:n}=await De(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(je(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Rl(t.userId),Rl(t.id);try{return{data:await De(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(je(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},f=await De(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:oE});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);c[`${x}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(je(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(je(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await De(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(je(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await De(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(je(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await De(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(je(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await De(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(je(r))return{data:null,error:r};throw r}}}function lE(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Pl={debug:!!(globalThis&&oN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cN extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class u7 extends cN{}async function f7(e,t,r){Pl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Pl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Pl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Pl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Pl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new u7(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Pl.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function d7(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function uN(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function h7(e){return parseInt(e,16)}function p7(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function m7(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:s=new Date,nonce:i,notBefore:o,requestId:l,resources:c,scheme:f,uri:d,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=uN(e.address),g=f?`${f}://${n}`:n,m=e.statement?`${e.statement}
`:"",x=`${g} wants you to sign in with your Ethereum account:
${p}

${m}`;let v=`URI: ${d}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${s.toISOString()}`;if(a&&(v+=`
Expiration Time: ${a.toISOString()}`),o&&(v+=`
Not Before: ${o.toISOString()}`),l&&(v+=`
Request ID: ${l}`),c){let y=`
Resources:`;for(const w of c){if(!w||typeof w!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${w}`);y+=`
- ${w}`}v+=y}return`${x}
${v}`}class dr extends Error{constructor({message:t,code:r,cause:n,name:a}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=a??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class P0 extends dr{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function g7({error:e,options:t}){var r,n,a;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new dr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new dr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new dr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=s.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new dr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new dr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new dr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new dr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new dr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(fN(i)){if(s.rp.id!==i)return new dr({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new dr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new dr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new dr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new dr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function x7({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new dr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new dr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(fN(n)){if(r.rpId!==n)return new dr({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new dr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new dr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new dr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class v7{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const y7=new v7;function w7(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=iu(e,["challenge","user","excludeCredentials"]),s=fc(t).buffer,i=Object.assign(Object.assign({},r),{id:fc(r.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:s,user:i});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:fc(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function _7(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=iu(e,["challenge","allowCredentials"]),a=fc(t).buffer,s=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const o=r[i];s.allowCredentials[i]=Object.assign(Object.assign({},o),{id:fc(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return s}function E7(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:To(new Uint8Array(e.response.attestationObject)),clientDataJSON:To(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function b7(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:To(new Uint8Array(a.authenticatorData)),clientDataJSON:To(new Uint8Array(a.clientDataJSON)),signature:To(new Uint8Array(a.signature)),userHandle:a.userHandle?To(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function fN(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function cE(){var e,t;return!!(Or()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function S7(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new P0("Browser returned unexpected credential type",t)}:{data:null,error:new P0("Empty credential response",t)}}catch(t){return{data:null,error:g7({error:t,options:e})}}}async function k7(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new P0("Browser returned unexpected credential type",t)}:{data:null,error:new P0("Empty credential response",t)}}catch(t){return{data:null,error:x7({error:t,options:e})}}}const C7={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},T7={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function j0(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const s in a){const i=a[s];if(i!==void 0)if(Array.isArray(i))n[s]=i;else if(r(i))n[s]=i;else if(t(i)){const o=n[s];t(o)?n[s]=j0(o,i):n[s]=j0(i)}else n[s]=i}return n}function N7(e,t){return j0(C7,e,t||{})}function A7(e,t){return j0(T7,e,t||{})}class R7{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},s){try{const{data:i,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:o};const l=a??y7.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:c}=i.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(i.webauthn.type){case"create":{const c=N7(i.webauthn.credential_options.publicKey,s==null?void 0:s.create),{data:f,error:d}=await S7({publicKey:c,signal:l});return f?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}case"request":{const c=A7(i.webauthn.credential_options.publicKey,s==null?void 0:s.request),{data:f,error:d}=await k7(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:c,signal:l}));return f?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}}}catch(i){return je(i)?{data:null,error:i}:{data:null,error:new _o("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},s){if(!r)return{data:null,error:new Hf("rpId is required for WebAuthn authentication")};try{if(!cE())return{data:null,error:new _o("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:s});if(!i)return{data:null,error:o};const{webauthn:l}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(i){return je(i)?{data:null,error:i}:{data:null,error:new _o("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},s){if(!r)return{data:null,error:new Hf("rpId is required for WebAuthn registration")};try{if(!cE())return{data:null,error:new _o("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(f=>{var d;return(d=f.data)===null||d===void 0?void 0:d.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:s});return l?this._verify({factorId:i.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(i){return je(i)?{data:null,error:i}:{data:null,error:new _o("Unexpected error in register",i)}}}}d7();const P7={url:CB,storageKey:TB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:NB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function uE(e,t,r){return await r()}const jl={};class Gf{get jwks(){var t,r;return(r=(t=jl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){jl[this.storageKey]=Object.assign(Object.assign({},jl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=jl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){jl[this.storageKey]=Object.assign(Object.assign({},jl[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},P7),t);if(this.storageKey=s.storageKey,this.instanceID=(r=Gf.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Gf.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&Or()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new c7({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=lN(s.fetch),this.lock=s.lock||uE,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&Or()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=f7:this.lock=uE,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new R7(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:oN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lE(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=lE(this.memoryStorage)),Or()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${aN}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(Or()&&(r=VB(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),Or()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),OB(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return je(r)?this._returnResult({error:r}):this._returnResult({error:new _o("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ra}),{data:i,error:o}=s;if(o||!i)return this._returnResult({data:{user:null,session:null},error:o});const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(je(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:f,password:d,options:h}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await Al(this.storage,this.storageKey)),s=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},xform:Ra})}else if("phone"in t){const{phone:f,password:d,options:h}=t;s=await De(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ra})}else throw new dh("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return await Fr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(await Fr(this.storage,`${this.storageKey}-code-verifier`),je(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:iE})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await De(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:iE})}else throw new dh("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const s=new Nl;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(je(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,s,i,o,l,c,f,d,h;let p,g;if("message"in t)p=t.message,g=t.signature;else{const{chain:m,wallet:x,statement:v,options:y}=t;let w;if(Or())if(typeof x=="object")w=x;else{const N=window;if("ethereum"in N&&typeof N.ethereum=="object"&&"request"in N.ethereum&&typeof N.ethereum.request=="function")w=N.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=x}const E=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),b=await w.request({method:"eth_requestAccounts"}).then(N=>N).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||b.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=uN(b[0]);let S=(n=y==null?void 0:y.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!S){const N=await w.request({method:"eth_chainId"});S=h7(N)}const T={domain:E.host,address:k,statement:v,uri:E.href,version:"1",chainId:S,nonce:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(i=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=y==null?void 0:y.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(f=y==null?void 0:y.signInWithEthereum)===null||f===void 0?void 0:f.resources};p=m7(T),g=await w.request({method:"personal_sign",params:[p7(p),k]})}try{const{data:m,error:x}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ra});if(x)throw x;if(!m||!m.session||!m.user){const v=new Nl;return this._returnResult({data:{user:null,session:null},error:v})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:x})}catch(m){if(je(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,a,s,i,o,l,c,f,d,h,p;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:x,wallet:v,statement:y,options:w}=t;let E;if(Or())if(typeof v=="object")E=v;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))E=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=v}const b=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const k=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),y?{statement:y}:null));let S;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")S=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)S=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)g=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),m=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${b.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(a=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((d=(f=w==null?void 0:w.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...w.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const k=await E.signMessage(new TextEncoder().encode(g),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=k}}try{const{data:x,error:v}=await De(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:To(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ra});if(v)throw v;if(!x||!x.session||!x.user){const y=new Nl;return this._returnResult({data:{user:null,session:null},error:y})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:v})}catch(x){if(je(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(t){const r=await mo(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new IB;const{data:s,error:i}=await De(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ra});if(await Fr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!s||!s.session||!s.user){const o=new Nl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(await Fr(this.storage,`${this.storageKey}-code-verifier`),je(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ra}),{data:l,error:c}=o;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const f=new Nl;return this._returnResult({data:{user:null,session:null},error:f})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(je(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await Al(this.storage,this.storageKey));const{error:d}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:f}=await De(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f})}throw new dh("You must provide either an email or phone number.")}catch(o){if(await Fr(this.storage,`${this.storageKey}-code-verifier`),je(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await De(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Ra});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(a){if(je(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,s,i;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Al(this.storage,this.storageKey));const c=await De(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:i7});return!((s=c.data)===null||s===void 0)&&s.url&&Or()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(o){if(await Fr(this.storage,`${this.storageKey}-code-verifier`),je(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Mn;const{error:a}=await De(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(je(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await De(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await De(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o})}throw new dh("You must provide either an email or phone number and a type")}catch(r){if(je(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await mo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<cg:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await mo(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=dg()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=r7(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:_i}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Mn}:await De(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:_i})})}catch(r){if(je(r))return FB(r)&&(await this._removeSession(),await Fr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Mn;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Al(this.storage,this.storageKey));const{data:c,error:f}=await De(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:_i});if(f)throw f;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(n){if(await Fr(this.storage,`${this.storageKey}-code-verifier`),je(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Mn;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=fg(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(je(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Mn;const{data:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(je(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Or())throw new hh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new hh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Z2("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new hh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Z2("No code detected.");const{data:y,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new hh("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let h=f+d;l&&(h=parseInt(l));const p=h-f;p*1e3<=Ul&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const g=h-d;f-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,f):f-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,f);const{data:m,error:x}=await this._getUser(s);if(x)throw x;const v={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:h,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:t.type},error:null})}catch(n){if(je(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await mo(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({error:s});const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(jB(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await Fr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=WB(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Al(this.storage,this.storageKey,!0));try{return await De(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await Fr(this.storage,`${this.storageKey}-code-verifier`),je(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(je(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,f;const{data:d,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await De(this.fetch,"GET",p,{headers:this.headers,jwt:(f=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return Or()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(je(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:s}}=r;if(a)throw a;const{options:i,provider:o,token:l,access_token:c,nonce:f}=t,d=await De(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s==null?void 0:s.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Ra}),{data:h,error:p}=d;return p?this._returnResult({data:{user:null,session:null},error:p}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Nl}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:p}))}catch(a){if(await Fr(this.storage,`${this.storageKey}-code-verifier`),je(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await De(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(je(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await GB(async a=>(a>0&&await HB(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await De(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ra})),(a,s)=>{const i=200*Math.pow(2,a);return s&&ug(s)&&Date.now()+i-n<Ul})}catch(n){if(this._debug(r,"error",n),je(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Or()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await mo(this.storage,this.storageKey);if(a&&this.userStorage){let i=await mo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await $l(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:dg()}else if(a&&!a.user&&!a.user){const i=await mo(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await Fr(this.storage,this.storageKey+"-user"),await $l(this.storage,this.storageKey,a)):a.user=dg()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<cg;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${cg}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),ug(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Mn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Ip;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Mn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={data:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),je(s)){const i={data:null,error:s};return ug(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Fr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await $l(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=aE(a);await $l(this.storage,this.storageKey,s)}else{const a=aE(r);await $l(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Fr(this.storage,this.storageKey),await Fr(this.storage,this.storageKey+"-code-verifier"),await Fr(this.storage,this.storageKey+"-user"),this.userStorage&&await Fr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Or()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Ul);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Ul);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Ul}ms, refresh threshold is ${fv} ticks`),a<=fv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof cN)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Or()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await Al(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?this._returnResult({data:null,error:s}):await De(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(je(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await De(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&l.type==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(je(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?E7(t.webauthn.credential_response):b7(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await De(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(je(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const i=await De(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:o}=i;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:w7(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:_7(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(je(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(s),s.status==="verified"&&a[s.factor_type].push(s);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=fg(n.access_token);let i=null;s.aal&&(i=s.aal);let o=i;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const c=s.amr||[];return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await De(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Mn})})}catch(r){if(je(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!a)return this._returnResult({data:null,error:new Mn});const i=await De(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&Or()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(je(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!a)return this._returnResult({data:null,error:new Mn});const i=await De(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&Or()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(je(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await De(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Mn})})}catch(t){if(je(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await De(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Mn})})}catch(r){if(je(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+RB>a)return n;const{data:s,error:i}=await De(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return this._returnResult({data:null,error:g});n=p.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=fg(n);r!=null&&r.allowExpired||ZB(s.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:a,signature:i},error:null}}const f=e7(a.alg),d=await crypto.subtle.importKey("jwk",c,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,i,UB(`${o}.${l}`)))throw new pv("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(je(n))return this._returnResult({data:null,error:n});throw n}}}Gf.nextInstanceID={};const j7=Gf,F7="2.90.1";let Uu="";typeof Deno<"u"?Uu="deno":typeof document<"u"?Uu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Uu="react-native":Uu="node";const O7={"X-Client-Info":`supabase-js-${Uu}/${F7}`},I7={headers:O7},D7={schema:"public"},M7={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},L7={};function Kf(e){"@babel/helpers - typeof";return Kf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kf(e)}function B7(e,t){if(Kf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function U7(e){var t=B7(e,"string");return Kf(t)=="symbol"?t:t+""}function $7(e,t,r){return(t=U7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fE(Object(r),!0).forEach(function(n){$7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const W7=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),V7=()=>Headers,z7=(e,t,r)=>{const n=W7(r),a=V7();return async(s,i)=>{var o;const l=(o=await t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Yt(Yt({},i),{},{headers:c}))}};function H7(e){return e.endsWith("/")?e:e+"/"}function G7(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:f,global:d}=t,h={db:Yt(Yt({},l),a),auth:Yt(Yt({},c),s),realtime:Yt(Yt({},f),i),storage:{},global:Yt(Yt(Yt({},d),o),{},{headers:Yt(Yt({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function K7(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(H7(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var q7=class extends j7{constructor(e){super(e)}},X7=class{constructor(e,t,r){var n,a;this.supabaseUrl=e,this.supabaseKey=t;const s=K7(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const i=`sb-${s.hostname.split(".")[0]}-auth-token`,o={db:D7,realtime:L7,auth:Yt(Yt({},M7),{},{storageKey:i}),global:I7},l=G7(r??{},o);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=l.global.headers)!==null&&a!==void 0?a:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(f,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=z7(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Yt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new NL(new URL("rest/v1",s).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new kB(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new bL(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,storageKey:s,flowType:i,lock:o,debug:l,throwOnError:c},f,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new q7({url:this.authUrl.href,headers:Yt(Yt({},h),f),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,flowType:i,lock:o,debug:l,throwOnError:c,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new HL(this.realtimeUrl.href,Yt(Yt({},e),{},{params:Yt(Yt({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Y7=(e,t,r)=>new X7(e,t,r);function Q7(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Q7()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const J7="https://jmqarsnvhafiszsotojn.supabase.co",Z7="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImptcWFyc252aGFmaXN6c290b2puIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc5Nzk3NzgsImV4cCI6MjA4MzU1NTc3OH0.64lN_p-n3vqUDhc93yVVcjjHlpXyhu2cuESU2n8p1u8",Ce=Y7(J7,Z7,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),dN=_.createContext(void 0);function e9({children:e}){const[t,r]=_.useState(null),[n,a]=_.useState(null),[s,i]=_.useState(null),[o,l]=_.useState(!0),c=async x=>{try{const{data:v,error:y}=await Ce.from("user_roles").select("role").eq("user_id",x).maybeSingle();return y?(console.error("Error fetching role:",y),null):(v==null?void 0:v.role)||null}catch(v){return console.error("Error in fetchUserRole:",v),null}},f=async(x,v)=>{if(!v)return;const{error:y}=await Ce.from("user_roles").insert({user_id:x,role:v});y&&y.code!=="23505"&&console.error("Error ensuring user role:",y)},d=async(x,v)=>{const y=await c(x);return y||(v?(await f(x,v),v):null)};_.useEffect(()=>{const{data:{subscription:x}}=Ce.auth.onAuthStateChange(async(v,y)=>{a(y),r((y==null?void 0:y.user)??null),y!=null&&y.user?setTimeout(async()=>{var b;const w=(b=y.user.user_metadata)==null?void 0:b.role,E=await d(y.user.id,w);i(E),l(!1)},0):(i(null),l(!1))});return Ce.auth.getSession().then(({data:{session:v}})=>{var y;if(a(v),r((v==null?void 0:v.user)??null),v!=null&&v.user){const w=(y=v.user.user_metadata)==null?void 0:y.role;d(v.user.id,w).then(E=>{i(E),l(!1)})}else l(!1)}),()=>x.unsubscribe()},[]);const m={user:t,session:n,role:s,loading:o,signIn:async(x,v)=>{try{const{error:y}=await Ce.auth.signInWithPassword({email:x,password:v});return{error:y?new Error(y.message):null}}catch(y){return{error:y}}},signUp:async(x,v,y,w)=>{try{const{data:E,error:b}=await Ce.auth.signUp({email:x,password:v,options:{data:{full_name:y,role:w||"cliente"}}});return b?{error:new Error(b.message)}:{error:null}}catch(E){return{error:E}}},signOut:async()=>{await Ce.auth.signOut(),r(null),a(null),i(null)},isGestor:s==="gestor",isCliente:s==="cliente"};return u.jsx(dN.Provider,{value:m,children:e})}function Dt(){const e=_.useContext(dN);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}var t9=Symbol.for("react.lazy"),F0=sp[" use ".trim().toString()];function r9(e){return typeof e=="object"&&e!==null&&"then"in e}function hN(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===t9&&"_payload"in e&&r9(e._payload)}function xy(e){const t=a9(e),r=_.forwardRef((n,a)=>{let{children:s,...i}=n;hN(s)&&typeof F0=="function"&&(s=F0(s._payload));const o=_.Children.toArray(s),l=o.find(i9);if(l){const c=l.props.children,f=o.map(d=>d===l?_.Children.count(c)>1?_.Children.only(null):_.isValidElement(c)?c.props.children:null:d);return u.jsx(t,{...i,ref:a,children:_.isValidElement(c)?_.cloneElement(c,void 0,f):null})}return u.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}var n9=xy("Slot");function a9(e){const t=_.forwardRef((r,n)=>{let{children:a,...s}=r;if(hN(a)&&typeof F0=="function"&&(a=F0(a._payload)),_.isValidElement(a)){const i=l9(a),o=o9(s,a.props);return a.type!==_.Fragment&&(o.ref=n?ti(n,i):i),_.cloneElement(a,o)}return _.Children.count(a)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var s9=Symbol("radix.slottable");function i9(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===s9}function o9(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function l9(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const vy=bp("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ye=_.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},s)=>{const i=n?n9:"button";return u.jsx(i,{className:he(vy({variant:t,size:r,className:e})),ref:s,...a})});ye.displayName="Button";const et=_.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:he("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));et.displayName="Card";const yr=_.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:he("flex flex-col space-y-1.5 p-6",e),...t}));yr.displayName="CardHeader";const Lr=_.forwardRef(({className:e,...t},r)=>u.jsx("h3",{ref:r,className:he("text-2xl font-semibold leading-none tracking-tight",e),...t}));Lr.displayName="CardTitle";const pn=_.forwardRef(({className:e,...t},r)=>u.jsx("p",{ref:r,className:he("text-sm text-muted-foreground",e),...t}));pn.displayName="CardDescription";const ot=_.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:he("p-6 pt-0",e),...t}));ot.displayName="CardContent";const c9=_.forwardRef(({className:e,...t},r)=>u.jsx("div",{ref:r,className:he("flex items-center p-6 pt-0",e),...t}));c9.displayName="CardFooter";class u9 extends _.Component{constructor(){super(...arguments);Ud(this,"state",{hasError:!1,error:null,errorInfo:null});Ud(this,"handleReload",()=>{window.location.reload()});Ud(this,"handleGoHome",()=>{window.location.href="/"})}static getDerivedStateFromError(r){return{hasError:!0,error:r,errorInfo:null}}componentDidCatch(r,n){console.error("ErrorBoundary caught an error:",r,n),this.setState({errorInfo:n})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:u.jsxs(et,{className:"max-w-lg w-full",children:[u.jsxs(yr,{className:"text-center",children:[u.jsx("div",{className:"mx-auto mb-4 h-16 w-16 rounded-full bg-destructive/10 flex items-center justify-center",children:u.jsx($1,{className:"h-8 w-8 text-destructive"})}),u.jsx(Lr,{className:"text-xl",children:"Algo sali mal"}),u.jsx(pn,{children:"Ha ocurrido un error inesperado. Por favor intenta recargar la pgina."})]}),u.jsxs(ot,{className:"space-y-4",children:[!1,u.jsxs("div",{className:"flex gap-3 justify-center",children:[u.jsxs(ye,{variant:"outline",onClick:this.handleGoHome,children:[u.jsx(yD,{className:"h-4 w-4 mr-2"}),"Ir al inicio"]}),u.jsxs(ye,{onClick:this.handleReload,children:[u.jsx(kp,{className:"h-4 w-4 mr-2"}),"Recargar pgina"]})]})]})]})}):this.props.children}}function mt({className:e,...t}){return u.jsx("div",{className:he("animate-pulse rounded-md bg-muted",e),...t})}function Rs({children:e,allowedRoles:t}){const{user:r,role:n,loading:a}=Dt(),s=ni();return a?u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:u.jsxs("div",{className:"space-y-4 w-full max-w-md p-8",children:[u.jsx(mt,{className:"h-8 w-3/4 mx-auto"}),u.jsx(mt,{className:"h-4 w-1/2 mx-auto"}),u.jsxs("div",{className:"space-y-2 pt-4",children:[u.jsx(mt,{className:"h-10 w-full"}),u.jsx(mt,{className:"h-10 w-full"}),u.jsx(mt,{className:"h-10 w-full"})]})]})}):r?t&&n&&!t.includes(n)?n==="cliente"?u.jsx(ag,{to:"/cliente",replace:!0}):u.jsx(ag,{to:"/dashboard",replace:!0}):u.jsx(u.Fragment,{children:e}):u.jsx(ag,{to:"/",state:{from:s},replace:!0})}const zt=_.forwardRef(({className:e,type:t,...r},n)=>u.jsx("input",{type:t,className:he("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));zt.displayName="Input";var f9=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],d9=f9.reduce((e,t)=>{const r=xy(`Primitive.${t}`),n=_.forwardRef((a,s)=>{const{asChild:i,...o}=a,l=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),h9="Label",pN=_.forwardRef((e,t)=>u.jsx(d9.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));pN.displayName=h9;var mN=pN;const p9=bp("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),pt=_.forwardRef(({className:e,...t},r)=>u.jsx(mN,{ref:r,className:he(p9(),e),...t}));pt.displayName=mN.displayName;var m9=_.createContext(void 0);function ou(e){const t=_.useContext(m9);return e||t||"ltr"}var pg="rovingFocusGroup.onEntryFocus",g9={bubbles:!1,cancelable:!0},Td="RovingFocusGroup",[mv,gN,x9]=wd(Td),[v9,Dp]=rn(Td,[x9]),[y9,w9]=v9(Td),xN=_.forwardRef((e,t)=>u.jsx(mv.Provider,{scope:e.__scopeRovingFocusGroup,children:u.jsx(mv.Slot,{scope:e.__scopeRovingFocusGroup,children:u.jsx(_9,{...e,ref:t})})}));xN.displayName=Td;var _9=_.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:f=!1,...d}=e,h=_.useRef(null),p=Ke(t,h),g=ou(s),[m,x]=ba({prop:i,defaultProp:o??null,onChange:l,caller:Td}),[v,y]=_.useState(!1),w=sr(c),E=gN(r),b=_.useRef(!1),[k,S]=_.useState(0);return _.useEffect(()=>{const T=h.current;if(T)return T.addEventListener(pg,w),()=>T.removeEventListener(pg,w)},[w]),u.jsx(y9,{scope:r,orientation:n,dir:g,loop:a,currentTabStopId:m,onItemFocus:_.useCallback(T=>x(T),[x]),onItemShiftTab:_.useCallback(()=>y(!0),[]),onFocusableItemAdd:_.useCallback(()=>S(T=>T+1),[]),onFocusableItemRemove:_.useCallback(()=>S(T=>T-1),[]),children:u.jsx(Ae.div,{tabIndex:v||k===0?-1:0,"data-orientation":n,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:ge(e.onMouseDown,()=>{b.current=!0}),onFocus:ge(e.onFocus,T=>{const N=!b.current;if(T.target===T.currentTarget&&N&&!v){const O=new CustomEvent(pg,g9);if(T.currentTarget.dispatchEvent(O),!O.defaultPrevented){const j=E().filter(X=>X.focusable),D=j.find(X=>X.active),Y=j.find(X=>X.id===m),G=[D,Y,...j].filter(Boolean).map(X=>X.ref.current);wN(G,f)}}b.current=!1}),onBlur:ge(e.onBlur,()=>y(!1))})})}),vN="RovingFocusGroupItem",yN=_.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:s,children:i,...o}=e,l=xa(),c=s||l,f=w9(vN,r),d=f.currentTabStopId===c,h=gN(r),{onFocusableItemAdd:p,onFocusableItemRemove:g,currentTabStopId:m}=f;return _.useEffect(()=>{if(n)return p(),()=>g()},[n,p,g]),u.jsx(mv.ItemSlot,{scope:r,id:c,focusable:n,active:a,children:u.jsx(Ae.span,{tabIndex:d?0:-1,"data-orientation":f.orientation,...o,ref:t,onMouseDown:ge(e.onMouseDown,x=>{n?f.onItemFocus(c):x.preventDefault()}),onFocus:ge(e.onFocus,()=>f.onItemFocus(c)),onKeyDown:ge(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){f.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const v=S9(x,f.orientation,f.dir);if(v!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let w=h().filter(E=>E.focusable).map(E=>E.ref.current);if(v==="last")w.reverse();else if(v==="prev"||v==="next"){v==="prev"&&w.reverse();const E=w.indexOf(x.currentTarget);w=f.loop?k9(w,E+1):w.slice(E+1)}setTimeout(()=>wN(w))}}),children:typeof i=="function"?i({isCurrentTabStop:d,hasTabStop:m!=null}):i})})});yN.displayName=vN;var E9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function b9(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function S9(e,t,r){const n=b9(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return E9[n]}function wN(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function k9(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var _N=xN,EN=yN,Mp="Tabs",[C9]=rn(Mp,[Dp]),bN=Dp(),[T9,yy]=C9(Mp),SN=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:s,orientation:i="horizontal",dir:o,activationMode:l="automatic",...c}=e,f=ou(o),[d,h]=ba({prop:n,onChange:a,defaultProp:s??"",caller:Mp});return u.jsx(T9,{scope:r,baseId:xa(),value:d,onValueChange:h,orientation:i,dir:f,activationMode:l,children:u.jsx(Ae.div,{dir:f,"data-orientation":i,...c,ref:t})})});SN.displayName=Mp;var kN="TabsList",CN=_.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,s=yy(kN,r),i=bN(r);return u.jsx(_N,{asChild:!0,...i,orientation:s.orientation,dir:s.dir,loop:n,children:u.jsx(Ae.div,{role:"tablist","aria-orientation":s.orientation,...a,ref:t})})});CN.displayName=kN;var TN="TabsTrigger",NN=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...s}=e,i=yy(TN,r),o=bN(r),l=PN(i.baseId,n),c=jN(i.baseId,n),f=n===i.value;return u.jsx(EN,{asChild:!0,...o,focusable:!a,active:f,children:u.jsx(Ae.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":c,"data-state":f?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...s,ref:t,onMouseDown:ge(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(n):d.preventDefault()}),onKeyDown:ge(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(n)}),onFocus:ge(e.onFocus,()=>{const d=i.activationMode!=="manual";!f&&!a&&d&&i.onValueChange(n)})})})});NN.displayName=TN;var AN="TabsContent",RN=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:s,...i}=e,o=yy(AN,r),l=PN(o.baseId,n),c=jN(o.baseId,n),f=n===o.value,d=_.useRef(f);return _.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),u.jsx(Vr,{present:a||f,children:({present:h})=>u.jsx(Ae.div,{"data-state":f?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});RN.displayName=AN;function PN(e,t){return`${e}-trigger-${t}`}function jN(e,t){return`${e}-content-${t}`}var N9=SN,FN=CN,ON=NN,IN=RN;const Lp=N9,Nd=_.forwardRef(({className:e,...t},r)=>u.jsx(FN,{ref:r,className:he("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Nd.displayName=FN.displayName;const mn=_.forwardRef(({className:e,...t},r)=>u.jsx(ON,{ref:r,className:he("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...t}));mn.displayName=ON.displayName;const gn=_.forwardRef(({className:e,...t},r)=>u.jsx(IN,{ref:r,className:he("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));gn.displayName=IN.displayName;function gv(e,[t,r]){return Math.min(r,Math.max(t,e))}var mg=0;function wy(){_.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??dE()),document.body.insertAdjacentElement("beforeend",e[1]??dE()),mg++,()=>{mg===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),mg--}},[])}function dE(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var gg="focusScope.autoFocusOnMount",xg="focusScope.autoFocusOnUnmount",hE={bubbles:!1,cancelable:!0},A9="FocusScope",Bp=_.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:s,...i}=e,[o,l]=_.useState(null),c=sr(a),f=sr(s),d=_.useRef(null),h=Ke(t,m=>l(m)),p=_.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;_.useEffect(()=>{if(n){let m=function(w){if(p.paused||!o)return;const E=w.target;o.contains(E)?d.current=E:mi(d.current,{select:!0})},x=function(w){if(p.paused||!o)return;const E=w.relatedTarget;E!==null&&(o.contains(E)||mi(d.current,{select:!0}))},v=function(w){if(document.activeElement===document.body)for(const b of w)b.removedNodes.length>0&&mi(o)};document.addEventListener("focusin",m),document.addEventListener("focusout",x);const y=new MutationObserver(v);return o&&y.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",x),y.disconnect()}}},[n,o,p.paused]),_.useEffect(()=>{if(o){mE.add(p);const m=document.activeElement;if(!o.contains(m)){const v=new CustomEvent(gg,hE);o.addEventListener(gg,c),o.dispatchEvent(v),v.defaultPrevented||(R9(I9(DN(o)),{select:!0}),document.activeElement===m&&mi(o))}return()=>{o.removeEventListener(gg,c),setTimeout(()=>{const v=new CustomEvent(xg,hE);o.addEventListener(xg,f),o.dispatchEvent(v),v.defaultPrevented||mi(m??document.body,{select:!0}),o.removeEventListener(xg,f),mE.remove(p)},0)}}},[o,c,f,p]);const g=_.useCallback(m=>{if(!r&&!n||p.paused)return;const x=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,v=document.activeElement;if(x&&v){const y=m.currentTarget,[w,E]=P9(y);w&&E?!m.shiftKey&&v===E?(m.preventDefault(),r&&mi(w,{select:!0})):m.shiftKey&&v===w&&(m.preventDefault(),r&&mi(E,{select:!0})):v===y&&m.preventDefault()}},[r,n,p.paused]);return u.jsx(Ae.div,{tabIndex:-1,...i,ref:h,onKeyDown:g})});Bp.displayName=A9;function R9(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(mi(n,{select:t}),document.activeElement!==r)return}function P9(e){const t=DN(e),r=pE(t,e),n=pE(t.reverse(),e);return[r,n]}function DN(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function pE(e,t){for(const r of e)if(!j9(r,{upTo:t}))return r}function j9(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function F9(e){return e instanceof HTMLInputElement&&"select"in e}function mi(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&F9(e)&&t&&e.select()}}var mE=O9();function O9(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=gE(e,t),e.unshift(t)},remove(t){var r;e=gE(e,t),(r=e[0])==null||r.resume()}}}function gE(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function I9(e){return e.filter(t=>t.tagName!=="A")}function D9(e){const t=M9(e),r=_.forwardRef((n,a)=>{const{children:s,...i}=n,o=_.Children.toArray(s),l=o.find(B9);if(l){const c=l.props.children,f=o.map(d=>d===l?_.Children.count(c)>1?_.Children.only(null):_.isValidElement(c)?c.props.children:null:d);return u.jsx(t,{...i,ref:a,children:_.isValidElement(c)?_.cloneElement(c,void 0,f):null})}return u.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}function M9(e){const t=_.forwardRef((r,n)=>{const{children:a,...s}=r;if(_.isValidElement(a)){const i=$9(a),o=U9(s,a.props);return a.type!==_.Fragment&&(o.ref=n?ti(n,i):i),_.cloneElement(a,o)}return _.Children.count(a)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var L9=Symbol("radix.slottable");function B9(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===L9}function U9(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function $9(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function _y(e){const t=_.useRef({value:e,previous:e});return _.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var W9=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Fl=new WeakMap,ph=new WeakMap,mh={},vg=0,MN=function(e){return e&&(e.host||MN(e.parentNode))},V9=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=MN(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},z9=function(e,t,r,n){var a=V9(t,Array.isArray(e)?e:[e]);mh[r]||(mh[r]=new WeakMap);var s=mh[r],i=[],o=new Set,l=new Set(a),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};a.forEach(c);var f=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))f(h);else try{var p=h.getAttribute(n),g=p!==null&&p!=="false",m=(Fl.get(h)||0)+1,x=(s.get(h)||0)+1;Fl.set(h,m),s.set(h,x),i.push(h),m===1&&g&&ph.set(h,!0),x===1&&h.setAttribute(r,"true"),g||h.setAttribute(n,"true")}catch(v){console.error("aria-hidden: cannot operate on ",h,v)}})};return f(t),o.clear(),vg++,function(){i.forEach(function(d){var h=Fl.get(d)-1,p=s.get(d)-1;Fl.set(d,h),s.set(d,p),h||(ph.has(d)||d.removeAttribute(n),ph.delete(d)),p||d.removeAttribute(r)}),vg--,vg||(Fl=new WeakMap,Fl=new WeakMap,ph=new WeakMap,mh={})}},Ey=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=W9(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),z9(n,a,r,"aria-hidden")):function(){return null}},Gh="right-scroll-bar-position",Kh="width-before-scroll-bar",H9="with-scroll-bars-hidden",G9="--removed-body-scroll-bar-size";function yg(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function K9(e,t){var r=_.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var q9=typeof window<"u"?_.useLayoutEffect:_.useEffect,xE=new WeakMap;function X9(e,t){var r=K9(null,function(n){return e.forEach(function(a){return yg(a,n)})});return q9(function(){var n=xE.get(r);if(n){var a=new Set(n),s=new Set(e),i=r.current;a.forEach(function(o){s.has(o)||yg(o,null)}),s.forEach(function(o){a.has(o)||yg(o,i)})}xE.set(r,e)},[e]),r}function Y9(e){return e}function Q9(e,t){t===void 0&&(t=Y9);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var i=t(s,n);return r.push(i),function(){r=r.filter(function(o){return o!==i})}},assignSyncMedium:function(s){for(n=!0;r.length;){var i=r;r=[],i.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var i=[];if(r.length){var o=r;r=[],o.forEach(s),i=r}var l=function(){var f=i;i=[],f.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(f){i.push(f),c()},filter:function(f){return i=i.filter(f),r}}}};return a}function J9(e){e===void 0&&(e={});var t=Q9(null);return t.options=hs({async:!0,ssr:!1},e),t}var LN=function(e){var t=e.sideCar,r=iu(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return _.createElement(n,hs({},r))};LN.isSideCarExport=!0;function Z9(e,t){return e.useMedium(t),LN}var BN=J9(),wg=function(){},Up=_.forwardRef(function(e,t){var r=_.useRef(null),n=_.useState({onScrollCapture:wg,onWheelCapture:wg,onTouchMoveCapture:wg}),a=n[0],s=n[1],i=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,f=e.enabled,d=e.shards,h=e.sideCar,p=e.noRelative,g=e.noIsolation,m=e.inert,x=e.allowPinchZoom,v=e.as,y=v===void 0?"div":v,w=e.gapMode,E=iu(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=h,k=X9([r,t]),S=hs(hs({},E),a);return _.createElement(_.Fragment,null,f&&_.createElement(b,{sideCar:BN,removeScrollBar:c,shards:d,noRelative:p,noIsolation:g,inert:m,setCallbacks:s,allowPinchZoom:!!x,lockRef:r,gapMode:w}),i?_.cloneElement(_.Children.only(o),hs(hs({},S),{ref:k})):_.createElement(y,hs({},S,{className:l,ref:k}),o))});Up.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Up.classNames={fullWidth:Kh,zeroRight:Gh};var eU=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function tU(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=eU();return t&&e.setAttribute("nonce",t),e}function rU(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function nU(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var aU=function(){var e=0,t=null;return{add:function(r){e==0&&(t=tU())&&(rU(t,r),nU(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},sU=function(){var e=aU();return function(t,r){_.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},UN=function(){var e=sU(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},iU={left:0,top:0,right:0,gap:0},_g=function(e){return parseInt(e||"",10)||0},oU=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[_g(r),_g(n),_g(a)]},lU=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return iU;var t=oU(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},cU=UN(),dc="data-scroll-locked",uU=function(e,t,r,n){var a=e.left,s=e.top,i=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(H9,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(dc,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Gh,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Kh,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Gh," .").concat(Gh,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Kh," .").concat(Kh,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(dc,`] {
    `).concat(G9,": ").concat(o,`px;
  }
`)},vE=function(){var e=parseInt(document.body.getAttribute(dc)||"0",10);return isFinite(e)?e:0},fU=function(){_.useEffect(function(){return document.body.setAttribute(dc,(vE()+1).toString()),function(){var e=vE()-1;e<=0?document.body.removeAttribute(dc):document.body.setAttribute(dc,e.toString())}},[])},dU=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;fU();var s=_.useMemo(function(){return lU(a)},[a]);return _.createElement(cU,{styles:uU(s,!t,a,r?"":"!important")})},xv=!1;if(typeof window<"u")try{var gh=Object.defineProperty({},"passive",{get:function(){return xv=!0,!0}});window.addEventListener("test",gh,gh),window.removeEventListener("test",gh,gh)}catch{xv=!1}var Ol=xv?{passive:!1}:!1,hU=function(e){return e.tagName==="TEXTAREA"},$N=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!hU(e)&&r[t]==="visible")},pU=function(e){return $N(e,"overflowY")},mU=function(e){return $N(e,"overflowX")},yE=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=WN(e,n);if(a){var s=VN(e,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},gU=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},xU=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},WN=function(e,t){return e==="v"?pU(t):mU(t)},VN=function(e,t){return e==="v"?gU(t):xU(t)},vU=function(e,t){return e==="h"&&t==="rtl"?-1:1},yU=function(e,t,r,n,a){var s=vU(e,window.getComputedStyle(t).direction),i=s*n,o=r.target,l=t.contains(o),c=!1,f=i>0,d=0,h=0;do{if(!o)break;var p=VN(e,o),g=p[0],m=p[1],x=p[2],v=m-x-s*g;(g||v)&&WN(e,o)&&(d+=v,h+=g);var y=o.parentNode;o=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(f&&Math.abs(d)<1||!f&&Math.abs(h)<1)&&(c=!0),c},xh=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},wE=function(e){return[e.deltaX,e.deltaY]},_E=function(e){return e&&"current"in e?e.current:e},wU=function(e,t){return e[0]===t[0]&&e[1]===t[1]},_U=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},EU=0,Il=[];function bU(e){var t=_.useRef([]),r=_.useRef([0,0]),n=_.useRef(),a=_.useState(EU++)[0],s=_.useState(UN)[0],i=_.useRef(e);_.useEffect(function(){i.current=e},[e]),_.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var m=wL([e.lockRef.current],(e.shards||[]).map(_E),!0).filter(Boolean);return m.forEach(function(x){return x.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),m.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=_.useCallback(function(m,x){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var v=xh(m),y=r.current,w="deltaX"in m?m.deltaX:y[0]-v[0],E="deltaY"in m?m.deltaY:y[1]-v[1],b,k=m.target,S=Math.abs(w)>Math.abs(E)?"h":"v";if("touches"in m&&S==="h"&&k.type==="range")return!1;var T=window.getSelection(),N=T&&T.anchorNode,O=N?N===k||N.contains(k):!1;if(O)return!1;var j=yE(S,k);if(!j)return!0;if(j?b=S:(b=S==="v"?"h":"v",j=yE(S,k)),!j)return!1;if(!n.current&&"changedTouches"in m&&(w||E)&&(n.current=b),!b)return!0;var D=n.current||b;return yU(D,x,m,D==="h"?w:E)},[]),l=_.useCallback(function(m){var x=m;if(!(!Il.length||Il[Il.length-1]!==s)){var v="deltaY"in x?wE(x):xh(x),y=t.current.filter(function(b){return b.name===x.type&&(b.target===x.target||x.target===b.shadowParent)&&wU(b.delta,v)})[0];if(y&&y.should){x.cancelable&&x.preventDefault();return}if(!y){var w=(i.current.shards||[]).map(_E).filter(Boolean).filter(function(b){return b.contains(x.target)}),E=w.length>0?o(x,w[0]):!i.current.noIsolation;E&&x.cancelable&&x.preventDefault()}}},[]),c=_.useCallback(function(m,x,v,y){var w={name:m,delta:x,target:v,should:y,shadowParent:SU(v)};t.current.push(w),setTimeout(function(){t.current=t.current.filter(function(E){return E!==w})},1)},[]),f=_.useCallback(function(m){r.current=xh(m),n.current=void 0},[]),d=_.useCallback(function(m){c(m.type,wE(m),m.target,o(m,e.lockRef.current))},[]),h=_.useCallback(function(m){c(m.type,xh(m),m.target,o(m,e.lockRef.current))},[]);_.useEffect(function(){return Il.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Ol),document.addEventListener("touchmove",l,Ol),document.addEventListener("touchstart",f,Ol),function(){Il=Il.filter(function(m){return m!==s}),document.removeEventListener("wheel",l,Ol),document.removeEventListener("touchmove",l,Ol),document.removeEventListener("touchstart",f,Ol)}},[]);var p=e.removeScrollBar,g=e.inert;return _.createElement(_.Fragment,null,g?_.createElement(s,{styles:_U(a)}):null,p?_.createElement(dU,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function SU(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const kU=Z9(BN,bU);var $p=_.forwardRef(function(e,t){return _.createElement(Up,hs({},e,{ref:t,sideCar:kU}))});$p.classNames=Up.classNames;var CU=[" ","Enter","ArrowUp","ArrowDown"],TU=[" ","Enter"],Zo="Select",[Wp,Vp,NU]=wd(Zo),[lu]=rn(Zo,[NU,ru]),zp=ru(),[AU,oo]=lu(Zo),[RU,PU]=lu(Zo),zN=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:s,value:i,defaultValue:o,onValueChange:l,dir:c,name:f,autoComplete:d,disabled:h,required:p,form:g}=e,m=zp(t),[x,v]=_.useState(null),[y,w]=_.useState(null),[E,b]=_.useState(!1),k=ou(c),[S,T]=ba({prop:n,defaultProp:a??!1,onChange:s,caller:Zo}),[N,O]=ba({prop:i,defaultProp:o,onChange:l,caller:Zo}),j=_.useRef(null),D=x?g||!!x.closest("form"):!0,[Y,Q]=_.useState(new Set),G=Array.from(Y).map(X=>X.props.value).join(";");return u.jsx(wT,{...m,children:u.jsxs(AU,{required:p,scope:t,trigger:x,onTriggerChange:v,valueNode:y,onValueNodeChange:w,valueNodeHasChildren:E,onValueNodeHasChildrenChange:b,contentId:xa(),value:N,onValueChange:O,open:S,onOpenChange:T,dir:k,triggerPointerDownPosRef:j,disabled:h,children:[u.jsx(Wp.Provider,{scope:t,children:u.jsx(RU,{scope:e.__scopeSelect,onNativeOptionAdd:_.useCallback(X=>{Q(q=>new Set(q).add(X))},[]),onNativeOptionRemove:_.useCallback(X=>{Q(q=>{const K=new Set(q);return K.delete(X),K})},[]),children:r})}),D?u.jsxs(pA,{"aria-hidden":!0,required:p,tabIndex:-1,name:f,autoComplete:d,value:N,onChange:X=>O(X.target.value),disabled:h,form:g,children:[N===void 0?u.jsx("option",{value:""}):null,Array.from(Y)]},G):null]})})};zN.displayName=Zo;var HN="SelectTrigger",GN=_.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,s=zp(r),i=oo(HN,r),o=i.disabled||n,l=Ke(t,i.onTriggerChange),c=Vp(r),f=_.useRef("touch"),[d,h,p]=gA(m=>{const x=c().filter(w=>!w.disabled),v=x.find(w=>w.value===i.value),y=xA(x,m,v);y!==void 0&&i.onValueChange(y.value)}),g=m=>{o||(i.onOpenChange(!0),p()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return u.jsx(J1,{asChild:!0,...s,children:u.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":mA(i.value)?"":void 0,...a,ref:l,onClick:ge(a.onClick,m=>{m.currentTarget.focus(),f.current!=="mouse"&&g(m)}),onPointerDown:ge(a.onPointerDown,m=>{f.current=m.pointerType;const x=m.target;x.hasPointerCapture(m.pointerId)&&x.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(g(m),m.preventDefault())}),onKeyDown:ge(a.onKeyDown,m=>{const x=d.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&h(m.key),!(x&&m.key===" ")&&CU.includes(m.key)&&(g(),m.preventDefault())})})})});GN.displayName=HN;var KN="SelectValue",qN=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:s,placeholder:i="",...o}=e,l=oo(KN,r),{onValueNodeHasChildrenChange:c}=l,f=s!==void 0,d=Ke(t,l.onValueNodeChange);return Er(()=>{c(f)},[c,f]),u.jsx(Ae.span,{...o,ref:d,style:{pointerEvents:"none"},children:mA(l.value)?u.jsx(u.Fragment,{children:i}):s})});qN.displayName=KN;var jU="SelectIcon",XN=_.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return u.jsx(Ae.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});XN.displayName=jU;var FU="SelectPortal",YN=e=>u.jsx(_d,{asChild:!0,...e});YN.displayName=FU;var el="SelectContent",QN=_.forwardRef((e,t)=>{const r=oo(el,e.__scopeSelect),[n,a]=_.useState();if(Er(()=>{a(new DocumentFragment)},[]),!r.open){const s=n;return s?gl.createPortal(u.jsx(JN,{scope:e.__scopeSelect,children:u.jsx(Wp.Slot,{scope:e.__scopeSelect,children:u.jsx("div",{children:e.children})})}),s):null}return u.jsx(ZN,{...e,ref:t})});QN.displayName=el;var Pa=10,[JN,lo]=lu(el),OU="SelectContentImpl",IU=D9("SelectContent.RemoveScroll"),ZN=_.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:s,onPointerDownOutside:i,side:o,sideOffset:l,align:c,alignOffset:f,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:m,avoidCollisions:x,...v}=e,y=oo(el,r),[w,E]=_.useState(null),[b,k]=_.useState(null),S=Ke(t,W=>E(W)),[T,N]=_.useState(null),[O,j]=_.useState(null),D=Vp(r),[Y,Q]=_.useState(!1),G=_.useRef(!1);_.useEffect(()=>{if(w)return Ey(w)},[w]),wy();const X=_.useCallback(W=>{const[se,...ie]=D().map(I=>I.ref.current),[ae]=ie.slice(-1),be=document.activeElement;for(const I of W)if(I===be||(I==null||I.scrollIntoView({block:"nearest"}),I===se&&b&&(b.scrollTop=0),I===ae&&b&&(b.scrollTop=b.scrollHeight),I==null||I.focus(),document.activeElement!==be))return},[D,b]),q=_.useCallback(()=>X([T,w]),[X,T,w]);_.useEffect(()=>{Y&&q()},[Y,q]);const{onOpenChange:K,triggerPointerDownPosRef:A}=y;_.useEffect(()=>{if(w){let W={x:0,y:0};const se=ae=>{var be,I;W={x:Math.abs(Math.round(ae.pageX)-(((be=A.current)==null?void 0:be.x)??0)),y:Math.abs(Math.round(ae.pageY)-(((I=A.current)==null?void 0:I.y)??0))}},ie=ae=>{W.x<=10&&W.y<=10?ae.preventDefault():w.contains(ae.target)||K(!1),document.removeEventListener("pointermove",se),A.current=null};return A.current!==null&&(document.addEventListener("pointermove",se),document.addEventListener("pointerup",ie,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",se),document.removeEventListener("pointerup",ie,{capture:!0})}}},[w,K,A]),_.useEffect(()=>{const W=()=>K(!1);return window.addEventListener("blur",W),window.addEventListener("resize",W),()=>{window.removeEventListener("blur",W),window.removeEventListener("resize",W)}},[K]);const[ne,ce]=gA(W=>{const se=D().filter(be=>!be.disabled),ie=se.find(be=>be.ref.current===document.activeElement),ae=xA(se,W,ie);ae&&setTimeout(()=>ae.ref.current.focus())}),R=_.useCallback((W,se,ie)=>{const ae=!G.current&&!ie;(y.value!==void 0&&y.value===se||ae)&&(N(W),ae&&(G.current=!0))},[y.value]),z=_.useCallback(()=>w==null?void 0:w.focus(),[w]),U=_.useCallback((W,se,ie)=>{const ae=!G.current&&!ie;(y.value!==void 0&&y.value===se||ae)&&j(W)},[y.value]),V=n==="popper"?vv:eA,J=V===vv?{side:o,sideOffset:l,align:c,alignOffset:f,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:m,avoidCollisions:x}:{};return u.jsx(JN,{scope:r,content:w,viewport:b,onViewportChange:k,itemRefCallback:R,selectedItem:T,onItemLeave:z,itemTextRefCallback:U,focusSelectedItem:q,selectedItemText:O,position:n,isPositioned:Y,searchRef:ne,children:u.jsx($p,{as:IU,allowPinchZoom:!0,children:u.jsx(Bp,{asChild:!0,trapped:y.open,onMountAutoFocus:W=>{W.preventDefault()},onUnmountAutoFocus:ge(a,W=>{var se;(se=y.trigger)==null||se.focus({preventScroll:!0}),W.preventDefault()}),children:u.jsx(Jc,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:W=>W.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:u.jsx(V,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:W=>W.preventDefault(),...v,...J,onPlaced:()=>Q(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:ge(v.onKeyDown,W=>{const se=W.ctrlKey||W.altKey||W.metaKey;if(W.key==="Tab"&&W.preventDefault(),!se&&W.key.length===1&&ce(W.key),["ArrowUp","ArrowDown","Home","End"].includes(W.key)){let ae=D().filter(be=>!be.disabled).map(be=>be.ref.current);if(["ArrowUp","End"].includes(W.key)&&(ae=ae.slice().reverse()),["ArrowUp","ArrowDown"].includes(W.key)){const be=W.target,I=ae.indexOf(be);ae=ae.slice(I+1)}setTimeout(()=>X(ae)),W.preventDefault()}})})})})})})});ZN.displayName=OU;var DU="SelectItemAlignedPosition",eA=_.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,s=oo(el,r),i=lo(el,r),[o,l]=_.useState(null),[c,f]=_.useState(null),d=Ke(t,S=>f(S)),h=Vp(r),p=_.useRef(!1),g=_.useRef(!0),{viewport:m,selectedItem:x,selectedItemText:v,focusSelectedItem:y}=i,w=_.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&c&&m&&x&&v){const S=s.trigger.getBoundingClientRect(),T=c.getBoundingClientRect(),N=s.valueNode.getBoundingClientRect(),O=v.getBoundingClientRect();if(s.dir!=="rtl"){const be=O.left-T.left,I=N.left-be,He=S.left-I,Ue=S.width+He,at=Math.max(Ue,T.width),Ve=window.innerWidth-Pa,ve=gv(I,[Pa,Math.max(Pa,Ve-at)]);o.style.minWidth=Ue+"px",o.style.left=ve+"px"}else{const be=T.right-O.right,I=window.innerWidth-N.right-be,He=window.innerWidth-S.right-I,Ue=S.width+He,at=Math.max(Ue,T.width),Ve=window.innerWidth-Pa,ve=gv(I,[Pa,Math.max(Pa,Ve-at)]);o.style.minWidth=Ue+"px",o.style.right=ve+"px"}const j=h(),D=window.innerHeight-Pa*2,Y=m.scrollHeight,Q=window.getComputedStyle(c),G=parseInt(Q.borderTopWidth,10),X=parseInt(Q.paddingTop,10),q=parseInt(Q.borderBottomWidth,10),K=parseInt(Q.paddingBottom,10),A=G+X+Y+K+q,ne=Math.min(x.offsetHeight*5,A),ce=window.getComputedStyle(m),R=parseInt(ce.paddingTop,10),z=parseInt(ce.paddingBottom,10),U=S.top+S.height/2-Pa,V=D-U,J=x.offsetHeight/2,W=x.offsetTop+J,se=G+X+W,ie=A-se;if(se<=U){const be=j.length>0&&x===j[j.length-1].ref.current;o.style.bottom="0px";const I=c.clientHeight-m.offsetTop-m.offsetHeight,He=Math.max(V,J+(be?z:0)+I+q),Ue=se+He;o.style.height=Ue+"px"}else{const be=j.length>0&&x===j[0].ref.current;o.style.top="0px";const He=Math.max(U,G+m.offsetTop+(be?R:0)+J)+ie;o.style.height=He+"px",m.scrollTop=se-U+m.offsetTop}o.style.margin=`${Pa}px 0`,o.style.minHeight=ne+"px",o.style.maxHeight=D+"px",n==null||n(),requestAnimationFrame(()=>p.current=!0)}},[h,s.trigger,s.valueNode,o,c,m,x,v,s.dir,n]);Er(()=>w(),[w]);const[E,b]=_.useState();Er(()=>{c&&b(window.getComputedStyle(c).zIndex)},[c]);const k=_.useCallback(S=>{S&&g.current===!0&&(w(),y==null||y(),g.current=!1)},[w,y]);return u.jsx(LU,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:u.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:E},children:u.jsx(Ae.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});eA.displayName=DU;var MU="SelectPopperPosition",vv=_.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=Pa,...s}=e,i=zp(r);return u.jsx(Z1,{...i,...s,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});vv.displayName=MU;var[LU,by]=lu(el,{}),yv="SelectViewport",tA=_.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,s=lo(yv,r),i=by(yv,r),o=Ke(t,s.onViewportChange),l=_.useRef(0);return u.jsxs(u.Fragment,{children:[u.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),u.jsx(Wp.Slot,{scope:r,children:u.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ge(a.onScroll,c=>{const f=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&d){const p=Math.abs(l.current-f.scrollTop);if(p>0){const g=window.innerHeight-Pa*2,m=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),v=Math.max(m,x);if(v<g){const y=v+p,w=Math.min(g,y),E=y-w;d.style.height=w+"px",d.style.bottom==="0px"&&(f.scrollTop=E>0?E:0,d.style.justifyContent="flex-end")}}}l.current=f.scrollTop})})})]})});tA.displayName=yv;var rA="SelectGroup",[BU,UU]=lu(rA),$U=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=xa();return u.jsx(BU,{scope:r,id:a,children:u.jsx(Ae.div,{role:"group","aria-labelledby":a,...n,ref:t})})});$U.displayName=rA;var nA="SelectLabel",aA=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=UU(nA,r);return u.jsx(Ae.div,{id:a.id,...n,ref:t})});aA.displayName=nA;var O0="SelectItem",[WU,sA]=lu(O0),iA=_.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:s,...i}=e,o=oo(O0,r),l=lo(O0,r),c=o.value===n,[f,d]=_.useState(s??""),[h,p]=_.useState(!1),g=Ke(t,y=>{var w;return(w=l.itemRefCallback)==null?void 0:w.call(l,y,n,a)}),m=xa(),x=_.useRef("touch"),v=()=>{a||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return u.jsx(WU,{scope:r,value:n,disabled:a,textId:m,isSelected:c,onItemTextChange:_.useCallback(y=>{d(w=>w||((y==null?void 0:y.textContent)??"").trim())},[]),children:u.jsx(Wp.ItemSlot,{scope:r,value:n,disabled:a,textValue:f,children:u.jsx(Ae.div,{role:"option","aria-labelledby":m,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:g,onFocus:ge(i.onFocus,()=>p(!0)),onBlur:ge(i.onBlur,()=>p(!1)),onClick:ge(i.onClick,()=>{x.current!=="mouse"&&v()}),onPointerUp:ge(i.onPointerUp,()=>{x.current==="mouse"&&v()}),onPointerDown:ge(i.onPointerDown,y=>{x.current=y.pointerType}),onPointerMove:ge(i.onPointerMove,y=>{var w;x.current=y.pointerType,a?(w=l.onItemLeave)==null||w.call(l):x.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(i.onPointerLeave,y=>{var w;y.currentTarget===document.activeElement&&((w=l.onItemLeave)==null||w.call(l))}),onKeyDown:ge(i.onKeyDown,y=>{var E;((E=l.searchRef)==null?void 0:E.current)!==""&&y.key===" "||(TU.includes(y.key)&&v(),y.key===" "&&y.preventDefault())})})})})});iA.displayName=O0;var $u="SelectItemText",oA=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...s}=e,i=oo($u,r),o=lo($u,r),l=sA($u,r),c=PU($u,r),[f,d]=_.useState(null),h=Ke(t,v=>d(v),l.onItemTextChange,v=>{var y;return(y=o.itemTextRefCallback)==null?void 0:y.call(o,v,l.value,l.disabled)}),p=f==null?void 0:f.textContent,g=_.useMemo(()=>u.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:m,onNativeOptionRemove:x}=c;return Er(()=>(m(g),()=>x(g)),[m,x,g]),u.jsxs(u.Fragment,{children:[u.jsx(Ae.span,{id:l.textId,...s,ref:h}),l.isSelected&&i.valueNode&&!i.valueNodeHasChildren?gl.createPortal(s.children,i.valueNode):null]})});oA.displayName=$u;var lA="SelectItemIndicator",cA=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return sA(lA,r).isSelected?u.jsx(Ae.span,{"aria-hidden":!0,...n,ref:t}):null});cA.displayName=lA;var wv="SelectScrollUpButton",uA=_.forwardRef((e,t)=>{const r=lo(wv,e.__scopeSelect),n=by(wv,e.__scopeSelect),[a,s]=_.useState(!1),i=Ke(t,n.onScrollButtonChange);return Er(()=>{if(r.viewport&&r.isPositioned){let o=function(){const c=l.scrollTop>0;s(c)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),a?u.jsx(dA,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});uA.displayName=wv;var _v="SelectScrollDownButton",fA=_.forwardRef((e,t)=>{const r=lo(_v,e.__scopeSelect),n=by(_v,e.__scopeSelect),[a,s]=_.useState(!1),i=Ke(t,n.onScrollButtonChange);return Er(()=>{if(r.viewport&&r.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,f=Math.ceil(l.scrollTop)<c;s(f)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),a?u.jsx(dA,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});fA.displayName=_v;var dA=_.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,s=lo("SelectScrollButton",r),i=_.useRef(null),o=Vp(r),l=_.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return _.useEffect(()=>()=>l(),[l]),Er(()=>{var f;const c=o().find(d=>d.ref.current===document.activeElement);(f=c==null?void 0:c.ref.current)==null||f.scrollIntoView({block:"nearest"})},[o]),u.jsx(Ae.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ge(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:ge(a.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:ge(a.onPointerLeave,()=>{l()})})}),VU="SelectSeparator",hA=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return u.jsx(Ae.div,{"aria-hidden":!0,...n,ref:t})});hA.displayName=VU;var Ev="SelectArrow",zU=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=zp(r),s=oo(Ev,r),i=lo(Ev,r);return s.open&&i.position==="popper"?u.jsx(ey,{...a,...n,ref:t}):null});zU.displayName=Ev;var HU="SelectBubbleInput",pA=_.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const a=_.useRef(null),s=Ke(n,a),i=_y(t);return _.useEffect(()=>{const o=a.current;if(!o)return;const l=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(l,"value").set;if(i!==t&&f){const d=new Event("change",{bubbles:!0});f.call(o,t),o.dispatchEvent(d)}},[i,t]),u.jsx(Ae.select,{...r,style:{...xC,...r.style},ref:s,defaultValue:t})});pA.displayName=HU;function mA(e){return e===""||e===void 0}function gA(e){const t=sr(e),r=_.useRef(""),n=_.useRef(0),a=_.useCallback(i=>{const o=r.current+i;t(o),function l(c){r.current=c,window.clearTimeout(n.current),c!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=_.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return _.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,s]}function xA(e,t,r){const a=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let i=GU(e,Math.max(s,0));a.length===1&&(i=i.filter(c=>c!==r));const l=i.find(c=>c.textValue.toLowerCase().startsWith(a.toLowerCase()));return l!==r?l:void 0}function GU(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var KU=zN,vA=GN,qU=qN,XU=XN,YU=YN,yA=QN,QU=tA,wA=aA,_A=iA,JU=oA,ZU=cA,EA=uA,bA=fA,SA=hA;const Ba=KU,Ua=qU,pa=_.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(vA,{ref:n,className:he("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,u.jsx(XU,{asChild:!0,children:u.jsx(Sp,{className:"h-4 w-4 opacity-50"})})]}));pa.displayName=vA.displayName;const kA=_.forwardRef(({className:e,...t},r)=>u.jsx(EA,{ref:r,className:he("flex cursor-default items-center justify-center py-1",e),...t,children:u.jsx(dD,{className:"h-4 w-4"})}));kA.displayName=EA.displayName;const CA=_.forwardRef(({className:e,...t},r)=>u.jsx(bA,{ref:r,className:he("flex cursor-default items-center justify-center py-1",e),...t,children:u.jsx(Sp,{className:"h-4 w-4"})}));CA.displayName=bA.displayName;const ma=_.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>u.jsx(YU,{children:u.jsxs(yA,{ref:a,className:he("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[u.jsx(kA,{}),u.jsx(QU,{className:he("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),u.jsx(CA,{})]})}));ma.displayName=yA.displayName;const e$=_.forwardRef(({className:e,...t},r)=>u.jsx(wA,{ref:r,className:he("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));e$.displayName=wA.displayName;const bt=_.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(_A,{ref:n,className:he("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(ZU,{children:u.jsx(jf,{className:"h-4 w-4"})})}),u.jsx(JU,{children:t})]}));bt.displayName=_A.displayName;const t$=_.forwardRef(({className:e,...t},r)=>u.jsx(SA,{ref:r,className:he("-mx-1 my-1 h-px bg-muted",e),...t}));t$.displayName=SA.displayName;function r$(){const e=xl(),{signIn:t,signUp:r,user:n,role:a,loading:s}=Dt(),[i,o]=_.useState(""),[l,c]=_.useState(""),[f,d]=_.useState(""),[h,p]=_.useState(""),[g,m]=_.useState(""),[x,v]=_.useState("cliente"),[y,w]=_.useState(!1);_.useEffect(()=>{!s&&n&&a&&(a==="gestor"?e("/dashboard",{replace:!0}):e("/cliente",{replace:!0}))},[s,n,a,e]);const E=async k=>{if(k.preventDefault(),!i||!l){Pe.error("Por favor completa todos los campos");return}w(!0);const{error:S}=await t(i,l);w(!1),S?Pe.error(S.message||"Error al iniciar sesin"):Pe.success("Sesin iniciada correctamente")},b=async k=>{if(k.preventDefault(),!f||!h||!g){Pe.error("Por favor completa todos los campos");return}if(h.length<6){Pe.error("La contrasea debe tener al menos 6 caracteres");return}w(!0);const{error:S}=await r(f,h,g,x);w(!1),S?Pe.error(S.message||"Error al registrarse"):Pe.success("Cuenta creada exitosamente. Inicia sesin.")};return s?u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:u.jsx(ws,{className:"h-8 w-8 animate-spin text-primary"})}):u.jsxs("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 p-4 text-white",children:[u.jsx("div",{className:"pointer-events-none absolute -top-32 right-0 h-80 w-80 rounded-full bg-primary/20 blur-[120px]"}),u.jsx("div",{className:"pointer-events-none absolute -bottom-24 left-0 h-80 w-80 rounded-full bg-cyan-400/20 blur-[140px]"}),u.jsx("div",{className:"relative mx-auto flex min-h-screen w-full max-w-5xl items-center justify-center",children:u.jsxs(et,{className:"w-full max-w-md border-white/10 bg-white/5 text-white shadow-2xl backdrop-blur",children:[u.jsxs(yr,{className:"text-center",children:[u.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-white/10",children:u.jsx("img",{src:"/brand-mark.svg",alt:"Catalogia",className:"h-10 w-10"})}),u.jsx(Lr,{className:"text-3xl",children:"Catalogia"}),u.jsx(pn,{className:"text-white/70",children:"Gestiona catlogos y clientes con una experiencia moderna."})]}),u.jsx(ot,{children:u.jsxs(Lp,{defaultValue:"login",className:"space-y-4",children:[u.jsxs(Nd,{className:"grid w-full grid-cols-2 bg-white/10 text-white",children:[u.jsx(mn,{value:"login",children:"Iniciar Sesin"}),u.jsx(mn,{value:"signup",children:"Registrarse"})]}),u.jsx(gn,{value:"login",children:u.jsxs("form",{onSubmit:E,className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"login-email",children:"Email"}),u.jsx(zt,{id:"login-email",type:"email",placeholder:"correo@ejemplo.com",value:i,onChange:k=>o(k.target.value),disabled:y,className:"border-white/20 bg-white/10 text-white placeholder:text-white/50"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"login-password",children:"Contrasea"}),u.jsx(zt,{id:"login-password",type:"password",placeholder:"",value:l,onChange:k=>c(k.target.value),disabled:y,className:"border-white/20 bg-white/10 text-white placeholder:text-white/50"})]}),u.jsx(ye,{type:"submit",className:"w-full",disabled:y,children:y?u.jsxs(u.Fragment,{children:[u.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}),"Iniciando sesin..."]}):"Iniciar Sesin"})]})}),u.jsx(gn,{value:"signup",children:u.jsxs("form",{onSubmit:b,className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"signup-name",children:"Nombre completo"}),u.jsx(zt,{id:"signup-name",type:"text",placeholder:"Juan Prez",value:g,onChange:k=>m(k.target.value),disabled:y,className:"border-white/20 bg-white/10 text-white placeholder:text-white/50"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"signup-email",children:"Email"}),u.jsx(zt,{id:"signup-email",type:"email",placeholder:"correo@ejemplo.com",value:f,onChange:k=>d(k.target.value),disabled:y,className:"border-white/20 bg-white/10 text-white placeholder:text-white/50"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"signup-password",children:"Contrasea"}),u.jsx(zt,{id:"signup-password",type:"password",placeholder:"",value:h,onChange:k=>p(k.target.value),disabled:y,className:"border-white/20 bg-white/10 text-white placeholder:text-white/50"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"signup-role",children:"Tipo de cuenta"}),u.jsxs(Ba,{value:x,onValueChange:k=>v(k),disabled:y,children:[u.jsx(pa,{className:"border-white/20 bg-white/10 text-white",children:u.jsx(Ua,{})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"gestor",children:"Gestor (administrador)"}),u.jsx(bt,{value:"cliente",children:"Cliente (solo lectura)"})]})]})]}),u.jsx(ye,{type:"submit",className:"w-full",disabled:y,children:y?u.jsxs(u.Fragment,{children:[u.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}),"Registrando..."]}):"Crear cuenta"})]})})]})})]})})]})}function n$(e){const t=a$(e),r=_.forwardRef((n,a)=>{const{children:s,...i}=n,o=_.Children.toArray(s),l=o.find(i$);if(l){const c=l.props.children,f=o.map(d=>d===l?_.Children.count(c)>1?_.Children.only(null):_.isValidElement(c)?c.props.children:null:d);return u.jsx(t,{...i,ref:a,children:_.isValidElement(c)?_.cloneElement(c,void 0,f):null})}return u.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}function a$(e){const t=_.forwardRef((r,n)=>{const{children:a,...s}=r;if(_.isValidElement(a)){const i=l$(a),o=o$(s,a.props);return a.type!==_.Fragment&&(o.ref=n?ti(n,i):i),_.cloneElement(a,o)}return _.Children.count(a)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var s$=Symbol("radix.slottable");function i$(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===s$}function o$(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function l$(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var bv=["Enter"," "],c$=["ArrowDown","PageUp","Home"],TA=["ArrowUp","PageDown","End"],u$=[...c$,...TA],f$={ltr:[...bv,"ArrowRight"],rtl:[...bv,"ArrowLeft"]},d$={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ad="Menu",[qf,h$,p$]=wd(Ad),[vl,NA]=rn(Ad,[p$,ru,Dp]),Hp=ru(),AA=Dp(),[m$,yl]=vl(Ad),[g$,Rd]=vl(Ad),RA=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:s,modal:i=!0}=e,o=Hp(t),[l,c]=_.useState(null),f=_.useRef(!1),d=sr(s),h=ou(a);return _.useEffect(()=>{const p=()=>{f.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>f.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),u.jsx(wT,{...o,children:u.jsx(m$,{scope:t,open:r,onOpenChange:d,content:l,onContentChange:c,children:u.jsx(g$,{scope:t,onClose:_.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:f,dir:h,modal:i,children:n})})})};RA.displayName=Ad;var x$="MenuAnchor",Sy=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=Hp(r);return u.jsx(J1,{...a,...n,ref:t})});Sy.displayName=x$;var ky="MenuPortal",[v$,PA]=vl(ky,{forceMount:void 0}),jA=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,s=yl(ky,t);return u.jsx(v$,{scope:t,forceMount:r,children:u.jsx(Vr,{present:r||s.open,children:u.jsx(_d,{asChild:!0,container:a,children:n})})})};jA.displayName=ky;var va="MenuContent",[y$,Cy]=vl(va),FA=_.forwardRef((e,t)=>{const r=PA(va,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,s=yl(va,e.__scopeMenu),i=Rd(va,e.__scopeMenu);return u.jsx(qf.Provider,{scope:e.__scopeMenu,children:u.jsx(Vr,{present:n||s.open,children:u.jsx(qf.Slot,{scope:e.__scopeMenu,children:i.modal?u.jsx(w$,{...a,ref:t}):u.jsx(_$,{...a,ref:t})})})})}),w$=_.forwardRef((e,t)=>{const r=yl(va,e.__scopeMenu),n=_.useRef(null),a=Ke(t,n);return _.useEffect(()=>{const s=n.current;if(s)return Ey(s)},[]),u.jsx(Ty,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:ge(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),_$=_.forwardRef((e,t)=>{const r=yl(va,e.__scopeMenu);return u.jsx(Ty,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),E$=n$("MenuContent.ScrollLock"),Ty=_.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:d,onInteractOutside:h,onDismiss:p,disableOutsideScroll:g,...m}=e,x=yl(va,r),v=Rd(va,r),y=Hp(r),w=AA(r),E=h$(r),[b,k]=_.useState(null),S=_.useRef(null),T=Ke(t,S,x.onContentChange),N=_.useRef(0),O=_.useRef(""),j=_.useRef(0),D=_.useRef(null),Y=_.useRef("right"),Q=_.useRef(0),G=g?$p:_.Fragment,X=g?{as:E$,allowPinchZoom:!0}:void 0,q=A=>{var W,se;const ne=O.current+A,ce=E().filter(ie=>!ie.disabled),R=document.activeElement,z=(W=ce.find(ie=>ie.ref.current===R))==null?void 0:W.textValue,U=ce.map(ie=>ie.textValue),V=O$(U,ne,z),J=(se=ce.find(ie=>ie.textValue===V))==null?void 0:se.ref.current;(function ie(ae){O.current=ae,window.clearTimeout(N.current),ae!==""&&(N.current=window.setTimeout(()=>ie(""),1e3))})(ne),J&&setTimeout(()=>J.focus())};_.useEffect(()=>()=>window.clearTimeout(N.current),[]),wy();const K=_.useCallback(A=>{var ce,R;return Y.current===((ce=D.current)==null?void 0:ce.side)&&D$(A,(R=D.current)==null?void 0:R.area)},[]);return u.jsx(y$,{scope:r,searchRef:O,onItemEnter:_.useCallback(A=>{K(A)&&A.preventDefault()},[K]),onItemLeave:_.useCallback(A=>{var ne;K(A)||((ne=S.current)==null||ne.focus(),k(null))},[K]),onTriggerLeave:_.useCallback(A=>{K(A)&&A.preventDefault()},[K]),pointerGraceTimerRef:j,onPointerGraceIntentChange:_.useCallback(A=>{D.current=A},[]),children:u.jsx(G,{...X,children:u.jsx(Bp,{asChild:!0,trapped:a,onMountAutoFocus:ge(s,A=>{var ne;A.preventDefault(),(ne=S.current)==null||ne.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:u.jsx(Jc,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:f,onFocusOutside:d,onInteractOutside:h,onDismiss:p,children:u.jsx(_N,{asChild:!0,...w,dir:v.dir,orientation:"vertical",loop:n,currentTabStopId:b,onCurrentTabStopIdChange:k,onEntryFocus:ge(l,A=>{v.isUsingKeyboardRef.current||A.preventDefault()}),preventScrollOnEntryFocus:!0,children:u.jsx(Z1,{role:"menu","aria-orientation":"vertical","data-state":XA(x.open),"data-radix-menu-content":"",dir:v.dir,...y,...m,ref:T,style:{outline:"none",...m.style},onKeyDown:ge(m.onKeyDown,A=>{const ce=A.target.closest("[data-radix-menu-content]")===A.currentTarget,R=A.ctrlKey||A.altKey||A.metaKey,z=A.key.length===1;ce&&(A.key==="Tab"&&A.preventDefault(),!R&&z&&q(A.key));const U=S.current;if(A.target!==U||!u$.includes(A.key))return;A.preventDefault();const J=E().filter(W=>!W.disabled).map(W=>W.ref.current);TA.includes(A.key)&&J.reverse(),j$(J)}),onBlur:ge(e.onBlur,A=>{A.currentTarget.contains(A.target)||(window.clearTimeout(N.current),O.current="")}),onPointerMove:ge(e.onPointerMove,Xf(A=>{const ne=A.target,ce=Q.current!==A.clientX;if(A.currentTarget.contains(ne)&&ce){const R=A.clientX>Q.current?"right":"left";Y.current=R,Q.current=A.clientX}}))})})})})})})});FA.displayName=va;var b$="MenuGroup",Ny=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return u.jsx(Ae.div,{role:"group",...n,ref:t})});Ny.displayName=b$;var S$="MenuLabel",OA=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return u.jsx(Ae.div,{...n,ref:t})});OA.displayName=S$;var I0="MenuItem",EE="menu.itemSelect",Gp=_.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,s=_.useRef(null),i=Rd(I0,e.__scopeMenu),o=Cy(I0,e.__scopeMenu),l=Ke(t,s),c=_.useRef(!1),f=()=>{const d=s.current;if(!r&&d){const h=new CustomEvent(EE,{bubbles:!0,cancelable:!0});d.addEventListener(EE,p=>n==null?void 0:n(p),{once:!0}),I1(d,h),h.defaultPrevented?c.current=!1:i.onClose()}};return u.jsx(IA,{...a,ref:l,disabled:r,onClick:ge(e.onClick,f),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:ge(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:ge(e.onKeyDown,d=>{const h=o.searchRef.current!=="";r||h&&d.key===" "||bv.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});Gp.displayName=I0;var IA=_.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...s}=e,i=Cy(I0,r),o=AA(r),l=_.useRef(null),c=Ke(t,l),[f,d]=_.useState(!1),[h,p]=_.useState("");return _.useEffect(()=>{const g=l.current;g&&p((g.textContent??"").trim())},[s.children]),u.jsx(qf.ItemSlot,{scope:r,disabled:n,textValue:a??h,children:u.jsx(EN,{asChild:!0,...o,focusable:!n,children:u.jsx(Ae.div,{role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...s,ref:c,onPointerMove:ge(e.onPointerMove,Xf(g=>{n?i.onItemLeave(g):(i.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ge(e.onPointerLeave,Xf(g=>i.onItemLeave(g))),onFocus:ge(e.onFocus,()=>d(!0)),onBlur:ge(e.onBlur,()=>d(!1))})})})}),k$="MenuCheckboxItem",DA=_.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return u.jsx($A,{scope:e.__scopeMenu,checked:r,children:u.jsx(Gp,{role:"menuitemcheckbox","aria-checked":D0(r)?"mixed":r,...a,ref:t,"data-state":Ry(r),onSelect:ge(a.onSelect,()=>n==null?void 0:n(D0(r)?!0:!r),{checkForDefaultPrevented:!1})})})});DA.displayName=k$;var MA="MenuRadioGroup",[C$,T$]=vl(MA,{value:void 0,onValueChange:()=>{}}),LA=_.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,s=sr(n);return u.jsx(C$,{scope:e.__scopeMenu,value:r,onValueChange:s,children:u.jsx(Ny,{...a,ref:t})})});LA.displayName=MA;var BA="MenuRadioItem",UA=_.forwardRef((e,t)=>{const{value:r,...n}=e,a=T$(BA,e.__scopeMenu),s=r===a.value;return u.jsx($A,{scope:e.__scopeMenu,checked:s,children:u.jsx(Gp,{role:"menuitemradio","aria-checked":s,...n,ref:t,"data-state":Ry(s),onSelect:ge(n.onSelect,()=>{var i;return(i=a.onValueChange)==null?void 0:i.call(a,r)},{checkForDefaultPrevented:!1})})})});UA.displayName=BA;var Ay="MenuItemIndicator",[$A,N$]=vl(Ay,{checked:!1}),WA=_.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,s=N$(Ay,r);return u.jsx(Vr,{present:n||D0(s.checked)||s.checked===!0,children:u.jsx(Ae.span,{...a,ref:t,"data-state":Ry(s.checked)})})});WA.displayName=Ay;var A$="MenuSeparator",VA=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return u.jsx(Ae.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});VA.displayName=A$;var R$="MenuArrow",zA=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=Hp(r);return u.jsx(ey,{...a,...n,ref:t})});zA.displayName=R$;var P$="MenuSub",[yae,HA]=vl(P$),Wu="MenuSubTrigger",GA=_.forwardRef((e,t)=>{const r=yl(Wu,e.__scopeMenu),n=Rd(Wu,e.__scopeMenu),a=HA(Wu,e.__scopeMenu),s=Cy(Wu,e.__scopeMenu),i=_.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},f=_.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return _.useEffect(()=>f,[f]),_.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),u.jsx(Sy,{asChild:!0,...c,children:u.jsx(IA,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":XA(r.open),...e,ref:ti(t,a.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:ge(e.onPointerMove,Xf(d=>{s.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!r.open&&!i.current&&(s.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),f()},100))})),onPointerLeave:ge(e.onPointerLeave,Xf(d=>{var p,g;f();const h=(p=r.content)==null?void 0:p.getBoundingClientRect();if(h){const m=(g=r.content)==null?void 0:g.dataset.side,x=m==="right",v=x?-5:5,y=h[x?"left":"right"],w=h[x?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+v,y:d.clientY},{x:y,y:h.top},{x:w,y:h.top},{x:w,y:h.bottom},{x:y,y:h.bottom}],side:m}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:ge(e.onKeyDown,d=>{var p;const h=s.searchRef.current!=="";e.disabled||h&&d.key===" "||f$[n.dir].includes(d.key)&&(r.onOpenChange(!0),(p=r.content)==null||p.focus(),d.preventDefault())})})})});GA.displayName=Wu;var KA="MenuSubContent",qA=_.forwardRef((e,t)=>{const r=PA(va,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,s=yl(va,e.__scopeMenu),i=Rd(va,e.__scopeMenu),o=HA(KA,e.__scopeMenu),l=_.useRef(null),c=Ke(t,l);return u.jsx(qf.Provider,{scope:e.__scopeMenu,children:u.jsx(Vr,{present:n||s.open,children:u.jsx(qf.Slot,{scope:e.__scopeMenu,children:u.jsx(Ty,{id:o.contentId,"aria-labelledby":o.triggerId,...a,ref:c,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var d;i.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:ge(e.onFocusOutside,f=>{f.target!==o.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:ge(e.onEscapeKeyDown,f=>{i.onClose(),f.preventDefault()}),onKeyDown:ge(e.onKeyDown,f=>{var p;const d=f.currentTarget.contains(f.target),h=d$[i.dir].includes(f.key);d&&h&&(s.onOpenChange(!1),(p=o.trigger)==null||p.focus(),f.preventDefault())})})})})})});qA.displayName=KA;function XA(e){return e?"open":"closed"}function D0(e){return e==="indeterminate"}function Ry(e){return D0(e)?"indeterminate":e?"checked":"unchecked"}function j$(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function F$(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function O$(e,t,r){const a=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let i=F$(e,Math.max(s,0));a.length===1&&(i=i.filter(c=>c!==r));const l=i.find(c=>c.toLowerCase().startsWith(a.toLowerCase()));return l!==r?l:void 0}function I$(e,t){const{x:r,y:n}=e;let a=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const o=t[s],l=t[i],c=o.x,f=o.y,d=l.x,h=l.y;f>n!=h>n&&r<(d-c)*(n-f)/(h-f)+c&&(a=!a)}return a}function D$(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return I$(r,t)}function Xf(e){return t=>t.pointerType==="mouse"?e(t):void 0}var M$=RA,L$=Sy,B$=jA,U$=FA,$$=Ny,W$=OA,V$=Gp,z$=DA,H$=LA,G$=UA,K$=WA,q$=VA,X$=zA,Y$=GA,Q$=qA,Kp="DropdownMenu",[J$]=rn(Kp,[NA]),_n=NA(),[Z$,YA]=J$(Kp),QA=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:s,onOpenChange:i,modal:o=!0}=e,l=_n(t),c=_.useRef(null),[f,d]=ba({prop:a,defaultProp:s??!1,onChange:i,caller:Kp});return u.jsx(Z$,{scope:t,triggerId:xa(),triggerRef:c,contentId:xa(),open:f,onOpenChange:d,onOpenToggle:_.useCallback(()=>d(h=>!h),[d]),modal:o,children:u.jsx(M$,{...l,open:f,onOpenChange:d,dir:n,modal:o,children:r})})};QA.displayName=Kp;var JA="DropdownMenuTrigger",ZA=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,s=YA(JA,r),i=_n(r);return u.jsx(L$,{asChild:!0,...i,children:u.jsx(Ae.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:ti(t,s.triggerRef),onPointerDown:ge(e.onPointerDown,o=>{!n&&o.button===0&&o.ctrlKey===!1&&(s.onOpenToggle(),s.open||o.preventDefault())}),onKeyDown:ge(e.onKeyDown,o=>{n||(["Enter"," "].includes(o.key)&&s.onOpenToggle(),o.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});ZA.displayName=JA;var eW="DropdownMenuPortal",e4=e=>{const{__scopeDropdownMenu:t,...r}=e,n=_n(t);return u.jsx(B$,{...n,...r})};e4.displayName=eW;var t4="DropdownMenuContent",r4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=YA(t4,r),s=_n(r),i=_.useRef(!1);return u.jsx(U$,{id:a.contentId,"aria-labelledby":a.triggerId,...s,...n,ref:t,onCloseAutoFocus:ge(e.onCloseAutoFocus,o=>{var l;i.current||(l=a.triggerRef.current)==null||l.focus(),i.current=!1,o.preventDefault()}),onInteractOutside:ge(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,f=l.button===2||c;(!a.modal||f)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});r4.displayName=t4;var tW="DropdownMenuGroup",rW=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx($$,{...a,...n,ref:t})});rW.displayName=tW;var nW="DropdownMenuLabel",n4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(W$,{...a,...n,ref:t})});n4.displayName=nW;var aW="DropdownMenuItem",a4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(V$,{...a,...n,ref:t})});a4.displayName=aW;var sW="DropdownMenuCheckboxItem",s4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(z$,{...a,...n,ref:t})});s4.displayName=sW;var iW="DropdownMenuRadioGroup",oW=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(H$,{...a,...n,ref:t})});oW.displayName=iW;var lW="DropdownMenuRadioItem",i4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(G$,{...a,...n,ref:t})});i4.displayName=lW;var cW="DropdownMenuItemIndicator",o4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(K$,{...a,...n,ref:t})});o4.displayName=cW;var uW="DropdownMenuSeparator",l4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(q$,{...a,...n,ref:t})});l4.displayName=uW;var fW="DropdownMenuArrow",dW=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(X$,{...a,...n,ref:t})});dW.displayName=fW;var hW="DropdownMenuSubTrigger",c4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(Y$,{...a,...n,ref:t})});c4.displayName=hW;var pW="DropdownMenuSubContent",u4=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=_n(r);return u.jsx(Q$,{...a,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});u4.displayName=pW;var mW=QA,gW=ZA,xW=e4,f4=r4,d4=n4,h4=a4,p4=s4,m4=i4,g4=o4,x4=l4,v4=c4,y4=u4;const $c=mW,Wc=gW,vW=_.forwardRef(({className:e,inset:t,children:r,...n},a)=>u.jsxs(v4,{ref:a,className:he("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",e),...n,children:[r,u.jsx(UC,{className:"ml-auto h-4 w-4"})]}));vW.displayName=v4.displayName;const yW=_.forwardRef(({className:e,...t},r)=>u.jsx(y4,{ref:r,className:he("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));yW.displayName=y4.displayName;const tl=_.forwardRef(({className:e,sideOffset:t=4,...r},n)=>u.jsx(xW,{children:u.jsx(f4,{ref:n,sideOffset:t,className:he("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));tl.displayName=f4.displayName;const Tr=_.forwardRef(({className:e,inset:t,...r},n)=>u.jsx(h4,{ref:n,className:he("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",e),...r}));Tr.displayName=h4.displayName;const wW=_.forwardRef(({className:e,children:t,checked:r,...n},a)=>u.jsxs(p4,{ref:a,className:he("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:r,...n,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(g4,{children:u.jsx(jf,{className:"h-4 w-4"})})}),t]}));wW.displayName=p4.displayName;const _W=_.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(m4,{ref:n,className:he("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[u.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:u.jsx(g4,{children:u.jsx(hD,{className:"h-2 w-2 fill-current"})})}),t]}));_W.displayName=m4.displayName;const EW=_.forwardRef(({className:e,inset:t,...r},n)=>u.jsx(d4,{ref:n,className:he("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));EW.displayName=d4.displayName;const Vc=_.forwardRef(({className:e,...t},r)=>u.jsx(x4,{ref:r,className:he("-mx-1 my-1 h-px bg-muted",e),...t}));Vc.displayName=x4.displayName;const bW=[{icon:WC,label:"Dashboard",href:"/dashboard"},{icon:Ha,label:"Catlogos",href:"/catalogos"},{icon:Df,label:"Clientes",href:"/clientes"},{icon:U1,label:"Configuracin",href:"/configuracion"}],SW=[{icon:WC,label:"Mis Catlogos",href:"/cliente"},{icon:U1,label:"Perfil",href:"/configuracion"}];function ya({children:e}){var h,p;const[t,r]=_.useState(!1),n=ni(),a=xl(),{user:s,role:i,signOut:o,isGestor:l}=Dt(),c=l?bW:SW,f=((h=s==null?void 0:s.user_metadata)==null?void 0:h.full_name)||((p=s==null?void 0:s.email)==null?void 0:p.split("@")[0])||"Usuario",d=async()=>{await o(),a("/")};return u.jsxs("div",{className:"min-h-screen bg-background",children:[t&&u.jsx("div",{className:"fixed inset-0 z-40 bg-foreground/20 backdrop-blur-sm lg:hidden",onClick:()=>r(!1)}),u.jsx("aside",{className:he("fixed top-0 left-0 z-50 h-full w-64 bg-sidebar text-sidebar-foreground transition-transform duration-300 lg:translate-x-0",t?"translate-x-0":"-translate-x-full"),children:u.jsxs("div",{className:"flex h-full flex-col",children:[u.jsxs("div",{className:"flex h-16 items-center justify-between px-6 border-b border-sidebar-border",children:[u.jsxs(xr,{to:l?"/dashboard":"/cliente",className:"flex items-center gap-2",children:[u.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-xl bg-sidebar-primary/10",children:u.jsx("img",{src:"/brand-mark.svg",alt:"Catalogia",className:"h-6 w-6"})}),u.jsxs("div",{className:"leading-tight",children:[u.jsx("span",{className:"text-lg font-semibold",children:"Catalogia"}),u.jsx("span",{className:"block text-[11px] text-sidebar-foreground/60",children:"Catlogos conectados"})]})]}),u.jsx(ye,{variant:"ghost",size:"icon",className:"lg:hidden text-sidebar-foreground hover:bg-sidebar-accent",onClick:()=>r(!1),children:u.jsx(Sd,{className:"h-5 w-5"})})]}),u.jsx("nav",{className:"flex-1 p-4 space-y-1",children:c.map(g=>{const m=n.pathname===g.href||g.href!=="/dashboard"&&g.href!=="/cliente"&&n.pathname.startsWith(g.href);return u.jsxs(xr,{to:g.href,className:he("flex items-center gap-3 px-4 py-2.5 rounded-lg text-sm font-medium transition-colors",m?"bg-sidebar-primary text-sidebar-primary-foreground":"text-sidebar-foreground/80 hover:bg-sidebar-accent hover:text-sidebar-foreground"),children:[u.jsx(g.icon,{className:"h-5 w-5"}),g.label]},g.href)})}),u.jsx("div",{className:"p-4 border-t border-sidebar-border",children:u.jsxs("div",{className:"flex items-center gap-3 px-2",children:[u.jsx("div",{className:"h-9 w-9 rounded-full bg-sidebar-primary flex items-center justify-center text-sidebar-primary-foreground font-medium",children:f.charAt(0).toUpperCase()}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium truncate",children:f}),u.jsx("p",{className:"text-xs text-sidebar-foreground/60 capitalize",children:i||"usuario"})]})]})})]})}),u.jsxs("div",{className:"lg:pl-64",children:[u.jsxs("header",{className:"sticky top-0 z-30 flex h-16 items-center gap-4 border-b bg-card px-4 lg:px-6",children:[u.jsx(ye,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>r(!0),children:u.jsx(bD,{className:"h-5 w-5"})}),u.jsx("div",{className:"flex-1"}),u.jsxs($c,{children:[u.jsx(Wc,{asChild:!0,children:u.jsxs(ye,{variant:"ghost",className:"flex items-center gap-2",children:[u.jsx("div",{className:"h-8 w-8 rounded-full bg-primary flex items-center justify-center text-primary-foreground text-sm font-medium",children:f.charAt(0).toUpperCase()}),u.jsx("span",{className:"hidden sm:inline-block text-sm font-medium",children:f}),u.jsx(Sp,{className:"h-4 w-4 text-muted-foreground"})]})}),u.jsxs(tl,{align:"end",className:"w-48",children:[l&&u.jsxs(Tr,{onClick:()=>a("/configuracion"),children:[u.jsx(U1,{className:"h-4 w-4 mr-2"}),"Configuracin"]}),u.jsx(Vc,{}),u.jsxs(Tr,{onClick:d,className:"text-destructive",children:[u.jsx(ED,{className:"h-4 w-4 mr-2"}),"Cerrar sesin"]})]})]})]}),u.jsx("main",{className:"p-4 lg:p-6",children:e})]})]})}const kW={draft:{label:"Borrador",className:"bg-warning/10 text-warning border-warning/20"},published:{label:"Publicado",className:"bg-success/10 text-success border-success/20"},archived:{label:"Archivado",className:"bg-muted text-muted-foreground border-muted-foreground/20"}};function M0({status:e,className:t}){const r=kW[e];return u.jsx("span",{className:he("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border",r.className,t),children:r.label})}function CW(){const{user:e}=Dt();return Zn({queryKey:["dashboard-stats",e==null?void 0:e.id],queryFn:async()=>{const{count:t}=await Ce.from("catalogs").select("*",{count:"exact",head:!0}).neq("status","archived").is("deleted_at",null),{count:r}=await Ce.from("catalog_items").select("*",{count:"exact",head:!0}).eq("is_active",!0).is("deleted_at",null),{count:n}=await Ce.from("clients").select("*",{count:"exact",head:!0}).eq("status","active").is("deleted_at",null),{count:a}=await Ce.from("catalog_versions").select("*",{count:"exact",head:!0}).eq("status","published");return{activeCatalogs:t||0,totalItems:r||0,totalClients:n||0,publishedVersions:a||0}},enabled:!!e})}function TW(e=5){const{user:t}=Dt();return Zn({queryKey:["recent-catalogs",t==null?void 0:t.id,e],queryFn:async()=>{const{data:r,error:n}=await Ce.from("catalogs").select("*").is("deleted_at",null).order("updated_at",{ascending:!1}).limit(e);if(n)throw n;return await Promise.all((r||[]).map(async s=>{const{data:i}=await Ce.from("catalog_versions").select("id").eq("catalog_id",s.id).in("status",["published","draft"]).order("version_number",{ascending:!1}).limit(1).maybeSingle();let o=0;if(i){const{count:c}=await Ce.from("catalog_items").select("*",{count:"exact",head:!0}).eq("version_id",i.id).is("deleted_at",null);o=c||0}const{count:l}=await Ce.from("catalog_clients").select("*",{count:"exact",head:!0}).eq("catalog_id",s.id);return{id:s.id,name:s.name,status:s.status,item_count:o,client_count:l||0,updated_at:s.updated_at}}))},enabled:!!t})}function Ur(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function NW(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const vh=43200,bE=1440;let AW={};function RW(){return AW}function SE(e){const t=Ur(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function qh(e,t){const r=Ur(e),n=Ur(t),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function PW(e){return NW(e,Date.now())}function jW(e,t){const r=Ur(e),n=Ur(t),a=r.getFullYear()-n.getFullYear(),s=r.getMonth()-n.getMonth();return a*12+s}function FW(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function OW(e,t){return+Ur(e)-+Ur(t)}function IW(e){const t=Ur(e);return t.setHours(23,59,59,999),t}function DW(e){const t=Ur(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function MW(e){const t=Ur(e);return+IW(t)==+DW(t)}function LW(e,t){const r=Ur(e),n=Ur(t),a=qh(r,n),s=Math.abs(jW(r,n));let i;if(s<1)i=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*s);let o=qh(r,n)===-a;MW(Ur(e))&&s===1&&qh(e,n)===1&&(o=!1),i=a*(s-Number(o))}return i===0?0:i}function BW(e,t,r){const n=OW(e,t)/1e3;return FW(r==null?void 0:r.roundingMethod)(n)}const UW={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},$W=(e,t,r)=>{let n;const a=UW[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function hc(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const WW={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},VW={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},zW={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},HW={date:hc({formats:WW,defaultWidth:"full"}),time:hc({formats:VW,defaultWidth:"full"}),dateTime:hc({formats:zW,defaultWidth:"full"})},GW={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},KW=(e,t,r,n)=>GW[e];function ps(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;a=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[i]}const s=e.argumentCallback?e.argumentCallback(t):t;return a[s]}}const qW={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},XW={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},YW={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},QW={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},JW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},ZW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},eV=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},tV={ordinalNumber:eV,era:ps({values:qW,defaultWidth:"wide"}),quarter:ps({values:XW,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ps({values:YW,defaultWidth:"wide"}),day:ps({values:QW,defaultWidth:"wide"}),dayPeriod:ps({values:JW,defaultWidth:"wide",formattingValues:ZW,defaultFormattingWidth:"wide"})};function ms(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const i=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?nV(o,d=>d.test(i)):rV(o,d=>d.test(i));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const f=t.slice(i.length);return{value:c,rest:f}}}function rV(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function nV(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function w4(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],s=t.match(e.parsePattern);if(!s)return null;let i=e.valueCallback?e.valueCallback(s[0]):s[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(a.length);return{value:i,rest:o}}}const aV=/^(\d+)(th|st|nd|rd)?/i,sV=/\d+/i,iV={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},oV={any:[/^b/i,/^(a|c)/i]},lV={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cV={any:[/1/i,/2/i,/3/i,/4/i]},uV={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},fV={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},dV={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},hV={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},pV={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},mV={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},gV={ordinalNumber:w4({matchPattern:aV,parsePattern:sV,valueCallback:e=>parseInt(e,10)}),era:ms({matchPatterns:iV,defaultMatchWidth:"wide",parsePatterns:oV,defaultParseWidth:"any"}),quarter:ms({matchPatterns:lV,defaultMatchWidth:"wide",parsePatterns:cV,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ms({matchPatterns:uV,defaultMatchWidth:"wide",parsePatterns:fV,defaultParseWidth:"any"}),day:ms({matchPatterns:dV,defaultMatchWidth:"wide",parsePatterns:hV,defaultParseWidth:"any"}),dayPeriod:ms({matchPatterns:pV,defaultMatchWidth:"any",parsePatterns:mV,defaultParseWidth:"any"})},xV={code:"en-US",formatDistance:$W,formatLong:HW,formatRelative:KW,localize:tV,match:gV,options:{weekStartsOn:0,firstWeekContainsDate:1}};function vV(e,t,r){const n=RW(),a=(r==null?void 0:r.locale)??n.locale??xV,s=2520,i=qh(e,t);if(isNaN(i))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:i});let l,c;i>0?(l=Ur(t),c=Ur(e)):(l=Ur(e),c=Ur(t));const f=BW(c,l),d=(SE(c)-SE(l))/1e3,h=Math.round((f-d)/60);let p;if(h<2)return r!=null&&r.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,o):f<10?a.formatDistance("lessThanXSeconds",10,o):f<20?a.formatDistance("lessThanXSeconds",20,o):f<40?a.formatDistance("halfAMinute",0,o):f<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):h===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",h,o);if(h<45)return a.formatDistance("xMinutes",h,o);if(h<90)return a.formatDistance("aboutXHours",1,o);if(h<bE){const g=Math.round(h/60);return a.formatDistance("aboutXHours",g,o)}else{if(h<s)return a.formatDistance("xDays",1,o);if(h<vh){const g=Math.round(h/bE);return a.formatDistance("xDays",g,o)}else if(h<vh*2)return p=Math.round(h/vh),a.formatDistance("aboutXMonths",p,o)}if(p=LW(c,l),p<12){const g=Math.round(h/vh);return a.formatDistance("xMonths",g,o)}else{const g=p%12,m=Math.trunc(p/12);return g<3?a.formatDistance("aboutXYears",m,o):g<9?a.formatDistance("overXYears",m,o):a.formatDistance("almostXYears",m+1,o)}}function L0(e,t){return vV(e,PW(e),t)}const yV={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},wV=(e,t,r)=>{let n;const a=yV[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"en "+n:"hace "+n:n},_V={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},EV={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},bV={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},SV={date:hc({formats:_V,defaultWidth:"full"}),time:hc({formats:EV,defaultWidth:"full"}),dateTime:hc({formats:bV,defaultWidth:"full"})},kV={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},CV={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},TV=(e,t,r,n)=>t.getHours()!==1?CV[e]:kV[e],NV={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},AV={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},RV={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},PV={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},jV={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},FV={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},OV=(e,t)=>Number(e)+"",IV={ordinalNumber:OV,era:ps({values:NV,defaultWidth:"wide"}),quarter:ps({values:AV,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:ps({values:RV,defaultWidth:"wide"}),day:ps({values:PV,defaultWidth:"wide"}),dayPeriod:ps({values:jV,defaultWidth:"wide",formattingValues:FV,defaultFormattingWidth:"wide"})},DV=/^(\d+)()?/i,MV=/\d+/i,LV={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},BV={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},UV={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},$V={any:[/1/i,/2/i,/3/i,/4/i]},WV={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},VV={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},zV={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},HV={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},GV={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},KV={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},qV={ordinalNumber:w4({matchPattern:DV,parsePattern:MV,valueCallback:function(e){return parseInt(e,10)}}),era:ms({matchPatterns:LV,defaultMatchWidth:"wide",parsePatterns:BV,defaultParseWidth:"any"}),quarter:ms({matchPatterns:UV,defaultMatchWidth:"wide",parsePatterns:$V,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ms({matchPatterns:WV,defaultMatchWidth:"wide",parsePatterns:VV,defaultParseWidth:"any"}),day:ms({matchPatterns:zV,defaultMatchWidth:"wide",parsePatterns:HV,defaultParseWidth:"any"}),dayPeriod:ms({matchPatterns:GV,defaultMatchWidth:"any",parsePatterns:KV,defaultParseWidth:"any"})},B0={code:"es",formatDistance:wV,formatLong:SV,formatRelative:TV,localize:IV,match:qV,options:{weekStartsOn:1,firstWeekContainsDate:1}};function XV(){const{data:e,isLoading:t}=CW(),{data:r,isLoading:n}=TW(5),a=[{label:"Catlogos Activos",value:(e==null?void 0:e.activeCatalogs)||0,icon:Ha},{label:"Items Totales",value:(e==null?void 0:e.totalItems)||0,icon:E0},{label:"Clientes Activos",value:(e==null?void 0:e.totalClients)||0,icon:Df},{label:"Versiones Publicadas",value:(e==null?void 0:e.publishedVersions)||0,icon:CD}];return u.jsx(ya,{children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Dashboard"}),u.jsx("p",{className:"text-muted-foreground",children:"Gestiona tus catlogos de precios"})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(ye,{variant:"outline",asChild:!0,children:u.jsxs(xr,{to:"/catalogos/importar",children:[u.jsx(If,{className:"h-4 w-4 mr-2"}),"Importar Excel"]})}),u.jsx(ye,{asChild:!0,children:u.jsxs(xr,{to:"/catalogos?nuevo=true",children:[u.jsx(Lc,{className:"h-4 w-4 mr-2"}),"Nuevo Catlogo"]})})]})]}),u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:a.map(s=>u.jsxs(et,{children:[u.jsxs(yr,{className:"flex flex-row items-center justify-between pb-2",children:[u.jsx(Lr,{className:"text-sm font-medium text-muted-foreground",children:s.label}),u.jsx(s.icon,{className:"h-4 w-4 text-muted-foreground"})]}),u.jsx(ot,{children:t?u.jsx(mt,{className:"h-8 w-16"}):u.jsx("div",{className:"text-2xl font-bold",children:s.value.toLocaleString()})})]},s.label))}),u.jsxs(et,{children:[u.jsxs(yr,{className:"flex flex-row items-center justify-between",children:[u.jsxs("div",{children:[u.jsx(Lr,{children:"Catlogos Recientes"}),u.jsx(pn,{children:"ltimas actualizaciones de tus catlogos"})]}),u.jsx(ye,{variant:"ghost",size:"sm",asChild:!0,children:u.jsxs(xr,{to:"/catalogos",children:["Ver todos",u.jsx(Hi,{className:"h-4 w-4 ml-1"})]})})]}),u.jsx(ot,{children:n?u.jsx("div",{className:"space-y-4",children:[1,2,3].map(s=>u.jsx(mt,{className:"h-20 w-full"},s))}):r&&r.length>0?u.jsx("div",{className:"space-y-4",children:r.map(s=>u.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-card hover:bg-accent/50 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:u.jsx(Ha,{className:"h-5 w-5 text-primary"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-medium",children:s.name}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.item_count," items  ",s.client_count," clientes  ",L0(new Date(s.updated_at),{addSuffix:!0,locale:B0})]})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(M0,{status:s.status}),u.jsx(ye,{variant:"ghost",size:"sm",asChild:!0,children:u.jsx(xr,{to:`/catalogos/${s.id}`,children:u.jsx(Hi,{className:"h-4 w-4"})})})]})]},s.id))}):u.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[u.jsx(Ha,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),u.jsx("p",{children:"No hay catlogos an"}),u.jsx(ye,{variant:"outline",className:"mt-4",asChild:!0,children:u.jsx(xr,{to:"/catalogos?nuevo=true",children:"Crear primer catlogo"})})]})})]}),u.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[u.jsx(et,{className:"border-dashed border-2 hover:border-primary/50 hover:bg-accent/30 transition-colors cursor-pointer",children:u.jsx(xr,{to:"/catalogos/importar",className:"block p-6",children:u.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[u.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:u.jsx(If,{className:"h-6 w-6 text-primary"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold",children:"Importar Excel"}),u.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Sube un archivo .xlsx para crear un nuevo catlogo"})]})]})})}),u.jsx(et,{className:"border-dashed border-2 hover:border-primary/50 hover:bg-accent/30 transition-colors cursor-pointer",children:u.jsx(xr,{to:"/clientes",className:"block p-6",children:u.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[u.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:u.jsx(Df,{className:"h-6 w-6 text-primary"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold",children:"Gestionar Clientes"}),u.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Administra accesos y asignaciones de catlogos"})]})]})})}),u.jsx(et,{className:"border-dashed border-2 hover:border-primary/50 hover:bg-accent/30 transition-colors cursor-pointer",children:u.jsx(xr,{to:"/catalogos",className:"block p-6",children:u.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[u.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:u.jsx(E0,{className:"h-6 w-6 text-primary"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold",children:"Ver Catlogos"}),u.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Administra y edita tus catlogos de precios"})]})]})})})]})]})})}const YV=bp("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ct({className:e,variant:t,...r}){return u.jsx("div",{className:he(YV({variant:t}),e),...r})}function QV(){const{user:e}=Dt();return Zn({queryKey:["client-catalogs",e==null?void 0:e.id],queryFn:async()=>{if(!e)return[];const{data:t,error:r}=await Ce.from("clients").select("id").eq("user_id",e.id).maybeSingle();if(r)throw r;if(!t)return[];const{data:n,error:a}=await Ce.from("catalog_clients").select("catalog_id").eq("client_id",t.id);if(a)throw a;if(!n||n.length===0)return[];const s=n.map(c=>c.catalog_id),{data:i,error:o}=await Ce.from("catalogs").select("*").in("id",s).eq("status","published").is("deleted_at",null);if(o)throw o;return await Promise.all((i||[]).map(async c=>{const{data:f}=await Ce.from("catalog_versions").select("id").eq("catalog_id",c.id).eq("status","published").maybeSingle();let d=0;if(f){const{count:h}=await Ce.from("catalog_items").select("*",{count:"exact",head:!0}).eq("version_id",f.id).eq("is_active",!0).is("deleted_at",null);d=h||0}return{id:c.id,name:c.name,description:c.description,status:c.status,updated_at:c.updated_at,item_count:d}}))},enabled:!!e})}function JV(e){const{user:t}=Dt();return Zn({queryKey:["client-catalog-items",e,t==null?void 0:t.id],queryFn:async()=>{if(!e||!t)return[];const{data:r,error:n}=await Ce.from("catalog_versions").select("id").eq("catalog_id",e).eq("status","published").maybeSingle();if(n)throw n;if(!r)return[];const{data:a,error:s}=await Ce.from("catalog_items").select("*").eq("version_id",r.id).eq("is_active",!0).is("deleted_at",null).order("name");if(s)throw s;return(a||[]).map(i=>({id:i.id,code:i.code,name:i.name,price_usd:Number(i.price_usd),category:i.category,store_name:i.store_name,supplier:i.supplier,image_url:i.image_url,is_selected:i.is_selected,is_active:i.is_active}))},enabled:!!e&&!!t})}function ZV(){return Zn({queryKey:["gestors"],queryFn:async()=>{const{data:e,error:t}=await Ce.from("user_roles").select("user_id").eq("role","gestor");if(t)throw t;const r=(e||[]).map(s=>s.user_id);if(r.length===0)return[];const{data:n,error:a}=await Ce.from("profiles").select("id, email, full_name, gestor_profiles(sales_description)").in("id",r).order("full_name",{ascending:!0,nullsFirst:!1});if(a)throw a;return(n||[]).map(s=>{var i;return{id:s.id,email:s.email,full_name:s.full_name,sales_description:Array.isArray(s.gestor_profiles)?((i=s.gestor_profiles[0])==null?void 0:i.sales_description)??null:null}})}})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var U0={};U0.version="0.18.5";var _4=1252,ez=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Py={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},jy=function(e){ez.indexOf(e)!=-1&&(_4=Py[0]=e)};function tz(){jy(1252)}var $a=function(e){jy(e)};function Fy(){$a(1200),tz()}function kE(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function rz(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function E4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Vu=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?rz(e.slice(2)):t==254&&r==255?E4(e.slice(2)):t==65279?e.slice(1):e},yh=function(t){return String.fromCharCode(t)},CE=function(t){return String.fromCharCode(t)},Yf,Ii="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qf(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Ii.charAt(s)+Ii.charAt(i)+Ii.charAt(o)+Ii.charAt(l);return t}function Yn(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Ii.indexOf(e.charAt(c++)),i=Ii.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Ii.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Ii.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var rt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),si=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Zi(e){return rt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function TE(e){return rt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var zn=function(t){return rt?si(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function qp(e){if(typeof ArrayBuffer>"u")return zn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function co(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function nz(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Oy(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Oy(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Nr=rt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:si(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function az(e){for(var t=[],r=0,n=e.length+250,a=Zi(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Zi(65535),n=65530)}return t.push(a.slice(0,r)),Nr(t)}var vn=/\u0000/g,zu=/[\u0001-\u0006]/g;function pc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Wa(e,t){var r=""+e;return r.length>=t?r:Jt("0",t-r.length)+r}function Iy(e,t){var r=""+e;return r.length>=t?r:Jt(" ",t-r.length)+r}function $0(e,t){var r=""+e;return r.length>=t?r:r+Jt(" ",t-r.length)}function sz(e,t){var r=""+Math.round(e);return r.length>=t?r:Jt("0",t-r.length)+r}function iz(e,t){var r=""+e;return r.length>=t?r:Jt("0",t-r.length)+r}var NE=Math.pow(2,32);function Dl(e,t){if(e>NE||e<-NE)return sz(e,t);var r=Math.round(e);return iz(r,t)}function W0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var AE=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Eg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oz(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Be={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},RE={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lz={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function V0(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,f=0,d=Math.floor(a);c<t&&(d=Math.floor(a),o=d*i+s,f=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=s):(f=c,o=i)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function No(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=pz(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var b4=new Date(1899,11,31,0,0,0),cz=b4.getTime(),uz=new Date(1900,2,1,0,0,0);function S4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=uz&&(r+=24*60*60*1e3),(r-(cz+(e.getTimezoneOffset()-b4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Dy(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fz(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dz(e){var t=e<0?12:11,r=Dy(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function hz(e){var t=Dy(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Jf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=dz(e):t===10?r=e.toFixed(10).substr(0,12):r=hz(e),Dy(fz(r.toUpperCase()))}function rl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Jf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Sa(14,S4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function pz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function mz(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Eg[r.m-1][1];case 5:return Eg[r.m-1][0];default:return Eg[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return AE[r.q][0];default:return AE[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Wa(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Wa(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Wa(l,c):"";return f}function Di(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var k4=/%/g;function gz(e,t,r){var n=t.replace(k4,""),a=t.length-n.length;return Vs(e,n,r*Math.pow(10,2*a))+Jt("%",a)}function xz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Vs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function C4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+C4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var T4=/# (\?+)( ?)\/( ?)(\d+)/;function vz(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Jt(" ",e[1].length+1+e[4].length):Iy(i,e[1].length)+e[2]+"/"+e[3]+Wa(o,e[4].length))}function yz(e,t,r){return r+(t===0?"":""+t)+Jt(" ",e[1].length+2+e[4].length)}var N4=/^#*0*\.([0#]+)/,A4=/\).*[0#]/,R4=/\(###\) ###\\?-####/;function dn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function PE(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function jE(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function wz(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function _z(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function aa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(A4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?aa("n",n,r):"("+aa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xz(e,t,r);if(t.indexOf("%")!==-1)return gz(e,t,r);if(t.indexOf("E")!==-1)return C4(t,r);if(t.charCodeAt(0)===36)return"$"+aa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Dl(l,t.length);if(t.match(/^[#?]+$/))return a=Dl(r,0),a==="0"&&(a=""),a.length>t.length?a:dn(t.substr(0,t.length-a.length))+a;if(s=t.match(T4))return vz(s,l,c);if(t.match(/^#+0+$/))return c+Dl(l,t.length-t.indexOf("0"));if(s=t.match(N4))return a=PE(r,s[1].length).replace(/^([^\.]+)$/,"$1."+dn(s[1])).replace(/\.$/,"."+dn(s[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Jt("0",dn(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+PE(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Di(Dl(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+aa(e,t,-r):Di(""+(Math.floor(r)+wz(r,s[1].length)))+"."+Wa(jE(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return aa(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=pc(aa(e,t.replace(/[\\-]/g,""),r)),i=0,pc(pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<a.length?a.charAt(i++):g==="0"?"0":""}));if(t.match(R4))return a=aa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=V0(l,Math.pow(10,i)-1,!1),a=""+c,f=Vs("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=$0(o[2],i),f.length<s[4].length&&(f=dn(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=V0(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Iy(o[1],i)+s[2]+"/"+s[3]+$0(o[2],i):Jt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Dl(r,0),t.length<=a.length?a:dn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return dn(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=jE(r,s[1].length),r<0?"-"+aa(e,t,-r):Di(_z(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Wa(0,3-g.length):"")+g})+"."+Wa(i,s[1].length);switch(t){case"###,##0.00":return aa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Di(Dl(l,0));return p!=="0"?c+p:"";case"###,###.00":return aa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return aa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Ez(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Vs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function bz(e,t,r){var n=t.replace(k4,""),a=t.length-n.length;return Vs(e,n,r*Math.pow(10,2*a))+Jt("%",a)}function P4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+P4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function is(e,t,r){if(e.charCodeAt(0)===40&&!t.match(A4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?is("n",n,r):"("+is("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ez(e,t,r);if(t.indexOf("%")!==-1)return bz(e,t,r);if(t.indexOf("E")!==-1)return P4(t,r);if(t.charCodeAt(0)===36)return"$"+is(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Wa(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:dn(t.substr(0,t.length-a.length))+a;if(s=t.match(T4))return yz(s,l,c);if(t.match(/^#+0+$/))return c+Wa(l,t.length-t.indexOf("0"));if(s=t.match(N4))return a=(""+r).replace(/^([^\.]+)$/,"$1."+dn(s[1])).replace(/\.$/,"."+dn(s[1])),a=a.replace(/\.(\d*)$/,function(g,m){return"."+m+Jt("0",dn(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Di(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+is(e,t,-r):Di(""+r)+"."+Jt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return is(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=pc(is(e,t.replace(/[\\-]/g,""),r)),i=0,pc(pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<a.length?a.charAt(i++):g==="0"?"0":""}));if(t.match(R4))return a=is(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=V0(l,Math.pow(10,i)-1,!1),a=""+c,f=Vs("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=$0(o[2],i),f.length<s[4].length&&(f=dn(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=V0(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Iy(o[1],i)+s[2]+"/"+s[3]+$0(o[2],i):Jt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:dn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return dn(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+is(e,t,-r):Di(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Wa(0,3-g.length):"")+g})+"."+Wa(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Di(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return is(e,t.slice(0,t.lastIndexOf(".")),r)+dn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Vs(e,t,r){return(r|0)===r?is(e,t,r):aa(e,t,r)}function Sz(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var j4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cu(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":W0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(j4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function kz(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!W0(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),g=p==="("||p===")"?p:"t";a[a.length]={t:g,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=No(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=No(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=No(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",i+=5,h="h"):(m.t="t",++i),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(j4)){if(c==null&&(c=No(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",cu(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var x=0,v=0,y;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",x<1&&(x=1);break;case"s":(y=a[i].v.match(/\.0+$/))&&(v=Math.max(v,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&a[i].v.match(/[Hh]/)&&(x=1),x<2&&a[i].v.match(/[Mm]/)&&(x=2),x<3&&a[i].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",E;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=mz(a[i].t.charCodeAt(0),a[i].v,c,v),a[i].t="t";break;case"n":case"?":for(E=i+1;a[E]!=null&&((o=a[E].t)==="?"||o==="D"||(o===" "||o==="t")&&a[E+1]!=null&&(a[E+1].t==="?"||a[E+1].t==="t"&&a[E+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[E].v==="/"||a[E].v===" "&&a[E+1]!=null&&a[E+1].t=="?"));)a[i].v+=a[E].v,a[E]={v:"",t:";"},++E;w+=a[i].v,i=E-1;break;case"G":a[i].t="t",a[i].v=rl(t,r);break}var b="",k,S;if(w.length>0){w.charCodeAt(0)==40?(k=t<0&&w.charCodeAt(0)===45?-t:t,S=Vs("n",w,k)):(k=t<0&&n>1?-t:t,S=Vs("n",w,k),k<0&&a[0]&&a[0].t=="t"&&(S=S.substr(1),a[0].v="-"+a[0].v)),E=S.length-1;var T=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){T=i;break}var N=a.length;if(T===a.length&&S.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(E>=a[i].v.length-1?(E-=a[i].v.length,a[i].v=S.substr(E+1,a[i].v.length)):E<0?a[i].v="":(a[i].v=S.substr(0,E+1),E=-1),a[i].t="t",N=i);E>=0&&N<a.length&&(a[N].v=S.substr(0,E+1)+a[N].v)}else if(T!==a.length&&S.indexOf("E")===-1){for(E=S.indexOf(".")-1,i=T;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")-1:a[i].v.length-1,b=a[i].v.substr(f+1);f>=0;--f)E>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(b=S.charAt(E--)+b);a[i].v=b,a[i].t="t",N=i}for(E>=0&&N<a.length&&(a[N].v=S.substr(0,E+1)+a[N].v),E=S.indexOf(".")+1,i=T;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==T)){for(f=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")+1:0,b=a[i].v.substr(0,f);f<a[i].v.length;++f)E<S.length&&(b+=S.charAt(E++));a[i].v=b,a[i].t="t",N=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(k=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=Vs(a[i].t,a[i].v,k),a[i].t="t");var O="";for(i=0;i!==a.length;++i)a[i]!=null&&(O+=a[i].v);return O}var FE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function OE(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Cz(e,t){var r=Sz(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(FE),o=r[1].match(FE);return OE(t,i)?[n,r[0]]:OE(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function Sa(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Be)[e],n==null&&(n=r.table&&r.table[RE[e]]||Be[RE[e]]),n==null&&(n=lz[e]||"General");break}if(W0(n,0))return rl(t,r);t instanceof Date&&(t=S4(t,r.date1904));var a=Cz(n,t);if(W0(a[1]))return rl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return kz(a[1],t,r,a[0])}function zs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Be[r]==null){t<0&&(t=r);continue}if(Be[r]==e){t=r;break}}t<0&&(t=391)}return Be[t]=e,t}function Xp(e){for(var t=0;t!=392;++t)e[t]!==void 0&&zs(e[t],t)}function uu(){Be=oz()}var Tz={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},F4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Nz(e){var t=typeof e=="number"?Be[e]:e;return t=t.replace(F4,"(\\d+)"),new RegExp("^"+t+"$")}function Az(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(F4)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:a=p;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?f:c+"T"+f}var Rz=function(){var e={};e.version="1.2.0";function t(){for(var S=0,T=new Array(256),N=0;N!=256;++N)S=N,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,S=S&1?-306674912^S>>>1:S>>>1,T[N]=S;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(S){var T=0,N=0,O=0,j=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)j[O]=S[O];for(O=0;O!=256;++O)for(N=S[O],T=256+O;T<4096;T+=256)N=j[T]=N>>>8^S[N&255];var D=[];for(O=1;O!=16;++O)D[O-1]=typeof Int32Array<"u"?j.subarray(O*256,O*256+256):j.slice(O*256,O*256+256);return D}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],f=a[5],d=a[6],h=a[7],p=a[8],g=a[9],m=a[10],x=a[11],v=a[12],y=a[13],w=a[14];function E(S,T){for(var N=T^-1,O=0,j=S.length;O<j;)N=N>>>8^r[(N^S.charCodeAt(O++))&255];return~N}function b(S,T){for(var N=T^-1,O=S.length-15,j=0;j<O;)N=w[S[j++]^N&255]^y[S[j++]^N>>8&255]^v[S[j++]^N>>16&255]^x[S[j++]^N>>>24]^m[S[j++]]^g[S[j++]]^p[S[j++]]^h[S[j++]]^d[S[j++]]^f[S[j++]]^c[S[j++]]^l[S[j++]]^o[S[j++]]^i[S[j++]]^s[S[j++]]^r[S[j++]];for(O+=15;j<O;)N=N>>>8^r[(N^S[j++])&255];return~N}function k(S,T){for(var N=T^-1,O=0,j=S.length,D=0,Y=0;O<j;)D=S.charCodeAt(O++),D<128?N=N>>>8^r[(N^D)&255]:D<2048?(N=N>>>8^r[(N^(192|D>>6&31))&255],N=N>>>8^r[(N^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,Y=S.charCodeAt(O++)&1023,N=N>>>8^r[(N^(240|D>>8&7))&255],N=N>>>8^r[(N^(128|D>>2&63))&255],N=N>>>8^r[(N^(128|Y>>6&15|(D&3)<<4))&255],N=N>>>8^r[(N^(128|Y&63))&255]):(N=N>>>8^r[(N^(224|D>>12&15))&255],N=N>>>8^r[(N^(128|D>>6&63))&255],N=N>>>8^r[(N^(128|D&63))&255]);return~N}return e.table=r,e.bstr=E,e.buf=b,e.str=k,e}(),Oe=function(){var t={};t.version="1.2.1";function r(C,M){for(var P=C.split("/"),F=M.split("/"),L=0,B=0,ee=Math.min(P.length,F.length);L<ee;++L){if(B=P[L].length-F[L].length)return B;if(P[L]!=F[L])return P[L]<F[L]?-1:1}return P.length-F.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(0,M+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var M=C.lastIndexOf("/");return M===-1?C:C.slice(M+1)}function s(C,M){typeof M=="string"&&(M=new Date(M));var P=M.getHours();P=P<<6|M.getMinutes(),P=P<<5|M.getSeconds()>>>1,C.write_shift(2,P);var F=M.getFullYear()-1980;F=F<<4|M.getMonth()+1,F=F<<5|M.getDate(),C.write_shift(2,F)}function i(C){var M=C.read_shift(2)&65535,P=C.read_shift(2)&65535,F=new Date,L=P&31;P>>>=5;var B=P&15;P>>>=4,F.setMilliseconds(0),F.setFullYear(P+1980),F.setMonth(B-1),F.setDate(L);var ee=M&31;M>>>=5;var le=M&63;return M>>>=6,F.setHours(M),F.setMinutes(le),F.setSeconds(ee<<1),F}function o(C){Mr(C,0);for(var M={},P=0;C.l<=C.length-4;){var F=C.read_shift(2),L=C.read_shift(2),B=C.l+L,ee={};switch(F){case 21589:P=C.read_shift(1),P&1&&(ee.mtime=C.read_shift(4)),L>5&&(P&2&&(ee.atime=C.read_shift(4)),P&4&&(ee.ctime=C.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}C.l=B,M[F]=ee}return M}var l;function c(){return l||(l={})}function f(C,M){if(C[0]==80&&C[1]==75)return mu(C,M);if((C[0]|32)==109&&(C[1]|32)==105)return Dn(C,M);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var P=3,F=512,L=0,B=0,ee=0,le=0,Z=0,te=[],re=C.slice(0,512);Mr(re,0);var pe=d(re);switch(P=pe[0],P){case 3:F=512;break;case 4:F=4096;break;case 0:if(pe[1]==0)return mu(C,M);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}F!==512&&(re=C.slice(0,F),Mr(re,28));var Ee=C.slice(0,F);h(re,P);var Te=re.read_shift(4,"i");if(P===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);re.l+=4,ee=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),le=re.read_shift(4,"i"),L=re.read_shift(4,"i"),Z=re.read_shift(4,"i"),B=re.read_shift(4,"i");for(var xe=-1,ke=0;ke<109&&(xe=re.read_shift(4,"i"),!(xe<0));++ke)te[ke]=xe;var Ye=p(C,F);x(Z,B,Ye,F,te);var Ut=y(Ye,ee,te,F);Ut[ee].name="!Directory",L>0&&le!==Y&&(Ut[le].name="!MiniFAT"),Ut[te[0]].name="!FAT",Ut.fat_addrs=te,Ut.ssz=F;var $t={},zr=[],xu=[],vu=[];w(ee,Ut,Ye,zr,L,$t,xu,le),g(xu,vu,zr),zr.shift();var yu={FileIndex:xu,FullPaths:vu};return M&&M.raw&&(yu.raw={header:Ee,sectors:Ye}),yu}function d(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Q,"Header Signature: "),C.l+=16;var M=C.read_shift(2,"u");return[C.read_shift(2,"u"),M]}function h(C,M){var P=9;switch(C.l+=2,P=C.read_shift(2)){case 9:if(M!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(M!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function p(C,M){for(var P=Math.ceil(C.length/M)-1,F=[],L=1;L<P;++L)F[L-1]=C.slice(L*M,(L+1)*M);return F[P-1]=C.slice(P*M),F}function g(C,M,P){for(var F=0,L=0,B=0,ee=0,le=0,Z=P.length,te=[],re=[];F<Z;++F)te[F]=re[F]=F,M[F]=P[F];for(;le<re.length;++le)F=re[le],L=C[F].L,B=C[F].R,ee=C[F].C,te[F]===F&&(L!==-1&&te[L]!==L&&(te[F]=te[L]),B!==-1&&te[B]!==B&&(te[F]=te[B])),ee!==-1&&(te[ee]=F),L!==-1&&F!=te[F]&&(te[L]=te[F],re.lastIndexOf(L)<le&&re.push(L)),B!==-1&&F!=te[F]&&(te[B]=te[F],re.lastIndexOf(B)<le&&re.push(B));for(F=1;F<Z;++F)te[F]===F&&(B!==-1&&te[B]!==B?te[F]=te[B]:L!==-1&&te[L]!==L&&(te[F]=te[L]));for(F=1;F<Z;++F)if(C[F].type!==0){if(le=F,le!=te[le])do le=te[le],M[F]=M[le]+"/"+M[F];while(le!==0&&te[le]!==-1&&le!=te[le]);te[F]=-1}for(M[0]+="/",F=1;F<Z;++F)C[F].type!==2&&(M[F]+="/")}function m(C,M,P){for(var F=C.start,L=C.size,B=[],ee=F;P&&L>0&&ee>=0;)B.push(M.slice(ee*D,ee*D+D)),L-=D,ee=Eo(P,ee*4);return B.length===0?oe(0):Nr(B).slice(0,C.size)}function x(C,M,P,F,L){var B=Y;if(C===Y){if(M!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ee=P[C],le=(F>>>2)-1;if(!ee)return;for(var Z=0;Z<le&&(B=Eo(ee,Z*4))!==Y;++Z)L.push(B);x(Eo(ee,F-4),M-1,P,F,L)}}function v(C,M,P,F,L){var B=[],ee=[];L||(L=[]);var le=F-1,Z=0,te=0;for(Z=M;Z>=0;){L[Z]=!0,B[B.length]=Z,ee.push(C[Z]);var re=P[Math.floor(Z*4/F)];if(te=Z*4&le,F<4+te)throw new Error("FAT boundary crossed: "+Z+" 4 "+F);if(!C[re])break;Z=Eo(C[re],te)}return{nodes:B,data:GE([ee])}}function y(C,M,P,F){var L=C.length,B=[],ee=[],le=[],Z=[],te=F-1,re=0,pe=0,Ee=0,Te=0;for(re=0;re<L;++re)if(le=[],Ee=re+M,Ee>=L&&(Ee-=L),!ee[Ee]){Z=[];var xe=[];for(pe=Ee;pe>=0;){xe[pe]=!0,ee[pe]=!0,le[le.length]=pe,Z.push(C[pe]);var ke=P[Math.floor(pe*4/F)];if(Te=pe*4&te,F<4+Te)throw new Error("FAT boundary crossed: "+pe+" 4 "+F);if(!C[ke]||(pe=Eo(C[ke],Te),xe[pe]))break}B[Ee]={nodes:le,data:GE([Z])}}return B}function w(C,M,P,F,L,B,ee,le){for(var Z=0,te=F.length?2:0,re=M[C].data,pe=0,Ee=0,Te;pe<re.length;pe+=128){var xe=re.slice(pe,pe+128);Mr(xe,64),Ee=xe.read_shift(2),Te=Vy(xe,0,Ee-te),F.push(Te);var ke={name:Te,type:xe.read_shift(1),color:xe.read_shift(1),L:xe.read_shift(4,"i"),R:xe.read_shift(4,"i"),C:xe.read_shift(4,"i"),clsid:xe.read_shift(16),state:xe.read_shift(4,"i"),start:0,size:0},Ye=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Ye!==0&&(ke.ct=E(xe,xe.l-8));var Ut=xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2)+xe.read_shift(2);Ut!==0&&(ke.mt=E(xe,xe.l-8)),ke.start=xe.read_shift(4,"i"),ke.size=xe.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=Y,ke.name=""),ke.type===5?(Z=ke.start,L>0&&Z!==Y&&(M[Z].name="!StreamData")):ke.size>=4096?(ke.storage="fat",M[ke.start]===void 0&&(M[ke.start]=v(P,ke.start,M.fat_addrs,M.ssz)),M[ke.start].name=ke.name,ke.content=M[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:Z!==Y&&ke.start!==Y&&M[Z]&&(ke.content=m(ke,M[Z].data,(M[le]||{}).data))),ke.content&&Mr(ke.content,0),B[Te]=ke,ee.push(ke)}}function E(C,M){return new Date(($n(C,M+4)/1e7*Math.pow(2,32)+$n(C,M)/1e7-11644473600)*1e3)}function b(C,M){return c(),f(l.readFileSync(C),M)}function k(C,M){var P=M&&M.type;switch(P||rt&&Buffer.isBuffer(C)&&(P="buffer"),P||"base64"){case"file":return b(C,M);case"base64":return f(zn(Yn(C)),M);case"binary":return f(zn(C),M)}return f(C,M)}function S(C,M){var P=M||{},F=P.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=F+"/",C.FileIndex[0]={name:F,type:5}),P.CLSID&&(C.FileIndex[0].clsid=P.CLSID),T(C)}function T(C){var M="Sh33tJ5";if(!Oe.find(C,"/"+M)){var P=oe(4);P[0]=55,P[1]=P[3]=50,P[2]=54,C.FileIndex.push({name:M,type:2,content:P,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+M),N(C)}}function N(C,M){S(C);for(var P=!1,F=!1,L=C.FullPaths.length-1;L>=0;--L){var B=C.FileIndex[L];switch(B.type){case 0:F?P=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(B.R*B.L*B.C)&&(P=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!M)){var ee=new Date(1987,1,19),le=0,Z=Object.create?Object.create(null):{},te=[];for(L=0;L<C.FullPaths.length;++L)Z[C.FullPaths[L]]=!0,C.FileIndex[L].type!==0&&te.push([C.FullPaths[L],C.FileIndex[L]]);for(L=0;L<te.length;++L){var re=n(te[L][0]);F=Z[re],F||(te.push([re,{name:a(re).replace("/",""),type:1,clsid:X,ct:ee,mt:ee,content:null}]),Z[re]=!0)}for(te.sort(function(Te,xe){return r(Te[0],xe[0])}),C.FullPaths=[],C.FileIndex=[],L=0;L<te.length;++L)C.FullPaths[L]=te[L][0],C.FileIndex[L]=te[L][1];for(L=0;L<te.length;++L){var pe=C.FileIndex[L],Ee=C.FullPaths[L];if(pe.name=a(Ee).replace("/",""),pe.L=pe.R=pe.C=-(pe.color=1),pe.size=pe.content?pe.content.length:0,pe.start=0,pe.clsid=pe.clsid||X,L===0)pe.C=te.length>1?1:-1,pe.size=0,pe.type=5;else if(Ee.slice(-1)=="/"){for(le=L+1;le<te.length&&n(C.FullPaths[le])!=Ee;++le);for(pe.C=le>=te.length?-1:le,le=L+1;le<te.length&&n(C.FullPaths[le])!=n(Ee);++le);pe.R=le>=te.length?-1:le,pe.type=1}else n(C.FullPaths[L+1]||"")==n(Ee)&&(pe.R=L+1),pe.type=2}}}function O(C,M){var P=M||{};if(P.fileType=="mad")return rs(C,P);switch(N(C),P.fileType){case"zip":return gu(C,P)}var F=function(Te){for(var xe=0,ke=0,Ye=0;Ye<Te.FileIndex.length;++Ye){var Ut=Te.FileIndex[Ye];if(Ut.content){var $t=Ut.content.length;$t>0&&($t<4096?xe+=$t+63>>6:ke+=$t+511>>9)}}for(var zr=Te.FullPaths.length+3>>2,xu=xe+7>>3,vu=xe+127>>7,yu=xu+ke+zr+vu,ho=yu+127>>7,Em=ho<=109?0:Math.ceil((ho-109)/127);yu+ho+Em+127>>7>ho;)Em=++ho<=109?0:Math.ceil((ho-109)/127);var Ns=[1,Em,ho,vu,zr,ke,xe,0];return Te.FileIndex[0].size=xe<<6,Ns[7]=(Te.FileIndex[0].start=Ns[0]+Ns[1]+Ns[2]+Ns[3]+Ns[4]+Ns[5])+(Ns[6]+7>>3),Ns}(C),L=oe(F[7]<<9),B=0,ee=0;{for(B=0;B<8;++B)L.write_shift(1,G[B]);for(B=0;B<8;++B)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),B=0;B<3;++B)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:Y),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:Y),L.write_shift(4,F[1]),B=0;B<109;++B)L.write_shift(-4,B<F[2]?F[1]+B:-1)}if(F[1])for(ee=0;ee<F[1];++ee){for(;B<236+ee*127;++B)L.write_shift(-4,B<F[2]?F[1]+B:-1);L.write_shift(-4,ee===F[1]-1?Y:ee+1)}var le=function(Te){for(ee+=Te;B<ee-1;++B)L.write_shift(-4,B+1);Te&&(++B,L.write_shift(-4,Y))};for(ee=B=0,ee+=F[1];B<ee;++B)L.write_shift(-4,q.DIFSECT);for(ee+=F[2];B<ee;++B)L.write_shift(-4,q.FATSECT);le(F[3]),le(F[4]);for(var Z=0,te=0,re=C.FileIndex[0];Z<C.FileIndex.length;++Z)re=C.FileIndex[Z],re.content&&(te=re.content.length,!(te<4096)&&(re.start=ee,le(te+511>>9)));for(le(F[6]+7>>3);L.l&511;)L.write_shift(-4,q.ENDOFCHAIN);for(ee=B=0,Z=0;Z<C.FileIndex.length;++Z)re=C.FileIndex[Z],re.content&&(te=re.content.length,!(!te||te>=4096)&&(re.start=ee,le(te+63>>6)));for(;L.l&511;)L.write_shift(-4,q.ENDOFCHAIN);for(B=0;B<F[4]<<2;++B){var pe=C.FullPaths[B];if(!pe||pe.length===0){for(Z=0;Z<17;++Z)L.write_shift(4,0);for(Z=0;Z<3;++Z)L.write_shift(4,-1);for(Z=0;Z<12;++Z)L.write_shift(4,0);continue}re=C.FileIndex[B],B===0&&(re.start=re.size?re.start-1:Y);var Ee=B===0&&P.root||re.name;if(te=2*(Ee.length+1),L.write_shift(64,Ee,"utf16le"),L.write_shift(2,te),L.write_shift(1,re.type),L.write_shift(1,re.color),L.write_shift(-4,re.L),L.write_shift(-4,re.R),L.write_shift(-4,re.C),re.clsid)L.write_shift(16,re.clsid,"hex");else for(Z=0;Z<4;++Z)L.write_shift(4,0);L.write_shift(4,re.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,re.start),L.write_shift(4,re.size),L.write_shift(4,0)}for(B=1;B<C.FileIndex.length;++B)if(re=C.FileIndex[B],re.size>=4096)if(L.l=re.start+1<<9,rt&&Buffer.isBuffer(re.content))re.content.copy(L,L.l,0,re.size),L.l+=re.size+511&-512;else{for(Z=0;Z<re.size;++Z)L.write_shift(1,re.content[Z]);for(;Z&511;++Z)L.write_shift(1,0)}for(B=1;B<C.FileIndex.length;++B)if(re=C.FileIndex[B],re.size>0&&re.size<4096)if(rt&&Buffer.isBuffer(re.content))re.content.copy(L,L.l,0,re.size),L.l+=re.size+63&-64;else{for(Z=0;Z<re.size;++Z)L.write_shift(1,re.content[Z]);for(;Z&63;++Z)L.write_shift(1,0)}if(rt)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function j(C,M){var P=C.FullPaths.map(function(Z){return Z.toUpperCase()}),F=P.map(function(Z){var te=Z.split("/");return te[te.length-(Z.slice(-1)=="/"?2:1)]}),L=!1;M.charCodeAt(0)===47?(L=!0,M=P[0].slice(0,-1)+M):L=M.indexOf("/")!==-1;var B=M.toUpperCase(),ee=L===!0?P.indexOf(B):F.indexOf(B);if(ee!==-1)return C.FileIndex[ee];var le=!B.match(zu);for(B=B.replace(vn,""),le&&(B=B.replace(zu,"!")),ee=0;ee<P.length;++ee)if((le?P[ee].replace(zu,"!"):P[ee]).replace(vn,"")==B||(le?F[ee].replace(zu,"!"):F[ee]).replace(vn,"")==B)return C.FileIndex[ee];return null}var D=64,Y=-2,Q="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],X="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:Q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:X,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(C,M,P){c();var F=O(C,P);l.writeFileSync(M,F)}function A(C){for(var M=new Array(C.length),P=0;P<C.length;++P)M[P]=String.fromCharCode(C[P]);return M.join("")}function ne(C,M){var P=O(C,M);switch(M&&M.type||"buffer"){case"file":return c(),l.writeFileSync(M.filename,P),P;case"binary":return typeof P=="string"?P:A(P);case"base64":return Qf(typeof P=="string"?P:A(P));case"buffer":if(rt)return Buffer.isBuffer(P)?P:si(P);case"array":return typeof P=="string"?zn(P):P}return P}var ce;function R(C){try{var M=C.InflateRaw,P=new M;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)ce=C;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function z(C,M){if(!ce)return Bd(C,M);var P=ce.InflateRaw,F=new P,L=F._processChunk(C.slice(C.l),F._finishFlushFlag);return C.l+=F.bytesRead,L}function U(C){return ce?ce.deflateRawSync(C):Xe(C)}var V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(C){var M=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(M>>16|M>>8|M)&255}for(var ie=typeof Uint8Array<"u",ae=ie?new Uint8Array(256):[],be=0;be<256;++be)ae[be]=se(be);function I(C,M){var P=ae[C&255];return M<=8?P>>>8-M:(P=P<<8|ae[C>>8&255],M<=16?P>>>16-M:(P=P<<8|ae[C>>16&255],P>>>24-M))}function He(C,M){var P=M&7,F=M>>>3;return(C[F]|(P<=6?0:C[F+1]<<8))>>>P&3}function Ue(C,M){var P=M&7,F=M>>>3;return(C[F]|(P<=5?0:C[F+1]<<8))>>>P&7}function at(C,M){var P=M&7,F=M>>>3;return(C[F]|(P<=4?0:C[F+1]<<8))>>>P&15}function Ve(C,M){var P=M&7,F=M>>>3;return(C[F]|(P<=3?0:C[F+1]<<8))>>>P&31}function ve(C,M){var P=M&7,F=M>>>3;return(C[F]|(P<=1?0:C[F+1]<<8))>>>P&127}function xt(C,M,P){var F=M&7,L=M>>>3,B=(1<<P)-1,ee=C[L]>>>F;return P<8-F||(ee|=C[L+1]<<8-F,P<16-F)||(ee|=C[L+2]<<16-F,P<24-F)||(ee|=C[L+3]<<24-F),ee&B}function fe(C,M,P){var F=M&7,L=M>>>3;return F<=5?C[L]|=(P&7)<<F:(C[L]|=P<<F&255,C[L+1]=(P&7)>>8-F),M+3}function Re(C,M,P){var F=M&7,L=M>>>3;return P=(P&1)<<F,C[L]|=P,M+1}function lt(C,M,P){var F=M&7,L=M>>>3;return P<<=F,C[L]|=P&255,P>>>=8,C[L+1]=P,M+8}function pr(C,M,P){var F=M&7,L=M>>>3;return P<<=F,C[L]|=P&255,P>>>=8,C[L+1]=P&255,C[L+2]=P>>>8,M+16}function Nt(C,M){var P=C.length,F=2*P>M?2*P:M+5,L=0;if(P>=M)return C;if(rt){var B=TE(F);if(C.copy)C.copy(B);else for(;L<C.length;++L)B[L]=C[L];return B}else if(ie){var ee=new Uint8Array(F);if(ee.set)ee.set(C);else for(;L<P;++L)ee[L]=C[L];return ee}return C.length=F,C}function qe(C){for(var M=new Array(C),P=0;P<C;++P)M[P]=0;return M}function rr(C,M,P){var F=1,L=0,B=0,ee=0,le=0,Z=C.length,te=ie?new Uint16Array(32):qe(32);for(B=0;B<32;++B)te[B]=0;for(B=Z;B<P;++B)C[B]=0;Z=C.length;var re=ie?new Uint16Array(Z):qe(Z);for(B=0;B<Z;++B)te[L=C[B]]++,F<L&&(F=L),re[B]=0;for(te[0]=0,B=1;B<=F;++B)te[B+16]=le=le+te[B-1]<<1;for(B=0;B<Z;++B)le=C[B],le!=0&&(re[B]=te[le+16]++);var pe=0;for(B=0;B<Z;++B)if(pe=C[B],pe!=0)for(le=I(re[B],F)>>F-pe,ee=(1<<F+4-pe)-1;ee>=0;--ee)M[le|ee<<pe]=pe&15|B<<4;return F}var Mt=ie?new Uint16Array(512):qe(512),ea=ie?new Uint16Array(32):qe(32);if(!ie){for(var jr=0;jr<512;++jr)Mt[jr]=0;for(jr=0;jr<32;++jr)ea[jr]=0}(function(){for(var C=[],M=0;M<32;M++)C.push(5);rr(C,ea,32);var P=[];for(M=0;M<=143;M++)P.push(8);for(;M<=255;M++)P.push(9);for(;M<=279;M++)P.push(7);for(;M<=287;M++)P.push(8);rr(P,Mt,288)})();var ta=function(){for(var M=ie?new Uint8Array(32768):[],P=0,F=0;P<W.length-1;++P)for(;F<W[P+1];++F)M[F]=P;for(;F<32768;++F)M[F]=29;var L=ie?new Uint8Array(259):[];for(P=0,F=0;P<J.length-1;++P)for(;F<J[P+1];++F)L[F]=P;function B(le,Z){for(var te=0;te<le.length;){var re=Math.min(65535,le.length-te),pe=te+re==le.length;for(Z.write_shift(1,+pe),Z.write_shift(2,re),Z.write_shift(2,~re&65535);re-- >0;)Z[Z.l++]=le[te++]}return Z.l}function ee(le,Z){for(var te=0,re=0,pe=ie?new Uint16Array(32768):[];re<le.length;){var Ee=Math.min(65535,le.length-re);if(Ee<10){for(te=fe(Z,te,+(re+Ee==le.length)),te&7&&(te+=8-(te&7)),Z.l=te/8|0,Z.write_shift(2,Ee),Z.write_shift(2,~Ee&65535);Ee-- >0;)Z[Z.l++]=le[re++];te=Z.l*8;continue}te=fe(Z,te,+(re+Ee==le.length)+2);for(var Te=0;Ee-- >0;){var xe=le[re];Te=(Te<<5^xe)&32767;var ke=-1,Ye=0;if((ke=pe[Te])&&(ke|=re&-32768,ke>re&&(ke-=32768),ke<re))for(;le[ke+Ye]==le[re+Ye]&&Ye<250;)++Ye;if(Ye>2){xe=L[Ye],xe<=22?te=lt(Z,te,ae[xe+1]>>1)-1:(lt(Z,te,3),te+=5,lt(Z,te,ae[xe-23]>>5),te+=3);var Ut=xe<8?0:xe-4>>2;Ut>0&&(pr(Z,te,Ye-J[xe]),te+=Ut),xe=M[re-ke],te=lt(Z,te,ae[xe]>>3),te-=3;var $t=xe<4?0:xe-2>>1;$t>0&&(pr(Z,te,re-ke-W[xe]),te+=$t);for(var zr=0;zr<Ye;++zr)pe[Te]=re&32767,Te=(Te<<5^le[re])&32767,++re;Ee-=Ye-1}else xe<=143?xe=xe+48:te=Re(Z,te,1),te=lt(Z,te,ae[xe]),pe[Te]=re&32767,++re}te=lt(Z,te,0)-1}return Z.l=(te+7)/8|0,Z.l}return function(Z,te){return Z.length<8?B(Z,te):ee(Z,te)}}();function Xe(C){var M=oe(50+Math.floor(C.length*1.1)),P=ta(C,M);return M.slice(0,P)}var Lt=ie?new Uint16Array(32768):qe(32768),sn=ie?new Uint16Array(32768):qe(32768),Bt=ie?new Uint16Array(128):qe(128),En=1,hu=1;function ci(C,M){var P=Ve(C,M)+257;M+=5;var F=Ve(C,M)+1;M+=5;var L=at(C,M)+4;M+=4;for(var B=0,ee=ie?new Uint8Array(19):qe(19),le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,te=ie?new Uint8Array(8):qe(8),re=ie?new Uint8Array(8):qe(8),pe=ee.length,Ee=0;Ee<L;++Ee)ee[V[Ee]]=B=Ue(C,M),Z<B&&(Z=B),te[B]++,M+=3;var Te=0;for(te[0]=0,Ee=1;Ee<=Z;++Ee)re[Ee]=Te=Te+te[Ee-1]<<1;for(Ee=0;Ee<pe;++Ee)(Te=ee[Ee])!=0&&(le[Ee]=re[Te]++);var xe=0;for(Ee=0;Ee<pe;++Ee)if(xe=ee[Ee],xe!=0){Te=ae[le[Ee]]>>8-xe;for(var ke=(1<<7-xe)-1;ke>=0;--ke)Bt[Te|ke<<xe]=xe&7|Ee<<3}var Ye=[];for(Z=1;Ye.length<P+F;)switch(Te=Bt[ve(C,M)],M+=Te&7,Te>>>=3){case 16:for(B=3+He(C,M),M+=2,Te=Ye[Ye.length-1];B-- >0;)Ye.push(Te);break;case 17:for(B=3+Ue(C,M),M+=3;B-- >0;)Ye.push(0);break;case 18:for(B=11+ve(C,M),M+=7;B-- >0;)Ye.push(0);break;default:Ye.push(Te),Z<Te&&(Z=Te);break}var Ut=Ye.slice(0,P),$t=Ye.slice(P);for(Ee=P;Ee<286;++Ee)Ut[Ee]=0;for(Ee=F;Ee<30;++Ee)$t[Ee]=0;return En=rr(Ut,Lt,286),hu=rr($t,sn,30),M}function ym(C,M){if(C[0]==3&&!(C[1]&3))return[Zi(M),2];for(var P=0,F=0,L=TE(M||1<<18),B=0,ee=L.length>>>0,le=0,Z=0;!(F&1);){if(F=Ue(C,P),P+=3,F>>>1)F>>1==1?(le=9,Z=5):(P=ci(C,P),le=En,Z=hu);else{P&7&&(P+=8-(P&7));var te=C[P>>>3]|C[(P>>>3)+1]<<8;if(P+=32,te>0)for(!M&&ee<B+te&&(L=Nt(L,B+te),ee=L.length);te-- >0;)L[B++]=C[P>>>3],P+=8;continue}for(;;){!M&&ee<B+32767&&(L=Nt(L,B+32767),ee=L.length);var re=xt(C,P,le),pe=F>>>1==1?Mt[re]:Lt[re];if(P+=pe&15,pe>>>=4,!(pe>>>8&255))L[B++]=pe;else{if(pe==256)break;pe-=257;var Ee=pe<8?0:pe-4>>2;Ee>5&&(Ee=0);var Te=B+J[pe];Ee>0&&(Te+=xt(C,P,Ee),P+=Ee),re=xt(C,P,Z),pe=F>>>1==1?ea[re]:sn[re],P+=pe&15,pe>>>=4;var xe=pe<4?0:pe-2>>1,ke=W[pe];for(xe>0&&(ke+=xt(C,P,xe),P+=xe),!M&&ee<Te&&(L=Nt(L,Te+100),ee=L.length);B<Te;)L[B]=L[B-ke],++B}}}return M?[L,P+7>>>3]:[L.slice(0,B),P+7>>>3]}function Bd(C,M){var P=C.slice(C.l||0),F=ym(P,M);return C.l+=F[1],F[0]}function pu(C,M){if(C)typeof console<"u"&&console.error(M);else throw new Error(M)}function mu(C,M){var P=C;Mr(P,0);var F=[],L=[],B={FileIndex:F,FullPaths:L};S(B,{root:M.root});for(var ee=P.length-4;(P[ee]!=80||P[ee+1]!=75||P[ee+2]!=5||P[ee+3]!=6)&&ee>=0;)--ee;P.l=ee+4,P.l+=4;var le=P.read_shift(2);P.l+=6;var Z=P.read_shift(4);for(P.l=Z,ee=0;ee<le;++ee){P.l+=20;var te=P.read_shift(4),re=P.read_shift(4),pe=P.read_shift(2),Ee=P.read_shift(2),Te=P.read_shift(2);P.l+=8;var xe=P.read_shift(4),ke=o(P.slice(P.l+pe,P.l+pe+Ee));P.l+=pe+Ee+Te;var Ye=P.l;P.l=xe+4,wm(P,te,re,B,ke),P.l=Ye}return B}function wm(C,M,P,F,L){C.l+=2;var B=C.read_shift(2),ee=C.read_shift(2),le=i(C);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var Z=C.read_shift(4),te=C.read_shift(4),re=C.read_shift(4),pe=C.read_shift(2),Ee=C.read_shift(2),Te="",xe=0;xe<pe;++xe)Te+=String.fromCharCode(C[C.l++]);if(Ee){var ke=o(C.slice(C.l,C.l+Ee));(ke[21589]||{}).mt&&(le=ke[21589].mt),((L||{})[21589]||{}).mt&&(le=L[21589].mt)}C.l+=Ee;var Ye=C.slice(C.l,C.l+te);switch(ee){case 8:Ye=z(C,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var Ut=!1;B&8&&(Z=C.read_shift(4),Z==134695760&&(Z=C.read_shift(4),Ut=!0),te=C.read_shift(4),re=C.read_shift(4)),te!=M&&pu(Ut,"Bad compressed size: "+M+" != "+te),re!=P&&pu(Ut,"Bad uncompressed size: "+P+" != "+re),on(F,Te,Ye,{unsafe:!0,mt:le})}function gu(C,M){var P=M||{},F=[],L=[],B=oe(1),ee=P.compression?8:0,le=0,Z=0,te=0,re=0,pe=0,Ee=C.FullPaths[0],Te=Ee,xe=C.FileIndex[0],ke=[],Ye=0;for(Z=1;Z<C.FullPaths.length;++Z)if(Te=C.FullPaths[Z].slice(Ee.length),xe=C.FileIndex[Z],!(!xe.size||!xe.content||Te=="Sh33tJ5")){var Ut=re,$t=oe(Te.length);for(te=0;te<Te.length;++te)$t.write_shift(1,Te.charCodeAt(te)&127);$t=$t.slice(0,$t.l),ke[pe]=Rz.buf(xe.content,0);var zr=xe.content;ee==8&&(zr=U(zr)),B=oe(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,le),B.write_shift(2,ee),xe.mt?s(B,xe.mt):B.write_shift(4,0),B.write_shift(-4,ke[pe]),B.write_shift(4,zr.length),B.write_shift(4,xe.content.length),B.write_shift(2,$t.length),B.write_shift(2,0),re+=B.length,F.push(B),re+=$t.length,F.push($t),re+=zr.length,F.push(zr),B=oe(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,le),B.write_shift(2,ee),B.write_shift(4,0),B.write_shift(-4,ke[pe]),B.write_shift(4,zr.length),B.write_shift(4,xe.content.length),B.write_shift(2,$t.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,Ut),Ye+=B.l,L.push(B),Ye+=$t.length,L.push($t),++pe}return B=oe(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,pe),B.write_shift(2,pe),B.write_shift(4,Ye),B.write_shift(4,re),B.write_shift(2,0),Nr([Nr(F),Nr(L),B])}var On={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _m(C,M){if(C.ctype)return C.ctype;var P=C.name||"",F=P.match(/\.([^\.]+)$/);return F&&On[F[1]]||M&&(F=(P=M).match(/[\.\\]([^\.\\])+$/),F&&On[F[1]])?On[F[1]]:"application/octet-stream"}function Ge(C){for(var M=Qf(C),P=[],F=0;F<M.length;F+=76)P.push(M.slice(F,F+76));return P.join(`\r
`)+`\r
`}function ht(C){var M=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var re=te.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});M=M.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),M.charAt(0)==`
`&&(M="=0D"+M.slice(1)),M=M.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],F=M.split(`\r
`),L=0;L<F.length;++L){var B=F[L];if(B.length==0){P.push("");continue}for(var ee=0;ee<B.length;){var le=76,Z=B.slice(ee,ee+le);Z.charAt(le-1)=="="?le--:Z.charAt(le-2)=="="?le-=2:Z.charAt(le-3)=="="&&(le-=3),Z=B.slice(ee,ee+le),ee+=le,ee<B.length&&(Z+="="),P.push(Z)}}return P.join(`\r
`)}function St(C){for(var M=[],P=0;P<C.length;++P){for(var F=C[P];P<=C.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+C[++P];M.push(F)}for(var L=0;L<M.length;++L)M[L]=M[L].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return zn(M.join(`\r
`))}function In(C,M,P){for(var F="",L="",B="",ee,le=0;le<10;++le){var Z=M[le];if(!Z||Z.match(/^\s*$/))break;var te=Z.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":F=te[2].trim();break;case"content-type":B=te[2].trim();break;case"content-transfer-encoding":L=te[2].trim();break}}switch(++le,L.toLowerCase()){case"base64":ee=zn(Yn(M.slice(le).join("")));break;case"quoted-printable":ee=St(M.slice(le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var re=on(C,F.slice(P.length),ee,{unsafe:!0});B&&(re.ctype=B)}function Dn(C,M){if(A(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=M&&M.root||"",F=(rt&&Buffer.isBuffer(C)?C.toString("binary"):A(C)).split(`\r
`),L=0,B="";for(L=0;L<F.length;++L)if(B=F[L],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),P||(P=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),B.slice(0,P.length)!=P););var ee=(F[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var le="--"+(ee[1]||""),Z=[],te=[],re={FileIndex:Z,FullPaths:te};S(re);var pe,Ee=0;for(L=0;L<F.length;++L){var Te=F[L];Te!==le&&Te!==le+"--"||(Ee++&&In(re,F.slice(pe,L),P),pe=L)}return re}function rs(C,M){var P=M||{},F=P.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],B=C.FullPaths[0],ee=B,le=C.FileIndex[0],Z=1;Z<C.FullPaths.length;++Z)if(ee=C.FullPaths[Z].slice(B.length),le=C.FileIndex[Z],!(!le.size||!le.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var te=le.content,re=rt&&Buffer.isBuffer(te)?te.toString("binary"):A(te),pe=0,Ee=Math.min(1024,re.length),Te=0,xe=0;xe<=Ee;++xe)(Te=re.charCodeAt(xe))>=32&&Te<128&&++pe;var ke=pe>=Ee*4/5;L.push(F),L.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+ee),L.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),L.push("Content-Type: "+_m(le,ee)),L.push(""),L.push(ke?ht(re):Ge(re))}return L.push(F+`--\r
`),L.join(`\r
`)}function Ts(C){var M={};return S(M,C),M}function on(C,M,P,F){var L=F&&F.unsafe;L||S(C);var B=!L&&Oe.find(C,M);if(!B){var ee=C.FullPaths[0];M.slice(0,ee.length)==ee?ee=M:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+M).replace("//","/")),B={name:a(M),type:2},C.FileIndex.push(B),C.FullPaths.push(ee),L||Oe.utils.cfb_gc(C)}return B.content=P,B.size=P?P.length:0,F&&(F.CLSID&&(B.clsid=F.CLSID),F.mt&&(B.mt=F.mt),F.ct&&(B.ct=F.ct)),B}function ns(C,M){S(C);var P=Oe.find(C,M);if(P){for(var F=0;F<C.FileIndex.length;++F)if(C.FileIndex[F]==P)return C.FileIndex.splice(F,1),C.FullPaths.splice(F,1),!0}return!1}function NF(C,M,P){S(C);var F=Oe.find(C,M);if(F){for(var L=0;L<C.FileIndex.length;++L)if(C.FileIndex[L]==F)return C.FileIndex[L].name=a(P),C.FullPaths[L]=P,!0}return!1}function AF(C){N(C,!0)}return t.find=j,t.read=k,t.parse=f,t.write=ne,t.writeFile=K,t.utils={cfb_new:Ts,cfb_add:on,cfb_del:ns,cfb_mov:NF,cfb_gc:AF,ReadShift:sf,CheckField:tR,prep_blob:Mr,bconcat:Nr,use_zlib:R,_deflateRaw:Xe,_inflateRaw:Bd,consts:q},t}();function Pz(e){return typeof e=="string"?qp(e):Array.isArray(e)?nz(e):e}function Pd(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=qp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?xs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([Pz(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=co(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function jz(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function tr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function IE(e,t){for(var r=[],n=tr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Yp(e){for(var t=[],r=tr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Qp(e){for(var t=[],r=tr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Fz(e){for(var t=[],r=tr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var z0=new Date(1899,11,30,0,0,0);function br(e,t){var r=e.getTime(),n=z0.getTime()+(e.getTimezoneOffset()-z0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var O4=new Date,Oz=z0.getTime()+(O4.getTimezoneOffset()-z0.getTimezoneOffset())*6e4,DE=O4.getTimezoneOffset();function Jp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Oz),t.getTimezoneOffset()!==DE&&t.setTime(t.getTime()+(t.getTimezoneOffset()-DE)*6e4),t}function Iz(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var ME=new Date("2017-02-19T19:06:09.000Z"),I4=isNaN(ME.getFullYear())?new Date("2/19/17"):ME,Dz=I4.getFullYear()==2017;function Ft(e,t){var r=new Date(e);if(Dz)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(I4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function nl(e,t){if(rt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return xs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return xs(E4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return xs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return xs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Ot(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ot(e[r]));return t}function Jt(e,t){for(var r="";r.length<t;)r+=e;return r}function Ga(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Mz=["january","february","march","april","may","june","july","august","september","october","november","december"];function zc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Mz.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Lz=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function D4(e){return e?e.content&&e.type?nl(e.content,!0):e.data?Vu(e.data):e.asNodeBuffer&&rt?Vu(e.asNodeBuffer().toString("binary")):e.asBinary?Vu(e.asBinary()):e._data&&e._data.getContent?Vu(nl(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function M4(e){if(!e)return null;if(e.data)return kE(e.data);if(e.asNodeBuffer&&rt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?kE(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Bz(e){return e&&e.name.slice(-4)===".bin"?M4(e):D4(e)}function oa(e,t){for(var r=e.FullPaths||tr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function My(e,t){var r=oa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ur(e,t,r){if(!r)return Bz(My(e,t));if(!t)return null;try{return ur(e,t)}catch{return null}}function Hn(e,t,r){if(!r)return D4(My(e,t));if(!t)return null;try{return Hn(e,t)}catch{return null}}function Uz(e,t,r){return M4(My(e,t))}function LE(e){for(var t=e.FullPaths||tr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ze(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return rt?n=si(r):n=az(r),Oe.utils.cfb_add(e,t,n)}Oe.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ly(){return Oe.utils.cfb_new()}function L4(e,t){switch(t.type){case"base64":return Oe.read(e,{type:"base64"});case"binary":return Oe.read(e,{type:"binary"});case"buffer":case"array":return Oe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var lr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,$z=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,BE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Wz=/<[^>]*>/g,an=lr.match(BE)?BE:Wz,Vz=/<\w*:/,zz=/<(\/?)\w+:/;function ze(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match($z),o=0,l="",c=0,f="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ss(e){return e.replace(zz,"<$1")}var B4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},By=Yp(B4),ut=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return B4[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Uy=/[&<>'"]/g,Hz=/[\u0000-\u0008\u000b-\u001f]/g;function wt(e){var t=e+"";return t.replace(Uy,function(r){return By[r]}).replace(Hz,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function UE(e){return wt(e).replace(/ /g,"_x0020_")}var U4=/[\u0000-\u001f]/g;function $y(e){var t=e+"";return t.replace(Uy,function(r){return By[r]}).replace(/\n/g,"<br/>").replace(U4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Gz(e){var t=e+"";return t.replace(Uy,function(r){return By[r]}).replace(U4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var $E=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Kz(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Pt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function bg(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function WE(e){var t=Zi(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function VE(e){return si(e,"binary").toString("utf8")}var wh="foo bar baz",Et=rt&&(VE(wh)==bg(wh)&&VE||WE(wh)==bg(wh)&&WE)||bg,xs=rt?function(e){return si(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Zf=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),$4=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),qz=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Xz=/<\/?(?:vt:)?variant>/g,Yz=/<(?:vt:)([^>]*)>([\s\S]*)</;function zE(e,t){var r=ze(e),n=e.match(qz(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(Xz,"").match(Yz);i&&a.push({v:Et(i[2]),t:i[1]})}),a}var W4=/(^\s|\s$|\n)/;function Br(e,t){return"<"+e+(t.match(W4)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ed(e){return tr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function we(e,t,r){return"<"+e+(r!=null?ed(r):"")+(t!=null?(t.match(W4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Qz(e,t){switch(typeof e){case"string":var r=we("vt:lpwstr",wt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return we((e|0)==e?"vt:i4":"vt:r8",wt(String(e)));case"boolean":return we("vt:bool",e?"true":"false")}if(e instanceof Date)return we("vt:filetime",Sv(e));throw new Error("Unable to serialize "+e)}function Wy(e){if(rt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Et(co(Oy(e)));throw new Error("Bad input format: expected Buffer or string")}var td=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,wr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},wl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Un={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Jz(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Zz(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var HE=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},GE=rt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:si(t)})):HE(e)}:HE,KE=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode($s(e,a)));return n.join("").replace(vn,"")},Vy=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(vn,""):KE(e,t,r)}:KE,qE=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},V4=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):qE(e,t,r)}:qE,XE=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Wl(e,a)));return n.join("")},jd=rt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):XE(t,r,n)}:XE,z4=function(e,t){var r=$n(e,t);return r>0?jd(e,t+4,t+4+r-1):""},H4=z4,G4=function(e,t){var r=$n(e,t);return r>0?jd(e,t+4,t+4+r-1):""},K4=G4,q4=function(e,t){var r=2*$n(e,t);return r>0?jd(e,t+4,t+4+r-1):""},X4=q4,Y4=function(t,r){var n=$n(t,r);return n>0?Vy(t,r+4,r+4+n):""},Q4=Y4,J4=function(e,t){var r=$n(e,t);return r>0?jd(e,t+4,t+4+r):""},Z4=J4,eR=function(e,t){return Jz(e,t)},H0=eR,zy=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rt&&(H4=function(t,r){if(!Buffer.isBuffer(t))return z4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},K4=function(t,r){if(!Buffer.isBuffer(t))return G4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},X4=function(t,r){if(!Buffer.isBuffer(t))return q4(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Q4=function(t,r){if(!Buffer.isBuffer(t))return Y4(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Z4=function(t,r){if(!Buffer.isBuffer(t))return J4(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},H0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):eR(t,r)},zy=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Wl=function(e,t){return e[t]},$s=function(e,t){return e[t+1]*256+e[t]},eH=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},$n=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Eo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},tH=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function sf(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode($s(this,c)),c+=2;e*=2;break;case"utf8":r=jd(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Vy(this,this.l,this.l+e);break;case"wstr":return sf.call(this,e,"dbcs");case"lpstr-ansi":r=H4(this,this.l),e=4+$n(this,this.l);break;case"lpstr-cp":r=K4(this,this.l),e=4+$n(this,this.l);break;case"lpwstr":r=X4(this,this.l),e=4+2*$n(this,this.l);break;case"lpp4":e=4+$n(this,this.l),r=Q4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+$n(this,this.l),r=Z4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Wl(this,this.l+e++))!==0;)s.push(yh(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=$s(this,this.l+e))!==0;)s.push(yh(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Wl(this,c),this.l=c+1,o=sf.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(yh($s(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Wl(this,c),this.l=c+1,o=sf.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(yh(Wl(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Wl(this,this.l),this.l++,n;case 2:return n=(t==="i"?eH:$s)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Eo:tH)(this,this.l),this.l+=4,n):(a=$n(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=H0(this,this.l):a=H0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=V4(this,this.l,e);break}}return this.l+=e,r}var rH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},nH=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},aH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function sH(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)aH(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,rH(this,t,this.l);break;case 8:if(n=8,r==="f"){Zz(this,t,this.l);break}case 16:break;case-4:n=4,nH(this,t,this.l);break}return this.l+=n,this}function tR(e,t){var r=V4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Mr(e,t){e.l=t,e.read_shift=sf,e.chk=tR,e.write_shift=sH}function tn(e,t){e.l+=t}function oe(e){var t=Zi(e);return Mr(t,0),t}function ii(e,t,r){if(e){var n,a,s;Mr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=od[o]||od[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=l,t(f,c,o))return}}}function jn(){var e=[],t=rt?256:2048,r=function(c){var f=oe(c);return Mr(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),Nr(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function ue(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=od[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&zy(r)&&e.push(r)}}function of(e,t,r){var n=Ot(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function YE(e,t,r){var n=Ot(e);return n.s=of(n.s,t.s,r),n.e=of(n.e,t.s,r),n}function lf(e,t){if(e.cRel&&e.c<0)for(e=Ot(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ot(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=$e(e);return!e.cRel&&e.cRel!=null&&(r=lH(r)),!e.rRel&&e.rRel!=null&&(r=iH(r)),r}function Sg(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ht(e.s.c)+":"+(e.e.cRel?"":"$")+Ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+or(e.s.r)+":"+(e.e.rRel?"":"$")+or(e.e.r):lf(e.s,t.biff)+":"+lf(e.e,t.biff)}function Hy(e){return parseInt(oH(e),10)-1}function or(e){return""+(e+1)}function iH(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function oH(e){return e.replace(/\$(\d+)$/,"$1")}function Gy(e){for(var t=cH(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function lH(e){return e.replace(/^([A-Z])/,"$$$1")}function cH(e){return e.replace(/^\$([A-Z])/,"$1")}function uH(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Gt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function $e(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Fn(e){var t=e.indexOf(":");return t==-1?{s:Gt(e),e:Gt(e)}:{s:Gt(e.slice(0,t)),e:Gt(e.slice(t+1))}}function Qe(e,t){return typeof t>"u"||typeof t=="number"?Qe(e.s,e.e):(typeof e!="string"&&(e=$e(e)),typeof t!="string"&&(t=$e(t)),e==t?e:e+":"+t)}function ft(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function QE(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Sa(e.z,r?br(t):t)}catch{}try{return e.w=Sa((e.XF||{}).numFmtId||(r?14:0),r?br(t):t)}catch{return""+t}}function Zs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?oi[e.v]||e.v:t==null?QE(e,e.v):QE(e,t))}function uo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function rR(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Gt(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=ft(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},g=i+d,m=o+h;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Be[14],n.cellDates?(p.t="d",p.w=Sa(p.z,br(p.v))):(p.t="n",p.v=br(p.v),p.w=Sa(p.z,p.v))):p.t="s";if(a)s[g]||(s[g]=[]),s[g][m]&&s[g][m].z&&(p.z=s[g][m].z),s[g][m]=p;else{var x=$e({c:m,r:g});s[x]&&s[x].z&&(p.z=s[x].z),s[x]=p}}}return c.s.c<1e7&&(s["!ref"]=Qe(c)),s}function fu(e,t){return rR(null,e,t)}function fH(e){return e.read_shift(4,"i")}function Ka(e,t){return t||(t=oe(4)),t.write_shift(4,e),t}function Zr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ar(e,t){var r=!1;return t==null&&(r=!0,t=oe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function dH(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hH(e,t){return t||(t=oe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ky(e,t){var r=e.l,n=e.read_shift(1),a=Zr(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(dH(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function pH(e,t){var r=!1;return t==null&&(r=!0,t=oe(15+4*e.t.length)),t.write_shift(1,0),Ar(e.t,t),r?t.slice(0,t.l):t}var mH=Ky;function gH(e,t){var r=!1;return t==null&&(r=!0,t=oe(23+4*e.t.length)),t.write_shift(1,1),Ar(e.t,t),t.write_shift(4,1),hH({},t),r?t.slice(0,t.l):t}function ka(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function _l(e,t){return t==null&&(t=oe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function El(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bl(e,t){return t==null&&(t=oe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var xH=Zr,nR=Ar;function qy(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function G0(e,t){var r=!1;return t==null&&(r=!0,t=oe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var vH=Zr,kv=qy,Xy=G0;function Yy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?H0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Eo(t,0)>>2;return r?a/100:a}function aR(e,t){t==null&&(t=oe(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function sR(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function yH(e,t){return t||(t=oe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Sl=sR,du=yH;function Jr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function al(e,t){return(t||oe(8)).write_shift(8,e,"f")}function wH(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Uo[a];c&&(t.rgb=nd(c));break;case 2:t.rgb=nd([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function K0(e,t){if(t||(t=oe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function _H(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function EH(e,t){t||(t=oe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function iR(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function bH(e){return iR(e,1)}function SH(e){return iR(e,2)}var Qy=2,Cn=3,_h=11,JE=12,q0=19,Eh=64,kH=65,CH=71,TH=4108,NH=4126,kr=80,oR=81,AH=[kr,oR],Cv={1:{n:"CodePage",t:Qy},2:{n:"Category",t:kr},3:{n:"PresentationFormat",t:kr},4:{n:"ByteCount",t:Cn},5:{n:"LineCount",t:Cn},6:{n:"ParagraphCount",t:Cn},7:{n:"SlideCount",t:Cn},8:{n:"NoteCount",t:Cn},9:{n:"HiddenCount",t:Cn},10:{n:"MultimediaClipCount",t:Cn},11:{n:"ScaleCrop",t:_h},12:{n:"HeadingPairs",t:TH},13:{n:"TitlesOfParts",t:NH},14:{n:"Manager",t:kr},15:{n:"Company",t:kr},16:{n:"LinksUpToDate",t:_h},17:{n:"CharacterCount",t:Cn},19:{n:"SharedDoc",t:_h},22:{n:"HyperlinksChanged",t:_h},23:{n:"AppVersion",t:Cn,p:"version"},24:{n:"DigSig",t:kH},26:{n:"ContentType",t:kr},27:{n:"ContentStatus",t:kr},28:{n:"Language",t:kr},29:{n:"Version",t:kr},255:{},2147483648:{n:"Locale",t:q0},2147483651:{n:"Behavior",t:q0},1919054434:{}},Tv={1:{n:"CodePage",t:Qy},2:{n:"Title",t:kr},3:{n:"Subject",t:kr},4:{n:"Author",t:kr},5:{n:"Keywords",t:kr},6:{n:"Comments",t:kr},7:{n:"Template",t:kr},8:{n:"LastAuthor",t:kr},9:{n:"RevNumber",t:kr},10:{n:"EditTime",t:Eh},11:{n:"LastPrinted",t:Eh},12:{n:"CreatedDate",t:Eh},13:{n:"ModifiedDate",t:Eh},14:{n:"PageCount",t:Cn},15:{n:"WordCount",t:Cn},16:{n:"CharCount",t:Cn},17:{n:"Thumbnail",t:CH},18:{n:"Application",t:kr},19:{n:"DocSecurity",t:Cn},255:{},2147483648:{n:"Locale",t:q0},2147483651:{n:"Behavior",t:q0},1919054434:{}},ZE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},RH=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function PH(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var jH=PH([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uo=Ot(jH),oi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lR={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Nv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},bh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Jy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function FH(e){var t=Jy();if(!e||!e.match)return t;var r={};if((e.match(an)||[]).forEach(function(n){var a=ze(n);switch(a[0].replace(Vz,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Nv[a.ContentType]]!==void 0&&t[Nv[a.ContentType]].push(a.PartName);break}}),t.xmlns!==wr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function cR(e,t){var r=Fz(Nv),n=[],a;n[n.length]=lr,n[n.length]=we("Types",null,{xmlns:wr.CT,"xmlns:xsd":wr.xsd,"xmlns:xsi":wr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return we("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=we("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:bh[l][t.bookType]||bh[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(c){n[n.length]=we("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:bh[l][t.bookType]||bh[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=we("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var nt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function rd(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function cf(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(an)||[]).forEach(function(a){var s=ze(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Hu(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function mc(e){var t=[lr,we("Relationships",null,{xmlns:wr.RELS})];return tr(e["!id"]).forEach(function(r){t[t.length]=we("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function yt(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[nt.HLINK,nt.XPATH,nt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var OH="application/vnd.oasis.opendocument.spreadsheet";function IH(e,t){for(var r=Wy(e),n,a;n=td.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ze(n[0],!1),a.path=="/"&&a.type!==OH)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function DH(e){var t=[lr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function eb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function MH(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function LH(e){var t=[lr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(eb(e[r][0],e[r][1])),t.push(MH("",e[r][0]));return t.push(eb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function uR(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+U0.version+"</meta:generator></office:meta></office:document-meta>"}var wa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],BH=function(){for(var e=new Array(wa.length),t=0;t<wa.length;++t){var r=wa[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function fR(e){var t={};e=Et(e);for(var r=0;r<wa.length;++r){var n=wa[r],a=e.match(BH[r]);a!=null&&a.length>0&&(t[n[1]]=ut(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Ft(t[n[1]]))}return t}function kg(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=wt(t),n[n.length]=r?we(e,t,r):Br(e,t))}function dR(e,t){var r=t||{},n=[lr,we("cp:coreProperties",null,{"xmlns:cp":wr.CORE_PROPS,"xmlns:dc":wr.dc,"xmlns:dcterms":wr.dcterms,"xmlns:dcmitype":wr.dcmitype,"xmlns:xsi":wr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&kg("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Sv(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&kg("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Sv(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=wa.length;++s){var i=wa[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&kg(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var $o=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],hR=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function pR(e,t,r,n){var a=[];if(typeof e=="string")a=zE(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?zE(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function UH(e,t,r){var n={};return t||(t={}),e=Et(e),$o.forEach(function(a){var s=(e.match(Zf(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=ut(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&pR(n.HeadingPairs,n.TitlesOfParts,t,r),t}function mR(e){var t=[],r=we;return e||(e={}),e.Application="SheetJS",t[t.length]=lr,t[t.length]=we("Properties",null,{xmlns:wr.EXT_PROPS,"xmlns:vt":wr.vt}),$o.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=wt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+wt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var $H=/<[^>]+>[^<]*/g;function WH(e,t){var r={},n="",a=e.match($H);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=ze(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ut(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ut(f);break;case"bool":r[n]=Pt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Ft(f);break;case"cy":case"error":r[n]=ut(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function gR(e){var t=[lr,we("Properties",null,{xmlns:wr.CUST_PROPS,"xmlns:vt":wr.vt})];if(!e)return t.join("");var r=1;return tr(e).forEach(function(a){++r,t[t.length]=we("property",Qz(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:wt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Av={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Cg;function VH(e,t,r){Cg||(Cg=Yp(Av)),t=Cg[t]||t,e[t]=r}function zH(e,t){var r=[];return tr(Av).map(function(n){for(var a=0;a<wa.length;++a)if(wa[a][1]==n)return wa[a];for(a=0;a<$o.length;++a)if($o[a][1]==n)return $o[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Br(Av[n[1]]||n[1],a))}}),we("DocumentProperties",r.join(""),{xmlns:Un.o})}function HH(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&tr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<wa.length;++i)if(s==wa[i][1])return;for(i=0;i<$o.length;++i)if(s==$o[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(we(UE(s),o,{"dt:dt":l}))}}),t&&tr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(we(UE(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Un.o+'">'+a.join("")+"</"+n+">"}function Zy(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function GH(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=oe(8);return i.write_shift(4,n),i.write_shift(4,a),i}function xR(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function vR(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function yR(e,t,r){return t===31?vR(e):xR(e,t,r)}function Rv(e,t,r){return yR(e,t,r===!1?0:4)}function KH(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return yR(e,t,0)}function qH(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(vn,""),e.l-a&2&&(e.l+=2)}return r}function XH(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(vn,"");return r}function YH(e){var t=e.l,r=X0(e,oR);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=X0(e,Cn);return[r,n]}function QH(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(YH(e));return r}function tb(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(vn,"").replace(zu,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function wR(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function JH(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function X0(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==JE&&n!==t&&AH.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===JE?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return xR(e,n,4).replace(vn,"");case 31:return vR(e);case 64:return Zy(e);case 65:return wR(e);case 71:return JH(e);case 80:return Rv(e,n,!s.raw).replace(vn,"");case 81:return KH(e,n).replace(vn,"");case 4108:return QH(e);case 4126:case 4127:return n==4127?qH(e):XH(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function rb(e,t){var r=oe(4),n=oe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=oe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=GH(t);break;case 31:case 80:for(n=oe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Nr([r,n])}function nb(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(y,w){return y[1]-w[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[s[i][0]];if(h[g.n]=X0(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:$a(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(s[i][0]===1){if(o=h.CodePage=X0(e,Qy),$a(o),l!==-1){var m=e.l;e.l=s[l][1],c=tb(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=tb(e,o)}else{var x=c[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=wR(e);break;case 30:e.l+=4,v=Rv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Rv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=nr(e,4);break;case 64:e.l+=4,v=Ft(Zy(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=v}}return e.l=r+n,h}var _R=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ZH(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function ab(e,t,r){var n=oe(8),a=[],s=[],i=8,o=0,l=oe(8),c=oe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),a.push(c),i+=8+l.length,!t){c=oe(8),c.write_shift(4,0),a.unshift(c);var f=[oe(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=oe(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=Nr(f),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(_R.indexOf(e[o][0])>-1||hR.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var g=r[p];if(g.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}l=rb(g.t,h)}else{var x=ZH(h);x==-1&&(x=31,h=String(h)),l=rb(x,h)}s.push(l),c=oe(8),c.write_shift(4,t?p:2+o),a.push(c),i+=8+l.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),Nr([n].concat(a).concat(s))}function sb(e,t,r){var n=e.content;if(!n)return{};Mr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Oe.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=nb(n,t),h={SystemIdentifier:c};for(var p in d)h[p]=d[p];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=nb(n,null)}catch{}for(p in g)h[p]=g[p];return h.FMTID=[s,i],h}function ib(e,t,r,n,a,s){var i=oe(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Oe.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=ab(e,r,n);if(o.push(l),a){var c=ab(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(c)}return Nr(o)}function hi(e,t){return e.read_shift(t),null}function eG(e,t){t||(t=oe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function tG(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function nr(e,t){return e.read_shift(t)===1}function hn(e,t){return t||(t=oe(2)),t.write_shift(2,+!!e),t}function fr(e){return e.read_shift(2,"u")}function ca(e,t){return t||(t=oe(2)),t.write_shift(2,e),t}function ER(e,t){return tG(e,t,fr)}function rG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function bR(e,t,r){return r||(r=oe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Fd(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function nG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=f,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function aG(e){var t=e.t||"",r=oe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=oe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Nr(a)}function sl(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Od(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):sl(e,n,r)}function kl(e,t,r){if(r.biff>5)return Od(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function SR(e,t,r){return r||(r=oe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function sG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function iG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(vn,"");return n&&(e.l+=24),a}function oG(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(vn,"");return r+i}function lG(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return iG(e);case"0303000000000000c000000000000046":return oG(e);default:throw new Error("Unsupported Moniker "+r)}}function Sh(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(vn,""):"";return r}function ob(e,t){t||(t=oe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function cG(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",f,d;a&16&&(s=Sh(e,r-e.l)),a&128&&(i=Sh(e,r-e.l)),(a&257)===257&&(o=Sh(e,r-e.l)),(a&257)===1&&(l=lG(e,r-e.l)),a&8&&(c=Sh(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=Zy(e)),e.l=r;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return f&&(p.guid=f),d&&(p.time=d),s&&(p.Tooltip=s),p}function uG(e){var t=oe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),ob(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&ob(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function kR(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function CR(e,t){var r=kR(e);return r[3]=0,r}function ks(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function il(e,t,r,n){return n||(n=oe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function fG(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function dG(e,t,r){return t===0?"":kl(e,t,r)}function hG(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function TR(e){var t=e.read_shift(2),r=Yy(e);return[t,r]}function pG(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Fd(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Zp(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function NR(e,t){return t||(t=oe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function AR(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var mG=AR;function RR(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function gG(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function xG(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Kr(e){e.l+=2,e.l+=e.read_shift(2)}var vG={0:Kr,4:Kr,5:Kr,6:Kr,7:xG,8:Kr,9:Kr,10:Kr,11:Kr,12:Kr,13:gG,14:Kr,15:Kr,16:Kr,17:Kr,18:Kr,19:Kr,20:Kr,21:RR};function yG(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(vG[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function kh(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function ew(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=oe(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function wG(e,t){return t===0||e.read_shift(2),1200}function _G(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=kl(e,0,r);return e.read_shift(t+n-e.l),a}function EG(e,t){var r=!t||t.biff==8,n=oe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function bG(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function SG(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Fd(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function kG(e,t){var r=!t||t.biff>=8?2:1,n=oe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function CG(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(nG(e));return s.Count=n,s.Unique=a,s}function TG(e,t){var r=oe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=aG(e[a]);var s=Nr([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function NG(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function AG(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function RG(e){var t=fG(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function PG(e){return e.read_shift(2),e.read_shift(4)}function lb(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function jG(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function FG(){var e=oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function OG(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function IG(e){var t=oe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function DG(){}function MG(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Fd(e,0,r),n}function LG(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=oe(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function BG(e){var t=ks(e);return t.isst=e.read_shift(4),t}function UG(e,t,r,n){var a=oe(10);return il(e,t,n,a),a.write_shift(4,r),a}function $G(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=ks(e);r.biff==2&&e.l++;var s=Od(e,n-e.l,r);return a.val=s,a}function WG(e,t,r,n,a){var s=!a||a.biff==8,i=oe(8+ +s+(1+s)*r.length);return il(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function VG(e,t,r){var n=e.read_shift(2),a=kl(e,0,r);return[n,a]}function zG(e,t,r,n){var a=r&&r.biff==5;n||(n=oe(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var HG=kl;function cb(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function GG(e,t){var r=t.biff==8||!t.biff?4:2,n=oe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function KG(e){var t=e.read_shift(2),r=e.read_shift(2),n=TR(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function qG(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(TR(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function XG(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function YG(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=RH[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function QG(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=YG(e,t,n.fStyle,r),n}function ub(e,t,r,n){var a=r&&r.biff==5;n||(n=oe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function JG(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ZG(e){var t=oe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function fb(e,t,r){var n=ks(e);(r.biff==2||t==9)&&++e.l;var a=rG(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function eK(e,t,r,n,a,s){var i=oe(8);return il(e,t,n,i),bR(r,s,i),i}function tK(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ks(e),a=Jr(e);return n.val=a,n}function rK(e,t,r,n){var a=oe(14);return il(e,t,n,a),al(r,a),a}var db=dG;function nK(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=sl(e,s),o=[];n>e.l;)o.push(Od(e));return[s,a,i,o]}function hb(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=pG(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var aK=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function pb(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=sl(e,i,r);a&32&&(c=aK[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:yQ(e,f,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function PR(e,t,r){if(r.biff<8)return sK(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(hG(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function sK(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Fd(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function iK(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=sl(e,n,r),i=sl(e,a,r);return[s,i]}function oK(e,t,r){var n=AR(e);e.l++;var a=e.read_shift(1);return t-=8,[wQ(e,t,r),a,n]}function mb(e,t,r){var n=mG(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,xQ(e,t,r)]}function lK(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function cK(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=kl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function uK(e,t,r){return cK(e,t,r)}function fK(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Zp(e));return r}function dK(e){var t=oe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)NR(e[r],t);return t}function hK(e,t,r){if(r&&r.biff<8)return mK(e,t,r);var n=RR(e),a=yG(e,t-22,n[1]);return{cmo:n,ft:a}}var pK={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function mK(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((pK[n]||tn)(e,t,r)),{cmo:[a,n,s],ft:i}}function gK(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=sG(e,6,r);var o=e.read_shift(2);e.read_shift(2),fr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],d=sl(e,e.lens[c+1]-e.lens[c]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function xK(e,t){var r=Zp(e);e.l+=16;var n=cG(e,t-24);return[r,n]}function vK(e){var t=oe(24),r=Gt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Nr([t,uG(e[1])])}function yK(e,t){e.read_shift(2);var r=Zp(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(vn,""),[r,n]}function wK(e){var t=e[1].Tooltip,r=oe(10+2*(t.length+1));r.write_shift(2,2048);var n=Gt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function _K(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ZE[r]||r,r=e.read_shift(2),t[1]=ZE[r]||r,t}function EK(e){return e||(e=oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function bK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(CR(e));return r}function SK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(CR(e));return r}function kK(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function jR(e,t,r){if(!r.cellStyles)return tn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function CK(e,t){var r=oe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function TK(e,t){var r={};return t<32||(e.l+=16,r.header=Jr(e),r.footer=Jr(e),e.l+=2),r}function NK(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function AK(e){for(var t=oe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var RK=ks,PK=ER,jK=Od;function FK(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function OK(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ks(e);++e.l;var a=kl(e,t-7,r);return n.t="str",n.val=a,n}function IK(e){var t=ks(e);++e.l;var r=Jr(e);return t.t="n",t.val=r,t}function DK(e,t,r){var n=oe(15);return Ld(n,e,t),n.write_shift(8,r,"f"),n}function MK(e){var t=ks(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function LK(e,t,r){var n=oe(9);return Ld(n,e,t),n.write_shift(2,r),n}function BK(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function UK(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function $K(e,t,r){var n=e.l+t,a=ks(e),s=e.read_shift(2),i=sl(e,s,r);return e.l=n,a.t="str",a.val=i,a}var WK=[2,3,48,49,131,139,140,245],Pv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Yp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=Zi(1);switch(l.type){case"base64":f=zn(Yn(o));break;case"binary":f=zn(o);break;case"buffer":case"array":f=o;break}Mr(f,0);var d=f.read_shift(1),h=!!(d&136),p=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,x=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(x=f.read_shift(2));var v=f.read_shift(2),y=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var w=[],E={},b=Math.min(f.length,d==2?521:x-10-(p?264:0)),k=g?32:11;f.l<b&&f[f.l]!=13;)switch(E={},E.name=Yf.utils.decode(y,f.slice(f.l,f.l+k)).replace(/[\u0000\r\n].*$/g,""),f.l+=k,E.type=String.fromCharCode(f.read_shift(1)),d!=2&&!g&&(E.offset=f.read_shift(4)),E.len=f.read_shift(1),d==2&&(E.offset=f.read_shift(2)),E.dec=f.read_shift(1),E.name.length&&w.push(E),d!=2&&(f.l+=g?13:14),E.type){case"B":(!p||E.len!=8)&&l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(f[f.l]!==13&&(f.l=x-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=x;var S=0,T=0;for(c[0]=[],T=0;T!=w.length;++T)c[0][T]=w[T].name;for(;m-- >0;){if(f[f.l]===42){f.l+=v;continue}for(++f.l,c[++S]=[],T=0,T=0;T!=w.length;++T){var N=f.slice(f.l,f.l+w[T].len);f.l+=w[T].len,Mr(N,0);var O=Yf.utils.decode(y,N);switch(w[T].type){case"C":O.trim().length&&(c[S][T]=O.replace(/\s+$/,""));break;case"D":O.length===8?c[S][T]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):c[S][T]=O;break;case"F":c[S][T]=parseFloat(O.trim());break;case"+":case"I":c[S][T]=g?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":c[S][T]=!0;break;case"N":case"F":c[S][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[S][T]="##MEMO##"+(g?parseInt(O.trim(),10):N.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(c[S][T]=+O||0);break;case"@":c[S][T]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":c[S][T]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":c[S][T]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[S][T]=-N.read_shift(-8,"f");break;case"B":if(p&&w[T].len==8){c[S][T]=N.read_shift(8,"f");break}case"G":case"P":N.l+=w[T].len;break;case"0":if(w[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[T].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=fu(r(o,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function a(o,l){try{return uo(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&$a(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=jn(),d=J0(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),g=o["!cols"]||[],m=0,x=0,v=0,y=1;for(m=0;m<h.length;++m){if(((g[m]||{}).DBF||{}).name){h[m]=g[m].DBF.name,++v;continue}if(h[m]!=null){if(++v,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(x=0;x<1024;++x)if(h.indexOf(h[m]+"_"+x)==-1){h[m]+="_"+x;break}}}}var w=ft(o["!ref"]),E=[],b=[],k=[];for(m=0;m<=w.e.c-w.s.c;++m){var S="",T="",N=0,O=[];for(x=0;x<p.length;++x)p[x][m]!=null&&O.push(p[x][m]);if(O.length==0||h[m]==null){E[m]="?";continue}for(x=0;x<O.length;++x){switch(typeof O[x]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=O[x]instanceof Date?"D":"C";break;default:T="C"}N=Math.max(N,String(O[x]).length),S=S&&S!=T?"C":T}N>250&&(N=250),T=((g[m]||{}).DBF||{}).type,T=="C"&&g[m].DBF.len>N&&(N=g[m].DBF.len),S=="B"&&T=="N"&&(S="N",k[m]=g[m].DBF.dec,N=g[m].DBF.len),b[m]=S=="C"||T=="N"?N:s[S]||0,y+=b[m],E[m]=S}var j=f.next(32);for(j.write_shift(4,318902576),j.write_shift(4,p.length),j.write_shift(2,296+32*v),j.write_shift(2,y),m=0;m<4;++m)j.write_shift(4,0);for(j.write_shift(4,0|(+t[_4]||3)<<8),m=0,x=0;m<h.length;++m)if(h[m]!=null){var D=f.next(32),Y=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,Y,"sbcs"),D.write_shift(1,E[m]=="?"?"C":E[m],"sbcs"),D.write_shift(4,x),D.write_shift(1,b[m]||s[E[m]]||0),D.write_shift(1,k[m]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),x+=b[m]||s[E[m]]||0}var Q=f.next(264);for(Q.write_shift(4,13),m=0;m<65;++m)Q.write_shift(4,0);for(m=0;m<p.length;++m){var G=f.next(y);for(G.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(E[x]){case"L":G.write_shift(1,p[m][x]==null?63:p[m][x]?84:70);break;case"B":G.write_shift(8,p[m][x]||0,"f");break;case"N":var X="0";for(typeof p[m][x]=="number"&&(X=p[m][x].toFixed(k[x]||0)),v=0;v<b[x]-X.length;++v)G.write_shift(1,32);G.write_shift(1,X,"sbcs");break;case"D":p[m][x]?(G.write_shift(4,("0000"+p[m][x].getFullYear()).slice(-4),"sbcs"),G.write_shift(2,("00"+(p[m][x].getMonth()+1)).slice(-2),"sbcs"),G.write_shift(2,("00"+p[m][x].getDate()).slice(-2),"sbcs")):G.write_shift(8,"00000000","sbcs");break;case"C":var q=String(p[m][x]!=null?p[m][x]:"").slice(0,b[x]);for(G.write_shift(1,q,"sbcs"),v=0;v<b[x]-q.length;++v)G.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),FR=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+tr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var g=e[p];return typeof g=="number"?CE(g):g},n=function(h,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?h:CE(m)};e["|"]=254;function a(h,p){switch(p.type){case"base64":return s(Yn(h),p);case"binary":return s(h,p);case"buffer":return s(rt&&Buffer.isBuffer(h)?h.toString("binary"):co(h),p);case"array":return s(nl(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var g=h.split(/[\n\r]+/),m=-1,x=-1,v=0,y=0,w=[],E=[],b=null,k={},S=[],T=[],N=[],O=0,j;for(+p.codepage>=0&&$a(+p.codepage);v!==g.length;++v){O=0;var D=g[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Y=D.replace(/;;/g,"\0").split(";").map(function(V){return V.replace(/\u0000/g,";")}),Q=Y[0],G;if(D.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&E.push(D.slice(3).replace(/;;/g,";"));break;case"C":var X=!1,q=!1,K=!1,A=!1,ne=-1,ce=-1;for(y=1;y<Y.length;++y)switch(Y[y].charAt(0)){case"A":break;case"X":x=parseInt(Y[y].slice(1))-1,q=!0;break;case"Y":for(m=parseInt(Y[y].slice(1))-1,q||(x=0),j=w.length;j<=m;++j)w[j]=[];break;case"K":G=Y[y].slice(1),G.charAt(0)==='"'?G=G.slice(1,G.length-1):G==="TRUE"?G=!0:G==="FALSE"?G=!1:isNaN(Ga(G))?isNaN(zc(G).getDate())||(G=Ft(G)):(G=Ga(G),b!==null&&cu(b)&&(G=Jp(G))),X=!0;break;case"E":A=!0;var R=gc(Y[y].slice(1),{r:m,c:x});w[m][x]=[w[m][x],R];break;case"S":K=!0,w[m][x]=[w[m][x],"S5S"];break;case"G":break;case"R":ne=parseInt(Y[y].slice(1))-1;break;case"C":ce=parseInt(Y[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}if(X&&(w[m][x]&&w[m][x].length==2?w[m][x][0]=G:w[m][x]=G,b=null),K){if(A)throw new Error("SYLK shared formula cannot have own formula");var z=ne>-1&&w[ne][ce];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");w[m][x][1]=QR(z[1],{r:m-ne,c:x-ce})}break;case"F":var U=0;for(y=1;y<Y.length;++y)switch(Y[y].charAt(0)){case"X":x=parseInt(Y[y].slice(1))-1,++U;break;case"Y":for(m=parseInt(Y[y].slice(1))-1,j=w.length;j<=m;++j)w[j]=[];break;case"M":O=parseInt(Y[y].slice(1))/20;break;case"F":break;case"G":break;case"P":b=E[parseInt(Y[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=Y[y].slice(1).split(" "),j=parseInt(N[0],10);j<=parseInt(N[1],10);++j)O=parseInt(N[2],10),T[j-1]=O===0?{hidden:!0}:{wch:O},eo(T[j-1]);break;case"C":x=parseInt(Y[y].slice(1))-1,T[x]||(T[x]={});break;case"R":m=parseInt(Y[y].slice(1))-1,S[m]||(S[m]={}),O>0?(S[m].hpt=O,S[m].hpx=Gc(O)):O===0&&(S[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}U<1&&(b=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+D)}}return S.length>0&&(k["!rows"]=S),T.length>0&&(k["!cols"]=T),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,k]}function i(h,p){var g=a(h,p),m=g[0],x=g[1],v=fu(m,p);return tr(x).forEach(function(y){v[y]=x[y]}),v}function o(h,p){return uo(i(h,p),p)}function l(h,p,g,m){var x="C;Y"+(g+1)+";X"+(m+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+iw(h.f,{r:g,c:m}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function c(h,p){p.forEach(function(g,m){var x="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=ad(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=sd(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function f(h,p){p.forEach(function(g,m){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*id(g.hpx)+";"),x.length>2&&h.push(x+"R"+(m+1))})}function d(h,p){var g=["ID;PWXL;N;E"],m=[],x=ft(h["!ref"]),v,y=Array.isArray(h),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&c(g,h["!cols"]),h["!rows"]&&f(g,h["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var E=x.s.r;E<=x.e.r;++E)for(var b=x.s.c;b<=x.e.c;++b){var k=$e({r:E,c:b});v=y?(h[E]||[])[b]:h[k],!(!v||v.v==null&&(!v.f||v.F))&&m.push(l(v,h,E,b))}return g.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),OR=function(){function e(s,i){switch(i.type){case"base64":return t(Yn(s),i);case"binary":return t(s,i);case"buffer":return t(rt&&Buffer.isBuffer(s)?s.toString("binary"):co(s),i);case"array":return t(nl(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[f].trim().split(","),p=h[0],g=h[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){d[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][c]=!0:m==="FALSE"?d[l][c]=!1:isNaN(Ga(g))?isNaN(zc(g).getDate())?d[l][c]=g:d[l][c]=Ft(g):d[l][c]=Ga(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return fu(e(s,i),i)}function n(s,i){return uo(r(s,i),i)}var a=function(){var s=function(l,c,f,d,h){l.push(c),l.push(f+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,f,d){l.push(c+","+f),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],f=ft(l["!ref"]),d,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(c,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var m=$e({r:p,c:g});if(d=h?(l[p]||[])[g]:l[m],!d){i(c,1,0,"");continue}switch(d.t){case"n":var x=d.w;!x&&d.v!=null&&(x=d.v),x==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,x,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Sa(d.z||Be[14],br(Ft(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var v=`\r
`,y=c.join(v);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),IR=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),g=-1,m=-1,x=0,v=[];x!==p.length;++x){var y=p[x].trim().split(":");if(y[0]==="cell"){var w=Gt(y[1]);if(v.length<=w.r)for(g=v.length;g<=w.r;++g)v[g]||(v[g]=[]);switch(g=w.r,m=w.c,y[2]){case"t":v[g][m]=e(y[3]);break;case"v":v[g][m]=+y[3];break;case"vtf":var E=y[y.length-1];case"vtc":switch(y[3]){case"nl":v[g][m]=!!+y[4];break;default:v[g][m]=+y[4];break}y[2]=="vtf"&&(v[g][m]=[v[g][m],E])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(d,h){return fu(r(d,h),h)}function a(d,h){return uo(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],g,m="",x=Fn(d["!ref"]),v=Array.isArray(d),y=x.s.r;y<=x.e.r;++y)for(var w=x.s.c;w<=x.e.c;++w)if(m=$e({r:y,c:w}),g=v?(d[y]||[])[w]:d[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var E=br(Ft(g.v));p[2]="vtc",p[3]="nd",p[4]=""+E,p[5]=g.w||Sa(g.z||Be[14],E);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[s,i,o,i,c(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Hc=function(){function e(f,d,h,p,g){g.raw?d[h][p]=f:f===""||(f==="TRUE"?d[h][p]=!0:f==="FALSE"?d[h][p]=!1:isNaN(Ga(f))?isNaN(zc(f).getDate())?d[h][p]=f:d[h][p]=Ft(f):d[h][p]=Ga(f))}function t(f,d){var h=d||{},p=[];if(!f||f.length===0)return p;for(var g=f.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var x=10,v=0,y=0;y<=m;++y)v=g[y].indexOf(" "),v==-1?v=g[y].length:v++,x=Math.max(x,v);for(y=0;y<=m;++y){p[y]=[];var w=0;for(e(g[y].slice(0,x).trim(),p,y,w,h),w=1;w<=(g[y].length-x)/10+1;++w)e(g[y].slice(x+(w-1)*10,x+w*10).trim(),p,y,w,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,p=0,g=0;p<f.length;++p)(g=f.charCodeAt(p))==34?h=!h:!h&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p]);if(!g.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p])}return g.sort(function(m,x){return m[0]-x[0]||n[m[1]]-n[x[1]]}),r[g.pop()[1]]||44}function s(f,d){var h=d||{},p="",g=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=a(f.slice(0,1024)):h&&h.FS?p=h.FS:p=a(f.slice(0,1024));var x=0,v=0,y=0,w=0,E=0,b=p.charCodeAt(0),k=!1,S=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var N=h.dateNF!=null?Nz(h.dateNF):null;function O(){var j=f.slice(w,E),D={};if(j.charAt(0)=='"'&&j.charAt(j.length-1)=='"'&&(j=j.slice(1,-1).replace(/""/g,'"')),j.length===0)D.t="z";else if(h.raw)D.t="s",D.v=j;else if(j.trim().length===0)D.t="s",D.v=j;else if(j.charCodeAt(0)==61)j.charCodeAt(1)==34&&j.charCodeAt(j.length-1)==34?(D.t="s",D.v=j.slice(2,-1).replace(/""/g,'"')):nY(j)?(D.t="n",D.f=j.slice(1)):(D.t="s",D.v=j);else if(j=="TRUE")D.t="b",D.v=!0;else if(j=="FALSE")D.t="b",D.v=!1;else if(!isNaN(y=Ga(j)))D.t="n",h.cellText!==!1&&(D.w=j),D.v=y;else if(!isNaN(zc(j).getDate())||N&&j.match(N)){D.z=h.dateNF||Be[14];var Y=0;N&&j.match(N)&&(j=Az(j,h.dateNF,j.match(N)||[]),Y=1),h.cellDates?(D.t="d",D.v=Ft(j,Y)):(D.t="n",D.v=br(Ft(j,Y))),h.cellText!==!1&&(D.w=Sa(D.z,D.v instanceof Date?br(D.v):D.v)),h.cellNF||delete D.z}else D.t="s",D.v=j;if(D.t=="z"||(h.dense?(g[x]||(g[x]=[]),g[x][v]=D):g[$e({c:v,r:x})]=D),w=E+1,T=f.charCodeAt(w),m.e.c<v&&(m.e.c=v),m.e.r<x&&(m.e.r=x),S==b)++v;else if(v=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;E<f.length;++E)switch(S=f.charCodeAt(E)){case 34:T===34&&(k=!k);break;case b:case 10:case 13:if(!k&&O())break e;break}return E-w>0&&O(),g["!ref"]=Qe(m),g}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):fu(t(f,d),d)}function o(f,d){var h="",p=d.type=="string"?[0,0,0,0]:pw(f,d);switch(d.type){case"base64":h=Yn(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof Yf<"u"||(h=rt&&Buffer.isBuffer(f)?f.toString("binary"):co(f));break;case"array":h=nl(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Et(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=Et(h):d.type=="binary"&&typeof Yf<"u",h.slice(0,19)=="socialcalc:version:"?IR.to_sheet(d.type=="string"?h:Et(h),d):i(h,d)}function l(f,d){return uo(o(f,d),d)}function c(f){for(var d=[],h=ft(f["!ref"]),p,g=Array.isArray(f),m=h.s.r;m<=h.e.r;++m){for(var x=[],v=h.s.c;v<=h.e.c;++v){var y=$e({r:m,c:v});if(p=g?(f[m]||[])[v]:f[y],!p||p.v==null){x.push("          ");continue}for(var w=(p.w||(Zs(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";x.push(w+(v===0?" ":""))}d.push(x.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function VK(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=FR.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Hc.to_workbook(e,t)}}var Wo=function(){function e(R,z,U){if(R){Mr(R,R.l||0);for(var V=U.Enum||ne;R.l<R.length;){var J=R.read_shift(2),W=V[J]||V[65535],se=R.read_shift(2),ie=R.l+se,ae=W.f&&W.f(R,se,U);if(R.l=ie,z(ae,W,J))return}}}function t(R,z){switch(z.type){case"base64":return r(zn(Yn(R)),z);case"binary":return r(zn(R),z);case"buffer":case"array":return r(R,z)}throw"Unsupported type "+z.type}function r(R,z){if(!R)return R;var U=z||{},V=U.dense?[]:{},J="Sheet1",W="",se=0,ie={},ae=[],be=[],I={s:{r:0,c:0},e:{r:0,c:0}},He=U.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)U.Enum=ne,e(R,function(ve,xt,fe){switch(fe){case 0:U.vers=ve,ve>=4096&&(U.qpro=!0);break;case 6:I=ve;break;case 204:ve&&(W=ve);break;case 222:W=ve;break;case 15:case 51:U.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:fe==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=U.dateNF||Be[14],U.cellDates&&(ve[1].t="d",ve[1].v=Jp(ve[1].v))),U.qpro&&ve[3]>se&&(V["!ref"]=Qe(I),ie[J]=V,ae.push(J),V=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},se=ve[3],J=W||"Sheet"+(se+1),W="");var Re=U.dense?(V[ve[0].r]||[])[ve[0].c]:V[$e(ve[0])];if(Re){Re.t=ve[1].t,Re.v=ve[1].v,ve[1].z!=null&&(Re.z=ve[1].z),ve[1].f!=null&&(Re.f=ve[1].f);break}U.dense?(V[ve[0].r]||(V[ve[0].r]=[]),V[ve[0].r][ve[0].c]=ve[1]):V[$e(ve[0])]=ve[1];break}},U);else if(R[2]==26||R[2]==14)U.Enum=ce,R[2]==14&&(U.qpro=!0,R.l=0),e(R,function(ve,xt,fe){switch(fe){case 204:J=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>se&&(V["!ref"]=Qe(I),ie[J]=V,ae.push(J),V=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},se=ve[3],J="Sheet"+(se+1)),He>0&&ve[0].r>=He)break;U.dense?(V[ve[0].r]||(V[ve[0].r]=[]),V[ve[0].r][ve[0].c]=ve[1]):V[$e(ve[0])]=ve[1],I.e.c<ve[0].c&&(I.e.c=ve[0].c),I.e.r<ve[0].r&&(I.e.r=ve[0].r);break;case 27:ve[14e3]&&(be[ve[14e3][0]]=ve[14e3][1]);break;case 1537:be[ve[0]]=ve[1],ve[0]==se&&(J=ve[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(V["!ref"]=Qe(I),ie[W||J]=V,ae.push(W||J),!be.length)return{SheetNames:ae,Sheets:ie};for(var Ue={},at=[],Ve=0;Ve<be.length;++Ve)ie[ae[Ve]]?(at.push(be[Ve]||ae[Ve]),Ue[be[Ve]]=ie[be[Ve]]||ie[ae[Ve]]):(at.push(be[Ve]),Ue[be[Ve]]={"!ref":"A1"});return{SheetNames:at,Sheets:Ue}}function n(R,z){var U=z||{};if(+U.codepage>=0&&$a(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var V=jn(),J=ft(R["!ref"]),W=Array.isArray(R),se=[];_e(V,0,s(1030)),_e(V,6,l(J));for(var ie=Math.min(J.e.r,8191),ae=J.s.r;ae<=ie;++ae)for(var be=or(ae),I=J.s.c;I<=J.e.c;++I){ae===J.s.r&&(se[I]=Ht(I));var He=se[I]+be,Ue=W?(R[ae]||[])[I]:R[He];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")(Ue.v|0)==Ue.v&&Ue.v>=-32768&&Ue.v<=32767?_e(V,13,p(ae,I,Ue.v)):_e(V,14,m(ae,I,Ue.v));else{var at=Zs(Ue);_e(V,15,d(ae,I,at.slice(0,239)))}}return _e(V,1),V.end()}function a(R,z){var U=z||{};if(+U.codepage>=0&&$a(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var V=jn();_e(V,0,i(R));for(var J=0,W=0;J<R.SheetNames.length;++J)(R.Sheets[R.SheetNames[J]]||{})["!ref"]&&_e(V,27,A(R.SheetNames[J],W++));var se=0;for(J=0;J<R.SheetNames.length;++J){var ie=R.Sheets[R.SheetNames[J]];if(!(!ie||!ie["!ref"])){for(var ae=ft(ie["!ref"]),be=Array.isArray(ie),I=[],He=Math.min(ae.e.r,8191),Ue=ae.s.r;Ue<=He;++Ue)for(var at=or(Ue),Ve=ae.s.c;Ve<=ae.e.c;++Ve){Ue===ae.s.r&&(I[Ve]=Ht(Ve));var ve=I[Ve]+at,xt=be?(ie[Ue]||[])[Ve]:ie[ve];if(!(!xt||xt.t=="z"))if(xt.t=="n")_e(V,23,O(Ue,Ve,se,xt.v));else{var fe=Zs(xt);_e(V,22,S(Ue,Ve,se,fe.slice(0,239)))}}++se}}return _e(V,1),V.end()}function s(R){var z=oe(2);return z.write_shift(2,R),z}function i(R){var z=oe(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var U=0,V=0,J=0,W=0;W<R.SheetNames.length;++W){var se=R.SheetNames[W],ie=R.Sheets[se];if(!(!ie||!ie["!ref"])){++J;var ae=Fn(ie["!ref"]);U<ae.e.r&&(U=ae.e.r),V<ae.e.c&&(V=ae.e.c)}}return U>8191&&(U=8191),z.write_shift(2,U),z.write_shift(1,J),z.write_shift(1,V),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(R,z,U){var V={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&U.qpro?(V.s.c=R.read_shift(1),R.l++,V.s.r=R.read_shift(2),V.e.c=R.read_shift(1),R.l++,V.e.r=R.read_shift(2),V):(V.s.c=R.read_shift(2),V.s.r=R.read_shift(2),z==12&&U.qpro&&(R.l+=2),V.e.c=R.read_shift(2),V.e.r=R.read_shift(2),z==12&&U.qpro&&(R.l+=2),V.s.c==65535&&(V.s.c=V.e.c=V.s.r=V.e.r=0),V)}function l(R){var z=oe(8);return z.write_shift(2,R.s.c),z.write_shift(2,R.s.r),z.write_shift(2,R.e.c),z.write_shift(2,R.e.r),z}function c(R,z,U){var V=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(V[0].c=R.read_shift(1),V[3]=R.read_shift(1),V[0].r=R.read_shift(2),R.l+=2):(V[2]=R.read_shift(1),V[0].c=R.read_shift(2),V[0].r=R.read_shift(2)),V}function f(R,z,U){var V=R.l+z,J=c(R,z,U);if(J[1].t="s",U.vers==20768){R.l++;var W=R.read_shift(1);return J[1].v=R.read_shift(W,"utf8"),J}return U.qpro&&R.l++,J[1].v=R.read_shift(V-R.l,"cstr"),J}function d(R,z,U){var V=oe(7+U.length);V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,R),V.write_shift(1,39);for(var J=0;J<V.length;++J){var W=U.charCodeAt(J);V.write_shift(1,W>=128?95:W)}return V.write_shift(1,0),V}function h(R,z,U){var V=c(R,z,U);return V[1].v=R.read_shift(2,"i"),V}function p(R,z,U){var V=oe(7);return V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,R),V.write_shift(2,U,"i"),V}function g(R,z,U){var V=c(R,z,U);return V[1].v=R.read_shift(8,"f"),V}function m(R,z,U){var V=oe(13);return V.write_shift(1,255),V.write_shift(2,z),V.write_shift(2,R),V.write_shift(8,U,"f"),V}function x(R,z,U){var V=R.l+z,J=c(R,z,U);if(J[1].v=R.read_shift(8,"f"),U.qpro)R.l=V;else{var W=R.read_shift(2);E(R.slice(R.l,R.l+W),J),R.l+=W}return J}function v(R,z,U){var V=z&32768;return z&=-32769,z=(V?R:0)+(z>=8192?z-16384:z),(V?"":"$")+(U?Ht(z):or(z))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(R,z){Mr(R,0);for(var U=[],V=0,J="",W="",se="",ie="";R.l<R.length;){var ae=R[R.l++];switch(ae){case 0:U.push(R.read_shift(8,"f"));break;case 1:W=v(z[0].c,R.read_shift(2),!0),J=v(z[0].r,R.read_shift(2),!1),U.push(W+J);break;case 2:{var be=v(z[0].c,R.read_shift(2),!0),I=v(z[0].r,R.read_shift(2),!1);W=v(z[0].c,R.read_shift(2),!0),J=v(z[0].r,R.read_shift(2),!1),U.push(be+I+":"+W+J)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(R.read_shift(2));break;case 6:{for(var He="";ae=R[R.l++];)He+=String.fromCharCode(ae);U.push('"'+He.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:ie=U.pop(),se=U.pop(),U.push(["AND","OR"][ae-20]+"("+se+","+ie+")");break;default:if(ae<32&&w[ae])ie=U.pop(),se=U.pop(),U.push(se+w[ae]+ie);else if(y[ae]){if(V=y[ae][1],V==69&&(V=R[R.l++]),V>U.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+U.join("|")+"|");return}var Ue=U.slice(-V);U.length-=V,U.push(y[ae][0]+"("+Ue.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}U.length==1?z[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function b(R){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=R.read_shift(2),z[3]=R[R.l++],z[0].c=R[R.l++],z}function k(R,z){var U=b(R);return U[1].t="s",U[1].v=R.read_shift(z-4,"cstr"),U}function S(R,z,U,V){var J=oe(6+V.length);J.write_shift(2,R),J.write_shift(1,U),J.write_shift(1,z),J.write_shift(1,39);for(var W=0;W<V.length;++W){var se=V.charCodeAt(W);J.write_shift(1,se>=128?95:se)}return J.write_shift(1,0),J}function T(R,z){var U=b(R);U[1].v=R.read_shift(2);var V=U[1].v>>1;if(U[1].v&1)switch(V&7){case 0:V=(V>>3)*5e3;break;case 1:V=(V>>3)*500;break;case 2:V=(V>>3)/20;break;case 3:V=(V>>3)/200;break;case 4:V=(V>>3)/2e3;break;case 5:V=(V>>3)/2e4;break;case 6:V=(V>>3)/16;break;case 7:V=(V>>3)/64;break}return U[1].v=V,U}function N(R,z){var U=b(R),V=R.read_shift(4),J=R.read_shift(4),W=R.read_shift(2);if(W==65535)return V===0&&J===3221225472?(U[1].t="e",U[1].v=15):V===0&&J===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var se=W&32768;return W=(W&32767)-16446,U[1].v=(1-se*2)*(J*Math.pow(2,W+32)+V*Math.pow(2,W)),U}function O(R,z,U,V){var J=oe(14);if(J.write_shift(2,R),J.write_shift(1,U),J.write_shift(1,z),V==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var W=0,se=0,ie=0,ae=0;return V<0&&(W=1,V=-V),se=Math.log2(V)|0,V/=Math.pow(2,se-31),ae=V>>>0,ae&2147483648||(V/=2,++se,ae=V>>>0),V-=ae,ae|=2147483648,ae>>>=0,V*=Math.pow(2,32),ie=V>>>0,J.write_shift(4,ie),J.write_shift(4,ae),se+=16383+(W?32768:0),J.write_shift(2,se),J}function j(R,z){var U=N(R);return R.l+=z-14,U}function D(R,z){var U=b(R),V=R.read_shift(4);return U[1].v=V>>6,U}function Y(R,z){var U=b(R),V=R.read_shift(8,"f");return U[1].v=V,U}function Q(R,z){var U=Y(R);return R.l+=z-10,U}function G(R,z){return R[R.l+z-1]==0?R.read_shift(z,"cstr"):""}function X(R,z){var U=R[R.l++];U>z-1&&(U=z-1);for(var V="";V.length<U;)V+=String.fromCharCode(R[R.l++]);return V}function q(R,z,U){if(!(!U.qpro||z<21)){var V=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var J=R.read_shift(z-21,"cstr");return[V,J]}}function K(R,z){for(var U={},V=R.l+z;R.l<V;){var J=R.read_shift(2);if(J==14e3){for(U[J]=[0,""],U[J][0]=R.read_shift(2);R[R.l];)U[J][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return U}function A(R,z){var U=oe(5+R.length);U.write_shift(2,14e3),U.write_shift(2,z);for(var V=0;V<R.length;++V){var J=R.charCodeAt(V);U[U.l++]=J>127?95:J}return U[U.l++]=0,U}var ne={0:{n:"BOF",f:fr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:G},222:{n:"SHEETNAMELP",f:X},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:j},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:Q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:G},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function zK(e){var t={},r=e.match(an),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=ze(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Py[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var HK=function(){var e=Zf("t"),t=Zf("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:ut(i[1])},l=s.match(t);return l&&(o.s=zK(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),GK=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),KK=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,qK=/<(?:\w+:)?r>/,XK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tw(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ut(Et(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Et(e),r&&(n.h=$y(n.t))):e.match(qK)&&(n.r=Et(e),n.t=ut(Et((e.replace(XK,"").match(KK)||[]).join("").replace(an,""))),r&&(n.h=GK(HK(n.r)))),n):{t:""}}var YK=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,QK=/<(?:\w+:)?(?:si|sstItem)>/g,JK=/<\/(?:\w+:)?(?:si|sstItem)>/;function ZK(e,t){var r=[],n="";if(!e)return r;var a=e.match(YK);if(a){n=a[2].replace(QK,"").split(JK);for(var s=0;s!=n.length;++s){var i=tw(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=ze(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var eq=/^\s|\s$|[\t\n\r]/;function DR(e,t){if(!t.bookSST)return"";var r=[lr];r[r.length]=we("sst",null,{xmlns:wl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(eq)&&(s+=' xml:space="preserve"'),s+=">"+wt(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function tq(e){return[e.read_shift(4),e.read_shift(4)]}function rq(e,t){var r=[],n=!1;return ii(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function nq(e,t){return t||(t=oe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var aq=pH;function sq(e){var t=jn();ue(t,159,nq(e));for(var r=0;r<e.length;++r)ue(t,19,aq(e[r]));return ue(t,160),t.end()}function MR(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Hs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function iq(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Hs(e,4),t.U=Hs(e,4),t.W=Hs(e,4),t}function oq(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function lq(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(oq(e));return t}function cq(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function uq(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Hs(e,4),t.U=Hs(e,4),t.W=Hs(e,4),t}function fq(e){var t=uq(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function LR(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function BR(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function dq(e){var t=Hs(e);switch(t.Minor){case 2:return[t.Minor,hq(e)];case 3:return[t.Minor,pq()];case 4:return[t.Minor,mq(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function hq(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=LR(e,r),a=BR(e,e.length-e.l);return{t:"Std",h:n,v:a}}function pq(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mq(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(an,function(s){var i=ze(s);switch(Ss(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function gq(e,t){var r={},n=r.EncryptionVersionInfo=Hs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=LR(e,a),t-=a,r.EncryptionVerifier=BR(e,t),r}function xq(e){var t={},r=t.EncryptionVersionInfo=Hs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function rw(e){var t=0,r,n=MR(e),a=n.length+1,s,i,o,l,c;for(r=Zi(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var UR=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=MR(i),l=s(o),c=o.length,f=Zi(16),d=0;d!=16;++d)f[d]=0;var h,p,g;for((c&1)===1&&(h=l>>8,f[c]=a(e[0],h),--c,h=l&255,p=o[o.length-1],f[c]=a(p,h));c>0;)--c,h=l>>8,f[c]=a(o[c],h),--c,h=l&255,f[c]=a(o[c],h);for(c=15,g=15-o.length;g>0;)h=l>>8,f[c]=a(e[g],h),--c,--g,h=l&255,f[c]=a(o[c],h),--c,--g;return f}}(),vq=function(e,t,r,n,a){a||(a=t),n||(n=UR(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},yq=function(e){var t=0,r=UR(e);return function(n){var a=vq("",n,t,r);return t=a[1],a[0]}};function wq(e,t,r,n){var a={key:fr(e),verificationBytes:fr(e)};return r.password&&(a.verifier=rw(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=yq(r.password)),a}function _q(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=xq(e):n.Data=gq(e,t),n}function Eq(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?_q(e,t-2,n):wq(e,r.biff>=8?t:t-2,r,n),n}var $R=function(){function e(a,s){switch(s.type){case"base64":return t(Yn(a),s);case"binary":return t(a,s);case"buffer":return t(rt&&Buffer.isBuffer(a)?a.toString("binary"):co(a),s);case"array":return t(nl(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,g,m=-1;g=h.exec(f);){switch(g[0]){case"\\cell":var x=f.slice(p,h.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++m,x.length){var v={v:x,t:"s"};Array.isArray(o)?o[d][m]=v:o[$e({r:d,c:m})]=v}break}p=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Qe(c),o}function r(a,s){return uo(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=ft(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=$e({r:c,c:f});o=l?(a[c]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Zs(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function bq(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function nd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Sq(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function kq(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function Y0(e,t){if(t===0)return e;var r=Sq(bq(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),nd(kq(r))}var WR=6,Cq=15,Tq=1,Qr=WR;function ad(e){return Math.floor((e+Math.round(128/Qr)/256)*Qr)}function sd(e){return Math.floor((e-5)/Qr*100+.5)/100}function Q0(e){return Math.round((e*Qr+5)/Qr*256)/256}function Tg(e){return Q0(sd(ad(e)))}function nw(e){var t=Math.abs(e-Tg(e)),r=Qr;if(t>.005)for(Qr=Tq;Qr<Cq;++Qr)Math.abs(e-Tg(e))<=t&&(t=Math.abs(e-Tg(e)),r=Qr);Qr=r}function eo(e){e.width?(e.wpx=ad(e.width),e.wch=sd(e.wpx),e.MDW=Qr):e.wpx?(e.wch=sd(e.wpx),e.width=Q0(e.wch),e.MDW=Qr):typeof e.wch=="number"&&(e.width=Q0(e.wch),e.wpx=ad(e.width),e.MDW=Qr),e.customWidth&&delete e.customWidth}var Nq=96,VR=Nq;function id(e){return e*96/VR}function Gc(e){return e*VR/96}var Aq={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Rq(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(an)||[]).forEach(function(i){var o=ze(i);switch(Ss(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=Pt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=Pt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function Pq(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(an)||[]).forEach(function(i){var o=ze(i);switch(Ss(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function jq(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(an)||[]).forEach(function(i){var o=ze(i);switch(Ss(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=Et(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?Pt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?Pt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?Pt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?Pt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?Pt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?Pt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?Pt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Py[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=Pt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Uo[a.color.index];a.color.index==81&&(l=Uo[1]),l||(l=Uo[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Y0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Fq(e,t,r){t.NumberFmt=[];for(var n=tr(Be),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Be[n[a]];var s=e[0].match(an);if(s)for(a=0;a<s.length;++a){var i=ze(s[a]);switch(Ss(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ut(Et(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}zs(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Oq(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=we("numFmt",null,{numFmtId:n,formatCode:wt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=we("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Ch=["numFmtId","fillId","fontId","borderId","xfId"],Th=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Iq(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(an)||[]).forEach(function(s){var i=ze(s),o=0;switch(Ss(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Ch.length;++o)n[Ch[o]]&&(n[Ch[o]]=parseInt(n[Ch[o]],10));for(o=0;o<Th.length;++o)n[Th[o]]&&(n[Th[o]]=Pt(n[Th[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Pt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function Dq(e){var t=[];return t[t.length]=we("cellXfs",null),e.forEach(function(r){t[t.length]=we("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=we("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Mq=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&Fq(d,f,c),(d=o.match(a))&&jq(d,f,l,c),(d=o.match(n))&&Pq(d,f,l,c),(d=o.match(s))&&Rq(d,f,l,c),(d=o.match(r))&&Iq(d,f,c),f}}();function zR(e,t){var r=[lr,we("styleSheet",null,{xmlns:wl[0],"xmlns:vt":wr.vt})],n;return e.SSF&&(n=Oq(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Dq(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Lq(e,t){var r=e.read_shift(2),n=Zr(e);return[r,n]}function Bq(e,t,r){r||(r=oe(6+4*t.length)),r.write_shift(2,e),Ar(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Uq(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=_H(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=wH(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Zr(e),n}function $q(e,t){t||(t=oe(25+4*32)),t.write_shift(2,e.sz*20),EH(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),K0(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ar(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Wq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ng,Vq=tn;function gb(e,t){t||(t=oe(4*3+8*7+16*1)),Ng||(Ng=Yp(Wq));var r=Ng[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(K0({auto:1},t),K0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function zq(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function HR(e,t,r){r||(r=oe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ru(e,t){return t||(t=oe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Hq=tn;function Gq(e,t){return t||(t=oe(51)),t.write_shift(1,0),Ru(null,t),Ru(null,t),Ru(null,t),Ru(null,t),Ru(null,t),t.length>t.l?t.slice(0,t.l):t}function Kq(e,t){return t||(t=oe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),G0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function qq(e,t,r){var n=oe(2052);return n.write_shift(4,e),G0(t,n),G0(r,n),n.length>n.l?n.slice(0,n.l):n}function Xq(e,t,r){var n={};n.NumberFmt=[];for(var a in Be)n.NumberFmt[a]=Be[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return ii(e,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],zs(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Y0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function Yq(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ue(e,615,Ka(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ue(e,44,Bq(a,t[a]))}),ue(e,616))}}function Qq(e){var t=1;ue(e,611,Ka(t)),ue(e,43,$q({sz:12,color:{theme:1},name:"Calibri",family:2})),ue(e,612)}function Jq(e){var t=2;ue(e,603,Ka(t)),ue(e,45,gb({patternType:"none"})),ue(e,45,gb({patternType:"gray125"})),ue(e,604)}function Zq(e){var t=1;ue(e,613,Ka(t)),ue(e,46,Gq()),ue(e,614)}function eX(e){var t=1;ue(e,626,Ka(t)),ue(e,47,HR({numFmtId:0},65535)),ue(e,627)}function tX(e,t){ue(e,617,Ka(t.length)),t.forEach(function(r){ue(e,47,HR(r,0))}),ue(e,618)}function rX(e){var t=1;ue(e,619,Ka(t)),ue(e,48,Kq({xfId:0,name:"Normal"})),ue(e,620)}function nX(e){var t=0;ue(e,505,Ka(t)),ue(e,506)}function aX(e){var t=0;ue(e,508,qq(t,"TableStyleMedium9","PivotStyleMedium4")),ue(e,509)}function sX(e,t){var r=jn();return ue(r,278),Yq(r,e.SSF),Qq(r),Jq(r),Zq(r),eX(r),tX(r,t.cellXfs),rX(r),nX(r),aX(r),ue(r,279),r.end()}var iX=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function oX(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(an)||[]).forEach(function(a){var s=ze(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[iX.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function lX(){}function cX(){}var uX=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fX=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,dX=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function hX(e,t,r){t.themeElements={};var n;[["clrScheme",uX,oX],["fontScheme",fX,lX],["fmtScheme",dX,cX]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var pX=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function GR(e,t){(!e||e.length===0)&&(e=aw());var r,n={};if(!(r=e.match(pX)))throw new Error("themeElements not found in theme");return hX(r[0],n,t),n.raw=e,n}function aw(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[lr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function mX(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=L4(s,{type:"array"})}catch{return}var o=Hn(i,"theme/theme/theme1.xml",!0);if(o)return GR(o,r)}}function gX(e){return e.read_shift(4)}function xX(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=vX(e,4);break;case 2:t.xclrValue=kR(e);break;case 3:t.xclrValue=gX(e);break;case 4:e.l+=4;break}return e.l+=8,t}function vX(e,t){return tn(e,t)}function yX(e,t){return tn(e,t)}function wX(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=xX(e);break;case 6:n[1]=yX(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function _X(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(wX(e,r-e.l));return{ixfe:n,ext:s}}function EX(e,t){t.forEach(function(r){switch(r[0]){}})}function bX(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Zr(e)}}function SX(e){var t=oe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ar(e.name,t),t.slice(0,t.l)}function kX(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function CX(e){var t=oe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function TX(e,t){var r=oe(8+2*t.length);return r.write_shift(4,e),Ar(t,r),r.slice(0,r.l)}function NX(e){return e.l+=4,e.read_shift(4)!=0}function AX(e,t){var r=oe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function RX(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return ii(e,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function PX(){var e=jn();return ue(e,332),ue(e,334,Ka(1)),ue(e,335,SX({name:"XLDAPR",version:12e4,flags:3496657072})),ue(e,336),ue(e,339,TX(1,"XLDAPR")),ue(e,52),ue(e,35,Ka(514)),ue(e,4096,Ka(0)),ue(e,4097,ca(1)),ue(e,36),ue(e,53),ue(e,340),ue(e,337,AX(1)),ue(e,51,CX([[1,0]])),ue(e,338),ue(e,333),e.end()}function jX(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(an,function(o){var l=ze(o);switch(Ss(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function KR(){var e=[lr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function FX(e){var t=[];if(!e)return t;var r=1;return(e.match(an)||[]).forEach(function(n){var a=ze(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function OX(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=$e(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function IX(e,t,r){var n=[];return ii(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function DX(e,t,r,n){if(!e)return e;var a=n||{},s=!1;ii(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function MX(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var rc=1024;function qR(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[we("xml",null,{"xmlns:v":Un.v,"xmlns:o":Un.o,"xmlns:x":Un.x,"xmlns:mv":Un.mv}).replace(/\/>/,">"),we("o:shapelayout",we("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),we("v:shapetype",[we("v:stroke",null,{joinstyle:"miter"}),we("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];rc<e*1e3;)rc+=1e3;return t.forEach(function(s){var i=Gt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?we("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=we("v:fill",l,o),f={on:"t",obscured:"t"};++rc,a=a.concat(["<v:shape"+ed({id:"_x0000_s"+rc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,we("v:shadow",null,f),we("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Br("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Br("x:AutoFill","False"),Br("x:Row",String(i.r)),Br("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function xb(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Gt(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=ft(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Qe(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function LX(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=ze(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Gt(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&tw(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function XR(e){var t=[lr,we("comments",null,{xmlns:wl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=wt(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(wt(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(Br("t",wt(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(Br("t",wt(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function BX(e,t){var r=[],n=!1,a={},s=0;return e.replace(an,function(o,l){var c=ze(o);switch(Ss(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function UX(e,t,r){var n=[lr,we("ThreadedComments",null,{xmlns:wr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(we("threadedComment",Br("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function $X(e,t){var r=[],n=!1;return e.replace(an,function(s){var i=ze(s);switch(Ss(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function WX(e){var t=[lr,we("personList",null,{xmlns:wr.TCMNT,"xmlns:x":wl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(we("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function VX(e){var t={};t.iauthor=e.read_shift(4);var r=Sl(e);return t.rfx=r.s,t.ref=$e(r.s),e.l+=16,t}function zX(e,t){return t==null&&(t=oe(36)),t.write_shift(4,e[1].iauthor),du(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var HX=Zr;function GX(e){return Ar(e.slice(0,54))}function KX(e,t){var r=[],n=[],a={},s=!1;return ii(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function qX(e){var t=jn(),r=[];return ue(t,628),ue(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ue(t,632,GX(a.a)))})}),ue(t,631),ue(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Gt(n[0]),e:Gt(n[0])};ue(t,635,zX([s,a])),a.t&&a.t.length>0&&ue(t,637,gH(a)),ue(t,636),delete a.iauthor})}),ue(t,634),ue(t,629),t.end()}var XX="application/vnd.ms-office.vbaProject";function YX(e){var t=Oe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Oe.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Oe.write(t)}function QX(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Oe.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var YR=["xlsb","xlsm","xlam","biff8","xla"];function JX(){return{"!type":"dialog"}}function ZX(){return{"!type":"dialog"}}function eY(){return{"!type":"macro"}}function tY(){return{"!type":"macro"}}var gc=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,a+(o?"":"$")+Ht(f)+(l?"":"$")+or(c)}return function(a,s){return t=s,a.replace(e,r)}}(),sw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,iw=function(){return function(t,r){return t.replace(sw,function(n,a,s,i,o,l){var c=Gy(i)-(s?0:r.c),f=Hy(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+d+"C"+h})}}();function QR(e,t){return e.replace(sw,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Ht(Gy(s)+t.c))+(i=="$"?i+o:or(Hy(o)+t.r))})}function rY(e,t,r){var n=Fn(t),a=n.s,s=Gt(r),i={r:s.r-a.r,c:s.c-a.c};return QR(e,i)}function nY(e){return e.length!=1}function vb(e){return e.replace(/_xlfn\./g,"")}function cr(e){e.l+=1}function to(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function JR(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ZR(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=to(e),o=to(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ZR(e){var t=to(e),r=to(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function aY(e,t,r){if(r.biff<8)return ZR(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=to(e),i=to(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function eP(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return sY(e);var n=e.read_shift(r&&r.biff==12?4:2),a=to(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function sY(e){var t=to(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function iY(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function oY(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return lY(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function lY(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function cY(e,t,r){var n=(e[e.l++]&96)>>5,a=JR(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function uY(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=JR(e,s,r);return[n,a,i]}function fY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function dY(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function hY(e,t,r){var n=(e[e.l++]&96)>>5,a=aY(e,t-1,r);return[n,a]}function pY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function yb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function mY(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function gY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function xY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function vY(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function yY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function tP(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function wY(e){return e.read_shift(2),tP(e)}function _Y(e){return e.read_shift(2),tP(e)}function EY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=eP(e,0,r);return[n,a]}function bY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=oY(e,0,r);return[n,a]}function SY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=eP(e,0,r);return[n,a,s]}function kY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[NQ[a],aP[a],n]}function CY(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:TY(e);return[a,(s[0]===0?aP:TQ)[s[1]]]}function TY(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function NY(e,t,r){e.l+=r&&r.biff==2?3:4}function AY(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function RY(e){return e.l++,oi[e.read_shift(1)]}function PY(e){return e.l++,e.read_shift(2)}function jY(e){return e.l++,e.read_shift(1)!==0}function FY(e){return e.l++,Jr(e)}function OY(e,t,r){return e.l++,Fd(e,t-1,r)}function IY(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=nr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=oi[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Jr(e);break;case 2:r[1]=kl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function DY(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Sl:Zp)(e));return a}function MY(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=IY(e,r.biff);return i}function LY(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function BY(e,t,r){if(r.biff==5)return UY(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function UY(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function $Y(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function WY(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function VY(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function zY(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var HY=tn,GY=tn,KY=tn;function Id(e,t,r){return e.l+=2,[iY(e)]}function ow(e){return e.l+=6,[]}var qY=Id,XY=ow,YY=ow,QY=Id;function rP(e){return e.l+=2,[fr(e),e.read_shift(2)&1]}var JY=Id,ZY=rP,eQ=ow,tQ=Id,rQ=Id,nQ=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function aQ(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=nQ[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function sQ(e){return e.l+=2,[e.read_shift(4)]}function iQ(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function oQ(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function lQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function cQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function uQ(e){return e.l+=4,[0,0]}var wb={1:{n:"PtgExp",f:AY},2:{n:"PtgTbl",f:KY},3:{n:"PtgAdd",f:cr},4:{n:"PtgSub",f:cr},5:{n:"PtgMul",f:cr},6:{n:"PtgDiv",f:cr},7:{n:"PtgPower",f:cr},8:{n:"PtgConcat",f:cr},9:{n:"PtgLt",f:cr},10:{n:"PtgLe",f:cr},11:{n:"PtgEq",f:cr},12:{n:"PtgGe",f:cr},13:{n:"PtgGt",f:cr},14:{n:"PtgNe",f:cr},15:{n:"PtgIsect",f:cr},16:{n:"PtgUnion",f:cr},17:{n:"PtgRange",f:cr},18:{n:"PtgUplus",f:cr},19:{n:"PtgUminus",f:cr},20:{n:"PtgPercent",f:cr},21:{n:"PtgParen",f:cr},22:{n:"PtgMissArg",f:cr},23:{n:"PtgStr",f:OY},26:{n:"PtgSheet",f:iQ},27:{n:"PtgEndSheet",f:oQ},28:{n:"PtgErr",f:RY},29:{n:"PtgBool",f:jY},30:{n:"PtgInt",f:PY},31:{n:"PtgNum",f:FY},32:{n:"PtgArray",f:pY},33:{n:"PtgFunc",f:kY},34:{n:"PtgFuncVar",f:CY},35:{n:"PtgName",f:LY},36:{n:"PtgRef",f:EY},37:{n:"PtgArea",f:cY},38:{n:"PtgMemArea",f:$Y},39:{n:"PtgMemErr",f:HY},40:{n:"PtgMemNoMem",f:GY},41:{n:"PtgMemFunc",f:WY},42:{n:"PtgRefErr",f:VY},43:{n:"PtgAreaErr",f:fY},44:{n:"PtgRefN",f:bY},45:{n:"PtgAreaN",f:hY},46:{n:"PtgMemAreaN",f:lQ},47:{n:"PtgMemNoMemN",f:cQ},57:{n:"PtgNameX",f:BY},58:{n:"PtgRef3d",f:SY},59:{n:"PtgArea3d",f:uY},60:{n:"PtgRefErr3d",f:zY},61:{n:"PtgAreaErr3d",f:dY},255:{}},fQ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dQ={1:{n:"PtgElfLel",f:rP},2:{n:"PtgElfRw",f:tQ},3:{n:"PtgElfCol",f:qY},6:{n:"PtgElfRwV",f:rQ},7:{n:"PtgElfColV",f:QY},10:{n:"PtgElfRadical",f:JY},11:{n:"PtgElfRadicalS",f:eQ},13:{n:"PtgElfColS",f:XY},15:{n:"PtgElfColSV",f:YY},16:{n:"PtgElfRadicalLel",f:ZY},25:{n:"PtgList",f:aQ},29:{n:"PtgSxName",f:sQ},255:{}},hQ={0:{n:"PtgAttrNoop",f:uQ},1:{n:"PtgAttrSemi",f:yY},2:{n:"PtgAttrIf",f:xY},4:{n:"PtgAttrChoose",f:mY},8:{n:"PtgAttrGoto",f:gY},16:{n:"PtgAttrSum",f:NY},32:{n:"PtgAttrBaxcel",f:yb},33:{n:"PtgAttrBaxcel",f:yb},64:{n:"PtgAttrSpace",f:wY},65:{n:"PtgAttrSpaceSemi",f:_Y},128:{n:"PtgAttrIfError",f:vY},255:{}};function Dd(e,t,r,n){if(n.biff<8)return tn(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=MY(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=DY(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(tn(e,t)),s}function Md(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=wb[s]||wb[fQ[s]],(s===24||s===25)&&(a=(s===24?dQ:hQ)[e[e.l+1]]),!a||!a.f?tn(e,t):i.push([a.n,a.f(e,t,r)]);return i}function pQ(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var mQ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function gQ(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function nP(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function _b(e,t,r){var n=nP(e,t,r);return n=="#REF"?n:gQ(n,r)}function Xr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],l,c,f,d=0,h=0,p,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,x="",v=0,y=e[0].length;v<y;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:x=Jt(" ",e[0][m][1][1]);break;case 1:x=Jt("\r",e[0][m][1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+x,m=-1}o.push(c+mQ[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=of(w[1][1],i,a),o.push(lf(f,s));break;case"PtgRefN":f=r?of(w[1][1],r,a):w[1][1],o.push(lf(f,s));break;case"PtgRef3d":d=w[1][1],f=of(w[1][2],i,a),g=_b(n,d,a),o.push(g+"!"+lf(f,s));break;case"PtgFunc":case"PtgFuncVar":var E=w[1][0],b=w[1][1];E||(E=0),E&=127;var k=E==0?[]:o.slice(-E);o.length-=E,b==="User"&&(b=k.shift()),o.push(b+"("+k.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":p=YE(w[1][1],r?{s:r}:i,a),o.push(Sg(p,a));break;case"PtgArea":p=YE(w[1][1],i,a),o.push(Sg(p,a));break;case"PtgArea3d":d=w[1][1],p=w[1][2],g=_b(n,d,a),o.push(g+"!"+Sg(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var S=(n.names||[])[h-1]||(n[0]||[])[h],T=S?S.Name:"SH33TJSNAME"+String(h);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var N=w[1][1];h=w[1][2];var O;if(a.biff<=5)N<0&&(N=-N),n[N]&&(O=n[N][h]);else{var j="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][h]&&n[N][h].itab>0&&(j=n.SheetNames[n[N][h].itab-1]+"!"):j=n.SheetNames[h-1]+"!"),n[N]&&n[N][h])j+=n[N][h].Name;else if(n[0]&&n[0][h])j+=n[0][h].Name;else{var D=(nP(n,N,a)||"").split(";;");D[h-1]?j=D[h-1]:j+="SH33TJSERRX"}o.push(j);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var Y="(",Q=")";if(m>=0){switch(x="",e[0][m][1][0]){case 2:Y=Jt(" ",e[0][m][1][1])+Y;break;case 3:Y=Jt("\r",e[0][m][1][1])+Y;break;case 4:Q=Jt(" ",e[0][m][1][1])+Q;break;case 5:Q=Jt("\r",e[0][m][1][1])+Q;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(Y+o.pop()+Q);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:w[1][1],r:w[1][0]};var G={c:r.c,r:r.r};if(n.sharedf[$e(f)]){var X=n.sharedf[$e(f)];o.push(Xr(X,i,G,n,a))}else{var q=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Xr(c[1],i,G,n,a)),q=!0;break}q||o.push(w[1])}break;case"PtgArray":o.push("{"+pQ(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&K.indexOf(e[0][v][0])==-1){w=e[0][m];var A=!0;switch(w[1][0]){case 4:A=!1;case 0:x=Jt(" ",w[1][1]);break;case 5:A=!1;case 1:x=Jt("\r",w[1][1]);break;default:if(x="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((A?x:"")+o.pop()+(A?"":x)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function xQ(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],tn(e,t-2)];var o=Md(e,i,r);return t!==i+a&&(s=Dd(e,t-i-a,o,r)),e.l=n,[o,s]}function vQ(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],tn(e,t-2)];var o=Md(e,i,r);return t!==i+a&&(s=Dd(e,t-i-a,o,r)),e.l=n,[o,s]}function yQ(e,t,r,n){var a=e.l+t,s=Md(e,n,r),i;return a!==e.l&&(i=Dd(e,a-e.l,s,r)),[s,i]}function wQ(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Md(e,s,r);return s==65535?[[],tn(e,t-2)]:(t!==s+2&&(a=Dd(e,n-s-2,i,r)),[i,a])}function _Q(e){var t;if($s(e,e.l+6)!==65535)return[Jr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function EQ(e){if(e==null){var t=oe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return al(e);return al(0)}function Ag(e,t,r){var n=e.l+t,a=ks(e);r.biff==2&&++e.l;var s=_Q(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=vQ(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function bQ(e,t,r,n,a){var s=il(t,r,a),i=EQ(e.v),o=oe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=oe(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var d=Nr([s,i,o,c]);return d}function em(e,t,r){var n=e.read_shift(4),a=Md(e,n,r),s=e.read_shift(4),i=s>0?Dd(e,s,a,r):null;return[a,i]}var SQ=em,tm=em,kQ=em,CQ=em,TQ={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},aP={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NQ={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Eb(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function AQ(e){var t="of:="+e.replace(sw,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Rg(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function RQ(e){return e.replace(/\./,"!")}var uf={},xc={},ff=typeof Map<"u";function lw(e,t,r){var n=0,a=e.length;if(r){if(ff?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=ff?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(ff?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function rm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Qr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=sd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Q0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Vo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function fo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){zs(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function sP(e,t,r,n,a,s){try{n.cellNF&&(e.z=Be[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ft(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Be[t]==null&&zs(Tz[t]||"General",t),e.t==="e")e.w=e.w||oi[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jf(e.v);else if(e.t==="d"){var i=br(e.v);(i|0)===i?e.w=i.toString(10):e.w=Jf(i)}else{if(e.v===void 0)return"";e.w=rl(e.v,xc)}else e.t==="d"?e.w=Sa(t,br(e.v),xc):e.w=Sa(t,e.v,xc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Y0(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Y0(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function PQ(e,t,r){if(e&&e["!ref"]){var n=ft(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function jQ(e,t){var r=ft(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Qe(r))}var FQ=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,OQ=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,IQ=/<(?:\w:)?hyperlink [^>]*>/mg,DQ=/"(\w*:\w*)"/,MQ=/<(?:\w:)?col\b[^>]*[\/]?>/g,LQ=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,BQ=/<(?:\w:)?pageMargins[^>]*\/>/g,iP=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,UQ=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$Q=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function WQ(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",d=e.match(OQ);d?(c=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):c=f=e;var h=c.match(iP);h?cw(h[0],o,a,r):(h=c.match(UQ))&&zQ(h[0],h[1]||"",o,a,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(DQ);g&&jQ(o,g[1])}var m=c.match($Q);m&&m[1]&&nJ(m[1],a);var x=[];if(t.cellStyles){var v=c.match(MQ);v&&JQ(x,v)}d&&iJ(d[1],o,t,l,s,i);var y=f.match(LQ);y&&(o["!autofilter"]=eJ(y[0]));var w=[],E=f.match(FQ);if(E)for(p=0;p!=E.length;++p)w[p]=ft(E[p].slice(E[p].indexOf('"')+1));var b=f.match(IQ);b&&XQ(o,b,n);var k=f.match(BQ);if(k&&(o["!margins"]=YQ(ze(k[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Qe(l)),t.sheetRows>0&&o["!ref"]){var S=ft(o["!ref"]);t.sheetRows<=+S.e.r&&(S.e.r=t.sheetRows-1,S.e.r>l.e.r&&(S.e.r=l.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>l.e.c&&(S.e.c=l.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Qe(S))}return x.length>0&&(o["!cols"]=x),w.length>0&&(o["!merges"]=w),o}function VQ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Qe(e[r])+'"/>';return t+"</mergeCells>"}function cw(e,t,r,n){var a=ze(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ut(Et(a.codeName)))}function zQ(e,t,r,n,a){cw(e.slice(0,e.indexOf(">")),r,n,a)}function HQ(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,i.codeName=xs(wt(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+we("outlinePr",null,c)}!s&&!o||(a[a.length]=we("sheetPr",o,i))}var GQ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],KQ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function qQ(e){var t={sheet:1};return GQ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),KQ.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=rw(e.password).toString(16).toUpperCase()),we("sheetProtection",null,t)}function XQ(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=ze(Et(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+ut(s.location))):(s.Target="#"+ut(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ft(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=$e({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function YQ(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function QQ(e){return Vo(e),we("pageMargins",null,e)}function JQ(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=ze(t[n],!0);a.hidden&&(a.hidden=Pt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,nw(a.width)),eo(a);s<=i;)e[s++]=Ot(a)}}function ZQ(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=we("col",null,rm(a,n)));return r[r.length]="</cols>",r.join("")}function eJ(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function tJ(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Qe(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=Fn(a);i.s.r==i.e.r&&(i.e.r=Fn(t["!ref"]).e.r,a=Qe(i));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),we("autoFilter",null,{ref:a})}var rJ=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nJ(e,t){t.Views||(t.Views=[{}]),(e.match(rJ)||[]).forEach(function(r,n){var a=ze(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Pt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function aJ(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),we("sheetViews",we("sheetView",null,a),{})}function sJ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=oi[e.v];break;case"d":n&&n.cellDates?a=Ft(e.v,-1).toISOString():(e=Ot(e),e.t="n",a=""+(e.v=br(Ft(e.v)))),typeof e.z>"u"&&(e.z=Be[14]);break;default:a=e.v;break}var o=Br("v",wt(a)),l={r:t},c=fo(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Br("v",""+lw(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=we("f",wt(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),we("c",o,l)}var iJ=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Zf("v"),i=Zf("f");return function(l,c,f,d,h,p){for(var g=0,m="",x=[],v=[],y=0,w=0,E=0,b="",k,S,T=0,N=0,O,j,D=0,Y=0,Q=Array.isArray(p.CellXf),G,X=[],q=[],K=Array.isArray(c),A=[],ne={},ce=!1,R=!!f.sheetStubs,z=l.split(t),U=0,V=z.length;U!=V;++U){m=z[U].trim();var J=m.length;if(J!==0){var W=0;e:for(g=0;g<J;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(S=ze(m.slice(W,g),!0),T=S.r!=null?parseInt(S.r,10):T+1,N=-1,f.sheetRows&&f.sheetRows<T)continue;ne={},ce=!1,S.ht&&(ce=!0,ne.hpt=parseFloat(S.ht),ne.hpx=Gc(ne.hpt)),S.hidden=="1"&&(ce=!0,ne.hidden=!0),S.outlineLevel!=null&&(ce=!0,ne.level=+S.outlineLevel),ce&&(A[T-1]=ne)}break;case"<":W=g;break}if(W>=g)break;if(S=ze(m.slice(W,g),!0),T=S.r!=null?parseInt(S.r,10):T+1,N=-1,!(f.sheetRows&&f.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),f&&f.cellStyles&&(ne={},ce=!1,S.ht&&(ce=!0,ne.hpt=parseFloat(S.ht),ne.hpx=Gc(ne.hpt)),S.hidden=="1"&&(ce=!0,ne.hidden=!0),S.outlineLevel!=null&&(ce=!0,ne.level=+S.outlineLevel),ce&&(A[T-1]=ne)),x=m.slice(g).split(e);for(var se=0;se!=x.length&&x[se].trim().charAt(0)=="<";++se);for(x=x.slice(se),g=0;g!=x.length;++g)if(m=x[g].trim(),m.length!==0){if(v=m.match(r),y=g,w=0,E=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,v!=null&&v.length===2){for(y=0,b=v[1],w=0;w!=b.length&&!((E=b.charCodeAt(w)-64)<1||E>26);++w)y=26*y+E;--y,N=y}else++N;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,S=ze(m.slice(0,w),!0),S.r||(S.r=$e({r:T-1,c:N})),b=m.slice(w),k={t:""},(v=b.match(s))!=null&&v[1]!==""&&(k.v=ut(v[1])),f.cellFormula){if((v=b.match(i))!=null&&v[1]!==""){if(k.f=ut(Et(v[1])).replace(/\r\n/g,`
`),f.xlfn||(k.f=vb(k.f)),v[0].indexOf('t="array"')>-1)k.F=(b.match(a)||[])[1],k.F.indexOf(":")>-1&&X.push([ft(k.F),k.F]);else if(v[0].indexOf('t="shared"')>-1){j=ze(v[0]);var ie=ut(Et(v[1]));f.xlfn||(ie=vb(ie)),q[parseInt(j.si,10)]=[j,ie,S.r]}}else(v=b.match(/<f[^>]*\/>/))&&(j=ze(v[0]),q[j.si]&&(k.f=rY(q[j.si][1],q[j.si][2],S.r)));var ae=Gt(S.r);for(w=0;w<X.length;++w)ae.r>=X[w][0].s.r&&ae.r<=X[w][0].e.r&&ae.c>=X[w][0].s.c&&ae.c<=X[w][0].e.c&&(k.F=X[w][1])}if(S.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(R)k.t="z";else continue;else k.t=S.t||"n";switch(d.s.c>N&&(d.s.c=N),d.e.c<N&&(d.e.c=N),k.t){case"n":if(k.v==""||k.v==null){if(!R)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!R)continue;k.t="z"}else O=uf[parseInt(k.v,10)],k.v=O.t,k.r=O.r,f.cellHTML&&(k.h=O.h);break;case"str":k.t="s",k.v=k.v!=null?Et(k.v):"",f.cellHTML&&(k.h=$y(k.v));break;case"inlineStr":v=b.match(n),k.t="s",v!=null&&(O=tw(v[1]))?(k.v=O.t,f.cellHTML&&(k.h=O.h)):k.v="";break;case"b":k.v=Pt(k.v);break;case"d":f.cellDates?k.v=Ft(k.v,1):(k.v=br(Ft(k.v,1)),k.t="n");break;case"e":(!f||f.cellText!==!1)&&(k.w=k.v),k.v=lR[k.v];break}if(D=Y=0,G=null,Q&&S.s!==void 0&&(G=p.CellXf[S.s],G!=null&&(G.numFmtId!=null&&(D=G.numFmtId),f.cellStyles&&G.fillId!=null&&(Y=G.fillId))),sP(k,D,Y,f,h,p),f.cellDates&&Q&&k.t=="n"&&cu(Be[D])&&(k.t="d",k.v=Jp(k.v)),S.cm&&f.xlmeta){var be=(f.xlmeta.Cell||[])[+S.cm-1];be&&be.type=="XLDAPR"&&(k.D=!0)}if(K){var I=Gt(S.r);c[I.r]||(c[I.r]=[]),c[I.r][I.c]=k}else c[S.r]=k}}}}A.length>0&&(c["!rows"]=A)}}();function oJ(e,t,r,n){var a=[],s=[],i=ft(e["!ref"]),o="",l,c="",f=[],d=0,h=0,p=e["!rows"],g=Array.isArray(e),m={r:c},x,v=-1;for(h=i.s.c;h<=i.e.c;++h)f[h]=Ht(h);for(d=i.s.r;d<=i.e.r;++d){for(s=[],c=or(d),h=i.s.c;h<=i.e.c;++h){l=f[h]+c;var y=g?(e[d]||[])[h]:e[l];y!==void 0&&(o=sJ(y,l,e,t))!=null&&s.push(o)}(s.length>0||p&&p[d])&&(m={r:c},p&&p[d]&&(x=p[d],x.hidden&&(m.hidden=1),v=-1,x.hpx?v=id(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(m.ht=v,m.customHeight=1),x.level&&(m.outlineLevel=x.level)),a[a.length]=we("row",s.join(""),m))}if(p)for(;d<p.length;++d)p&&p[d]&&(m={r:d+1},x=p[d],x.hidden&&(m.hidden=1),v=-1,x.hpx?v=id(x.hpx):x.hpt&&(v=x.hpt),v>-1&&(m.ht=v,m.customHeight=1),x.level&&(m.outlineLevel=x.level),a[a.length]=we("row","",m));return a.join("")}function oP(e,t,r,n){var a=[lr,we("worksheet",null,{xmlns:wl[0],"xmlns:r":wr.r})],s=r.SheetNames[e],i=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",f=ft(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=Qe(f)}n||(n={}),l["!comments"]=[];var d=[];HQ(l,r,e,t,a),a[a.length]=we("dimension",null,{ref:c}),a[a.length]=aJ(l,t,e,r),t.sheetFormat&&(a[a.length]=we("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=ZQ(l,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=oJ(l,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=qQ(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=tJ(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=VQ(l["!merges"]));var h=-1,p,g=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=yt(n,-1,wt(m[1].Target).replace(/#.*$/,""),nt.HLINK),p["r:id"]="rId"+g),(h=m[1].Target.indexOf("#"))>-1&&(p.location=wt(m[1].Target.slice(h+1))),m[1].Tooltip&&(p.tooltip=wt(m[1].Tooltip)),a[a.length]=we("hyperlink",null,p))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=QQ(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Br("ignoredErrors",we("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(g=yt(n,-1,"../drawings/drawing"+(e+1)+".xml",nt.DRAW),a[a.length]=we("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=d),l["!comments"].length>0&&(g=yt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",nt.VML),a[a.length]=we("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function lJ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function cJ(e,t,r){var n=oe(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=id(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,p=f<<10;p<f+1<<10;++p){c.c=p;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[$e(c)];g&&(d<0&&(d=p),h=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function uJ(e,t,r,n){var a=cJ(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ue(e,0,a)}var fJ=Sl,dJ=du;function hJ(){}function pJ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=xH(e),r}function mJ(e,t,r){r==null&&(r=oe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return K0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),nR(e,r),r.slice(0,r.l)}function gJ(e){var t=ka(e);return[t]}function xJ(e,t,r){return r==null&&(r=oe(8)),_l(t,r)}function vJ(e){var t=El(e);return[t]}function yJ(e,t,r){return r==null&&(r=oe(4)),bl(t,r)}function wJ(e){var t=ka(e),r=e.read_shift(1);return[t,r,"b"]}function _J(e,t,r){return r==null&&(r=oe(9)),_l(t,r),r.write_shift(1,e.v?1:0),r}function EJ(e){var t=El(e),r=e.read_shift(1);return[t,r,"b"]}function bJ(e,t,r){return r==null&&(r=oe(5)),bl(t,r),r.write_shift(1,e.v?1:0),r}function SJ(e){var t=ka(e),r=e.read_shift(1);return[t,r,"e"]}function kJ(e,t,r){return r==null&&(r=oe(9)),_l(t,r),r.write_shift(1,e.v),r}function CJ(e){var t=El(e),r=e.read_shift(1);return[t,r,"e"]}function TJ(e,t,r){return r==null&&(r=oe(8)),bl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function NJ(e){var t=ka(e),r=e.read_shift(4);return[t,r,"s"]}function AJ(e,t,r){return r==null&&(r=oe(12)),_l(t,r),r.write_shift(4,t.v),r}function RJ(e){var t=El(e),r=e.read_shift(4);return[t,r,"s"]}function PJ(e,t,r){return r==null&&(r=oe(8)),bl(t,r),r.write_shift(4,t.v),r}function jJ(e){var t=ka(e),r=Jr(e);return[t,r,"n"]}function FJ(e,t,r){return r==null&&(r=oe(16)),_l(t,r),al(e.v,r),r}function lP(e){var t=El(e),r=Jr(e);return[t,r,"n"]}function OJ(e,t,r){return r==null&&(r=oe(12)),bl(t,r),al(e.v,r),r}function IJ(e){var t=ka(e),r=Yy(e);return[t,r,"n"]}function DJ(e,t,r){return r==null&&(r=oe(12)),_l(t,r),aR(e.v,r),r}function MJ(e){var t=El(e),r=Yy(e);return[t,r,"n"]}function LJ(e,t,r){return r==null&&(r=oe(8)),bl(t,r),aR(e.v,r),r}function BJ(e){var t=ka(e),r=Ky(e);return[t,r,"is"]}function UJ(e){var t=ka(e),r=Zr(e);return[t,r,"str"]}function $J(e,t,r){return r==null&&(r=oe(12+4*e.v.length)),_l(t,r),Ar(e.v,r),r.length>r.l?r.slice(0,r.l):r}function WJ(e){var t=El(e),r=Zr(e);return[t,r,"str"]}function VJ(e,t,r){return r==null&&(r=oe(8+4*e.v.length)),bl(t,r),Ar(e.v,r),r.length>r.l?r.slice(0,r.l):r}function zJ(e,t,r){var n=e.l+t,a=ka(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=tm(e,n-e.l,r);i[3]=Xr(o,null,a,r.supbooks,r)}else e.l=n;return i}function HJ(e,t,r){var n=e.l+t,a=ka(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=tm(e,n-e.l,r);i[3]=Xr(o,null,a,r.supbooks,r)}else e.l=n;return i}function GJ(e,t,r){var n=e.l+t,a=ka(e);a.r=r["!row"];var s=Jr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=tm(e,n-e.l,r);i[3]=Xr(o,null,a,r.supbooks,r)}else e.l=n;return i}function KJ(e,t,r){var n=e.l+t,a=ka(e);a.r=r["!row"];var s=Zr(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=tm(e,n-e.l,r);i[3]=Xr(o,null,a,r.supbooks,r)}else e.l=n;return i}var qJ=Sl,XJ=du;function YJ(e,t){return t==null&&(t=oe(4)),t.write_shift(4,e),t}function QJ(e,t){var r=e.l+t,n=Sl(e),a=qy(e),s=Zr(e),i=Zr(e),o=Zr(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function JJ(e,t){var r=oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));du({s:Gt(e[0]),e:Gt(e[0])},r),Xy("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Ar(a||"",r),Ar(e[1].Tooltip||"",r),Ar("",r),r.slice(0,r.l)}function ZJ(){}function eZ(e,t,r){var n=e.l+t,a=sR(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=SQ(e,n-e.l,r);i[1]=o}else e.l=n;return i}function tZ(e,t,r){var n=e.l+t,a=Sl(e),s=[a];if(r.cellFormula){var i=CQ(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function rZ(e,t,r){r==null&&(r=oe(18));var n=rm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var cP=["left","right","top","bottom","header","footer"];function nZ(e){var t={};return cP.forEach(function(r){t[r]=Jr(e)}),t}function aZ(e,t){return t==null&&(t=oe(6*8)),Vo(e),cP.forEach(function(r){al(e[r],t)}),t}function sZ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function iZ(e,t,r){r==null&&(r=oe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function oZ(e){var t=oe(24);return t.write_shift(4,4),t.write_shift(4,1),du(e,t),t}function lZ(e,t){return t==null&&(t=oe(16*4+2)),t.write_shift(2,e.password?rw(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function cZ(){}function uZ(){}function fZ(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,g,m,x,v,y,w,E,b,k=[];o.biff=12,o["!row"]=0;var S=0,T=!1,N=[],O={},j=o.supbooks||a.supbooks||[[]];if(j.sharedf=O,j.arrayf=N,j.SheetNames=a.SheetNames||a.Sheets.map(function(K){return K.name}),!o.supbooks&&(o.supbooks=j,a.Names))for(var D=0;D<a.Names.length;++D)j[0][D+1]=a.Names[D];var Y=[],Q=[],G=!1;od[16]={n:"BrtShortReal",f:lP};var X;if(ii(e,function(A,ne,ce){if(!h)switch(ce){case 148:c=A;break;case 0:p=A,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),E=or(x=p.r),o["!row"]=p.r,(A.hidden||A.hpt||A.level!=null)&&(A.hpt&&(A.hpx=Gc(A.hpt)),Q[A.r]=A);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:A[2]},A[2]){case"n":g.v=A[1];break;case"s":w=uf[A[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!A[1];break;case"e":g.v=A[1],o.cellText!==!1&&(g.w=oi[g.v]);break;case"str":g.t="s",g.v=A[1];break;case"is":g.t="s",g.v=A[1].t;break}if((m=i.CellXf[A[0].iStyleRef])&&sP(g,m.numFmtId,null,o,s,i),v=A[0].c==-1?v+1:A[0].c,o.dense?(l[x]||(l[x]=[]),l[x][v]=g):l[Ht(v)+E]=g,o.cellFormula){for(T=!1,S=0;S<N.length;++S){var R=N[S];p.r>=R[0].s.r&&p.r<=R[0].e.r&&v>=R[0].s.c&&v<=R[0].e.c&&(g.F=Qe(R[0]),T=!0)}!T&&A.length>3&&(g.f=A[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>v&&(f.s.c=v),f.e.r<p.r&&(f.e.r=p.r),f.e.c<v&&(f.e.c=v),o.cellDates&&m&&g.t=="n"&&cu(Be[m.numFmtId])){var z=No(g.v);z&&(g.t="d",g.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}X&&(X.type=="XLDAPR"&&(g.D=!0),X=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},v=A[0].c==-1?v+1:A[0].c,o.dense?(l[x]||(l[x]=[]),l[x][v]=g):l[Ht(v)+E]=g,f.s.r>p.r&&(f.s.r=p.r),f.s.c>v&&(f.s.c=v),f.e.r<p.r&&(f.e.r=p.r),f.e.c<v&&(f.e.c=v),X&&(X.type=="XLDAPR"&&(g.D=!0),X=void 0);break;case 176:k.push(A);break;case 49:X=((o.xlmeta||{}).Cell||[])[A-1];break;case 494:var U=n["!id"][A.relId];for(U?(A.Target=U.Target,A.loc&&(A.Target+="#"+A.loc),A.Rel=U):A.relId==""&&(A.Target="#"+A.loc),x=A.rfx.s.r;x<=A.rfx.e.r;++x)for(v=A.rfx.s.c;v<=A.rfx.e.c;++v)o.dense?(l[x]||(l[x]=[]),l[x][v]||(l[x][v]={t:"z",v:void 0}),l[x][v].l=A):(y=$e({c:v,r:x}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=A);break;case 426:if(!o.cellFormula)break;N.push(A),b=o.dense?l[x][v]:l[Ht(v)+E],b.f=Xr(A[1],f,{r:p.r,c:v},j,o),b.F=Qe(A[0]);break;case 427:if(!o.cellFormula)break;O[$e(A[0].s)]=A[1],b=o.dense?l[x][v]:l[Ht(v)+E],b.f=Xr(A[1],f,{r:p.r,c:v},j,o);break;case 60:if(!o.cellStyles)break;for(;A.e>=A.s;)Y[A.e--]={width:A.w/256,hidden:!!(A.flags&1),level:A.level},G||(G=!0,nw(A.w/256)),eo(Y[A.e+1]);break;case 161:l["!autofilter"]={ref:Qe(A)};break;case 476:l["!margins"]=A;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),A.name&&(a.Sheets[r].CodeName=A.name),(A.above||A.left)&&(l["!outline"]={above:A.above,left:A.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),A.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ne.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Qe(c||f)),o.sheetRows&&l["!ref"]){var q=ft(l["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>f.e.r&&(q.e.r=f.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>f.e.c&&(q.e.c=f.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Qe(q))}return k.length>0&&(l["!merges"]=k),Y.length>0&&(l["!cols"]=Y),Q.length>0&&(l["!rows"]=Q),l}function dZ(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Ot(t),t.z=t.z||Be[14],t.v=br(Ft(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=fo(a.cellXfs,t,a),t.l&&s["!links"].push([$e(l),t.l]),t.c&&s["!comments"].push([$e(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=lw(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?ue(e,18,PJ(t,l)):ue(e,7,AJ(t,l))):(l.t="str",i?ue(e,17,VJ(t,l)):ue(e,6,$J(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?ue(e,13,LJ(t,l)):ue(e,2,DJ(t,l)):i?ue(e,16,OJ(t,l)):ue(e,5,FJ(t,l)),!0;case"b":return l.t="b",i?ue(e,15,bJ(t,l)):ue(e,4,_J(t,l)),!0;case"e":return l.t="e",i?ue(e,14,TJ(t,l)):ue(e,3,kJ(t,l)),!0}return i?ue(e,12,yJ(t,l)):ue(e,1,xJ(t,l)),!0}function hZ(e,t,r,n){var a=ft(t["!ref"]||"A1"),s,i="",o=[];ue(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=c;++f){i=or(f),uJ(e,t,a,f);var d=!1;if(f<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){f===a.s.r&&(o[h]=Ht(h)),s=o[h]+i;var p=l?(t[f]||[])[h]:t[s];if(!p){d=!1;continue}d=dZ(e,p,f,h,n,t,d)}}ue(e,146)}function pZ(e,t){!t||!t["!merges"]||(ue(e,177,YJ(t["!merges"].length)),t["!merges"].forEach(function(r){ue(e,176,XJ(r))}),ue(e,178))}function mZ(e,t){!t||!t["!cols"]||(ue(e,390),t["!cols"].forEach(function(r,n){r&&ue(e,60,rZ(n,r))}),ue(e,391))}function gZ(e,t){!t||!t["!ref"]||(ue(e,648),ue(e,649,oZ(ft(t["!ref"]))),ue(e,650))}function xZ(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=yt(r,-1,n[1].Target.replace(/#.*$/,""),nt.HLINK);ue(e,494,JJ(n,a))}}),delete t["!links"]}function vZ(e,t,r,n){if(t["!comments"].length>0){var a=yt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",nt.VML);ue(e,551,Xy("rId"+a)),t["!legacy"]=a}}function yZ(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Qe(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Fn(s);o.s.r==o.e.r&&(o.e.r=Fn(t["!ref"]).e.r,s=Qe(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ue(e,161,du(ft(s))),ue(e,162)}}function wZ(e,t,r){ue(e,133),ue(e,137,iZ(t,r)),ue(e,138),ue(e,134)}function _Z(e,t){t["!protect"]&&ue(e,535,lZ(t["!protect"]))}function EZ(e,t,r,n){var a=jn(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=ft(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ue(a,129),(r.vbaraw||i["!outline"])&&ue(a,147,mJ(o,i["!outline"])),ue(a,148,dJ(l)),wZ(a,i,r.Workbook),mZ(a,i),hZ(a,i,e,t),_Z(a,i),yZ(a,i,r,e),pZ(a,i),xZ(a,i,n),i["!margins"]&&ue(a,476,aZ(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&gZ(a,i),vZ(a,i,e,n),ue(a,130),a.end()}function bZ(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=ut((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function SZ(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=bZ(d);f.s.r=f.s.c=0,f.e.c=o,c=Ht(o),h[0].forEach(function(p,g){i[c+or(g)]={t:"n",v:p,z:h[1]},l=g}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=Qe(f)),i}function kZ(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(iP);return o&&cw(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function CZ(e,t){e.l+=10;var r=Zr(e);return{name:r}}function TZ(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ii(e,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var uw=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],NZ=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AZ=[],RZ=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function bb(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Pt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Sb(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Pt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function uP(e){Sb(e.WBProps,uw),Sb(e.CalcPr,RZ),bb(e.WBView,NZ),bb(e.Sheets,AZ),xc.date1904=Pt(e.WBProps.date1904)}function PZ(e){return!e.Workbook||!e.Workbook.WBProps?"false":Pt(e.Workbook.WBProps.date1904)?"true":"false"}var jZ="][*?/\\".split("");function fP(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return jZ.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function FZ(e,t,r){e.forEach(function(n,a){fP(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function OZ(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];FZ(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)PQ(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var IZ=/<\w+:workbook/;function DZ(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(an,function(l,c){var f=ze(l);switch(Ss(f[0])){case"<?xml":break;case"<workbook":l.match(IZ)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uw.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=Pt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=Et(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=ut(Et(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Et(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),Pt(f.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=ut(Et(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),wl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return uP(r),r}function dP(e){var t=[lr];t[t.length]=we("workbook",null,{xmlns:wl[0],"xmlns:r":wr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(uw.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=we("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:wt(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=we("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=we("definedName",wt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function MZ(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=kv(e),r.name=Zr(e),r}function LZ(e,t){return t||(t=oe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Xy(e.strRelID,t),Ar(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function BZ(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Zr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function UZ(e,t){t||(t=oe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),nR(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function $Z(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function WZ(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=vH(e),i=kQ(e,0,r),o=qy(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function VZ(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],od[16]={n:"BrtFRTArchID$",f:$Z},ii(e,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Xr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),uP(r),r.Names=s,r.supbooks=i,r}function zZ(e,t){ue(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ue(e,156,LZ(a))}ue(e,144)}function HZ(e,t){t||(t=oe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ar("SheetJS",t),Ar(U0.version,t),Ar(U0.version,t),Ar("7262",t),t.length>t.l?t.slice(0,t.l):t}function GZ(e,t){t||(t=oe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function KZ(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(ue(e,135),ue(e,158,GZ(a)),ue(e,136))}}function qZ(e,t){var r=jn();return ue(r,131),ue(r,128,HZ()),ue(r,153,UZ(e.Workbook&&e.Workbook.WBProps||null)),KZ(r,e),zZ(r,e),ue(r,132),r.end()}function XZ(e,t,r){return t.slice(-4)===".bin"?VZ(e,r):DZ(e,r)}function YZ(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?fZ(e,n,r,a,s,i,o):WQ(e,n,r,a,s,i,o)}function QZ(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?TZ(e,n,r,a,s):kZ(e,n,r,a,s)}function JZ(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?eY():tY()}function ZZ(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?JX():ZX()}function eee(e,t,r,n){return t.slice(-4)===".bin"?Xq(e,r,n):Mq(e,r,n)}function tee(e,t,r){return GR(e,r)}function ree(e,t,r){return t.slice(-4)===".bin"?rq(e,r):ZK(e,r)}function nee(e,t,r){return t.slice(-4)===".bin"?KX(e,r):LX(e,r)}function aee(e,t,r){return t.slice(-4)===".bin"?IX(e):FX(e)}function see(e,t,r,n){return r.slice(-4)===".bin"?DX(e,t,r,n):void 0}function iee(e,t,r){return t.slice(-4)===".bin"?RX(e,t,r):jX(e,t,r)}function oee(e,t,r){return(t.slice(-4)===".bin"?qZ:dP)(e)}function lee(e,t,r,n,a){return(t.slice(-4)===".bin"?EZ:oP)(e,r,n,a)}function cee(e,t,r){return(t.slice(-4)===".bin"?sX:zR)(e,r)}function uee(e,t,r){return(t.slice(-4)===".bin"?sq:DR)(e,r)}function fee(e,t,r){return(t.slice(-4)===".bin"?qX:XR)(e)}function dee(e){return(e.slice(-4)===".bin"?PX:KR)()}var hP=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,pP=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Aa(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(hP),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(pP),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function hee(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(hP),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(pP),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var df;function pee(e,t){var r=df[e]||ut(e);return r==="General"?rl(t):Sa(r,t)}function mee(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Pt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Ft(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ut(t)]=a}function gee(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||oi[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jf(e.v):e.w=rl(e.v):e.w=pee(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=df[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&cu(n)){var a=No(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function xee(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Aq[n.Pattern]||n.Pattern)}e[t.ID]=t}function vee(e,t,r,n,a,s,i,o,l,c){var f="General",d=n.StyleID,h={};c=c||{};var p=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&p.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Pt(e);break;case"String":n.t="s",n.r=$E(ut(e)),n.v=e.indexOf("<")>-1?ut(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Ft(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ut(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=lR[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=$E(t||e));break}if(gee(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=ut(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=gc(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=gc("RC:RC",a):n.ArrayRange&&(n.F=gc(n.ArrayRange,a),l.push([ft(n.F),n.F]))}else for(g=0;g<l.length;++g)a.r>=l[g][0].s.r&&a.r<=l[g][0].e.r&&a.c>=l[g][0].s.c&&a.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(p.forEach(function(x){!h.patternType&&x.patternType&&(h.patternType=x.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function yee(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Pg(e,t){var r=t||{};uu();var n=Vu(Wy(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Et(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Ot(r);return i.type="string",Hc.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xt){a.indexOf("<"+xt)>=0&&(s=!0)}),s)return ate(n,r);df={"General Number":"General","General Date":Be[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Be[15],"Short Date":Be[14],"Long Time":Be[19],"Medium Time":Be[18],"Short Time":Be[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Be[2],Standard:Be[4],Percent:Be[10],Scientific:Be[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},d=[],h=r.dense?[]:{},p="",g={},m={},x=Aa('<Data ss:Type="String">'),v=0,y=0,w=0,E={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},k={},S="",T=0,N=[],O={},j={},D=0,Y=[],Q=[],G={},X=[],q,K=!1,A=[],ne=[],ce={},R=0,z=0,U={Sheets:[],WBProps:{date1904:!1}},V={};td.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=td.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?vee(n.slice(v,o.index),S,x,l[l.length-1][0]=="comment"?G:g,{c:y,r:w},b,X[y],m,A,r):(S="",x=Aa(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Q.length>0&&(g.c=Q),(!r.sheetRows||r.sheetRows>w)&&g.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][y]=g):h[Ht(y)+or(w)]=g),g.HRef&&(g.l={Target:ut(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(R=y+(parseInt(g.MergeAcross,10)|0),z=w+(parseInt(g.MergeDown,10)|0),N.push({s:{c:y,r:w},e:{c:R,r:z}})),!r.sheetStubs)g.MergeAcross?y=R+1:++y;else if(g.MergeAcross||g.MergeDown){for(var W=y;W<=R;++W)for(var se=w;se<=z;++se)(W>y||se>w)&&(r.dense?(h[se]||(h[se]=[]),h[se][W]={t:"z"}):h[Ht(W)+or(se)]={t:"z"});y=R+1}else++y;else g=hee(o[0]),g.Index&&(y=+g.Index-1),y<E.s.c&&(E.s.c=y),y>E.e.c&&(E.e.c=y),o[0].slice(-2)==="/>"&&++y,Q=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<E.s.r&&(E.s.r=w),w>E.e.r&&(E.e.r=w),o[0].slice(-2)==="/>"&&(m=Aa(o[0]),m.Index&&(w=+m.Index-1)),y=0,++w):(m=Aa(o[0]),m.Index&&(w=+m.Index-1),ce={},(m.AutoFitHeight=="0"||m.Height)&&(ce.hpx=parseInt(m.Height,10),ce.hpt=id(ce.hpx),ne[w]=ce),m.Hidden=="1"&&(ce.hidden=!0,ne[w]=ce));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(p),E.s.r<=E.e.r&&E.s.c<=E.e.c&&(h["!ref"]=Qe(E),r.sheetRows&&r.sheetRows<=E.e.r&&(h["!fullref"]=h["!ref"],E.e.r=r.sheetRows-1,h["!ref"]=Qe(E))),N.length&&(h["!merges"]=N),X.length>0&&(h["!cols"]=X),ne.length>0&&(h["!rows"]=ne),f[p]=h}else E={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=y=0,l.push([o[3],!1]),c=Aa(o[0]),p=ut(c.Name),h=r.dense?[]:{},N=[],A=[],ne=[],V={name:p,Hidden:0},U.Sheets.push(V);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),X=[],K=!1}break;case"style":o[1]==="/"?xee(b,k,r):k=Aa(o[0]);break;case"numberformat":k.nf=ut(Aa(o[0]).Format||"General"),df[k.nf]&&(k.nf=df[k.nf]);for(var ie=0;ie!=392&&Be[ie]!=k.nf;++ie);if(ie==392){for(ie=57;ie!=392;++ie)if(Be[ie]==null){zs(k.nf,ie);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(q=Aa(o[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!K&&q.wpx>10){K=!0,Qr=WR;for(var ae=0;ae<X.length;++ae)X[ae]&&eo(X[ae])}K&&eo(q),X[q.Index-1||X.length]=q;for(var be=0;be<+q.Span;++be)X[X.length]=Ot(q);break;case"namedrange":if(o[1]==="/")break;U.Names||(U.Names=[]);var I=ze(o[0]),He={Name:I.Name,Ref:gc(I.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(He.Sheet=U.Sheets.length-1),U.Names.push(He);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?S+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Aa(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?VH(O,J,n.slice(D,o.index)):D=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));yee(G),Q.push(G)}else l.push([o[3],!1]),c=Aa(o[0]),G={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ue=Aa(o[0]);h["!autofilter"]={ref:gc(Ue.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Ab(n,r);var at=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:at=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:at=!1}break;case"excelworkbook":switch(o[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:at=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:at=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(D,o.index)){case"SheetHidden":V.Hidden=1;break;case"SheetVeryHidden":V.Hidden=2;break}else D=o.index+o[0].length;break;case"header":h["!margins"]||Vo(h["!margins"]={},"xlml"),isNaN(+ze(o[0]).Margin)||(h["!margins"].header=+ze(o[0]).Margin);break;case"footer":h["!margins"]||Vo(h["!margins"]={},"xlml"),isNaN(+ze(o[0]).Margin)||(h["!margins"].footer=+ze(o[0]).Margin);break;case"pagemargins":var Ve=ze(o[0]);h["!margins"]||Vo(h["!margins"]={},"xlml"),isNaN(+Ve.Top)||(h["!margins"].top=+Ve.Top),isNaN(+Ve.Left)||(h["!margins"].left=+Ve.Left),isNaN(+Ve.Right)||(h["!margins"].right=+Ve.Right),isNaN(+Ve.Bottom)||(h["!margins"].bottom=+Ve.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:at=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:at=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:at=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:at=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:at=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:at=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:at=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:at=!1}break;case"smarttags":break;default:at=!1;break}if(at||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?mee(j,J,Y,n.slice(D,o.index)):(Y=o,D=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ve={};return!r.bookSheets&&!r.bookProps&&(ve.Sheets=f),ve.SheetNames=d,ve.Workbook=U,ve.SSF=Ot(Be),ve.Props=O,ve.Custprops=j,ve}function jv(e,t){switch(dw(t=t||{}),t.type||"base64"){case"base64":return Pg(Yn(e),t);case"binary":case"buffer":case"file":return Pg(e,t);case"array":return Pg(co(e),t)}}function wee(e,t){var r=[];return e.Props&&r.push(zH(e.Props,t)),e.Custprops&&r.push(HH(e.Props,e.Custprops)),r.join("")}function _ee(){return""}function Eee(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(we("NumberFormat",null,{"ss:Format":wt(Be[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(we("Style",s.join(""),i))}),we("Styles",r.join(""))}function mP(e){return we("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+iw(e.Ref,{r:0,c:0})})}function bee(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(mP(a)))}return we("Names",r.join(""))}function See(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(mP(o)))}return s.join("")}function kee(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(we("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(we("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(we("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(we("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Br("ProtectContents","True")),e["!protect"].objects&&a.push(Br("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Br("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Br("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Br("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":we("WorksheetOptions",a.join(""),{xmlns:Un.x})}function Cee(e){return e.map(function(t){var r=Kz(t.t||""),n=we("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return we("Comment",n,{"ss:Author":t.a})}).join("")}function Tee(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+wt(iw(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=Gt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=wt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=wt(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=i.c||c[f].s.r!=i.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=oi[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Be[14]);break;case"s":d="String",h=Gz(e.v||"");break}var p=fo(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var g=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=Cee(e.c)),we("Cell",m,o)}function Nee(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Gc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Aee(e,t,r,n){if(!e["!ref"])return"";var a=ft(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,v){eo(x);var y=!!x.width,w=rm(v,x),E={"ss:Index":v+1};y&&(E["ss:Width"]=ad(w.width)),x.hidden&&(E["ss:Hidden"]="1"),o.push(we("Column",null,E))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var f=[Nee(c,(e["!rows"]||[])[c])],d=a.s.c;d<=a.e.c;++d){var h=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>d)&&!(s[i].s.r>c)&&!(s[i].e.c<d)&&!(s[i].e.r<c)){(s[i].s.c!=d||s[i].s.r!=c)&&(h=!0);break}if(!h){var p={r:c,c:d},g=$e(p),m=l?(e[c]||[])[d]:e[g];f.push(Tee(m,g,e,t,r,n,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function Ree(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?See(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?Aee(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(kee(s,t,e,r)),n.join("")}function Pee(e,t){t||(t={}),e.SSF||(e.SSF=Ot(Be)),e.SSF&&(uu(),Xp(e.SSF),t.revssf=Qp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],fo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(wee(e,t)),r.push(_ee()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(we("Worksheet",Ree(n,t,e),{"ss:Name":wt(e.SheetNames[n])}));return r[2]=Eee(e,t),r[3]=bee(e),lr+we("Workbook",r.join(""),{xmlns:Un.ss,"xmlns:o":Un.o,"xmlns:x":Un.x,"xmlns:ss":Un.ss,"xmlns:dt":Un.dt,"xmlns:html":Un.html})}function jee(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=bH(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=SH(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Fee=[60,1084,2066,2165,2175];function Oee(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=$s(r,r.l),c=Fv[l],f=0;c!=null&&Fee.indexOf(l)>-1;)s=$s(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,c=Fv[l=$s(r,r.l)];var d=Nr(i);Mr(d,0);var h=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(h),h+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function ss(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Be[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||oi[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jf(e.v):e.w=rl(e.v):e.w=Sa(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&cu(Be[n]||String(n))){var a=No(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Nh(e,t,r){return{v:e,ixfe:t,t:r}}function Iee(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",f={},d,h="",p,g,m,x,v={},y=[],w,E,b=[],k=[],S={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},N=function(Xe){return Xe<8?Uo[Xe]:Xe<64&&k[Xe-8]||Uo[Xe]},O=function(Xe,Lt,sn){var Bt=Lt.XF.data;if(!(!Bt||!Bt.patternType||!sn||!sn.cellStyles)){Lt.s={},Lt.s.patternType=Bt.patternType;var En;(En=nd(N(Bt.icvFore)))&&(Lt.s.fgColor={rgb:En}),(En=nd(N(Bt.icvBack)))&&(Lt.s.bgColor={rgb:En})}},j=function(Xe,Lt,sn){if(!(ce>1)&&!(sn.sheetRows&&Xe.r>=sn.sheetRows)){if(sn.cellStyles&&Lt.XF&&Lt.XF.data&&O(Xe,Lt,sn),delete Lt.ixfe,delete Lt.XF,d=Xe,h=$e(Xe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Xe.r<i.s.r&&(i.s.r=Xe.r),Xe.c<i.s.c&&(i.s.c=Xe.c),Xe.r+1>i.e.r&&(i.e.r=Xe.r+1),Xe.c+1>i.e.c&&(i.e.c=Xe.c+1),sn.cellFormula&&Lt.f){for(var Bt=0;Bt<y.length;++Bt)if(!(y[Bt][0].s.c>Xe.c||y[Bt][0].s.r>Xe.r)&&!(y[Bt][0].e.c<Xe.c||y[Bt][0].e.r<Xe.r)){Lt.F=Qe(y[Bt][0]),(y[Bt][0].s.c!=Xe.c||y[Bt][0].s.r!=Xe.r)&&delete Lt.f,Lt.f&&(Lt.f=""+Xr(y[Bt][1],i,Xe,A,D));break}}sn.dense?(a[Xe.r]||(a[Xe.r]=[]),a[Xe.r][Xe.c]=Lt):a[h]=Lt}},D={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(D.password=t.password);var Y,Q=[],G=[],X=[],q=[],K=!1,A=[];A.SheetNames=D.snames,A.sharedf=D.sharedf,A.arrayf=D.arrayf,A.names=[],A.XTI=[];var ne=0,ce=0,R=0,z=[],U=[],V;D.codepage=1200,$a(1200);for(var J=!1;e.l<e.length-1;){var W=e.l,se=e.read_shift(2);if(se===0&&ne===10)break;var ie=e.l===e.length?0:e.read_shift(2),ae=Fv[se];if(ae&&ae.f){if(t.bookSheets&&ne===133&&se!==133)break;if(ne=se,ae.r===2||ae.r==12){var be=e.read_shift(2);if(ie-=2,!D.enc&&be!==se&&((be&255)<<8|be>>8)!==se)throw new Error("rt mismatch: "+be+"!="+se);ae.r==12&&(e.l+=10,ie-=10)}var I={};if(se===10?I=ae.f(e,ie,D):I=Oee(se,ae,e,ie,D),ce==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(se){case 34:r.opts.Date1904=S.WBProps.date1904=I;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(e.l=0),D.enc=I,!t.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=I;break;case 66:var He=Number(I);switch(He){case 21010:He=1200;break;case 32768:He=1e4;break;case 32769:He=1252;break}$a(D.codepage=He),J=!0;break;case 317:D.rrtabid=I;break;case 25:D.winlocked=I;break;case 439:r.opts.RefreshAll=I;break;case 12:r.opts.CalcCount=I;break;case 16:r.opts.CalcDelta=I;break;case 17:r.opts.CalcIter=I;break;case 13:r.opts.CalcMode=I;break;case 14:r.opts.CalcPrecision=I;break;case 95:r.opts.CalcSaveRecalc=I;break;case 15:D.CalcRefMode=I;break;case 2211:r.opts.FullCalc=I;break;case 129:I.fDialog&&(a["!type"]="dialog"),I.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),I.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:b.push(I);break;case 430:A.push([I]),A[A.length-1].XTI=[];break;case 35:case 547:A[A.length-1].push(I);break;case 24:case 536:V={Name:I.Name,Ref:Xr(I.rgce,i,null,A,D)},I.itab>0&&(V.Sheet=I.itab-1),A.names.push(V),A[0]||(A[0]=[],A[0].XTI=[]),A[A.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(U[I.itab-1]={ref:Qe(I.rgce[0][0][1][2])});break;case 22:D.ExternCount=I;break;case 23:A.length==0&&(A[0]=[],A[0].XTI=[]),A[A.length-1].XTI=A[A.length-1].XTI.concat(I),A.XTI=A.XTI.concat(I);break;case 2196:if(D.biff<8)break;V!=null&&(V.Comment=I[1]);break;case 18:a["!protect"]=I;break;case 19:I!==0&&D.WTF&&console.error("Password verifier: "+I);break;case 133:s[I.pos]=I,D.snames.push(I.name);break;case 10:{if(--ce)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Qe(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ue=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Qe(i),i.e.r=Ue}i.e.r++,i.e.c++}Q.length>0&&(a["!merges"]=Q),G.length>0&&(a["!objects"]=G),X.length>0&&(a["!cols"]=X),q.length>0&&(a["!rows"]=q),S.Sheets.push(T)}c===""?f=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),D.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(D.biff=5,J=!0,$a(D.codepage=28591)),D.biff==8&&I.BIFFVer==0&&I.dt==16&&(D.biff=2),ce++)break;if(a=t.dense?[]:{},D.biff<8&&!J&&(J=!0,$a(D.codepage=t.codepage||1252)),D.biff<5||I.BIFFVer==0&&I.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var at={pos:e.l-ie,name:c};s[at.pos]=at,D.snames.push(c)}else c=(s[W]||{name:""}).name;I.dt==32&&(a["!type"]="chart"),I.dt==64&&(a["!type"]="macro"),Q=[],G=[],D.arrayf=y=[],X=[],q=[],K=!1,T={Hidden:(s[W]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[I.r]||[])[I.c]:a[$e({c:I.c,r:I.r})])&&++I.c,w={ixfe:I.ixfe,XF:b[I.ixfe]||{},v:I.val,t:"n"},R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j({c:I.c,r:I.r},w,t);break;case 5:case 517:w={ixfe:I.ixfe,XF:b[I.ixfe],v:I.val,t:I.t},R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j({c:I.c,r:I.r},w,t);break;case 638:w={ixfe:I.ixfe,XF:b[I.ixfe],v:I.rknum,t:"n"},R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j({c:I.c,r:I.r},w,t);break;case 189:for(var Ve=I.c;Ve<=I.C;++Ve){var ve=I.rkrec[Ve-I.c][0];w={ixfe:ve,XF:b[ve],v:I.rkrec[Ve-I.c][1],t:"n"},R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j({c:Ve,r:I.r},w,t)}break;case 6:case 518:case 1030:{if(I.val=="String"){o=I;break}if(w=Nh(I.val,I.cell.ixfe,I.tt),w.XF=b[w.ixfe],t.cellFormula){var xt=I.formula;if(xt&&xt[0]&&xt[0][0]&&xt[0][0][0]=="PtgExp"){var fe=xt[0][0][1][0],Re=xt[0][0][1][1],lt=$e({r:fe,c:Re});v[lt]?w.f=""+Xr(I.formula,i,I.cell,A,D):w.F=((t.dense?(a[fe]||[])[Re]:a[lt])||{}).F}else w.f=""+Xr(I.formula,i,I.cell,A,D)}R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j(I.cell,w,t),o=I}break;case 7:case 519:if(o)o.val=I,w=Nh(I,o.cell.ixfe,"s"),w.XF=b[w.ixfe],t.cellFormula&&(w.f=""+Xr(o.formula,i,o.cell,A,D)),R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(I);var pr=$e(I[0].s);if(p=t.dense?(a[I[0].s.r]||[])[I[0].s.c]:a[pr],t.cellFormula&&p){if(!o||!pr||!p)break;p.f=""+Xr(I[1],i,I[0],A,D),p.F=Qe(I[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;v[$e(o.cell)]=I[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[$e(o.cell)],(p||{}).f=""+Xr(I[0],i,d,A,D)}}break;case 253:w=Nh(l[I.isst].t,I.ixfe,"s"),l[I.isst].h&&(w.h=l[I.isst].h),w.XF=b[w.ixfe],R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j({c:I.c,r:I.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:I.ixfe,XF:b[I.ixfe],t:"z"},R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j({c:I.c,r:I.r},w,t));break;case 190:if(t.sheetStubs)for(var Nt=I.c;Nt<=I.C;++Nt){var qe=I.ixfe[Nt-I.c];w={ixfe:qe,XF:b[qe],t:"z"},R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j({c:Nt,r:I.r},w,t)}break;case 214:case 516:case 4:w=Nh(I.val,I.ixfe,"s"),w.XF=b[w.ixfe],R>0&&(w.z=z[w.ixfe>>8&63]),ss(w,t,r.opts.Date1904),j({c:I.c,r:I.r},w,t);break;case 0:case 512:ce===1&&(i=I);break;case 252:l=I;break;case 1054:if(D.biff==4){z[R++]=I[1];for(var rr=0;rr<R+163&&Be[rr]!=I[1];++rr);rr>=163&&zs(I[1],R+163)}else zs(I[1],I[0]);break;case 30:{z[R++]=I;for(var Mt=0;Mt<R+163&&Be[Mt]!=I;++Mt);Mt>=163&&zs(I,R+163)}break;case 229:Q=Q.concat(I);break;case 93:G[I.cmo[0]]=D.lastobj=I;break;case 438:D.lastobj.TxO=I;break;case 127:D.lastobj.ImData=I;break;case 440:for(x=I[0].s.r;x<=I[0].e.r;++x)for(m=I[0].s.c;m<=I[0].e.c;++m)p=t.dense?(a[x]||[])[m]:a[$e({c:m,r:x})],p&&(p.l=I[1]);break;case 2048:for(x=I[0].s.r;x<=I[0].e.r;++x)for(m=I[0].s.c;m<=I[0].e.c;++m)p=t.dense?(a[x]||[])[m]:a[$e({c:m,r:x})],p&&p.l&&(p.l.Tooltip=I[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;p=t.dense?(a[I[0].r]||[])[I[0].c]:a[$e(I[0])];var ea=G[I[2]];p||(t.dense?(a[I[0].r]||(a[I[0].r]=[]),p=a[I[0].r][I[0].c]={t:"z"}):p=a[$e(I[0])]={t:"z"},i.e.r=Math.max(i.e.r,I[0].r),i.s.r=Math.min(i.s.r,I[0].r),i.e.c=Math.max(i.e.c,I[0].c),i.s.c=Math.min(i.s.c,I[0].c)),p.c||(p.c=[]),g={a:I[1],t:ea.TxO.t},p.c.push(g)}break;case 2173:EX(b[I.ixfe],I.ext);break;case 125:{if(!D.cellStyles)break;for(;I.e>=I.s;)X[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},K||(K=!0,nw(I.w/256)),eo(X[I.e+1])}break;case 520:{var jr={};I.level!=null&&(q[I.r]=jr,jr.level=I.level),I.hidden&&(q[I.r]=jr,jr.hidden=!0),I.hpt&&(q[I.r]=jr,jr.hpt=I.hpt,jr.hpx=Gc(I.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Vo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=I;break;case 161:a["!margins"]||Vo(a["!margins"]={}),a["!margins"].header=I.header,a["!margins"].footer=I.footer;break;case 574:I.RTL&&(S.Views[0].RTL=!0);break;case 146:k=I;break;case 2198:Y=I;break;case 140:E=I;break;case 442:c?T.CodeName=I||T.name:S.WBProps.CodeName=I||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=ie}return r.SheetNames=tr(s).sort(function(ta,Xe){return Number(ta)-Number(Xe)}).map(function(ta){return s[ta].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&U.forEach(function(ta,Xe){r.Sheets[r.SheetNames[Xe]]["!autofilter"]=ta}),r.Strings=l,r.SSF=Ot(Be),D.enc&&(r.Encryption=D.enc),Y&&(r.Themes=Y),r.Metadata={},E!==void 0&&(r.Metadata.Country=E),A.names.length>0&&(S.Names=A.names),r.Workbook=S,r}var hf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Dee(e,t,r){var n=Oe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=sb(n,Cv,hf.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Oe.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=sb(i,Tv,hf.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(pR(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Mee(e,t){var r=[],n=[],a=[],s=0,i,o=IE(Cv,"n"),l=IE(Tv,"n");if(e.Props)for(i=tr(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=tr(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var c=[];for(s=0;s<a.length;++s)_R.indexOf(a[s][0])>-1||hR.indexOf(a[s][0])>-1||a[s][1]!=null&&c.push(a[s]);n.length&&Oe.utils.cfb_add(t,"/SummaryInformation",ib(n,hf.SI,l,Tv)),(r.length||c.length)&&Oe.utils.cfb_add(t,"/DocumentSummaryInformation",ib(r,hf.DSI,o,Cv,c.length?c:null,hf.UDI))}function gP(e,t){t||(t={}),dw(t),Fy(),t.codepage&&jy(t.codepage);var r,n;if(e.FullPaths){if(Oe.find(e,"/encryption"))throw new Error("File is password-protected");r=Oe.find(e,"!CompObj"),n=Oe.find(e,"/Workbook")||Oe.find(e,"/Book")}else{switch(t.type){case"base64":e=zn(Yn(e));break;case"binary":e=zn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Mr(e,0),n={content:e}}var a,s;if(r&&jee(r),t.bookProps&&!t.bookSheets)a={};else{var i=rt?"buffer":"array";if(n&&n.content)a=Iee(n.content,t);else if((s=Oe.find(e,"PerfectOffice_MAIN"))&&s.content)a=Wo.to_workbook(s.content,(t.type=i,t));else if((s=Oe.find(e,"NativeContent_MAIN"))&&s.content)a=Wo.to_workbook(s.content,(t.type=i,t));else throw(s=Oe.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Oe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=YX(e))}var o={};return e.FullPaths&&Dee(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function Lee(e,t){var r=t||{},n=Oe.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Oe.utils.cfb_add(n,a,xP(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Mee(e,n),r.biff==8&&e.vbaraw&&QX(n,Oe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var od={0:{f:lJ},1:{f:gJ},2:{f:IJ},3:{f:SJ},4:{f:wJ},5:{f:jJ},6:{f:UJ},7:{f:NJ},8:{f:KJ},9:{f:GJ},10:{f:zJ},11:{f:HJ},12:{f:vJ},13:{f:MJ},14:{f:CJ},15:{f:EJ},16:{f:lP},17:{f:WJ},18:{f:RJ},19:{f:Ky},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:WZ},40:{},42:{},43:{f:Uq},44:{f:Lq},45:{f:Vq},46:{f:Hq},47:{f:zq},48:{},49:{f:fH},50:{},51:{f:kX},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:jR},62:{f:BJ},63:{f:OX},64:{f:cZ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:tn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sZ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pJ},148:{f:fJ,p:16},151:{f:ZJ},152:{},153:{f:BZ},154:{},155:{},156:{f:MZ},157:{},158:{},159:{T:1,f:tq},160:{T:-1},161:{T:1,f:Sl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qJ},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:bX},336:{T:-1},337:{f:NX,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:kv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:PR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eZ},427:{f:tZ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nZ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hJ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:QJ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:kv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:HX},633:{T:1},634:{T:-1},635:{T:1,f:VX},636:{T:-1},637:{f:mH},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:CZ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uZ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Fv={6:{f:Ag},10:{f:hi},12:{f:fr},13:{f:fr},14:{f:nr},15:{f:nr},16:{f:Jr},17:{f:nr},18:{f:nr},19:{f:fr},20:{f:db},21:{f:db},23:{f:PR},24:{f:pb},25:{f:nr},26:{},27:{},28:{f:uK},29:{},34:{f:nr},35:{f:hb},38:{f:Jr},39:{f:Jr},40:{f:Jr},41:{f:Jr},42:{f:nr},43:{f:nr},47:{f:Eq},49:{f:MG},51:{f:fr},60:{},61:{f:jG},64:{f:nr},65:{f:DG},66:{f:fr},77:{},80:{},81:{},82:{},85:{f:fr},89:{},90:{},91:{},92:{f:_G},93:{f:hK},94:{},95:{f:nr},96:{},97:{},99:{f:nr},125:{f:jR},128:{f:JG},129:{f:bG},130:{f:fr},131:{f:nr},132:{f:nr},133:{f:SG},134:{},140:{f:_K},141:{f:fr},144:{},146:{f:SK},151:{},152:{},153:{},154:{},155:{},156:{f:fr},157:{},158:{},160:{f:PK},161:{f:TK},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:qG},190:{f:XG},193:{f:hi},197:{},198:{},199:{},200:{},201:{},202:{f:nr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:fr},220:{},221:{f:nr},222:{},224:{f:QG},225:{f:wG},226:{f:hi},227:{},229:{f:fK},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:CG},253:{f:BG},255:{f:NG},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ER},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:nr},353:{f:hi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:nK},431:{f:nr},432:{},433:{},434:{},437:{},438:{f:gK},439:{f:nr},440:{f:xK},441:{},442:{f:Od},443:{},444:{f:fr},445:{},446:{},448:{f:hi},449:{f:PG,r:2},450:{f:hi},512:{f:cb},513:{f:RK},515:{f:tK},516:{f:$G},517:{f:fb},519:{f:jK},520:{f:AG},523:{},545:{f:mb},549:{f:lb},566:{},574:{f:OG},638:{f:KG},659:{},1048:{},1054:{f:VG},1084:{},1212:{f:oK},2048:{f:yK},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:kh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:hi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:kK,r:12},2173:{f:_X,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:nr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:iK,r:12},2197:{},2198:{f:mX,r:12},2199:{},2200:{},2201:{},2202:{f:lK,r:12},2203:{f:hi},2204:{},2205:{},2206:{},2207:{},2211:{f:RG},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:fr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:NK},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bK},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cb},1:{},2:{f:MK},3:{f:IK},4:{f:OK},5:{f:fb},7:{f:BK},8:{},9:{f:kh},11:{},22:{f:fr},30:{f:HG},31:{},32:{},33:{f:mb},36:{},37:{f:lb},50:{f:UK},62:{},52:{},67:{},68:{f:fr},69:{},86:{},126:{},127:{f:FK},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:$K},223:{},234:{},354:{},421:{},518:{f:Ag},521:{f:kh},536:{f:pb},547:{f:hb},561:{},579:{},1030:{f:Ag},1033:{f:kh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _e(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&zy(r)&&e.push(r)}}function Bee(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return _e(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(i[o]||8224)<=8224;)c+=i[o]||8224,o++;f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Ld(e,t,r){return e||(e=oe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Uee(e,t,r,n){var a=oe(9);return Ld(a,e,t),bR(r,n||"b",a),a}function $ee(e,t,r){var n=oe(8+2*r.length);return Ld(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Wee(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?br(Ft(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?_e(e,2,LK(r,n,a)):_e(e,3,DK(r,n,a));return;case"b":case"e":_e(e,5,Uee(r,n,t.v,t.t));return;case"s":case"str":_e(e,4,$ee(r,n,(t.v||"").slice(0,255)));return}_e(e,1,Ld(null,r,n))}function Vee(e,t,r,n){var a=Array.isArray(t),s=ft(t["!ref"]||"A1"),i,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Qe(s)}for(var c=s.s.r;c<=s.e.r;++c){o=or(c);for(var f=s.s.c;f<=s.e.c;++f){c===s.s.r&&(l[f]=Ht(f)),i=l[f]+o;var d=a?(t[c]||[])[f]:t[i];d&&Wee(e,d,c,f)}}}function zee(e,t){for(var r=t||{},n=jn(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(n,r.biff==4?1033:r.biff==3?521:9,ew(e,16,r)),Vee(n,e.Sheets[e.SheetNames[a]],a,r),_e(n,10),n.end()}function Hee(e,t,r){_e(e,49,LG({sz:12,name:"Arial"},r))}function Gee(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&_e(e,1054,zG(a,t[a],r))})}function Kee(e,t){var r=oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(e,2151,r),r=oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),NR(ft(t["!ref"]||"A1"),r),r.write_shift(4,4),_e(e,2152,r)}function qee(e,t){for(var r=0;r<16;++r)_e(e,224,ub({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){_e(e,224,ub(n,0,t))})}function Xee(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];_e(e,440,vK(n)),n[1].Tooltip&&_e(e,2048,wK(n))}delete t["!links"]}function Yee(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&_e(e,125,CK(rm(a,n),a))})}}function Qee(e,t,r,n,a){var s=16+fo(a.cellXfs,t,a);if(t.v==null&&!t.bf){_e(e,513,il(r,n,s));return}if(t.bf)_e(e,6,bQ(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?br(Ft(t.v)):t.v;_e(e,515,rK(r,n,i,s));break;case"b":case"e":_e(e,517,eK(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=lw(a.Strings,t.v,a.revStrings);_e(e,253,UG(r,n,o,s))}else _e(e,516,WG(r,n,(t.v||"").slice(0,255),s,a));break;default:_e(e,513,il(r,n,s))}}function Jee(e,t,r){var n=jn(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,f,d="",h=[],p=ft(s["!ref"]||"A1"),g=c?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}_e(n,2057,ew(r,16,t)),_e(n,13,ca(1)),_e(n,12,ca(100)),_e(n,15,hn(!0)),_e(n,17,hn(!1)),_e(n,16,al(.001)),_e(n,95,hn(!0)),_e(n,42,hn(!1)),_e(n,43,hn(!1)),_e(n,130,ca(1)),_e(n,128,ZG()),_e(n,131,hn(!1)),_e(n,132,hn(!1)),c&&Yee(n,s["!cols"]),_e(n,512,GG(p,t)),c&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){d=or(m);for(var x=p.s.c;x<=p.e.c;++x){m===p.s.r&&(h[x]=Ht(x)),f=h[x]+d;var v=l?(s[m]||[])[x]:s[f];v&&(Qee(n,v,m,x,t),c&&v.l&&s["!links"].push([f,v.l]))}}var y=o.CodeName||o.name||a;return c&&_e(n,574,IG((i.Views||[])[0])),c&&(s["!merges"]||[]).length&&_e(n,229,dK(s["!merges"])),c&&Xee(n,s),_e(n,442,SR(y)),c&&Kee(n,s),_e(n,10),n.end()}function Zee(e,t,r){var n=jn(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(_e(n,2057,ew(e,5,r)),r.bookType=="xla"&&_e(n,135),_e(n,225,o?ca(1200):null),_e(n,193,eG(2)),l&&_e(n,191),l&&_e(n,192),_e(n,226),_e(n,92,EG("SheetJS",r)),_e(n,66,ca(o?1200:1252)),o&&_e(n,353,ca(0)),o&&_e(n,448),_e(n,317,AK(e.SheetNames.length)),o&&e.vbaraw&&_e(n,211),o&&e.vbaraw){var c=i.CodeName||"ThisWorkbook";_e(n,442,SR(c))}_e(n,156,ca(17)),_e(n,25,hn(!1)),_e(n,18,hn(!1)),_e(n,19,ca(0)),o&&_e(n,431,hn(!1)),o&&_e(n,444,ca(0)),_e(n,61,FG()),_e(n,64,hn(!1)),_e(n,141,ca(0)),_e(n,34,hn(PZ(e)=="true")),_e(n,14,hn(!0)),o&&_e(n,439,hn(!1)),_e(n,218,ca(0)),Hee(n,e,r),Gee(n,e.SSF,r),qee(n,r),o&&_e(n,352,hn(!1));var f=n.end(),d=jn();o&&_e(d,140,EK()),o&&r.Strings&&Bee(d,252,TG(r.Strings)),_e(d,10);var h=d.end(),p=jn(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var x=f.length+g+h.length;for(m=0;m<e.SheetNames.length;++m){var v=s[m]||{};_e(p,133,kG({pos:x,hs:v.Hidden||0,dt:0,name:e.SheetNames[m]},r)),x+=t[m].length}var y=p.end();if(g!=y.length)throw new Error("BS8 "+g+" != "+y.length);var w=[];return f.length&&w.push(f),y.length&&w.push(y),h.length&&w.push(h),Nr(w)}function ete(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Ot(Be)),e&&e.SSF&&(uu(),Xp(e.SSF),r.revssf=Qp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,hw(r),r.cellXfs=[],fo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Jee(a,r,e);return n.unshift(Zee(e,n,r)),Nr(n)}function xP(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Fn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return ete(e,t);case 4:case 3:case 2:return zee(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function kb(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=Lz(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<l.length;++i){var m=l[i].trim(),x=m.slice(0,3).toLowerCase();if(x=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(x!="<td"&&x!="<th")){var v=m.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var y=v[o].trim();if(y.match(/<t[dh]/i)){for(var w=y,E=0;w.charAt(0)=="<"&&(E=w.indexOf(">"))>-1;)w=w.slice(E+1);for(var b=0;b<g.length;++b){var k=g[b];k.s.c==f&&k.s.r<c&&c<=k.e.r&&(f=k.e.c+1,b=-1)}var S=ze(y.slice(0,y.indexOf(">")));h=S.colspan?+S.colspan:1,((d=+S.rowspan)>1||h>1)&&g.push({s:{r:c,c:f},e:{r:c+(d||1)-1,c:f+h-1}});var T=S.t||S["data-t"]||"";if(!w.length){f+=h;continue}if(w=$4(w),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!w.length){f+=h;continue}var N={t:"s",v:w};r.raw||!w.trim().length||T=="s"||(w==="TRUE"?N={t:"b",v:!0}:w==="FALSE"?N={t:"b",v:!1}:isNaN(Ga(w))?isNaN(zc(w).getDate())||(N={t:"d",v:Ft(w)},r.cellDates||(N={t:"n",v:br(N.v)}),N.z=r.dateNF||Be[14]):N={t:"n",v:Ga(w)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=N):n[$e({r:c,c:f})]=N,f+=h}}}}return n["!ref"]=Qe(p),g.length&&(n["!merges"]=g),n}function tte(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var f=$e({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||$y(d.w||(Zs(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+f,s.push(we("td",h,p))}}var g="<tr>";return g+s.join("")+"</tr>"}var rte='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nte="</body></html>";function ate(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return uo(kb(r[0],t),t);var n=gw();return r.forEach(function(a,s){xw(n,kb(a,t),"Sheet"+(s+1))}),n}function ste(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function vP(e,t){var r=t||{},n=r.header!=null?r.header:rte,a=r.footer!=null?r.footer:nte,s=[n],i=Fn(e["!ref"]);r.dense=Array.isArray(e),s.push(ste(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(tte(e,i,o,r));return s.push("</table>"+a),s.join("")}function yP(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Gt(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=Fn(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),a==-1&&(c.e.r=a=f.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),g=0,m=0,x=0,v=0,y=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<l;++g){var E=o[g];if(Cb(E)){if(n.display)continue;p[m]={hidden:!0}}var b=E.children;for(x=v=0;x<b.length;++x){var k=b[x];if(!(n.display&&Cb(k))){var S=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):$4(k.innerHTML),T=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<d.length;++h){var N=d[h];N.s.c==v+s&&N.s.r<m+a&&m+a<=N.e.r&&(v=N.e.c+1-s,h=-1)}w=+k.getAttribute("colspan")||1,((y=+k.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:m+a,c:v+s},e:{r:m+a+(y||1)-1,c:v+s+(w||1)-1}});var O={t:"s",v:S},j=k.getAttribute("data-t")||k.getAttribute("t")||"";S!=null&&(S.length==0?O.t=j||"z":n.raw||S.trim().length==0||j=="s"||(S==="TRUE"?O={t:"b",v:!0}:S==="FALSE"?O={t:"b",v:!1}:isNaN(Ga(S))?isNaN(zc(S).getDate())||(O={t:"d",v:Ft(S)},n.cellDates||(O={t:"n",v:br(O.v)}),O.z=n.dateNF||Be[14]):O={t:"n",v:Ga(S)})),O.z===void 0&&T!=null&&(O.z=T);var D="",Y=k.getElementsByTagName("A");if(Y&&Y.length)for(var Q=0;Q<Y.length&&!(Y[Q].hasAttribute("href")&&(D=Y[Q].getAttribute("href"),D.charAt(0)!="#"));++Q);D&&D.charAt(0)!="#"&&(O.l={Target:D}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][v+s]=O):e[$e({c:v+s,r:m+a})]=O,c.e.c<v+s&&(c.e.c=v+s),v+=w}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Qe(c),m>=l&&(e["!fullref"]=Qe((c.e.r=o.length-g+m-1+a,c))),e}function wP(e,t){var r=t||{},n=r.dense?[]:{};return yP(n,e,t)}function ite(e,t){return uo(wP(e,t),t)}function Cb(e){var t="",r=ote(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function ote(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function lte(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ut(t.replace(/<[^>]*>/g,""));return[r]}var Tb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function _P(e,t){var r=t||{},n=Wy(e),a=[],s,i,o={name:""},l="",c=0,f,d,h={},p=[],g=r.dense?[]:{},m,x,v={value:""},y="",w=0,E=[],b=-1,k=-1,S={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,N={},O=[],j={},D=0,Y=0,Q=[],G=1,X=1,q=[],K={Names:[]},A={},ne=["",""],ce=[],R={},z="",U=0,V=!1,J=!1,W=0;for(td.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=td.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(S.e.c>=S.s.c&&S.e.r>=S.s.r?g["!ref"]=Qe(S):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=S.e.r&&(g["!fullref"]=g["!ref"],S.e.r=r.sheetRows-1,g["!ref"]=Qe(S)),O.length&&(g["!merges"]=O),Q.length&&(g["!rows"]=Q),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),h[f.name]=g,J=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=ze(m[0],!1),b=k=-1,S.s.r=S.s.c=1e7,S.e.r=S.e.c=0,g=r.dense?[]:{},O=[],Q=[],J=!0);break;case"table-row-group":m[1]==="/"?--T:++T;break;case"table-row":case"":if(m[1]==="/"){b+=G,G=1;break}if(d=ze(m[0],!1),d.?b=d.-1:b==-1&&(b=0),G=+d["number-rows-repeated"]||1,G<10)for(W=0;W<G;++W)T>0&&(Q[b+W]={level:T});k=-1;break;case"covered-table-cell":m[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(g[b]||(g[b]=[]),g[b][k]={t:"z"}):g[$e({r:b,c:k})]={t:"z"}),y="",E=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++k,v=ze(m[0],!1),X=parseInt(v["number-columns-repeated"]||"1",10),x={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(x.f=Eb(ut(v.formula))),(v.||v["value-type"])=="string"&&(x.t="s",x.v=ut(v["string-value"]||""),r.dense?(g[b]||(g[b]=[]),g[b][k]=x):g[$e({r:b,c:k})]=x),k+=X-1;else if(m[1]!=="/"){++k,y="",w=0,E=[],X=1;var se=G?b+G-1:b;if(k>S.e.c&&(S.e.c=k),k<S.s.c&&(S.s.c=k),b<S.s.r&&(S.s.r=b),se>S.e.r&&(S.e.r=se),v=ze(m[0],!1),ce=[],R={},x={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=ut(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(D=parseInt(v["number-matrix-rows-spanned"],10)||0,Y=parseInt(v["number-matrix-columns-spanned"],10)||0,j={s:{r:b,c:k},e:{r:b+D-1,c:k+Y-1}},x.F=Qe(j),q.push([j,x.F])),v.formula)x.f=Eb(v.formula);else for(W=0;W<q.length;++W)b>=q[W][0].s.r&&b<=q[W][0].e.r&&k>=q[W][0].s.c&&k<=q[W][0].e.c&&(x.F=q[W][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(D=parseInt(v["number-rows-spanned"],10)||0,Y=parseInt(v["number-columns-spanned"],10)||0,j={s:{r:b,c:k},e:{r:b+D-1,c:k+Y-1}},O.push(j)),v["number-columns-repeated"]&&(X=parseInt(v["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=Pt(v["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(v.value);break;case"percentage":x.t="n",x.v=parseFloat(v.value);break;case"currency":x.t="n",x.v=parseFloat(v.value);break;case"date":x.t="d",x.v=Ft(v["date-value"]),r.cellDates||(x.t="n",x.v=br(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=Iz(v["time-value"])/86400,r.cellDates&&(x.t="d",x.v=Jp(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(v.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",v["string-value"]!=null&&(y=ut(v["string-value"]),E=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(V=!1,x.t==="s"&&(x.v=y||"",E.length&&(x.R=E),V=w==0),A.Target&&(x.l=A),ce.length>0&&(x.c=ce,ce=[]),y&&r.cellText!==!1&&(x.w=y),V&&(x.t="z",delete x.v),(!V||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var ie=0;ie<G;++ie){if(X=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(g[b+ie]||(g[b+ie]=[]),g[b+ie][k]=ie==0?x:Ot(x);--X>0;)g[b+ie][k+X]=Ot(x);else for(g[$e({r:b+ie,c:k})]=x;--X>0;)g[$e({r:b+ie,c:k+X})]=Ot(x);S.e.c<=k&&(S.e.c=k)}X=parseInt(v["number-columns-repeated"]||"1",10),k+=X-1,X=0,x={},y="",E=[]}A={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;R.t=y,E.length&&(R.R=E),R.a=z,ce.push(R)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);z="",U=0,y="",w=0,E=[];break;case"creator":m[1]==="/"?z=n.slice(U,m.index):U=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);y="",w=0,E=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(N[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=ze(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=ze(m[0],!1),l+=Tb[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=ze(m[0],!1),l+=Tb[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=ze(m[0],!1),ne=Rg(i["cell-range-address"]);var ae={Name:i.name,Ref:ne[0]+"!"+ne[1]};J&&(ae.Sheet=p.length),K.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!v||!v["string-value"])){var be=lte(n.slice(w,m.index));y=(y.length>0?y+`
`:"")+be[0]}else ze(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ne=Rg(ze(m[0])["target-range-address"]),h[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(A=ze(m[0],!1),!A.href)break;A.Target=ut(A.href),delete A.href,A.Target.charAt(0)=="#"&&A.Target.indexOf(".")>-1?(ne=Rg(A.Target.slice(1)),A.Target="#"+ne[0]+"!"+ne[1]):A.Target.match(/^\.\.[\\\/]/)&&(A.Target=A.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var I={Sheets:h,SheetNames:p,Workbook:K};return r.bookSheets&&delete I.Sheets,I}function Nb(e,t){t=t||{},oa(e,"META-INF/manifest.xml")&&IH(ur(e,"META-INF/manifest.xml"),t);var r=Hn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=_P(Et(r),t);return oa(e,"meta.xml")&&(n.Props=fR(ur(e,"meta.xml"))),n}function Ab(e,t){return _P(e,t)}var cte=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ed({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return lr+t}}(),Rb=function(){var e=function(s){return wt(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var l=[];l.push('      <table:table table:name="'+wt(i.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,d=Fn(s["!ref"]||"A1"),h=s["!merges"]||[],p=0,g=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",x=s["!rows"]||[];for(c=0;c<d.s.r;++c)m=x[c]?' table:style-name="ro'+x[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=d.e.r;++c){for(m=x[c]?' table:style-name="ro'+x[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),f=0;f<d.s.c;++f)l.push(t);for(;f<=d.e.c;++f){var v=!1,y={},w="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>f)&&!(h[p].s.r>c)&&!(h[p].e.c<f)&&!(h[p].e.r<c)){(h[p].s.c!=f||h[p].s.r!=c)&&(v=!0),y["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,y["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(v){l.push(r);continue}var E=$e({r:c,c:f}),b=g?(s[c]||[])[f]:s[E];if(b&&b.f&&(y["table:formula"]=wt(AQ(b.f)),b.F&&b.F.slice(0,E.length)==E)){var k=Fn(b.F);y["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,y["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!b){l.push(t);continue}switch(b.t){case"b":w=b.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=b.v?"true":"false";break;case"n":w=b.w||String(b.v||0),y["office:value-type"]="float",y["office:value"]=b.v||0;break;case"s":case"str":w=b.v==null?"":b.v,y["office:value-type"]="string";break;case"d":w=b.w||Ft(b.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Ft(b.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var S=e(w);if(b.l&&b.l.Target){var T=b.l.Target;T=T.charAt(0)=="#"?"#"+RQ(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),S=we("text:a",S,{"xlink:href":T.replace(/&/g,"&amp;")})}l.push("          "+we("table:table-cell",we("text:p",S,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var d=c["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;eo(d),d.ods=o;var h=c["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(c){return i.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var d=c["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var l=[lr],c=ed({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=ed({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(uR().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),a(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)l.push(n(i.Sheets[i.SheetNames[d]],i,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function EP(e,t){if(t.bookType=="fods")return Rb(e,t);var r=Ly(),n="",a=[],s=[];return n="mimetype",Ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ze(r,n,Rb(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ze(r,n,cte(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ze(r,n,lr+uR()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ze(r,n,LH(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ze(r,n,DH(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ol(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ov(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Et(co(e))}function ute(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):zn(xs(e))}function fte(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ro(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Pb(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function dte(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function hte(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function ld(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function vt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function er(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function dt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=ld(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=ld(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Ir(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(vt(n*8+a.type)),a.type==2&&t.push(vt(a.data.length)),t.push(a.data))})}),ro(t)}function fw(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function sa(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=ld(e,n),s=dt(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:er(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=dt(o.data),c=er(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=er(s[3][0].data)>>>0>0),r.push(i)}return r}function Ml(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:vt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:vt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:vt(i.data.length)}],n[2].push({data:Ir(i.meta),type:2})});var s=Ir(n);t.push(vt(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),ro(t)}function pte(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ld(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ro(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var f=ro(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function ia(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(pte(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ro(t)}function Ll(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=vt(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return ro(t)}function mte(e,t,r,n){var a=ol(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Pb(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=Pb(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function gte(e,t,r){var n=ol(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);a&1&&(l=dte(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function jg(e,t){var r=new Uint8Array(32),n=ol(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,hte(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Fg(e,t){var r=new Uint8Array(32),n=ol(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function xte(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return mte(e,t,r,e[0]);case 5:return gte(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function qr(e){var t=dt(e);return ld(t[1][0].data)}function jb(e,t){var r=dt(t.data),n=er(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=dt(i.data),l=er(o[1][0].data)>>>0;switch(n){case 1:s[l]=Ov(o[3][0].data);break;case 8:{var c=e[qr(o[9][0].data)][0],f=dt(c.data),d=e[qr(f[1][0].data)][0],h=er(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=dt(d.data);s[l]=p[3].map(function(g){return Ov(g.data)}).join("")}break}}),s}function vte(e,t){var r,n,a,s,i,o,l,c,f,d,h,p,g,m,x=dt(e),v=er(x[1][0].data)>>>0,y=er(x[2][0].data)>>>0,w=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&er(x[8][0].data)>0||!1,E,b;if((s=(a=x[7])==null?void 0:a[0])!=null&&s.data&&t!=0)E=(o=(i=x[7])==null?void 0:i[0])==null?void 0:o.data,b=(c=(l=x[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(f=x[4])==null?void 0:f[0])!=null&&d.data&&t!=1)E=(p=(h=x[4])==null?void 0:h[0])==null?void 0:p.data,b=(m=(g=x[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=w?4:1,S=ol(E),T=[],N=0;N<E.length/2;++N){var O=S.getUint16(N*2,!0);O<65535&&T.push([N,O])}if(T.length!=y)throw"Expected ".concat(y," cells, found ").concat(T.length);var j=[];for(N=0;N<T.length-1;++N)j[T[N][0]]=b.subarray(T[N][1]*k,T[N+1][1]*k);return T.length>=1&&(j[T[T.length-1][0]]=b.subarray(T[T.length-1][1]*k)),{R:v,cells:j}}function yte(e,t){var r,n=dt(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?er(n[7][0].data)>>>0>0?1:0:-1,s=fw(n[5],function(i){return vte(i,a)});return{nrows:er(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function wte(e,t,r){var n,a=dt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(er(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(er(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Qe(s);var i=dt(a[4][0].data),o=jb(e,e[qr(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?jb(e,e[qr(i[17][0].data)][0]):[],c=dt(i[3][0].data),f=0;c[1].forEach(function(d){var h=dt(d.data),p=e[qr(h[2][0].data)][0],g=er(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=yte(e,p);m.data.forEach(function(x,v){x.forEach(function(y,w){var E=$e({r:f+v,c:w}),b=xte(y,o,l);b&&(r[E]=b)})}),f+=m.nrows})}function _te(e,t){var r=dt(t.data),n={"!ref":"A1"},a=e[qr(r[2][0].data)],s=er(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return wte(e,a[0],n),n}function Ete(e,t){var r,n=dt(t.data),a={name:(r=n[1])!=null&&r[0]?Ov(n[1][0].data):"",sheets:[]},s=fw(n[2],qr);return s.forEach(function(i){e[i].forEach(function(o){var l=er(o.meta[1][0].data);l==6e3&&a.sheets.push(_te(e,o))})}),a}function bte(e,t){var r=gw(),n=dt(t.data),a=fw(n[1],qr);if(a.forEach(function(s){e[s].forEach(function(i){var o=er(i.meta[1][0].data);if(o==2){var l=Ete(e,i);l.sheets.forEach(function(c,f){xw(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Og(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=ia(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=sa(c)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&er(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var f=er(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return bte(s,o)}function Ste(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&er(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=ol(e[7][0].data),f=0,d=[],h=ol(e[4][0].data),p=0,g=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}c.setUint16(m*2,f,!0),h.setUint16(m*2,p,!0);var x,v;switch(typeof t[m]){case"string":x=jg({t:"s",v:t[m]},r),v=Fg({t:"s",v:t[m]},r);break;case"number":x=jg({t:"n",v:t[m]},r),v=Fg({t:"n",v:t[m]},r);break;case"boolean":x=jg({t:"b",v:t[m]},r),v=Fg({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(x),f+=x.length,g.push(v),p+=v.length,++l}for(e[2][0].data=vt(l);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=ro(d),e[3][0].data=ro(g),l}function kte(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Fn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Qe(n)));var s=J0(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(z){return z.forEach(function(U){typeof U=="string"&&i.push(U)})});var o={},l=[],c=Oe.read(t.numbers,{type:"base64"});c.FileIndex.map(function(z,U){return[z,c.FullPaths[U]]}).forEach(function(z){var U=z[0],V=z[1];if(U.type==2&&U.name.match(/\.iwa/)){var J=U.content,W=ia(J),se=sa(W);se.forEach(function(ie){l.push(ie.id),o[ie.id]={deps:[],location:V,type:er(ie.messages[0].meta[1][0].data)}})}}),l.sort(function(z,U){return z-U});var f=l.filter(function(z){return z>1}).map(function(z){return[z,vt(z)]});c.FileIndex.map(function(z,U){return[z,c.FullPaths[U]]}).forEach(function(z){var U=z[0];if(z[1],!!U.name.match(/\.iwa/)){var V=sa(ia(U.content));V.forEach(function(J){J.messages.forEach(function(W){f.forEach(function(se){J.messages.some(function(ie){return er(ie.meta[1][0].data)!=11006&&fte(ie.data,se[1])})&&o[se[0]].deps.push(J.id)})})})}});for(var d=Oe.find(c,o[1].location),h=sa(ia(d.content)),p,g=0;g<h.length;++g){var m=h[g];m.id==1&&(p=m)}var x=qr(dt(p.messages[0].data)[1][0].data);for(d=Oe.find(c,o[x].location),h=sa(ia(d.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);for(x=qr(dt(p.messages[0].data)[2][0].data),d=Oe.find(c,o[x].location),h=sa(ia(d.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);for(x=qr(dt(p.messages[0].data)[2][0].data),d=Oe.find(c,o[x].location),h=sa(ia(d.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);var v=dt(p.messages[0].data);{v[6][0].data=vt(n.e.r+1),v[7][0].data=vt(n.e.c+1);var y=qr(v[46][0].data),w=Oe.find(c,o[y].location),E=sa(ia(w.content));{for(var b=0;b<E.length&&E[b].id!=y;++b);if(E[b].id!=y)throw"Bad ColumnRowUIDMapArchive";var k=dt(E[b].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var S=0;S<=n.e.c;++S){var T=[];T[1]=T[2]=[{type:0,data:vt(S+420690)}],k[1].push({type:2,data:Ir(T)}),k[2].push({type:0,data:vt(S)}),k[3].push({type:0,data:vt(S)})}k[4]=[],k[5]=[],k[6]=[];for(var N=0;N<=n.e.r;++N)T=[],T[1]=T[2]=[{type:0,data:vt(N+726270)}],k[4].push({type:2,data:Ir(T)}),k[5].push({type:0,data:vt(N)}),k[6].push({type:0,data:vt(N)});E[b].messages[0].data=Ir(k)}w.content=Ll(Ml(E)),w.size=w.content.length,delete v[46];var O=dt(v[4][0].data);{O[7][0].data=vt(n.e.r+1);var j=dt(O[1][0].data),D=qr(j[2][0].data);w=Oe.find(c,o[D].location),E=sa(ia(w.content));{if(E[0].id!=D)throw"Bad HeaderStorageBucket";var Y=dt(E[0].messages[0].data);for(N=0;N<s.length;++N){var Q=dt(Y[2][0].data);Q[1][0].data=vt(N),Q[4][0].data=vt(s[N].length),Y[2][N]={type:Y[2][0].type,data:Ir(Q)}}E[0].messages[0].data=Ir(Y)}w.content=Ll(Ml(E)),w.size=w.content.length;var G=qr(O[2][0].data);w=Oe.find(c,o[G].location),E=sa(ia(w.content));{if(E[0].id!=G)throw"Bad HeaderStorageBucket";for(Y=dt(E[0].messages[0].data),S=0;S<=n.e.c;++S)Q=dt(Y[2][0].data),Q[1][0].data=vt(S),Q[4][0].data=vt(n.e.r+1),Y[2][S]={type:Y[2][0].type,data:Ir(Q)};E[0].messages[0].data=Ir(Y)}w.content=Ll(Ml(E)),w.size=w.content.length;var X=qr(O[4][0].data);(function(){for(var z=Oe.find(c,o[X].location),U=sa(ia(z.content)),V,J=0;J<U.length;++J){var W=U[J];W.id==X&&(V=W)}var se=dt(V.messages[0].data);{se[3]=[];var ie=[];i.forEach(function(I,He){ie[1]=[{type:0,data:vt(He)}],ie[2]=[{type:0,data:vt(1)}],ie[3]=[{type:2,data:ute(I)}],se[3].push({type:2,data:Ir(ie)})})}V.messages[0].data=Ir(se);var ae=Ml(U),be=Ll(ae);z.content=be,z.size=z.content.length})();var q=dt(O[3][0].data);{var K=q[1][0];delete q[2];var A=dt(K.data);{var ne=qr(A[2][0].data);(function(){for(var z=Oe.find(c,o[ne].location),U=sa(ia(z.content)),V,J=0;J<U.length;++J){var W=U[J];W.id==ne&&(V=W)}var se=dt(V.messages[0].data);{delete se[6],delete q[7];var ie=new Uint8Array(se[5][0].data);se[5]=[];for(var ae=0,be=0;be<=n.e.r;++be){var I=dt(ie);ae+=Ste(I,s[be],i),I[1][0].data=vt(be),se[5].push({data:Ir(I),type:2})}se[1]=[{type:0,data:vt(n.e.c+1)}],se[2]=[{type:0,data:vt(n.e.r+1)}],se[3]=[{type:0,data:vt(ae)}],se[4]=[{type:0,data:vt(n.e.r+1)}]}V.messages[0].data=Ir(se);var He=Ml(U),Ue=Ll(He);z.content=Ue,z.size=z.content.length})()}K.data=Ir(A)}O[3][0].data=Ir(q)}v[4][0].data=Ir(O)}p.messages[0].data=Ir(v);var ce=Ml(h),R=Ll(ce);return d.content=R,d.size=d.content.length,c}function bP(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function dw(e){bP([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function hw(e){bP([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Cte(e){return nt.WS.indexOf(e)>-1?"sheet":e==nt.CS?"chart":e==nt.DS?"dialog":e==nt.MS?"macro":e&&e.length?e:"sheet"}function Tte(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Cte(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Nte(e,t,r,n,a,s,i,o,l,c,f,d){try{s[n]=cf(Hn(e,r,!0),t);var h=ur(e,t),p;switch(o){case"sheet":p=YZ(h,t,a,l,s[n],c,f,d);break;case"chart":if(p=QZ(h,t,a,l,s[n],c,f,d),!p||!p["!drawel"])break;var g=Hu(p["!drawel"].Target,t),m=rd(g),x=MX(Hn(e,g,!0),cf(Hn(e,m,!0),g)),v=Hu(x,g),y=rd(v);p=SZ(Hn(e,v,!0),v,l,cf(Hn(e,y,!0),v),c,p);break;case"macro":p=JZ(h,t,a,l,s[n],c,f,d);break;case"dialog":p=ZZ(h,t,a,l,s[n],c,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var w=[];s&&s[n]&&tr(s[n]).forEach(function(E){var b="";if(s[n][E].Type==nt.CMNT){b=Hu(s[n][E].Target,t);var k=nee(ur(e,b,!0),b,l);if(!k||!k.length)return;xb(p,k,!1)}s[n][E].Type==nt.TCMNT&&(b=Hu(s[n][E].Target,t),w=w.concat(BX(ur(e,b,!0),l)))}),w&&w.length&&xb(p,w,!0,l.people||[])}catch(E){if(l.WTF)throw E}}function ra(e){return e.charAt(0)=="/"?e.slice(1):e}function Ate(e,t){if(uu(),t=t||{},dw(t),oa(e,"META-INF/manifest.xml")||oa(e,"objectdata.xml"))return Nb(e,t);if(oa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Og<"u"){if(e.FileIndex)return Og(e);var r=Oe.utils.cfb_new();return LE(e).forEach(function(Q){Ze(r,Q,Uz(e,Q))}),Og(r)}throw new Error("Unsupported NUMBERS file")}if(!oa(e,"[Content_Types].xml"))throw oa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):oa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=LE(e),a=FH(Hn(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",ur(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!ur(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(uf=[],a.sst)try{uf=ree(ur(e,ra(a.sst)),a.sst,t)}catch(Q){if(t.WTF)throw Q}t.cellStyles&&a.themes.length&&(l=tee(Hn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=eee(ur(e,ra(a.style)),a.style,l,t))}a.links.map(function(Q){try{var G=cf(Hn(e,rd(ra(Q))),Q);return see(ur(e,ra(Q)),G,Q,t)}catch{}});var f=XZ(ur(e,ra(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=ur(e,ra(a.coreprops[0]),!0),h&&(d=fR(h)),a.extprops.length!==0&&(h=ur(e,ra(a.extprops[0]),!0),h&&UH(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=Hn(e,ra(a.custprops[0]),!0),h&&(p=WH(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(G){return G.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=p),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var m={};t.bookDeps&&a.calcchain&&(m=aee(ur(e,ra(a.calcchain)),a.calcchain));var x=0,v={},y,w;{var E=f.Sheets;d.Worksheets=E.length,d.SheetNames=[];for(var b=0;b!=E.length;++b)d.SheetNames[b]=E[b].name}var k=s?"bin":"xml",S=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,S+1)+"_rels/"+a.workbooks[0].slice(S+1)+".rels").replace(/^\//,"");oa(e,T)||(T="xl/_rels/workbook."+k+".rels");var N=cf(Hn(e,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=iee(ur(e,ra(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=$X(ur(e,ra(a.people[0])),t)),N&&(N=Tte(N,f.Sheets));var O=ur(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=d.Worksheets;++x){var j="sheet";if(N&&N[x]?(y="xl/"+N[x][1].replace(/[\/]?xl\//,""),oa(e,y)||(y=N[x][1]),oa(e,y)||(y=T.replace(/_rels\/.*$/,"")+N[x][1]),j=N[x][2]):(y="xl/worksheets/sheet"+(x+1-O)+"."+k,y=y.replace(/sheet0\./,"sheet.")),w=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(d.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var D=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==x&&(D=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==d.SheetNames[x].toLowerCase()&&(D=1);if(!D)continue e}}Nte(e,y,w,d.SheetNames[x],x,v,i,j,t,f,l,c)}return g={Directory:a,Workbook:f,Props:d,Custprops:p,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:uf,Styles:c,Themes:l,SSF:Ot(Be)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(Q,G){Q=Q.replace(/^Root Entry[\/]/,""),g.keys.push(Q),g.files[Q]=e.FileIndex[G]}))),t&&t.bookVBA&&(a.vba.length>0?g.vbaraw=ur(e,ra(a.vba[0]),!0):a.defaults&&a.defaults.bin===XX&&(g.vbaraw=ur(e,"xl/vbaProject.bin",!0))),g}function Rte(e,t){var r=t||{},n="Workbook",a=Oe.find(e,n);try{if(n="/!DataSpaces/Version",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(iq(a.content),n="/!DataSpaces/DataSpaceMap",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=lq(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=cq(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);fq(a.content)}catch{}if(n="/EncryptionInfo",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=dq(a.content);if(n="/EncryptedPackage",a=Oe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function Pte(e,t){return t.bookType=="ods"?EP(e,t):t.bookType=="numbers"?kte(e,t):t.bookType=="xlsb"?jte(e,t):Fte(e,t)}function jte(e,t){rc=1024,e&&!e.SSF&&(e.SSF=Ot(Be)),e&&e.SSF&&(uu(),Xp(e.SSF),t.revssf=Qp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ff?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=YR.indexOf(t.bookType)>-1,a=Jy();hw(t=t||{});var s=Ly(),i="",o=0;if(t.cellXfs=[],fo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ze(s,i,dR(e.Props,t)),a.coreprops.push(i),yt(t.rels,2,i,nt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ze(s,i,mR(e.Props)),a.extprops.push(i),yt(t.rels,3,i,nt.EXT_PROPS),e.Custprops!==e.Props&&tr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ze(s,i,gR(e.Custprops)),a.custprops.push(i),yt(t.rels,4,i,nt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ze(s,i,lee(o-1,i,t,e,f)),a.sheets.push(i),yt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,nt.WS[0])}if(d){var p=d["!comments"],g=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,Ze(s,m,fee(p,m)),a.comments.push(m),yt(f,-1,"../comments"+o+"."+r,nt.CMNT),g=!0),d["!legacy"]&&g&&Ze(s,"xl/drawings/vmlDrawing"+o+".vml",qR(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Ze(s,rd(i),mc(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ze(s,i,uee(t.Strings,i,t)),a.strs.push(i),yt(t.wbrels,-1,"sharedStrings."+r,nt.SST)),i="xl/workbook."+r,Ze(s,i,oee(e,i)),a.workbooks.push(i),yt(t.rels,1,i,nt.WB),i="xl/theme/theme1.xml",Ze(s,i,aw(e.Themes,t)),a.themes.push(i),yt(t.wbrels,-1,"theme/theme1.xml",nt.THEME),i="xl/styles."+r,Ze(s,i,cee(e,i,t)),a.styles.push(i),yt(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ze(s,i,e.vbaraw),a.vba.push(i),yt(t.wbrels,-1,"vbaProject.bin",nt.VBA)),i="xl/metadata."+r,Ze(s,i,dee(i)),a.metadata.push(i),yt(t.wbrels,-1,"metadata."+r,nt.XLMETA),Ze(s,"[Content_Types].xml",cR(a,t)),Ze(s,"_rels/.rels",mc(t.rels)),Ze(s,"xl/_rels/workbook."+r+".rels",mc(t.wbrels)),delete t.revssf,delete t.ssf,s}function Fte(e,t){rc=1024,e&&!e.SSF&&(e.SSF=Ot(Be)),e&&e.SSF&&(uu(),Xp(e.SSF),t.revssf=Qp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ff?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=YR.indexOf(t.bookType)>-1,a=Jy();hw(t=t||{});var s=Ly(),i="",o=0;if(t.cellXfs=[],fo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Ze(s,i,dR(e.Props,t)),a.coreprops.push(i),yt(t.rels,2,i,nt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ze(s,i,mR(e.Props)),a.extprops.push(i),yt(t.rels,3,i,nt.EXT_PROPS),e.Custprops!==e.Props&&tr(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Ze(s,i,gR(e.Custprops)),a.custprops.push(i),yt(t.rels,4,i,nt.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Ze(s,i,oP(o-1,t,e,d)),a.sheets.push(i),yt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,nt.WS[0])}if(h){var g=h["!comments"],m=!1,x="";if(g&&g.length>0){var v=!1;g.forEach(function(y){y[1].forEach(function(w){w.T==!0&&(v=!0)})}),v&&(x="xl/threadedComments/threadedComment"+o+"."+r,Ze(s,x,UX(g,f,t)),a.threadedcomments.push(x),yt(d,-1,"../threadedComments/threadedComment"+o+"."+r,nt.TCMNT)),x="xl/comments"+o+"."+r,Ze(s,x,XR(g)),a.comments.push(x),yt(d,-1,"../comments"+o+"."+r,nt.CMNT),m=!0}h["!legacy"]&&m&&Ze(s,"xl/drawings/vmlDrawing"+o+".vml",qR(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ze(s,rd(i),mc(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Ze(s,i,DR(t.Strings,t)),a.strs.push(i),yt(t.wbrels,-1,"sharedStrings."+r,nt.SST)),i="xl/workbook."+r,Ze(s,i,dP(e)),a.workbooks.push(i),yt(t.rels,1,i,nt.WB),i="xl/theme/theme1.xml",Ze(s,i,aw(e.Themes,t)),a.themes.push(i),yt(t.wbrels,-1,"theme/theme1.xml",nt.THEME),i="xl/styles."+r,Ze(s,i,zR(e,t)),a.styles.push(i),yt(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Ze(s,i,e.vbaraw),a.vba.push(i),yt(t.wbrels,-1,"vbaProject.bin",nt.VBA)),i="xl/metadata."+r,Ze(s,i,KR()),a.metadata.push(i),yt(t.wbrels,-1,"metadata."+r,nt.XLMETA),f.length>1&&(i="xl/persons/person.xml",Ze(s,i,WX(f)),a.people.push(i),yt(t.wbrels,-1,"persons/person.xml",nt.PEOPLE)),Ze(s,"[Content_Types].xml",cR(a,t)),Ze(s,"_rels/.rels",mc(t.rels)),Ze(s,"xl/_rels/workbook."+r+".rels",mc(t.wbrels)),delete t.revssf,delete t.ssf,s}function pw(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Yn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ote(e,t){return Oe.find(e,"EncryptedPackage")?Rte(e,t):gP(e,t)}function Ite(e,t){var r,n=e,a=t||{};return a.type||(a.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r=L4(n,a),Ate(r,a)}function SP(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return jv(e.slice(r),t);default:break e}return Hc.to_workbook(e,t)}function Dte(e,t){var r="",n=pw(e,t);switch(t.type){case"base64":r=Yn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=nl(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Et(r)),t.type="binary",SP(r,t)}function Mte(e,t){var r=e;return t.type=="base64"&&(r=Yn(r)),r=Yf.utils.decode(1200,r.slice(2),"str"),t.type="binary",SP(r,t)}function Lte(e){return e.match(/[^\x00-\x7F]/)?xs(e):e}function Ig(e,t,r,n){return n?(r.type="string",Hc.to_workbook(e,r)):Hc.to_workbook(t,r)}function Iv(e,t){Fy();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Iv(new Uint8Array(e),(r=Ot(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xc={},r.dateNF&&(xc.dateNF=r.dateNF),r.type||(r.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=rt?"buffer":"binary",n=jz(e),typeof Uint8Array<"u"&&!rt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Lte(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Ot(r),r.type="array",Iv(Oy(n),r)}switch((a=pw(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Ote(Oe.read(n,r),r);break;case 9:if(a[1]<=8)return gP(n,r);break;case 60:return jv(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return VK(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return OR.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Ite(n,r):Ig(e,n,r,s);case 239:return a[3]===60?jv(n,r):Ig(e,n,r,s);case 255:if(a[1]===254)return Mte(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Wo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Wo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Pv.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return $R.to_workbook(n,r);break;case 10:case 13:case 32:return Dte(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return WK.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Pv.to_workbook(n,r):Ig(e,n,r,s)}function kP(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Pd(t.file,Oe.write(e,{type:rt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Oe.write(e,t)}function Bte(e,t){var r=Ot(t||{}),n=Pte(e,r);return Ute(n,r)}function Ute(e,t){var r={},n=rt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Oe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(qp(a))}return t.password&&typeof encrypt_agile<"u"?kP(encrypt_agile(a,t.password),t):t.type==="file"?Pd(t.file,a):t.type=="string"?Et(a):a}function $te(e,t){var r=t||{},n=Lee(e,r);return kP(n,r)}function os(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Qf(xs(n));case"binary":return xs(n);case"string":return e;case"file":return Pd(t.file,n,"utf8");case"buffer":return rt?si(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):os(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Wte(e,t){switch(t.type){case"base64":return Qf(e);case"binary":return e;case"string":return e;case"file":return Pd(t.file,e,"binary");case"buffer":return rt?si(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ah(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Qf(r):t.type=="string"?Et(r):r;case"file":return Pd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function CP(e,t){Fy(),OZ(e);var r=Ot(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=CP(e,r);return r.type="array",qp(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return os(Pee(e,r),r);case"slk":case"sylk":return os(FR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return os(vP(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Wte(NP(e.Sheets[e.SheetNames[a]],r),r);case"csv":return os(mw(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return os(OR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Ah(Pv.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return os(Hc.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return os($R.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return os(IR.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return os(EP(e,r),r);case"wk1":return Ah(Wo.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Ah(Wo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ah(xP(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),$te(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Bte(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Vte(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function TP(e,t,r){var n=r||{};return n.type="file",n.file=t,Vte(n),CP(e,n)}function zte(e,t,r,n,a,s,i,o){var l=or(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=i?e[r][p]:e[n[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[p]!=null&&(h[s[p]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[p]!=null){if(m==null)if(g.t=="e"&&m===null)h[s[p]]=null;else if(c!==void 0)h[s[p]]=c;else if(f&&m===null)h[s[p]]=null;else continue;else h[s[p]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:Zs(g,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function J0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=ft(f);break;case"number":l=ft(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var d=or(l.s.r),h=[],p=[],g=0,m=0,x=Array.isArray(e),v=l.s.r,y=0,w={};x&&!e[v]&&(e[v]=[]);var E=c.skipHidden&&e["!cols"]||[],b=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(E[y]||{}).hidden)switch(h[y]=Ht(y),r=x?e[v][y]:e[h[y]+d],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Zs(r,null,c),m=w[i]||0,!m)w[i]=1;else{do o=i+"_"+m++;while(w[o]);w[i]=m,w[o]=1}s[y]=o}for(v=l.s.r+a;v<=l.e.r;++v)if(!(b[v]||{}).hidden){var k=zte(e,l,v,h,n,s,x,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=k.row)}return p.length=g,p}var Fb=/"/g;function Hte(e,t,r,n,a,s,i,o){for(var l=!0,c=[],f="",d=or(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+d];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:Zs(p,null,o));for(var g=0,m=0;g!==f.length;++g)if((m=f.charCodeAt(g))===a||m===s||m===34||o.forceQuotes){f='"'+f.replace(Fb,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Fb,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function mw(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ft(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(h[g]||{}).hidden||(d[g]=Ht(g));for(var m=0,x=a.s.r;x<=a.e.r;++x)(p[x]||{}).hidden||(f=Hte(e,a,x,d,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function NP(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=mw(e,t);return r}function Gte(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ft(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Ht(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=or(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function AP(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Gt(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=ft(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var h=n.header||[],p=0;t.forEach(function(m,x){tr(m).forEach(function(v){(p=h.indexOf(v))==-1&&(h[p=h.length]=v);var y=m[v],w="z",E="",b=$e({c:o+p,r:i+x+a});c=cd(s,b),y&&typeof y=="object"&&!(y instanceof Date)?s[b]=y:(typeof y=="number"?w="n":typeof y=="boolean"?w="b":typeof y=="string"?w="s":y instanceof Date?(w="d",n.cellDates||(w="n",y=br(y)),E=n.dateNF||Be[14]):y===null&&n.nullError&&(w="e",y=0),c?(c.t=w,c.v=y,delete c.w,delete c.R,E&&(c.z=E)):s[b]=c={t:w,v:y},E&&(c.z=E))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var g=or(i);if(a)for(p=0;p<h.length;++p)s[Ht(p+o)+g]={t:"s",v:h[p]};return s["!ref"]=Qe(f),s}function Kte(e,t){return AP(null,e,t)}function cd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Gt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?cd(e,$e(t)):cd(e,$e({r:t,c:r||0}))}function qte(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function gw(){return{SheetNames:[],Sheets:{}}}function xw(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(fP(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Xte(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=qte(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Yte(e,t){return e.z=t,e}function RP(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Qte(e,t,r){return RP(e,"#"+t,r)}function Jte(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Zte(e,t,r,n){for(var a=typeof t!="string"?t:ft(t),s=typeof t=="string"?t:Qe(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=cd(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var zo={encode_col:Ht,encode_row:or,encode_cell:$e,encode_range:Qe,decode_col:Gy,decode_row:Hy,split_cell:uH,decode_cell:Gt,decode_range:Fn,format_cell:Zs,sheet_add_aoa:rR,sheet_add_json:AP,sheet_add_dom:yP,aoa_to_sheet:fu,json_to_sheet:Kte,table_to_sheet:wP,table_to_book:ite,sheet_to_csv:mw,sheet_to_txt:NP,sheet_to_json:J0,sheet_to_html:vP,sheet_to_formulae:Gte,sheet_to_row_object_array:J0,sheet_get_cell:cd,book_new:gw,book_append_sheet:xw,book_set_sheet_visibility:Xte,cell_set_number_format:Yte,cell_set_hyperlink:RP,cell_set_internal_link:Qte,cell_add_comment:Jte,sheet_set_array_formula:Zte,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const PP=[{key:"code",header:"Codigo"},{key:"name",header:"Producto"},{key:"price_usd",header:"Precio"},{key:"image_url",header:"Imagen"},{key:"supplier",header:"Suministrador"},{key:"warehouse",header:"Almacen"},{key:"category",header:"Categoria"},{key:"extra_prices.precio_p",header:"Precio P"},{key:"extra_prices.precio_m",header:"Precio M."},{key:"image_filter",header:"Filtro para Imagenes"},{key:"flags.ef_tkc",header:"EF TKC"},{key:"store_id",header:"ID Tienda"},{key:"states.estado_anuncio",header:"Estado Anuncio"},{key:"states.estado_tienda",header:"Estado en Tienda"},{key:"store_name",header:"Tienda"},{key:"is_selected",header:"Selecto"},{key:"category_f1",header:"Cat.F1"},{key:"category_f2",header:"Cat.F2"},{key:"category_f3",header:"Cat.F3"},{key:"is_active",header:"Activo"}];function ere(e,t){return t.split(".").reduce((r,n)=>{if(r&&typeof r=="object")return r[n]},e)}function tre(e,t){return e==null?null:typeof e=="boolean"?e?"S":"No":typeof e=="number"?e:e instanceof Date?e.toISOString().split("T")[0]:typeof e=="object"?JSON.stringify(e):String(e)}function jP(e,t){let r=e;return t.includeInactive||(r=r.filter(n=>n.is_active)),t.onlySelected&&(r=r.filter(n=>n.is_selected)),t.category&&(r=r.filter(n=>n.category===t.category)),r.map(n=>{const a={};for(const s of PP){const i=ere(n,s.key);a[s.header]=tre(i,s.key)}return a})}function Dv(e,t){const r=jP(e,t);if(r.length===0)throw new Error("No hay items para exportar");const n=zo.book_new(),a=zo.json_to_sheet(r),s=PP.map(l=>({wch:Math.max(l.header.length,15)}));a["!cols"]=s,zo.book_append_sheet(n,a,"Catalogo");const i=new Date().toISOString().split("T")[0];let o=`${t.catalogName}_${i}`;t.onlySelected&&(o+="_selectos"),t.category&&(o+=`_${t.category}`),o+=".xlsx",o=o.replace(/[^a-zA-Z0-9_\-\.]/g,"_"),TP(n,o)}function FP(e,t){const r=jP(e,t);if(r.length===0)throw new Error("No hay items para exportar");const n=zo.book_new(),a=zo.json_to_sheet(r);zo.book_append_sheet(n,a,"Catalogo");const s=new Date().toISOString().split("T")[0];let i=`${t.catalogName}_${s}`;t.onlySelected&&(i+="_selectos"),t.category&&(i+=`_${t.category}`),i+=".csv",i=i.replace(/[^a-zA-Z0-9_\-\.]/g,"_"),TP(n,i,{bookType:"csv"})}function rre(){const{data:e,isLoading:t}=QV(),{data:r,isLoading:n}=ZV(),[a,s]=_.useState(null),[i,o]=_.useState(""),[l,c]=_.useState("all"),[f,d]=_.useState("grid"),h=a||(e&&e.length>0?e[0].id:null),{data:p,isLoading:g}=JV(h),m=[...new Set((p||[]).map(y=>y.category).filter(Boolean))],x=(p||[]).filter(y=>{const w=y.name.toLowerCase().includes(i.toLowerCase())||y.code.toLowerCase().includes(i.toLowerCase()),E=l==="all"||y.category===l;return w&&E}),v=e==null?void 0:e.find(y=>y.id===h);return t?u.jsx(ya,{children:u.jsxs("div",{className:"space-y-8",children:[u.jsx(mt,{className:"h-10 w-64"}),u.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[u.jsx(mt,{className:"h-48"}),u.jsx(mt,{className:"h-48"})]})]})}):!e||e.length===0?u.jsx(ya,{children:u.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[u.jsx(Ha,{className:"h-16 w-16 text-muted-foreground/50 mb-4"}),u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"No tienes catlogos asignados"}),u.jsx("p",{className:"text-muted-foreground max-w-md",children:"Contacta a tu gestor para que te asigne acceso a los catlogos disponibles."}),u.jsx("div",{className:"mt-6 w-full max-w-md space-y-3",children:n?u.jsx("div",{className:"space-y-2",children:[1,2,3].map(y=>u.jsx(mt,{className:"h-12 w-full"},y))}):r&&r.length>0?r.map(y=>u.jsx(et,{children:u.jsxs(ot,{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 py-4",children:[u.jsxs("div",{className:"text-left",children:[u.jsx("p",{className:"font-medium",children:y.full_name||y.email.split("@")[0]}),u.jsx("p",{className:"text-sm text-muted-foreground",children:y.email}),y.sales_description&&u.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:y.sales_description})]}),u.jsx(ye,{asChild:!0,variant:"outline",className:"justify-center",children:u.jsx("a",{href:`mailto:${y.email}`,children:"Escribir"})})]})},y.id)):u.jsx("p",{className:"text-sm text-muted-foreground",children:"No hay gestores disponibles para contacto."})})]})}):u.jsx(ya,{children:u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Catlogo de Productos"}),u.jsx("p",{className:"text-muted-foreground mt-1",children:"Explora nuestra seleccin de productos disponibles"})]}),v&&u.jsxs($c,{children:[u.jsx(Wc,{asChild:!0,children:u.jsxs(ye,{size:"lg",className:"gap-2",children:[u.jsx(_0,{className:"h-5 w-5"}),"Descargar catlogo"]})}),u.jsxs(tl,{align:"end",children:[u.jsx(Tr,{onClick:()=>{try{Dv(p||[],{catalogName:v.name,includeInactive:!0}),Pe.success("Catlogo exportado en Excel")}catch(y){Pe.error(y instanceof Error?y.message:"Error al exportar el catlogo")}},children:"Descargar en Excel"}),u.jsx(Tr,{onClick:()=>{try{FP(p||[],{catalogName:v.name,includeInactive:!0}),Pe.success("Catlogo exportado en CSV")}catch(y){Pe.error(y instanceof Error?y.message:"Error al exportar el catlogo")}},children:"Descargar en CSV"})]})]})]}),u.jsx("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:e.map(y=>u.jsxs(et,{className:`group cursor-pointer overflow-hidden transition-all duration-300 hover:shadow-xl ${h===y.id?"ring-2 ring-primary shadow-xl":"hover:-translate-y-1"}`,onClick:()=>s(y.id),children:[u.jsxs("div",{className:"relative h-32 overflow-hidden bg-gradient-to-br from-primary/20 to-primary/5",children:[u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx(Ha,{className:"h-16 w-16 text-primary/30"})}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-background/80 to-transparent"}),u.jsxs("div",{className:"absolute bottom-3 left-4 right-4",children:[u.jsx("h3",{className:"font-semibold text-foreground text-lg",children:y.name}),u.jsxs("p",{className:"text-muted-foreground text-sm",children:[y.item_count," productos"]})]})]}),u.jsx(ot,{className:"py-3",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("span",{className:"text-xs text-muted-foreground",children:["Actualizado: ",L0(new Date(y.updated_at),{addSuffix:!0,locale:B0})]}),u.jsxs(ye,{size:"sm",variant:"ghost",className:"text-primary hover:text-primary",children:[u.jsx(_0,{className:"h-4 w-4 mr-1"}),"PDF"]})]})})]},y.id))}),v&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between bg-muted/30 p-4 rounded-xl",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 flex-1 w-full sm:w-auto",children:[u.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[u.jsx(Cp,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),u.jsx(zt,{placeholder:"Buscar productos...",value:i,onChange:y=>o(y.target.value),className:"pl-9 bg-background"})]}),u.jsxs(Ba,{value:l,onValueChange:c,children:[u.jsx(pa,{className:"w-full sm:w-[180px] bg-background",children:u.jsx(Ua,{placeholder:"Categora"})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"all",children:"Todas las categoras"}),m.map(y=>u.jsx(bt,{value:y,children:y},y))]})]})]}),u.jsxs("div",{className:"flex items-center gap-1 bg-background rounded-lg p-1 border",children:[u.jsx(ye,{size:"sm",variant:f==="grid"?"default":"ghost",onClick:()=>d("grid"),className:"h-8 px-3",children:u.jsx(xD,{className:"h-4 w-4"})}),u.jsx(ye,{size:"sm",variant:f==="list"?"default":"ghost",onClick:()=>d("list"),className:"h-8 px-3",children:u.jsx(_D,{className:"h-4 w-4"})})]})]}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:[x.length," productos encontrados"]}),g?u.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:[1,2,3,4].map(y=>u.jsx(mt,{className:"h-80"},y))}):x.length===0?u.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[u.jsx(Zm,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),u.jsx("p",{children:"No se encontraron productos"})]}):u.jsxs(u.Fragment,{children:[f==="grid"&&u.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:x.map(y=>u.jsxs(et,{className:"group overflow-hidden transition-all duration-300 hover:shadow-xl hover:-translate-y-1",children:[u.jsxs("div",{className:"relative aspect-square overflow-hidden bg-muted",children:[y.image_url?u.jsx("img",{src:y.image_url,alt:y.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-muted to-muted/50",children:u.jsx(Zm,{className:"h-16 w-16 text-muted-foreground/30"})}),y.is_selected&&u.jsx("div",{className:"absolute top-3 right-3",children:u.jsx("div",{className:"bg-warning text-warning-foreground rounded-full p-1.5 shadow-lg",children:u.jsx(rf,{className:"h-4 w-4 fill-current"})})}),y.category&&u.jsx("div",{className:"absolute top-3 left-3",children:u.jsx(Ct,{variant:"secondary",className:"bg-background/90 backdrop-blur-sm",children:y.category})})]}),u.jsxs(ot,{className:"p-4 space-y-3",children:[u.jsx("span",{className:"text-xs font-mono text-muted-foreground",children:y.code}),u.jsx("h3",{className:"font-medium leading-tight line-clamp-2 min-h-[2.5rem]",children:y.name}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[u.jsx("span",{children:y.supplier||"Sin proveedor"}),u.jsx("span",{className:"text-primary/70",children:y.store_name||"Sin tienda"})]}),u.jsx("div",{className:"pt-2 border-t",children:u.jsxs("div",{className:"flex items-baseline justify-between",children:[u.jsxs("span",{className:"text-2xl font-bold text-primary",children:["$",y.price_usd.toFixed(2)]}),u.jsx("span",{className:"text-xs text-muted-foreground",children:"USD"})]})})]})]},y.id))}),f==="list"&&u.jsx("div",{className:"space-y-3",children:x.map(y=>u.jsx(et,{className:"group overflow-hidden transition-all duration-200 hover:shadow-lg",children:u.jsxs("div",{className:"flex items-center gap-4 p-4",children:[u.jsxs("div",{className:"relative h-20 w-20 flex-shrink-0 overflow-hidden rounded-lg bg-muted",children:[y.image_url?u.jsx("img",{src:y.image_url,alt:y.name,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center",children:u.jsx(Zm,{className:"h-8 w-8 text-muted-foreground/30"})}),y.is_selected&&u.jsx("div",{className:"absolute -top-1 -right-1",children:u.jsx("div",{className:"bg-warning text-warning-foreground rounded-full p-1 shadow-lg",children:u.jsx(rf,{className:"h-3 w-3 fill-current"})})})]}),u.jsx("div",{className:"flex-1 min-w-0",children:u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx("span",{className:"text-xs font-mono text-muted-foreground",children:y.code}),y.category&&u.jsx(Ct,{variant:"secondary",className:"text-xs",children:y.category})]}),u.jsx("h3",{className:"font-medium truncate",children:y.name}),u.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-muted-foreground",children:[u.jsx("span",{children:y.supplier||"Sin proveedor"}),u.jsx("span",{children:""}),u.jsx("span",{children:y.store_name||"Sin tienda"})]})]}),u.jsxs("div",{className:"text-right flex-shrink-0",children:[u.jsxs("div",{className:"text-2xl font-bold text-primary",children:["$",y.price_usd.toFixed(2)]}),u.jsx("span",{className:"text-xs text-muted-foreground",children:"USD"})]})]})})]})},y.id))})]})]})]})})}const nm=_.forwardRef(({className:e,...t},r)=>u.jsx("textarea",{className:he("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));nm.displayName="Textarea";function nre(e){const t=are(e),r=_.forwardRef((n,a)=>{const{children:s,...i}=n,o=_.Children.toArray(s),l=o.find(ire);if(l){const c=l.props.children,f=o.map(d=>d===l?_.Children.count(c)>1?_.Children.only(null):_.isValidElement(c)?c.props.children:null:d);return u.jsx(t,{...i,ref:a,children:_.isValidElement(c)?_.cloneElement(c,void 0,f):null})}return u.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}function are(e){const t=_.forwardRef((r,n)=>{const{children:a,...s}=r;if(_.isValidElement(a)){const i=lre(a),o=ore(s,a.props);return a.type!==_.Fragment&&(o.ref=n?ti(n,i):i),_.cloneElement(a,o)}return _.Children.count(a)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var sre=Symbol("radix.slottable");function ire(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===sre}function ore(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function lre(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var am="Dialog",[OP,IP]=rn(am),[cre,es]=OP(am),DP=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:s,modal:i=!0}=e,o=_.useRef(null),l=_.useRef(null),[c,f]=ba({prop:n,defaultProp:a??!1,onChange:s,caller:am});return u.jsx(cre,{scope:t,triggerRef:o,contentRef:l,contentId:xa(),titleId:xa(),descriptionId:xa(),open:c,onOpenChange:f,onOpenToggle:_.useCallback(()=>f(d=>!d),[f]),modal:i,children:r})};DP.displayName=am;var MP="DialogTrigger",LP=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=es(MP,r),s=Ke(t,a.triggerRef);return u.jsx(Ae.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":ww(a.open),...n,ref:s,onClick:ge(e.onClick,a.onOpenToggle)})});LP.displayName=MP;var vw="DialogPortal",[ure,BP]=OP(vw,{forceMount:void 0}),UP=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,s=es(vw,t);return u.jsx(ure,{scope:t,forceMount:r,children:_.Children.map(n,i=>u.jsx(Vr,{present:r||s.open,children:u.jsx(_d,{asChild:!0,container:a,children:i})}))})};UP.displayName=vw;var Z0="DialogOverlay",$P=_.forwardRef((e,t)=>{const r=BP(Z0,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,s=es(Z0,e.__scopeDialog);return s.modal?u.jsx(Vr,{present:n||s.open,children:u.jsx(dre,{...a,ref:t})}):null});$P.displayName=Z0;var fre=nre("DialogOverlay.RemoveScroll"),dre=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=es(Z0,r);return u.jsx($p,{as:fre,allowPinchZoom:!0,shards:[a.contentRef],children:u.jsx(Ae.div,{"data-state":ww(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),ll="DialogContent",WP=_.forwardRef((e,t)=>{const r=BP(ll,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,s=es(ll,e.__scopeDialog);return u.jsx(Vr,{present:n||s.open,children:s.modal?u.jsx(hre,{...a,ref:t}):u.jsx(pre,{...a,ref:t})})});WP.displayName=ll;var hre=_.forwardRef((e,t)=>{const r=es(ll,e.__scopeDialog),n=_.useRef(null),a=Ke(t,r.contentRef,n);return _.useEffect(()=>{const s=n.current;if(s)return Ey(s)},[]),u.jsx(VP,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(e.onCloseAutoFocus,s=>{var i;s.preventDefault(),(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ge(e.onPointerDownOutside,s=>{const i=s.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&s.preventDefault()}),onFocusOutside:ge(e.onFocusOutside,s=>s.preventDefault())})}),pre=_.forwardRef((e,t)=>{const r=es(ll,e.__scopeDialog),n=_.useRef(!1),a=_.useRef(!1);return u.jsx(VP,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((c=r.triggerRef.current)==null?void 0:c.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),VP=_.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:s,...i}=e,o=es(ll,r),l=_.useRef(null),c=Ke(t,l);return wy(),u.jsxs(u.Fragment,{children:[u.jsx(Bp,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:s,children:u.jsx(Jc,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":ww(o.open),...i,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),u.jsxs(u.Fragment,{children:[u.jsx(gre,{titleId:o.titleId}),u.jsx(vre,{contentRef:l,descriptionId:o.descriptionId})]})]})}),yw="DialogTitle",zP=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=es(yw,r);return u.jsx(Ae.h2,{id:a.titleId,...n,ref:t})});zP.displayName=yw;var HP="DialogDescription",GP=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=es(HP,r);return u.jsx(Ae.p,{id:a.descriptionId,...n,ref:t})});GP.displayName=HP;var KP="DialogClose",qP=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=es(KP,r);return u.jsx(Ae.button,{type:"button",...n,ref:t,onClick:ge(e.onClick,()=>a.onOpenChange(!1))})});qP.displayName=KP;function ww(e){return e?"open":"closed"}var XP="DialogTitleWarning",[mre,YP]=uI(XP,{contentName:ll,titleName:yw,docsSlug:"dialog"}),gre=({titleId:e})=>{const t=YP(XP),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return _.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},xre="DialogDescriptionWarning",vre=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${YP(xre).contentName}}.`;return _.useEffect(()=>{var s;const a=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},QP=DP,JP=LP,ZP=UP,_w=$P,Ew=WP,bw=zP,Sw=GP,kw=qP;const Kc=QP,ej=JP,yre=ZP,tj=_.forwardRef(({className:e,...t},r)=>u.jsx(_w,{ref:r,className:he("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));tj.displayName=_w.displayName;const cl=_.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(yre,{children:[u.jsx(tj,{}),u.jsxs(Ew,{ref:n,className:he("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,u.jsxs(kw,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[u.jsx(Sd,{className:"h-4 w-4"}),u.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));cl.displayName=Ew.displayName;const ul=({className:e,...t})=>u.jsx("div",{className:he("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ul.displayName="DialogHeader";const fl=({className:e,...t})=>u.jsx("div",{className:he("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});fl.displayName="DialogFooter";const dl=_.forwardRef(({className:e,...t},r)=>u.jsx(bw,{ref:r,className:he("text-lg font-semibold leading-none tracking-tight",e),...t}));dl.displayName=bw.displayName;const hl=_.forwardRef(({className:e,...t},r)=>u.jsx(Sw,{ref:r,className:he("text-sm text-muted-foreground",e),...t}));hl.displayName=Sw.displayName;var wre=Symbol("radix.slottable");function _re(e){const t=({children:r})=>u.jsx(u.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=wre,t}var rj="AlertDialog",[Ere]=rn(rj,[IP]),li=IP(),nj=e=>{const{__scopeAlertDialog:t,...r}=e,n=li(t);return u.jsx(QP,{...n,...r,modal:!0})};nj.displayName=rj;var bre="AlertDialogTrigger",Sre=_.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=li(r);return u.jsx(JP,{...a,...n,ref:t})});Sre.displayName=bre;var kre="AlertDialogPortal",aj=e=>{const{__scopeAlertDialog:t,...r}=e,n=li(t);return u.jsx(ZP,{...n,...r})};aj.displayName=kre;var Cre="AlertDialogOverlay",sj=_.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=li(r);return u.jsx(_w,{...a,...n,ref:t})});sj.displayName=Cre;var vc="AlertDialogContent",[Tre,Nre]=Ere(vc),Are=_re("AlertDialogContent"),ij=_.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:n,...a}=e,s=li(r),i=_.useRef(null),o=Ke(t,i),l=_.useRef(null);return u.jsx(mre,{contentName:vc,titleName:oj,docsSlug:"alert-dialog",children:u.jsx(Tre,{scope:r,cancelRef:l,children:u.jsxs(Ew,{role:"alertdialog",...s,...a,ref:o,onOpenAutoFocus:ge(a.onOpenAutoFocus,c=>{var f;c.preventDefault(),(f=l.current)==null||f.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[u.jsx(Are,{children:n}),u.jsx(Pre,{contentRef:i})]})})})});ij.displayName=vc;var oj="AlertDialogTitle",lj=_.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=li(r);return u.jsx(bw,{...a,...n,ref:t})});lj.displayName=oj;var cj="AlertDialogDescription",uj=_.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=li(r);return u.jsx(Sw,{...a,...n,ref:t})});uj.displayName=cj;var Rre="AlertDialogAction",fj=_.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,a=li(r);return u.jsx(kw,{...a,...n,ref:t})});fj.displayName=Rre;var dj="AlertDialogCancel",hj=_.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...n}=e,{cancelRef:a}=Nre(dj,r),s=li(r),i=Ke(t,a);return u.jsx(kw,{...s,...n,ref:i})});hj.displayName=dj;var Pre=({contentRef:e})=>{const t=`\`${vc}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${vc}\` by passing a \`${cj}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${vc}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return _.useEffect(()=>{var n;document.getElementById((n=e.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},jre=nj,Fre=aj,pj=sj,mj=ij,gj=fj,xj=hj,vj=lj,yj=uj;const Cw=jre,Ore=Fre,wj=_.forwardRef(({className:e,...t},r)=>u.jsx(pj,{className:he("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));wj.displayName=pj.displayName;const sm=_.forwardRef(({className:e,...t},r)=>u.jsxs(Ore,{children:[u.jsx(wj,{}),u.jsx(mj,{ref:r,className:he("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));sm.displayName=mj.displayName;const im=({className:e,...t})=>u.jsx("div",{className:he("flex flex-col space-y-2 text-center sm:text-left",e),...t});im.displayName="AlertDialogHeader";const om=({className:e,...t})=>u.jsx("div",{className:he("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});om.displayName="AlertDialogFooter";const lm=_.forwardRef(({className:e,...t},r)=>u.jsx(vj,{ref:r,className:he("text-lg font-semibold",e),...t}));lm.displayName=vj.displayName;const cm=_.forwardRef(({className:e,...t},r)=>u.jsx(yj,{ref:r,className:he("text-sm text-muted-foreground",e),...t}));cm.displayName=yj.displayName;const um=_.forwardRef(({className:e,...t},r)=>u.jsx(gj,{ref:r,className:he(vy(),e),...t}));um.displayName=gj.displayName;const fm=_.forwardRef(({className:e,...t},r)=>u.jsx(xj,{ref:r,className:he(vy({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));fm.displayName=xj.displayName;function Ire(){const{user:e}=Dt();return Zn({queryKey:["catalogs"],queryFn:async()=>{const{data:t,error:r}=await Ce.from("catalogs").select("*").is("deleted_at",null).order("updated_at",{ascending:!1});if(r)throw r;return await Promise.all((t||[]).map(async a=>{const{data:s}=await Ce.from("catalog_versions").select("id, version_number").eq("catalog_id",a.id).order("version_number",{ascending:!1}).limit(1),i=s==null?void 0:s[0];let o=0;if(i){const{count:c}=await Ce.from("catalog_items").select("*",{count:"exact",head:!0}).eq("version_id",i.id).is("deleted_at",null);o=c||0}const{count:l}=await Ce.from("catalog_clients").select("*",{count:"exact",head:!0}).eq("catalog_id",a.id);return{...a,item_count:o,client_count:l||0,current_version:(i==null?void 0:i.version_number)||0}}))},enabled:!!e})}function _j(e){const{user:t}=Dt();return Zn({queryKey:["catalog",e],queryFn:async()=>{if(!e)return null;const{data:r,error:n}=await Ce.from("catalogs").select("*").eq("id",e).maybeSingle();if(n)throw n;if(!r)return null;const{data:a}=await Ce.from("catalog_versions").select("id, version_number").eq("catalog_id",r.id).order("version_number",{ascending:!1}).limit(1),s=a==null?void 0:a[0];let i=0;if(s){const{count:f}=await Ce.from("catalog_items").select("*",{count:"exact",head:!0}).eq("version_id",s.id).is("deleted_at",null);i=f||0}const{count:o}=await Ce.from("catalog_clients").select("*",{count:"exact",head:!0}).eq("catalog_id",r.id),{data:l}=await Ce.from("catalog_clients").select("client_id, clients!inner(id, name, email, status)").eq("catalog_id",r.id),c=(l||[]).map(f=>f.clients);return{...r,item_count:i,client_count:o||0,current_version:(s==null?void 0:s.version_number)||0,assigned_clients:c}},enabled:!!t&&!!e})}function Dre(){const e=Pr(),{user:t}=Dt();return nn({mutationFn:async r=>{if(!t)throw new Error("Not authenticated");const{data:n,error:a}=await Ce.from("catalogs").insert({name:r.name,description:r.description||null,tags:r.tags||[],created_by:t.id}).select().single();if(a)throw a;const{error:s}=await Ce.from("catalog_versions").insert({catalog_id:n.id,version_number:1,status:"draft",notes:"Versin inicial",created_by:t.id});if(s)throw s;return n},onSuccess:()=>{e.invalidateQueries({queryKey:["catalogs"]}),Pe.success("Catlogo creado exitosamente")},onError:r=>{console.error("Error creating catalog:",r),Pe.error("Error al crear el catlogo")}})}function Ej(){const e=Pr();return nn({mutationFn:async({id:t,...r})=>{const{data:n,error:a}=await Ce.from("catalogs").update(r).eq("id",t).select().single();if(a)throw a;return n},onSuccess:(t,r)=>{e.invalidateQueries({queryKey:["catalogs"]}),e.invalidateQueries({queryKey:["catalog",r.id]}),Pe.success("Catlogo actualizado")},onError:t=>{console.error("Error updating catalog:",t),Pe.error("Error al actualizar el catlogo")}})}function Mre(){const e=Pr();return nn({mutationFn:async t=>{const{error:r}=await Ce.from("catalogs").update({deleted_at:new Date().toISOString()}).eq("id",t);if(r)throw r},onSuccess:()=>{e.invalidateQueries({queryKey:["catalogs"]}),Pe.success("Catlogo eliminado")},onError:t=>{console.error("Error deleting catalog:",t),Pe.error("Error al eliminar el catlogo")}})}function Ob(){const e=xl(),{user:t}=Dt(),{data:r,isLoading:n}=Ire(),a=Dre();Ej();const s=Mre(),[i,o]=_.useState(""),[l,c]=_.useState("all"),[f,d]=_.useState(!1),[h,p]=_.useState(!1),[g,m]=_.useState(null),[x,v]=_.useState(""),[y,w]=_.useState(""),E=(r||[]).filter(T=>{const N=T.name.toLowerCase().includes(i.toLowerCase())||(T.description||"").toLowerCase().includes(i.toLowerCase()),O=l==="all"||T.status===l;return N&&O}),b=async()=>{if(!x)return;const T=await a.mutateAsync({name:x,description:y});d(!1),v(""),w(""),T&&e(`/catalogos/${T.id}`)},k=async()=>{g&&(await s.mutateAsync(g.id),p(!1),m(null))},S=T=>{m(T),p(!0)};return u.jsx(ya,{children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Catlogos"}),u.jsx("p",{className:"text-muted-foreground",children:"Administra todos tus catlogos de precios"})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(ye,{variant:"outline",asChild:!0,children:u.jsxs(xr,{to:"/catalogos/importar",children:[u.jsx(If,{className:"h-4 w-4 mr-2"}),"Importar Excel"]})}),u.jsxs(Kc,{open:f,onOpenChange:d,children:[u.jsx(ej,{asChild:!0,children:u.jsxs(ye,{children:[u.jsx(Lc,{className:"h-4 w-4 mr-2"}),"Nuevo Catlogo"]})}),u.jsxs(cl,{children:[u.jsxs(ul,{children:[u.jsx(dl,{children:"Crear nuevo catlogo"}),u.jsx(hl,{children:"Crea un catlogo para organizar tus productos"})]}),u.jsxs("div",{className:"space-y-4 py-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"catalog-name",children:"Nombre"}),u.jsx(zt,{id:"catalog-name",placeholder:"Lista de Precios 2024",value:x,onChange:T=>v(T.target.value)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"catalog-description",children:"Descripcin"}),u.jsx(nm,{id:"catalog-description",placeholder:"Descripcin del catlogo...",value:y,onChange:T=>w(T.target.value)})]})]}),u.jsxs(fl,{children:[u.jsx(ye,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),u.jsxs(ye,{onClick:b,disabled:a.isPending||!x,children:[a.isPending?u.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}):null,"Crear catlogo"]})]})]})]})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(Cp,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),u.jsx(zt,{placeholder:"Buscar catlogos...",value:i,onChange:T=>o(T.target.value),className:"pl-9"})]}),u.jsxs(Ba,{value:l,onValueChange:c,children:[u.jsx(pa,{className:"w-full sm:w-[180px]",children:u.jsx(Ua,{placeholder:"Estado"})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"all",children:"Todos los estados"}),u.jsx(bt,{value:"draft",children:"Borrador"}),u.jsx(bt,{value:"published",children:"Publicado"}),u.jsx(bt,{value:"archived",children:"Archivado"})]})]})]}),n?u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[...Array(6)].map((T,N)=>u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(mt,{className:"h-6 w-3/4"}),u.jsx(mt,{className:"h-4 w-1/2"})]}),u.jsxs(ot,{children:[u.jsx(mt,{className:"h-4 w-full mb-4"}),u.jsx(mt,{className:"h-4 w-2/3"})]})]},N))}):u.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:E.map(T=>u.jsxs(et,{className:"hover:shadow-md transition-shadow",children:[u.jsx(yr,{className:"pb-3",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center",children:u.jsx(Ha,{className:"h-5 w-5 text-primary"})}),u.jsxs("div",{children:[u.jsx(Lr,{className:"text-base",children:T.name}),u.jsxs(pn,{className:"text-xs mt-0.5",children:["Versin ",T.current_version]})]})]}),u.jsxs($c,{children:[u.jsx(Wc,{asChild:!0,children:u.jsx(ye,{variant:"ghost",size:"icon",className:"h-8 w-8",children:u.jsx(B1,{className:"h-4 w-4"})})}),u.jsxs(tl,{align:"end",children:[u.jsx(Tr,{asChild:!0,children:u.jsxs(xr,{to:`/catalogos/${T.id}`,children:[u.jsx($C,{className:"h-4 w-4 mr-2"}),"Ver detalles"]})}),u.jsx(Tr,{asChild:!0,children:u.jsxs(xr,{to:`/catalogos/${T.id}/editar`,children:[u.jsx(bd,{className:"h-4 w-4 mr-2"}),"Editar"]})}),u.jsxs(Tr,{children:[u.jsx(_0,{className:"h-4 w-4 mr-2"}),"Descargar PDF"]}),u.jsx(Vc,{}),u.jsxs(Tr,{className:"text-destructive",onClick:()=>S(T),children:[u.jsx(Of,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]})]})}),u.jsxs(ot,{className:"space-y-4",children:[u.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:T.description||"Sin descripcin"}),u.jsxs("div",{className:"flex items-center justify-between text-sm",children:[u.jsx(M0,{status:T.status}),u.jsxs("span",{className:"text-muted-foreground",children:[T.item_count," items"]})]}),u.jsxs("div",{className:"flex items-center justify-between pt-3 border-t",children:[u.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[u.jsx(Df,{className:"h-4 w-4"}),u.jsxs("span",{children:[T.client_count," clientes"]})]}),u.jsxs("span",{className:"text-xs text-muted-foreground",children:["Actualizado: ",new Date(T.updated_at).toLocaleDateString()]})]})]})]},T.id))}),E.length===0&&!n&&u.jsx(et,{className:"p-12",children:u.jsxs("div",{className:"flex flex-col items-center text-center",children:[u.jsx(Ha,{className:"h-12 w-12 text-muted-foreground mb-4"}),u.jsx("h3",{className:"font-semibold text-lg",children:"No se encontraron catlogos"}),u.jsx("p",{className:"text-muted-foreground mt-1 mb-4",children:i||l!=="all"?"No hay catlogos que coincidan con tu bsqueda":"Crea tu primer catlogo para comenzar"}),u.jsxs(ye,{onClick:()=>d(!0),children:[u.jsx(Lc,{className:"h-4 w-4 mr-2"}),"Crear nuevo catlogo"]})]})}),u.jsx(Cw,{open:h,onOpenChange:p,children:u.jsxs(sm,{children:[u.jsxs(im,{children:[u.jsx(lm,{children:"Eliminar catlogo?"}),u.jsxs(cm,{children:['Esta accin eliminar el catlogo "',g==null?void 0:g.name,'" y todos sus datos. Esta accin no se puede deshacer.']})]}),u.jsxs(om,{children:[u.jsx(fm,{children:"Cancelar"}),u.jsxs(um,{onClick:k,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[s.isPending?u.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}):null,"Eliminar"]})]})]})})]})})}var dm="Switch",[Lre]=rn(dm),[Bre,Ure]=Lre(dm),bj=_.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:a,defaultChecked:s,required:i,disabled:o,value:l="on",onCheckedChange:c,form:f,...d}=e,[h,p]=_.useState(null),g=Ke(t,w=>p(w)),m=_.useRef(!1),x=h?f||!!h.closest("form"):!0,[v,y]=ba({prop:a,defaultProp:s??!1,onChange:c,caller:dm});return u.jsxs(Bre,{scope:r,checked:v,disabled:o,children:[u.jsx(Ae.button,{type:"button",role:"switch","aria-checked":v,"aria-required":i,"data-state":Tj(v),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:g,onClick:ge(e.onClick,w=>{y(E=>!E),x&&(m.current=w.isPropagationStopped(),m.current||w.stopPropagation())})}),x&&u.jsx(Cj,{control:h,bubbles:!m.current,name:n,value:l,checked:v,required:i,disabled:o,form:f,style:{transform:"translateX(-100%)"}})]})});bj.displayName=dm;var Sj="SwitchThumb",kj=_.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,a=Ure(Sj,r);return u.jsx(Ae.span,{"data-state":Tj(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:t})});kj.displayName=Sj;var $re="SwitchBubbleInput",Cj=_.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...a},s)=>{const i=_.useRef(null),o=Ke(i,s),l=_y(r),c=X1(t);return _.useEffect(()=>{const f=i.current;if(!f)return;const d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==r&&p){const g=new Event("click",{bubbles:n});p.call(f,r),f.dispatchEvent(g)}},[l,r,n]),u.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:o,style:{...a.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Cj.displayName=$re;function Tj(e){return e?"checked":"unchecked"}var Nj=bj,Wre=kj;const pf=_.forwardRef(({className:e,...t},r)=>u.jsx(Nj,{className:he("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e),...t,ref:r,children:u.jsx(Wre,{className:he("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));pf.displayName=Nj.displayName;const qa=_.forwardRef(({className:e,...t},r)=>u.jsx("div",{className:"relative w-full overflow-auto",children:u.jsx("table",{ref:r,className:he("w-full caption-bottom text-sm",e),...t})}));qa.displayName="Table";const Xa=_.forwardRef(({className:e,...t},r)=>u.jsx("thead",{ref:r,className:he("[&_tr]:border-b",e),...t}));Xa.displayName="TableHeader";const Ya=_.forwardRef(({className:e,...t},r)=>u.jsx("tbody",{ref:r,className:he("[&_tr:last-child]:border-0",e),...t}));Ya.displayName="TableBody";const Vre=_.forwardRef(({className:e,...t},r)=>u.jsx("tfoot",{ref:r,className:he("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Vre.displayName="TableFooter";const Zt=_.forwardRef(({className:e,...t},r)=>u.jsx("tr",{ref:r,className:he("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...t}));Zt.displayName="TableRow";const Le=_.forwardRef(({className:e,...t},r)=>u.jsx("th",{ref:r,className:he("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));Le.displayName="TableHead";const Ie=_.forwardRef(({className:e,...t},r)=>u.jsx("td",{ref:r,className:he("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));Ie.displayName="TableCell";const zre=_.forwardRef(({className:e,...t},r)=>u.jsx("caption",{ref:r,className:he("mt-4 text-sm text-muted-foreground",e),...t}));zre.displayName="TableCaption";function Aj(e){const{user:t}=Dt();return Zn({queryKey:["catalog-versions",e],queryFn:async()=>{if(!e)return[];const{data:r,error:n}=await Ce.from("catalog_versions").select("*").eq("catalog_id",e).order("version_number",{ascending:!1});if(n)throw n;return r},enabled:!!t&&!!e})}function Rj(e){const{user:t}=Dt();return Zn({queryKey:["catalog-items",e],queryFn:async()=>{if(!e)return[];const{data:r,error:n}=await Ce.from("catalog_items").select("*").eq("version_id",e).is("deleted_at",null).order("code",{ascending:!0});if(n)throw n;return r},enabled:!!t&&!!e})}function Hre(){const e=Pr();return nn({mutationFn:async({id:t,...r})=>{const{data:n,error:a}=await Ce.from("catalog_items").update(r).eq("id",t).select().single();if(a)throw a;return n},onSuccess:t=>{e.invalidateQueries({queryKey:["catalog-items",t.version_id]}),Pe.success("Producto actualizado")},onError:t=>{console.error("Error updating item:",t),Pe.error("Error al actualizar el producto")}})}function Gre(){const e=Pr();return nn({mutationFn:async({id:t,versionId:r})=>{const{error:n}=await Ce.from("catalog_items").update({deleted_at:new Date().toISOString()}).eq("id",t);if(n)throw n;return r},onSuccess:t=>{e.invalidateQueries({queryKey:["catalog-items",t]}),Pe.success("Producto eliminado")},onError:t=>{console.error("Error deleting item:",t),Pe.error("Error al eliminar el producto")}})}function Kre(){const e=Pr();return nn({mutationFn:async({versionId:t,catalogId:r})=>{await Ce.from("catalog_versions").update({status:"archived"}).eq("catalog_id",r).eq("status","published");const{error:n}=await Ce.from("catalog_versions").update({status:"published",published_at:new Date().toISOString()}).eq("id",t);if(n)throw n;return await Ce.from("catalogs").update({status:"published"}).eq("id",r),{versionId:t,catalogId:r}},onSuccess:({catalogId:t})=>{e.invalidateQueries({queryKey:["catalog-versions",t]}),e.invalidateQueries({queryKey:["catalogs"]}),Pe.success("Versin publicada")},onError:t=>{console.error("Error publishing version:",t),Pe.error("Error al publicar la versin")}})}function Pj(){const{user:e}=Dt();return Zn({queryKey:["clients"],queryFn:async()=>{if(!e)return[];const{data:t,error:r}=await Ce.from("clients").select("*");if(r)throw r;const{data:n,error:a}=await Ce.from("user_roles").select("user_id").eq("role","cliente");if(a)throw a;const s=(n||[]).map(c=>c.user_id);if(s.length>0){const{data:c,error:f}=await Ce.from("profiles").select("id, email, full_name").in("id",s);if(f)throw f;const d=new Map((t||[]).filter(g=>g.user_id).map(g=>[g.user_id,g])),h=new Map((t||[]).map(g=>[g.email.toLowerCase(),g])),p=[];if((c||[]).forEach(g=>{const m=g.email.toLowerCase(),x=d.get(g.id),v=h.get(m),y=g.full_name||g.email.split("@")[0];p.push({name:(x==null?void 0:x.name)||(v==null?void 0:v.name)||y,email:g.email,status:"active",user_id:g.id,created_by:(x==null?void 0:x.created_by)||(v==null?void 0:v.created_by)||e.id,deleted_at:null})}),p.length>0){const{error:g}=await Ce.from("clients").upsert(p,{onConflict:"email"});if(g)throw g}}const{data:i,error:o}=await Ce.from("clients").select("*").is("deleted_at",null).order("created_at",{ascending:!1});if(o)throw o;return await Promise.all((i||[]).map(async c=>{const{data:f}=await Ce.from("catalog_clients").select("catalog_id, catalogs(id, name)").eq("client_id",c.id),d=(f||[]).map(h=>h.catalogs).filter(Boolean);return{...c,catalogs:d}}))},enabled:!!e})}function qre(){const e=Pr(),{user:t}=Dt();return nn({mutationFn:async r=>{if(!t)throw new Error("Not authenticated");const n=r.email.trim().toLowerCase(),{data:a,error:s}=await Ce.from("clients").select("*").eq("email",n).maybeSingle();if(s)throw s;const{data:i,error:o}=await Ce.from("profiles").select("id").eq("email",n).maybeSingle();if(o)throw o;if(a){const{data:f,error:d}=await Ce.from("clients").update({name:r.name,user_id:a.user_id||(i==null?void 0:i.id)||null,deleted_at:null,status:"active"}).eq("id",a.id).select().single();if(d)throw d;return f}const{data:l,error:c}=await Ce.from("clients").insert({name:r.name,email:n,status:"active",created_by:t.id,user_id:(i==null?void 0:i.id)||null}).select().single();if(c)throw c;return l},onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]}),Pe.success("Cliente creado exitosamente")},onError:r=>{console.error("Error creating client:",r),r.code==="23505"?Pe.error("Ya existe un cliente con ese email"):Pe.error("Error al crear el cliente")}})}function Xre(){const e=Pr();return nn({mutationFn:async({id:t,...r})=>{const{data:n,error:a}=await Ce.from("clients").update(r).eq("id",t).select().single();if(a)throw a;return n},onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]}),Pe.success("Cliente actualizado")},onError:t=>{console.error("Error updating client:",t),Pe.error("Error al actualizar el cliente")}})}function Yre(){const e=Pr();return nn({mutationFn:async t=>{const{error:r}=await Ce.from("clients").update({deleted_at:new Date().toISOString()}).eq("id",t);if(r)throw r},onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]}),Pe.success("Cliente eliminado")},onError:t=>{console.error("Error deleting client:",t),Pe.error("Error al eliminar el cliente")}})}function Qre(){const e=Pr();return nn({mutationFn:async({clientId:t,catalogId:r})=>{const{error:n}=await Ce.from("catalog_clients").insert({client_id:t,catalog_id:r});if(n)throw n},onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["catalogs"]}),Pe.success("Catlogo asignado al cliente")},onError:t=>{console.error("Error assigning catalog:",t),t.code==="23505"?Pe.error("El catlogo ya est asignado a este cliente"):Pe.error("Error al asignar el catlogo")}})}function Jre(){const e=Pr();return nn({mutationFn:async({clientId:t,catalogId:r})=>{const{error:n}=await Ce.from("catalog_clients").delete().eq("client_id",t).eq("catalog_id",r);if(n)throw n},onSuccess:()=>{e.invalidateQueries({queryKey:["clients"]}),e.invalidateQueries({queryKey:["catalogs"]}),Pe.success("Catlogo desasignado del cliente")},onError:t=>{console.error("Error unassigning catalog:",t),Pe.error("Error al desasignar el catlogo")}})}function Ib(){const{id:e}=z6();xl();const[t,r]=_.useState(""),[n,a]=_.useState("all"),[s,i]=_.useState("all"),[o,l]=_.useState(!1),[c,f]=_.useState(null),[d,h]=_.useState(!1),[p,g]=_.useState(""),{data:m,isLoading:x}=_j(e||""),{data:v,isLoading:y}=Aj(e||""),w=(v==null?void 0:v.find(W=>W.status==="published"))||(v==null?void 0:v[0]),{data:E,isLoading:b}=Rj((w==null?void 0:w.id)||""),{data:k}=Pj(),S=Ej(),T=Hre(),N=Gre(),O=Kre(),j=Qre(),D=Jre(),[Y,Q]=_.useState({name:"",description:""}),G=(E||[]).filter(W=>{const se=W.name.toLowerCase().includes(t.toLowerCase())||W.code.toLowerCase().includes(t.toLowerCase()),ie=n==="all"||W.category===n,ae=s==="all"||s==="selected"&&W.is_selected||s==="not-selected"&&!W.is_selected;return se&&ie&&ae}),X=[...new Set((E||[]).map(W=>W.category).filter(Boolean))],q=(m==null?void 0:m.assigned_clients)||[],K=(k||[]).filter(W=>!q.some(se=>se.id===W.id)&&W.status!=="inactive"),A=()=>{m&&(Q({name:m.name,description:m.description||""}),l(!0))},ne=async()=>{e&&(await S.mutateAsync({id:e,name:Y.name,description:Y.description}),l(!1))},ce=async(W,se)=>{await T.mutateAsync({id:W,is_active:!se})},R=async(W,se)=>{await T.mutateAsync({id:W,is_selected:!se})},z=async()=>{!c||!w||(await N.mutateAsync({id:c,versionId:w.id}),f(null))},U=async()=>{!w||!e||w.status==="published"||(await O.mutateAsync({versionId:w.id,catalogId:e}),Pe.success("Catlogo publicado exitosamente"))},V=async()=>{!e||!p||(await j.mutateAsync({catalogId:e,clientId:p}),h(!1),g(""))},J=async W=>{e&&await D.mutateAsync({catalogId:e,clientId:W})};return x?u.jsx(ya,{children:u.jsxs("div",{className:"space-y-6",children:[u.jsx(mt,{className:"h-10 w-64"}),u.jsx("div",{className:"grid gap-4 sm:grid-cols-4",children:[1,2,3,4].map(W=>u.jsx(mt,{className:"h-24"},W))}),u.jsx(mt,{className:"h-96"})]})}):m?u.jsxs(ya,{children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx(ye,{variant:"ghost",size:"icon",asChild:!0,children:u.jsx(xr,{to:"/catalogos",children:u.jsx(cD,{className:"h-5 w-5"})})}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[u.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:m.name}),u.jsx(M0,{status:m.status})]}),u.jsx("p",{className:"text-muted-foreground max-w-2xl",children:m.description||"Sin descripcin"})]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(ye,{variant:"outline",asChild:!0,children:u.jsxs(xr,{to:`/catalogos/importar?catalogId=${m.id}`,children:[u.jsx(kp,{className:"h-4 w-4 mr-2"}),"Actualizar"]})}),u.jsxs($c,{children:[u.jsx(Wc,{asChild:!0,children:u.jsxs(ye,{variant:"outline",children:[u.jsx(_0,{className:"h-4 w-4 mr-2"}),"Exportar"]})}),u.jsxs(tl,{align:"end",children:[u.jsx(Tr,{onClick:()=>{try{Dv(E||[],{catalogName:m.name,includeInactive:!0}),Pe.success("Excel exportado correctamente")}catch(W){Pe.error(W instanceof Error?W.message:"Error al exportar")}},children:"Excel Completo"}),u.jsx(Tr,{onClick:()=>{try{Dv(E||[],{catalogName:m.name,onlySelected:!0}),Pe.success("Excel exportado correctamente")}catch(W){Pe.error(W instanceof Error?W.message:"Error al exportar")}},children:"Excel Solo Selectos"}),u.jsx(Vc,{}),u.jsx(Tr,{onClick:()=>{try{FP(E||[],{catalogName:m.name,includeInactive:!0}),Pe.success("CSV exportado correctamente")}catch(W){Pe.error(W instanceof Error?W.message:"Error al exportar")}},children:"CSV"})]})]}),m.status==="draft"&&u.jsxs(ye,{onClick:U,disabled:O.isPending,children:[u.jsx(kD,{className:"h-4 w-4 mr-2"}),"Publicar"]}),u.jsxs(ye,{variant:"outline",onClick:A,children:[u.jsx(bd,{className:"h-4 w-4 mr-2"}),"Editar"]})]})]}),u.jsxs("div",{className:"grid gap-4 sm:grid-cols-4",children:[u.jsx(et,{children:u.jsx(ot,{className:"pt-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Items"}),u.jsx("p",{className:"text-2xl font-bold",children:m.item_count||0})]}),u.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:u.jsx(Fi,{className:"h-5 w-5 text-primary"})})]})})}),u.jsx(et,{children:u.jsx(ot,{className:"pt-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-muted-foreground",children:"Versin"}),u.jsx("p",{className:"text-2xl font-bold",children:m.current_version||1})]}),u.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:u.jsx(vD,{className:"h-5 w-5 text-primary"})})]})})}),u.jsx(et,{children:u.jsx(ot,{className:"pt-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-muted-foreground",children:"Clientes"}),u.jsx("p",{className:"text-2xl font-bold",children:m.client_count||0})]}),u.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:u.jsx(Df,{className:"h-5 w-5 text-primary"})})]})})}),u.jsx(et,{children:u.jsx(ot,{className:"pt-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-muted-foreground",children:"ltima actualizacin"}),u.jsx("p",{className:"text-lg font-bold",children:L0(new Date(m.updated_at),{addSuffix:!0,locale:B0})})]}),u.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center",children:u.jsx(pD,{className:"h-5 w-5 text-primary"})})]})})})]}),u.jsxs(Lp,{defaultValue:"items",className:"space-y-4",children:[u.jsxs(Nd,{children:[u.jsxs(mn,{value:"items",children:["Items (",(E==null?void 0:E.length)||0,")"]}),u.jsxs(mn,{value:"versions",children:["Versiones (",(v==null?void 0:v.length)||0,")"]}),u.jsxs(mn,{value:"clients",children:["Clientes (",q.length,")"]})]}),u.jsxs(gn,{value:"items",className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(Cp,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),u.jsx(zt,{placeholder:"Buscar por cdigo o nombre...",value:t,onChange:W=>r(W.target.value),className:"pl-9"})]}),u.jsxs(Ba,{value:n,onValueChange:a,children:[u.jsx(pa,{className:"w-full sm:w-[180px]",children:u.jsx(Ua,{placeholder:"Categora"})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"all",children:"Todas las categoras"}),X.map(W=>u.jsx(bt,{value:W,children:W},W))]})]}),u.jsxs(Ba,{value:s,onValueChange:i,children:[u.jsx(pa,{className:"w-full sm:w-[150px]",children:u.jsx(Ua,{placeholder:"Selecto"})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"all",children:"Todos"}),u.jsx(bt,{value:"selected",children:"Solo Selectos"}),u.jsx(bt,{value:"not-selected",children:"No Selectos"})]})]})]}),u.jsx(et,{children:u.jsx(ot,{className:"p-0",children:b?u.jsx("div",{className:"p-8",children:u.jsx(mt,{className:"h-64 w-full"})}):G.length===0?u.jsx("div",{className:"p-8 text-center text-muted-foreground",children:"No hay items en este catlogo"}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsxs(Zt,{className:"bg-muted/50",children:[u.jsx(Le,{className:"w-16",children:"Imagen"}),u.jsx(Le,{className:"w-28",children:"Cdigo"}),u.jsx(Le,{children:"Producto"}),u.jsx(Le,{className:"text-right",children:"Precio USD"}),u.jsx(Le,{children:"Categora"}),u.jsx(Le,{children:"Tienda"}),u.jsx(Le,{className:"text-center",children:"Selecto"}),u.jsx(Le,{className:"text-center",children:"Activo"}),u.jsx(Le,{className:"w-12"})]})}),u.jsx(Ya,{children:G.map(W=>u.jsxs(Zt,{className:W.is_active?"":"opacity-50",children:[u.jsx(Ie,{children:W.image_url?u.jsx("img",{src:W.image_url,alt:W.name,className:"h-10 w-10 rounded object-cover"}):u.jsx("div",{className:"h-10 w-10 rounded bg-muted flex items-center justify-center",children:u.jsx(wD,{className:"h-4 w-4 text-muted-foreground"})})}),u.jsx(Ie,{className:"font-mono text-sm",children:W.code}),u.jsx(Ie,{className:"font-medium",children:W.name}),u.jsxs(Ie,{className:"text-right font-semibold",children:["$",Number(W.price_usd).toFixed(2)]}),u.jsx(Ie,{children:W.category&&u.jsx(Ct,{variant:"secondary",children:W.category})}),u.jsx(Ie,{className:"text-muted-foreground",children:W.store_name||"-"}),u.jsx(Ie,{className:"text-center",children:u.jsx("button",{onClick:()=>R(W.id,W.is_selected),className:"focus:outline-none",children:W.is_selected?u.jsx(rf,{className:"h-4 w-4 text-warning mx-auto fill-warning"}):u.jsx(rf,{className:"h-4 w-4 text-muted-foreground/30 mx-auto hover:text-warning/50"})})}),u.jsx(Ie,{className:"text-center",children:u.jsx(pf,{checked:W.is_active,onCheckedChange:()=>ce(W.id,W.is_active)})}),u.jsx(Ie,{children:u.jsxs($c,{children:[u.jsx(Wc,{asChild:!0,children:u.jsx(ye,{variant:"ghost",size:"icon",className:"h-8 w-8",children:u.jsx(B1,{className:"h-4 w-4"})})}),u.jsxs(tl,{align:"end",children:[u.jsxs(Tr,{onClick:()=>R(W.id,W.is_selected),children:[u.jsx(rf,{className:"h-4 w-4 mr-2"}),W.is_selected?"Quitar selecto":"Marcar selecto"]}),u.jsx(Tr,{onClick:()=>ce(W.id,W.is_active),children:W.is_active?"Desactivar":"Activar"}),u.jsx(Vc,{}),u.jsxs(Tr,{className:"text-destructive",onClick:()=>f(W.id),children:[u.jsx(Of,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]})})]},W.id))})]})})})}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:["Mostrando ",G.length," de ",(E==null?void 0:E.length)||0," items"]})]}),u.jsx(gn,{value:"versions",className:"space-y-4",children:u.jsx(et,{children:u.jsx(ot,{className:"p-0",children:y?u.jsx("div",{className:"p-8",children:u.jsx(mt,{className:"h-32 w-full"})}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsxs(Zt,{className:"bg-muted/50",children:[u.jsx(Le,{className:"w-24",children:"Versin"}),u.jsx(Le,{children:"Nota"}),u.jsx(Le,{children:"Fecha"}),u.jsx(Le,{children:"Estado"}),u.jsx(Le,{className:"w-32"})]})}),u.jsx(Ya,{children:(v||[]).map(W=>u.jsxs(Zt,{children:[u.jsxs(Ie,{className:"font-mono font-semibold",children:["v",W.version_number]}),u.jsx(Ie,{children:W.notes||"Sin notas"}),u.jsx(Ie,{className:"text-muted-foreground",children:L0(new Date(W.created_at),{addSuffix:!0,locale:B0})}),u.jsx(Ie,{children:u.jsx(M0,{status:W.status})}),u.jsx(Ie,{children:W.status==="draft"&&e&&u.jsx(ye,{variant:"ghost",size:"sm",onClick:()=>O.mutateAsync({versionId:W.id,catalogId:e}),disabled:O.isPending,children:"Publicar"})})]},W.id))})]})})})})}),u.jsx(gn,{value:"clients",className:"space-y-4",children:u.jsxs(et,{children:[u.jsx(yr,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx(Lr,{className:"text-lg",children:"Clientes con acceso"}),u.jsxs(ye,{size:"sm",onClick:()=>h(!0),children:[u.jsx(ND,{className:"h-4 w-4 mr-2"}),"Asignar cliente"]})]})}),u.jsx(ot,{children:q.length===0?u.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No hay clientes asignados a este catlogo"}):u.jsx("div",{className:"space-y-3",children:q.map(W=>u.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"h-9 w-9 rounded-full bg-primary/10 flex items-center justify-center",children:u.jsx("span",{className:"text-sm font-medium text-primary",children:W.name.charAt(0).toUpperCase()})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium",children:W.name}),u.jsx("p",{className:"text-sm text-muted-foreground",children:W.email})]})]}),u.jsxs(ye,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",onClick:()=>J(W.id),children:[u.jsx(TD,{className:"h-4 w-4 mr-1"}),"Quitar"]})]},W.id))})})]})})]})]}),u.jsx(Kc,{open:o,onOpenChange:l,children:u.jsxs(cl,{children:[u.jsxs(ul,{children:[u.jsx(dl,{children:"Editar Catlogo"}),u.jsx(hl,{children:"Modifica los datos del catlogo"})]}),u.jsxs("div",{className:"space-y-4 py-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"edit-name",children:"Nombre"}),u.jsx(zt,{id:"edit-name",value:Y.name,onChange:W=>Q(se=>({...se,name:W.target.value}))})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"edit-description",children:"Descripcin"}),u.jsx(nm,{id:"edit-description",value:Y.description,onChange:W=>Q(se=>({...se,description:W.target.value})),rows:3})]})]}),u.jsxs(fl,{children:[u.jsx(ye,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),u.jsx(ye,{onClick:ne,disabled:S.isPending,children:"Guardar"})]})]})}),u.jsx(Cw,{open:!!c,onOpenChange:()=>f(null),children:u.jsxs(sm,{children:[u.jsxs(im,{children:[u.jsx(lm,{children:"Eliminar item?"}),u.jsx(cm,{children:"Esta accin no se puede deshacer. El item ser eliminado permanentemente."})]}),u.jsxs(om,{children:[u.jsx(fm,{children:"Cancelar"}),u.jsx(um,{onClick:z,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Eliminar"})]})]})}),u.jsx(Kc,{open:d,onOpenChange:h,children:u.jsxs(cl,{children:[u.jsxs(ul,{children:[u.jsx(dl,{children:"Asignar Cliente"}),u.jsx(hl,{children:"Selecciona un cliente para darle acceso a este catlogo"})]}),u.jsx("div",{className:"py-4",children:K.length===0?u.jsx("p",{className:"text-center text-muted-foreground",children:"No hay clientes disponibles para asignar"}):u.jsxs(Ba,{value:p,onValueChange:g,children:[u.jsx(pa,{children:u.jsx(Ua,{placeholder:"Seleccionar cliente"})}),u.jsx(ma,{children:K.map(W=>u.jsxs(bt,{value:W.id,children:[W.name," (",W.email,")"]},W.id))})]})}),u.jsxs(fl,{children:[u.jsx(ye,{variant:"outline",onClick:()=>h(!1),children:"Cancelar"}),u.jsx(ye,{onClick:V,disabled:!p||j.isPending,children:"Asignar"})]})]})})]}):u.jsx(ya,{children:u.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[u.jsx("p",{className:"text-muted-foreground mb-4",children:"Catlogo no encontrado"}),u.jsx(ye,{asChild:!0,children:u.jsx(xr,{to:"/catalogos",children:"Volver a catlogos"})})]})})}function Zre(e,t=[]){let r=[];function n(s,i){const o=_.createContext(i);o.displayName=s+"Context";const l=r.length;r=[...r,i];const c=d=>{var v;const{scope:h,children:p,...g}=d,m=((v=h==null?void 0:h[e])==null?void 0:v[l])||o,x=_.useMemo(()=>g,Object.values(g));return u.jsx(m.Provider,{value:x,children:p})};c.displayName=s+"Provider";function f(d,h){var m;const p=((m=h==null?void 0:h[e])==null?void 0:m[l])||o,g=_.useContext(p);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,f]}const a=()=>{const s=r.map(i=>_.createContext(i));return function(o){const l=(o==null?void 0:o[e])||s;return _.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return a.scopeName=e,[n,ene(a,...t)]}function ene(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const i=n.reduce((o,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...o,...d}},{});return _.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}var tne=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],jj=tne.reduce((e,t)=>{const r=xy(`Primitive.${t}`),n=_.forwardRef((a,s)=>{const{asChild:i,...o}=a,l=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{}),Tw="Progress",Nw=100,[rne]=Zre(Tw),[nne,ane]=rne(Tw),Fj=_.forwardRef((e,t)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:s=sne,...i}=e;(a||a===0)&&!Db(a)&&console.error(ine(`${a}`,"Progress"));const o=Db(a)?a:Nw;n!==null&&!Mb(n,o)&&console.error(one(`${n}`,"Progress"));const l=Mb(n,o)?n:null,c=ep(l)?s(l,o):void 0;return u.jsx(nne,{scope:r,value:l,max:o,children:u.jsx(jj.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":ep(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":Dj(l,o),"data-value":l??void 0,"data-max":o,...i,ref:t})})});Fj.displayName=Tw;var Oj="ProgressIndicator",Ij=_.forwardRef((e,t)=>{const{__scopeProgress:r,...n}=e,a=ane(Oj,r);return u.jsx(jj.div,{"data-state":Dj(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});Ij.displayName=Oj;function sne(e,t){return`${Math.round(e/t*100)}%`}function Dj(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function ep(e){return typeof e=="number"}function Db(e){return ep(e)&&!isNaN(e)&&e>0}function Mb(e,t){return ep(e)&&!isNaN(e)&&e<=t&&e>=0}function ine(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Nw}\`.`}function one(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Nw} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Mj=Fj,lne=Ij;const Mv=_.forwardRef(({className:e,value:t,...r},n)=>u.jsx(Mj,{ref:n,className:he("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:u.jsx(lne,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Mv.displayName=Mj.displayName;const Dg=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),Lb=(e,t)=>{const r=[],n=new Set;for(const a of e){const s=Dg(a.label),i=Dg(a.key);let o=null,l=0;for(const c of t){if(n.has(c))continue;const f=Dg(c);if(f===s||f===i){o=c,l=100;break}if(f.includes(s)||s.includes(f)){const d=Math.min(f.length,s.length)/Math.max(f.length,s.length)*80;d>l&&(l=d,o=c)}}o&&l>=50?(n.add(o),r.push({systemField:a.key,excelColumn:o})):r.push({systemField:a.key,excelColumn:null})}return r};function cne({excelColumns:e,systemFields:t,initialMappings:r,previewData:n=[],onMappingsChange:a,onValidate:s,onBack:i}){const[o,l]=_.useState(()=>r&&r.length>0?r:Lb(t,e)),c=(x,v)=>{const y=o.map(w=>w.systemField===x?{...w,excelColumn:v==="none"?null:v}:w);l(y),a==null||a(y)},f=()=>{const x=Lb(t,e);l(x),a==null||a(x)},d=()=>{const x=t.map(v=>({systemField:v.key,excelColumn:null}));l(x),a==null||a(x)},h=_.useMemo(()=>{const x=t.filter(E=>E.required),v=x.filter(E=>o.find(b=>b.systemField===E.key&&b.excelColumn!==null)),y=o.filter(E=>E.excelColumn!==null).length,w=e.filter(E=>!o.some(b=>b.excelColumn===E));return{requiredTotal:x.length,requiredMapped:v.length,allRequiredMapped:v.length===x.length,totalMapped:y,unmappedExcelColumns:w}},[o,t,e]),p=x=>{var v;return((v=o.find(y=>y.systemField===x))==null?void 0:v.excelColumn)||null},g=_.useMemo(()=>new Set(o.filter(x=>x.excelColumn).map(x=>x.excelColumn)),[o]),m=_.useMemo(()=>n.length?n.slice(0,5).map(x=>{const v={};for(const y of o)y.excelColumn&&x[y.excelColumn]!==void 0?v[y.systemField]=x[y.excelColumn]:v[y.systemField]="";return v}):[],[o,n]);return u.jsxs(et,{children:[u.jsx(yr,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx(Lr,{children:"Mapeo de columnas"}),u.jsx(pn,{children:"Asigna cada columna del Excel a su campo correspondiente en el sistema"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(ye,{variant:"outline",size:"sm",onClick:d,children:[u.jsx(kp,{className:"h-4 w-4 mr-2"}),"Limpiar"]}),u.jsxs(ye,{variant:"outline",size:"sm",onClick:f,children:[u.jsx(RD,{className:"h-4 w-4 mr-2"}),"Auto-mapear"]})]})]})}),u.jsxs(ot,{className:"space-y-6",children:[u.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[u.jsx("div",{className:he("p-4 rounded-lg border",h.allRequiredMapped?"bg-success/10 border-success/20":"bg-warning/10 border-warning/20"),children:u.jsxs("div",{className:"flex items-center gap-2",children:[h.allRequiredMapped?u.jsx(Fi,{className:"h-5 w-5 text-success"}):u.jsx(Ff,{className:"h-5 w-5 text-warning"}),u.jsxs("span",{className:"font-medium",children:[h.requiredMapped," de ",h.requiredTotal," campos requeridos mapeados"]})]})}),u.jsxs("div",{className:"p-4 rounded-lg bg-muted border",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("span",{className:"font-medium",children:[h.totalMapped," de ",t.length," campos totales mapeados"]})}),h.unmappedExcelColumns.length>0&&u.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[h.unmappedExcelColumns.length," columnas del Excel sin asignar"]})]})]}),u.jsxs("div",{className:"p-4 rounded-lg bg-accent/50 border",children:[u.jsxs("p",{className:"text-sm font-medium mb-2",children:["Columnas detectadas en el Excel (",e.length,"):"]}),u.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(x=>{const v=g.has(x);return u.jsx(Ct,{variant:v?"default":"outline",className:he(!v&&"opacity-60"),children:x},x)})})]}),u.jsx("div",{className:"border rounded-lg overflow-hidden",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsxs(Zt,{className:"bg-muted/50",children:[u.jsx(Le,{className:"w-1/3",children:"Campo del sistema"}),u.jsx(Le,{className:"w-1/3",children:"Columna del Excel"}),u.jsx(Le,{className:"w-24 text-center",children:"Requerido"}),u.jsx(Le,{className:"w-1/4",children:"Vista previa"})]})}),u.jsx(Ya,{children:t.map(x=>{var E;const v=p(x.key),y=v!==null,w=((E=m[0])==null?void 0:E[x.key])||"";return u.jsxs(Zt,{className:he(x.required&&!y&&"bg-destructive/5"),children:[u.jsx(Ie,{children:u.jsxs("div",{children:[u.jsx("span",{className:"font-medium",children:x.label}),x.description&&u.jsx("p",{className:"text-xs text-muted-foreground",children:x.description})]})}),u.jsx(Ie,{children:u.jsxs(Ba,{value:v||"none",onValueChange:b=>c(x.key,b),children:[u.jsx(pa,{className:he("w-full",!y&&x.required&&"border-destructive"),children:u.jsx(Ua,{placeholder:"Seleccionar columna..."})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"none",children:u.jsx("span",{className:"text-muted-foreground",children:"-- No mapear --"})}),e.map(b=>{const k=g.has(b)&&v!==b;return u.jsxs(bt,{value:b,disabled:k,children:[b,k&&" (ya asignada)"]},b)})]})]})}),u.jsx(Ie,{className:"text-center",children:x.required?u.jsx(Ct,{variant:"destructive",className:"text-xs",children:"S"}):u.jsx("span",{className:"text-muted-foreground text-sm",children:"No"})}),u.jsx(Ie,{children:y&&w?u.jsx("span",{className:"text-sm font-mono truncate block max-w-32",children:w}):u.jsx("span",{className:"text-muted-foreground text-sm",children:""})})]},x.key)})})]})}),m.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"font-medium mb-3",children:"Vista previa de datos mapeados"}),u.jsx("div",{className:"border rounded-lg overflow-x-auto",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsx(Zt,{className:"bg-muted/50",children:t.filter(x=>p(x.key)!==null).slice(0,6).map(x=>u.jsx(Le,{children:x.label},x.key))})}),u.jsx(Ya,{children:m.map((x,v)=>u.jsx(Zt,{children:t.filter(y=>p(y.key)!==null).slice(0,6).map(y=>u.jsx(Ie,{className:"text-sm",children:x[y.key]||""},y.key))},v))})]})}),u.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Mostrando primeras 5 filas con las primeras 6 columnas mapeadas"})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx(ye,{variant:"outline",onClick:i,children:"Atrs"}),u.jsxs(ye,{onClick:()=>s(o),disabled:!h.allRequiredMapped,children:[h.allRequiredMapped?"Validar datos":"Mapea todos los campos requeridos",u.jsx(Hi,{className:"h-4 w-4 ml-2"})]})]})]})]})}function une({rows:e,errors:t,mappings:r,systemFields:n,onSave:a,onCancel:s}){const[i,o]=_.useState(()=>t.map((G,X)=>({...G,id:`${G.row}-${G.field}-${X}`,originalValue:G.value,newValue:G.value,isEditing:!1,isFixed:!1}))),[l,c]=_.useState(!1),[f,d]=_.useState(null),[h,p]=_.useState({}),[g,m]=_.useState(0),x=20,v=_.useMemo(()=>{const G=new Map;for(const X of i)G.has(X.row)||G.set(X.row,[]),G.get(X.row).push(X);return G},[i]),y=_.useMemo(()=>{const G=e.map(X=>({...X}));for(const X of i)if(X.isFixed&&X.newValue!==X.originalValue){const q=X.row-2;q>=0&&q<G.length&&(G[q][X.column]=X.newValue)}return G},[e,i]),w=i.filter(G=>G.isFixed).length,E=i.filter(G=>!G.isFixed&&G.severity==="error").length,b=_.useMemo(()=>{const G=i.filter(q=>!q.isFixed),X=g*x;return G.slice(X,X+x)},[i,g]),k=Math.ceil(i.filter(G=>!G.isFixed).length/x),S=G=>{o(X=>X.map(q=>q.id===G?{...q,isEditing:!0}:q))},T=G=>{o(X=>X.map(q=>q.id===G?{...q,isEditing:!1,newValue:q.originalValue}:q))},N=G=>{o(X=>X.map(q=>q.id===G?{...q,isEditing:!1,isFixed:!0}:q))},O=(G,X)=>{o(q=>q.map(K=>K.id===G?{...K,newValue:X}:K))},j=G=>{const X=G-2;if(X<0||X>=e.length)return;d(X);const q={};for(const K of r)if(K.excelColumn){const A=e[X][K.excelColumn];q[K.excelColumn]=A!==null?String(A):""}p(q),c(!0)},D=()=>{if(f===null)return;const G=f+2;o(X=>X.map(q=>{if(q.row===G){const K=h[q.column]??null;return{...q,newValue:K,isFixed:!0,isEditing:!1}}return q})),c(!1),d(null),p({})},Y=()=>{a(y)},Q=G=>{var X;return((X=n.find(q=>q.key===G))==null?void 0:X.label)||G};return u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsxs(Lr,{className:"flex items-center justify-between",children:[u.jsx("span",{children:"Editar errores de validacin"}),u.jsxs("div",{className:"flex items-center gap-2 text-sm font-normal",children:[w>0&&u.jsxs(Ct,{variant:"outline",className:"bg-success/10 text-success border-success/30",children:[u.jsx(jf,{className:"h-3 w-3 mr-1"}),w," corregidos"]}),E>0&&u.jsxs(Ct,{variant:"destructive",children:[E," errores pendientes"]})]})]}),u.jsx(pn,{children:"Corrige los valores directamente antes de importar. Los cambios se aplicarn a los datos."})]}),u.jsxs(ot,{className:"space-y-4",children:[u.jsx("div",{className:"border rounded-lg overflow-hidden",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsxs(Zt,{className:"bg-muted/50",children:[u.jsx(Le,{className:"w-20",children:"Fila"}),u.jsx(Le,{className:"w-32",children:"Campo"}),u.jsx(Le,{children:"Problema"}),u.jsx(Le,{children:"Valor original"}),u.jsx(Le,{children:"Nuevo valor"}),u.jsx(Le,{className:"w-24",children:"Acciones"})]})}),u.jsx(Ya,{children:b.map(G=>u.jsxs(Zt,{className:he(G.isFixed&&"bg-success/5",G.isEditing&&"bg-muted/50"),children:[u.jsx(Ie,{children:u.jsx("button",{className:"font-mono text-primary hover:underline",onClick:()=>j(G.row),title:"Editar fila completa",children:G.row})}),u.jsx(Ie,{children:u.jsx("span",{className:"font-medium",children:Q(G.field)})}),u.jsx(Ie,{children:u.jsxs("div",{className:"flex items-center gap-2",children:[G.severity==="error"?u.jsx(Ff,{className:"h-4 w-4 text-destructive shrink-0"}):u.jsx($1,{className:"h-4 w-4 text-warning shrink-0"}),u.jsx("span",{className:he("text-sm",G.severity==="error"?"text-destructive":"text-warning"),children:G.error})]})}),u.jsx(Ie,{children:u.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded",children:G.originalValue||"(vaco)"})}),u.jsx(Ie,{children:G.isEditing?u.jsx(zt,{value:G.newValue||"",onChange:X=>O(G.id,X.target.value),className:"h-8",autoFocus:!0}):G.isFixed?u.jsx("code",{className:"text-xs bg-success/20 text-success px-1 py-0.5 rounded",children:G.newValue||"(vaco)"}):u.jsx("span",{className:"text-muted-foreground text-sm",children:""})}),u.jsx(Ie,{children:G.isEditing?u.jsxs("div",{className:"flex gap-1",children:[u.jsx(ye,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>N(G.id),children:u.jsx(jf,{className:"h-4 w-4 text-success"})}),u.jsx(ye,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>T(G.id),children:u.jsx(Sd,{className:"h-4 w-4 text-muted-foreground"})})]}):G.isFixed?u.jsx(Ct,{variant:"outline",className:"bg-success/10 text-success text-xs",children:"Corregido"}):u.jsxs(ye,{size:"sm",variant:"ghost",className:"h-7",onClick:()=>S(G.id),children:[u.jsx(bd,{className:"h-3 w-3 mr-1"}),"Editar"]})})]},G.id))})]})}),k>1&&u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-muted-foreground",children:["Pgina ",g+1," de ",k]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(ye,{variant:"outline",size:"sm",onClick:()=>m(G=>Math.max(0,G-1)),disabled:g===0,children:u.jsx(fD,{className:"h-4 w-4"})}),u.jsx(ye,{variant:"outline",size:"sm",onClick:()=>m(G=>Math.min(k-1,G+1)),disabled:g>=k-1,children:u.jsx(UC,{className:"h-4 w-4"})})]})]}),u.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[u.jsx(ye,{variant:"outline",onClick:s,children:"Cancelar"}),u.jsxs(ye,{onClick:Y,children:[u.jsx(yo,{className:"h-4 w-4 mr-2"}),"Aplicar correcciones y revalidar"]})]}),u.jsx(Kc,{open:l,onOpenChange:c,children:u.jsxs(cl,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[u.jsxs(ul,{children:[u.jsxs(dl,{children:["Editar fila ",f!==null?f+2:""]}),u.jsx(hl,{children:"Edita todos los campos de esta fila. Los errores de esta fila se marcarn como corregidos."})]}),u.jsx("div",{className:"grid gap-4 py-4",children:r.filter(G=>G.excelColumn).map(G=>{var K;const X=n.find(A=>A.key===G.systemField),q=f!==null&&((K=v.get(f+2))==null?void 0:K.some(A=>A.column===G.excelColumn));return u.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[u.jsxs(pt,{className:he("text-right",q&&"text-destructive"),children:[(X==null?void 0:X.label)||G.systemField,(X==null?void 0:X.required)&&u.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),u.jsx("div",{className:"col-span-3",children:u.jsx(zt,{value:h[G.excelColumn]||"",onChange:A=>p(ne=>({...ne,[G.excelColumn]:A.target.value})),className:he(q&&"border-destructive")})})]},G.systemField)})}),u.jsxs(fl,{children:[u.jsx(ye,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),u.jsxs(ye,{onClick:D,children:[u.jsx(yo,{className:"h-4 w-4 mr-2"}),"Guardar cambios"]})]})]})})]})]})}async function fne(e){return new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{var s;try{const i=(s=a.target)==null?void 0:s.result;if(!i){r({message:"No se pudo leer el archivo"});return}const o=Iv(i,{type:"array"}),l=o.SheetNames[0];if(!l){r({message:"El archivo Excel est vaco"});return}const c=o.Sheets[l],f=zo.sheet_to_json(c,{header:void 0,defval:null,raw:!1});if(f.length===0){r({message:"El archivo Excel no contiene datos"});return}const d=Object.keys(f[0]||{});t({columns:d,rows:f,totalRows:f.length})}catch(i){console.error("Error parsing Excel:",i),r({message:"Error al procesar el archivo Excel",details:i instanceof Error?i.message:"Error desconocido"})}},n.onerror=()=>{r({message:"Error al leer el archivo"})},n.readAsArrayBuffer(e)})}function dne(e,t=5){return e.slice(0,t).map(r=>{const n={};for(const[a,s]of Object.entries(r))n[a]=s!==null?String(s):"";return n})}const hne={codigo:{field:"codigo",required:!0,type:"text",maxLength:100},producto:{field:"producto",required:!0,type:"text",maxLength:500},precio:{field:"precio",required:!0,type:"number"},imagen:{field:"imagen",required:!1,type:"url"},suministrador:{field:"suministrador",required:!1,type:"text",maxLength:200},almacen:{field:"almacen",required:!1,type:"text",maxLength:200},categoria:{field:"categoria",required:!1,type:"text",maxLength:200},precio_p:{field:"precio_p",required:!1,type:"number"},precio_m:{field:"precio_m",required:!1,type:"number"},filtro_imagenes:{field:"filtro_imagenes",required:!1,type:"text"},ef_tkc:{field:"ef_tkc",required:!1,type:"text"},id_tienda:{field:"id_tienda",required:!1,type:"text",maxLength:100},estado_anuncio:{field:"estado_anuncio",required:!1,type:"text"},estado_tienda:{field:"estado_tienda",required:!1,type:"text"},tienda:{field:"tienda",required:!1,type:"text",maxLength:200},selecto:{field:"selecto",required:!1,type:"boolean"},cat_f1:{field:"cat_f1",required:!1,type:"text",maxLength:200},cat_f2:{field:"cat_f2",required:!1,type:"text",maxLength:200},cat_f3:{field:"cat_f3",required:!1,type:"text",maxLength:200}};function Lj(e){if(e==null||e==="")return null;if(typeof e=="number")return e;let t=e.replace(/[$]/g,"").replace(/\s/g,"").trim();const r=t.includes(","),n=t.includes(".");if(r&&!n)t=t.replace(",",".");else if(r&&n){const s=t.lastIndexOf(","),i=t.lastIndexOf(".");s>i?t=t.replace(/\./g,"").replace(",","."):t=t.replace(/,/g,"")}const a=parseFloat(t);return isNaN(a)?null:a}function Lv(e){if(e==null||e==="")return null;const t=String(e).toLowerCase().trim();return["true","1","yes","s","si","verdadero","activo","x"].includes(t)?!0:["false","0","no","falso","inactivo",""].includes(t)?!1:null}function pne(e){if(!e||e.trim()===""||e.startsWith("/")||e.startsWith("./"))return!0;try{return new URL(e),!0}catch{return/^[\w-]+(\.[\w-]+)+/.test(e)}}function Mg(e,t,r){const n=[],a=new Map;let s=0;const i=new Map;for(const d of t)d.excelColumn&&i.set(d.systemField,d.excelColumn);const o=i.get("codigo");e.forEach((d,h)=>{const p=h+2;let g=!1;for(const m of r){const x=i.get(m.key),v=hne[m.key];if(!x){m.required&&(n.push({row:p,column:m.label,field:m.key,error:"Campo requerido no mapeado",value:null,severity:"error"}),g=!0);continue}const y=d[x],w=y!==null?String(y).trim():null;if(m.required&&(!w||w==="")){n.push({row:p,column:x,field:m.key,error:"Valor vaco en campo requerido",value:w,severity:"error"}),g=!0;continue}if(!(!w||w==="")){if((v==null?void 0:v.type)==="number"){const E=Lj(w);E===null?(n.push({row:p,column:x,field:m.key,error:`Valor no numrico: '${w}'`,value:w,severity:"error"}),g=!0):E<0&&m.key.includes("precio")&&n.push({row:p,column:x,field:m.key,error:`Precio negativo: ${E}`,value:w,severity:"warning"})}(v==null?void 0:v.type)==="url"&&w&&(pne(w)||n.push({row:p,column:x,field:m.key,error:`URL invlida: '${w}'`,value:w,severity:"warning"})),(v==null?void 0:v.type)==="boolean"&&w&&Lv(w)===null&&n.push({row:p,column:x,field:m.key,error:`Valor booleano no reconocido: '${w}'`,value:w,severity:"warning"}),v!=null&&v.maxLength&&w.length>v.maxLength&&n.push({row:p,column:x,field:m.key,error:`Texto demasiado largo (${w.length}/${v.maxLength})`,value:w.substring(0,50)+"...",severity:"warning"})}}if(o){const m=d[o];if(m!==null&&m!==""){const x=String(m).trim();a.has(x)||a.set(x,[]),a.get(x).push(p)}}g||s++});const l=new Map;for(const[d,h]of a)if(h.length>1){l.set(d,h);for(const p of h.slice(1))n.push({row:p,column:o||"Codigo",field:"codigo",error:`Cdigo duplicado: '${d}' (tambin en filas: ${h.filter(g=>g!==p).join(", ")})`,value:d,severity:"error"}),s=Math.max(0,s-1)}n.sort((d,h)=>d.row-h.row);const c=n.filter(d=>d.severity==="error").length,f=n.filter(d=>d.severity==="warning").length;return{isValid:c===0,totalRows:e.length,validRows:s,errorCount:c,warningCount:f,errors:n,duplicates:l}}function Bj(e,t){const r=new Map;for(const m of t)m.excelColumn&&r.set(m.systemField,m.excelColumn);const n=m=>{const x=r.get(m);if(!x)return null;const v=e[x];return v!==null?String(v).trim():null},a=m=>{const x=n(m);return x?Lj(x):null},s=m=>{const x=n(m);return Lv(x)??!1},i={},o=n("estado_anuncio"),l=n("estado_tienda");o&&(i.estado_anuncio=o),l&&(i.estado_tienda=l);const c={},f=a("precio_p"),d=a("precio_m");f!==null&&(c.precio_p=f),d!==null&&(c.precio_m=d);const h={},p=s("selecto"),g=n("ef_tkc");return h.selecto=p,g&&(h.ef_tkc=Lv(g)??!1),{code:n("codigo")||"",name:n("producto")||"",price_usd:a("precio")||0,category:n("categoria"),category_f1:n("cat_f1"),category_f2:n("cat_f2"),category_f3:n("cat_f3"),supplier:n("suministrador"),warehouse:n("almacen"),store_id:n("id_tienda"),store_name:n("tienda"),image_url:n("imagen"),image_filter:n("filtro_imagenes"),states:Object.keys(i).length>0?i:{},extra_prices:Object.keys(c).length>0?c:{},flags:Object.keys(h).length>0?h:{},is_selected:p,is_active:!0}}const Pu=100;function mne(){const{user:e}=Dt(),t=Pr();return nn({mutationFn:async({catalogName:r,catalogDescription:n,rows:a,mappings:s,onProgress:i})=>{if(!e)throw new Error("Usuario no autenticado");i==null||i(5,"Creando catlogo...");const{data:o,error:l}=await Ce.from("catalogs").insert({name:r,description:n||null,status:"draft",created_by:e.id}).select().single();if(l)throw console.error("Error creating catalog:",l),new Error("Error al crear el catlogo");i==null||i(15,"Creando versin...");const{data:c,error:f}=await Ce.from("catalog_versions").insert({catalog_id:o.id,version_number:1,status:"draft",created_by:e.id,notes:`Importacin inicial de ${a.length} productos`}).select().single();if(f)throw console.error("Error creating version:",f),await Ce.from("catalogs").delete().eq("id",o.id),new Error("Error al crear la versin del catlogo");i==null||i(25,"Preparando productos...");const d=a.map(g=>{const m=Bj(g,s);return{version_id:c.id,code:m.code,name:m.name,price_usd:m.price_usd,category:m.category,category_f1:m.category_f1,category_f2:m.category_f2,category_f3:m.category_f3,supplier:m.supplier,warehouse:m.warehouse,store_id:m.store_id,store_name:m.store_name,image_url:m.image_url,image_filter:m.image_filter,states:m.states,extra_prices:m.extra_prices,flags:m.flags,is_selected:m.is_selected,is_active:m.is_active}}),h=Math.ceil(d.length/Pu);let p=0;for(let g=0;g<d.length;g+=Pu){const m=d.slice(g,g+Pu),x=Math.floor(g/Pu)+1;i==null||i(25+Math.round(x/h*70),`Importando productos (${Math.min(g+Pu,d.length)}/${d.length})...`);const{error:v}=await Ce.from("catalog_items").insert(m);v?(console.error("Error inserting batch:",v),Pe.error(`Error en lote ${x}: ${v.message}`)):p+=m.length}return i==null||i(100,"Importacin completada!"),{catalogId:o.id,versionId:c.id,itemsImported:p}},onSuccess:()=>{t.invalidateQueries({queryKey:["catalogs"]}),Pe.success("Catlogo importado exitosamente")},onError:r=>{console.error("Import error:",r),Pe.error(r instanceof Error?r.message:"Error al importar el catlogo")}})}const ju=100;function gne(){const{user:e}=Dt(),t=Pr();return nn({mutationFn:async({catalogId:r,baseVersionNumber:n,items:a,onProgress:s})=>{if(!e)throw new Error("Usuario no autenticado");s==null||s(5,"Creando nueva versin...");const{data:i,error:o}=await Ce.from("catalog_versions").insert({catalog_id:r,version_number:n+1,status:"draft",created_by:e.id,notes:`Actualizacin con ${a.length} productos`}).select().single();if(o)throw console.error("Error creating version:",o),new Error("Error al crear la versin del catlogo");const l=a.map(d=>({version_id:i.id,code:d.code,name:d.name,price_usd:d.price_usd,category:d.category,category_f1:d.category_f1,category_f2:d.category_f2,category_f3:d.category_f3,supplier:d.supplier,warehouse:d.warehouse,store_id:d.store_id,store_name:d.store_name,image_url:d.image_url,image_filter:d.image_filter,states:d.states,extra_prices:d.extra_prices,flags:d.flags,is_selected:d.is_selected,is_active:d.is_active})),c=Math.ceil(l.length/ju);let f=0;for(let d=0;d<l.length;d+=ju){const h=l.slice(d,d+ju),p=Math.floor(d/ju)+1;s==null||s(10+Math.round(p/c*85),`Actualizando productos (${Math.min(d+ju,l.length)}/${l.length})...`);const{error:g}=await Ce.from("catalog_items").insert(h);g?(console.error("Error inserting batch:",g),Pe.error(`Error en lote ${p}: ${g.message}`)):f+=h.length}return s==null||s(100,"Actualizacin completada"),{catalogId:r,versionId:i.id,itemsImported:f}},onSuccess:r=>{t.invalidateQueries({queryKey:["catalog",r.catalogId]}),t.invalidateQueries({queryKey:["catalogs"]}),t.invalidateQueries({queryKey:["catalog-versions",r.catalogId]}),Pe.success("Catlogo actualizado exitosamente")},onError:r=>{console.error("Update error:",r),Pe.error(r instanceof Error?r.message:"Error al actualizar el catlogo")}})}var hm="Checkbox",[xne]=rn(hm),[vne,Aw]=xne(hm);function yne(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:s,form:i,name:o,onCheckedChange:l,required:c,value:f="on",internal_do_not_use_render:d}=e,[h,p]=ba({prop:r,defaultProp:a??!1,onChange:l,caller:hm}),[g,m]=_.useState(null),[x,v]=_.useState(null),y=_.useRef(!1),w=g?!!i||!!g.closest("form"):!0,E={checked:h,disabled:s,setChecked:p,control:g,setControl:m,name:o,form:i,value:f,hasConsumerStoppedPropagationRef:y,required:c,defaultChecked:qi(a)?!1:a,isFormControl:w,bubbleInput:x,setBubbleInput:v};return u.jsx(vne,{scope:t,...E,children:wne(d)?d(E):n})}var Uj="CheckboxTrigger",$j=_.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},a)=>{const{control:s,value:i,disabled:o,checked:l,required:c,setControl:f,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:p,bubbleInput:g}=Aw(Uj,e),m=Ke(a,f),x=_.useRef(l);return _.useEffect(()=>{const v=s==null?void 0:s.form;if(v){const y=()=>d(x.current);return v.addEventListener("reset",y),()=>v.removeEventListener("reset",y)}},[s,d]),u.jsx(Ae.button,{type:"button",role:"checkbox","aria-checked":qi(l)?"mixed":l,"aria-required":c,"data-state":Gj(l),"data-disabled":o?"":void 0,disabled:o,value:i,...n,ref:m,onKeyDown:ge(t,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:ge(r,v=>{d(y=>qi(y)?!0:!y),g&&p&&(h.current=v.isPropagationStopped(),h.current||v.stopPropagation())})})});$j.displayName=Uj;var Rw=_.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:s,required:i,disabled:o,value:l,onCheckedChange:c,form:f,...d}=e;return u.jsx(yne,{__scopeCheckbox:r,checked:a,defaultChecked:s,disabled:o,required:i,onCheckedChange:c,name:n,form:f,value:l,internal_do_not_use_render:({isFormControl:h})=>u.jsxs(u.Fragment,{children:[u.jsx($j,{...d,ref:t,__scopeCheckbox:r}),h&&u.jsx(Hj,{__scopeCheckbox:r})]})})});Rw.displayName=hm;var Wj="CheckboxIndicator",Vj=_.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=e,s=Aw(Wj,r);return u.jsx(Vr,{present:n||qi(s.checked)||s.checked===!0,children:u.jsx(Ae.span,{"data-state":Gj(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});Vj.displayName=Wj;var zj="CheckboxBubbleInput",Hj=_.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:s,defaultChecked:i,required:o,disabled:l,name:c,value:f,form:d,bubbleInput:h,setBubbleInput:p}=Aw(zj,e),g=Ke(r,p),m=_y(s),x=X1(n);_.useEffect(()=>{const y=h;if(!y)return;const w=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(w,"checked").set,k=!a.current;if(m!==s&&b){const S=new Event("click",{bubbles:k});y.indeterminate=qi(s),b.call(y,qi(s)?!1:s),y.dispatchEvent(S)}},[h,m,s,a]);const v=_.useRef(qi(s)?!1:s);return u.jsx(Ae.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??v.current,required:o,disabled:l,name:c,value:f,form:d,...t,tabIndex:-1,ref:g,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Hj.displayName=zj;function wne(e){return typeof e=="function"}function qi(e){return e==="indeterminate"}function Gj(e){return qi(e)?"indeterminate":e?"checked":"unchecked"}const Xh=_.forwardRef(({className:e,...t},r)=>u.jsx(Rw,{ref:r,className:he("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:u.jsx(Vj,{className:he("flex items-center justify-center text-current"),children:u.jsx(jf,{className:"h-4 w-4"})})}));Xh.displayName=Rw.displayName;function _ne(e,t){return _.useReducer((r,n)=>t[r][n]??r,e)}var Pw="ScrollArea",[Kj]=rn(Pw),[Ene,Ca]=Kj(Pw),qj=_.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:s=600,...i}=e,[o,l]=_.useState(null),[c,f]=_.useState(null),[d,h]=_.useState(null),[p,g]=_.useState(null),[m,x]=_.useState(null),[v,y]=_.useState(0),[w,E]=_.useState(0),[b,k]=_.useState(!1),[S,T]=_.useState(!1),N=Ke(t,j=>l(j)),O=ou(a);return u.jsx(Ene,{scope:r,type:n,dir:O,scrollHideDelay:s,scrollArea:o,viewport:c,onViewportChange:f,content:d,onContentChange:h,scrollbarX:p,onScrollbarXChange:g,scrollbarXEnabled:b,onScrollbarXEnabledChange:k,scrollbarY:m,onScrollbarYChange:x,scrollbarYEnabled:S,onScrollbarYEnabledChange:T,onCornerWidthChange:y,onCornerHeightChange:E,children:u.jsx(Ae.div,{dir:O,...i,ref:N,style:{position:"relative","--radix-scroll-area-corner-width":v+"px","--radix-scroll-area-corner-height":w+"px",...e.style}})})});qj.displayName=Pw;var Xj="ScrollAreaViewport",Yj=_.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:n,nonce:a,...s}=e,i=Ca(Xj,r),o=_.useRef(null),l=Ke(t,o,i.onViewportChange);return u.jsxs(u.Fragment,{children:[u.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),u.jsx(Ae.div,{"data-radix-scroll-area-viewport":"",...s,ref:l,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...e.style},children:u.jsx("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});Yj.displayName=Xj;var Cs="ScrollAreaScrollbar",jw=_.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=Ca(Cs,e.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:i}=a,o=e.orientation==="horizontal";return _.useEffect(()=>(o?s(!0):i(!0),()=>{o?s(!1):i(!1)}),[o,s,i]),a.type==="hover"?u.jsx(bne,{...n,ref:t,forceMount:r}):a.type==="scroll"?u.jsx(Sne,{...n,ref:t,forceMount:r}):a.type==="auto"?u.jsx(Qj,{...n,ref:t,forceMount:r}):a.type==="always"?u.jsx(Fw,{...n,ref:t}):null});jw.displayName=Cs;var bne=_.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=Ca(Cs,e.__scopeScrollArea),[s,i]=_.useState(!1);return _.useEffect(()=>{const o=a.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),i(!0)},f=()=>{l=window.setTimeout(()=>i(!1),a.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",f),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",f)}}},[a.scrollArea,a.scrollHideDelay]),u.jsx(Vr,{present:r||s,children:u.jsx(Qj,{"data-state":s?"visible":"hidden",...n,ref:t})})}),Sne=_.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=Ca(Cs,e.__scopeScrollArea),s=e.orientation==="horizontal",i=mm(()=>l("SCROLL_END"),100),[o,l]=_ne("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return _.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,a.scrollHideDelay,l]),_.useEffect(()=>{const c=a.viewport,f=s?"scrollLeft":"scrollTop";if(c){let d=c[f];const h=()=>{const p=c[f];d!==p&&(l("SCROLL"),i()),d=p};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[a.viewport,s,l,i]),u.jsx(Vr,{present:r||o!=="hidden",children:u.jsx(Fw,{"data-state":o==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:ge(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:ge(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Qj=_.forwardRef((e,t)=>{const r=Ca(Cs,e.__scopeScrollArea),{forceMount:n,...a}=e,[s,i]=_.useState(!1),o=e.orientation==="horizontal",l=mm(()=>{if(r.viewport){const c=r.viewport.offsetWidth<r.viewport.scrollWidth,f=r.viewport.offsetHeight<r.viewport.scrollHeight;i(o?c:f)}},10);return qc(r.viewport,l),qc(r.content,l),u.jsx(Vr,{present:n||s,children:u.jsx(Fw,{"data-state":s?"visible":"hidden",...a,ref:t})})}),Fw=_.forwardRef((e,t)=>{const{orientation:r="vertical",...n}=e,a=Ca(Cs,e.__scopeScrollArea),s=_.useRef(null),i=_.useRef(0),[o,l]=_.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=rF(o.viewport,o.content),f={...n,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>s.current=h,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:h=>i.current=h};function d(h,p){return Rne(h,i.current,o,p)}return r==="horizontal"?u.jsx(kne,{...f,ref:t,onThumbPositionChange:()=>{if(a.viewport&&s.current){const h=a.viewport.scrollLeft,p=Bb(h,o,a.dir);s.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:h=>{a.viewport&&(a.viewport.scrollLeft=h)},onDragScroll:h=>{a.viewport&&(a.viewport.scrollLeft=d(h,a.dir))}}):r==="vertical"?u.jsx(Cne,{...f,ref:t,onThumbPositionChange:()=>{if(a.viewport&&s.current){const h=a.viewport.scrollTop,p=Bb(h,o);s.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:h=>{a.viewport&&(a.viewport.scrollTop=h)},onDragScroll:h=>{a.viewport&&(a.viewport.scrollTop=d(h))}}):null}),kne=_.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...a}=e,s=Ca(Cs,e.__scopeScrollArea),[i,o]=_.useState(),l=_.useRef(null),c=Ke(t,l,s.onScrollbarXChange);return _.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),u.jsx(Zj,{"data-orientation":"horizontal",...a,ref:c,sizes:r,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":pm(r)+"px",...e.style},onThumbPointerDown:f=>e.onThumbPointerDown(f.x),onDragScroll:f=>e.onDragScroll(f.x),onWheelScroll:(f,d)=>{if(s.viewport){const h=s.viewport.scrollLeft+f.deltaX;e.onWheelScroll(h),aF(h,d)&&f.preventDefault()}},onResize:()=>{l.current&&s.viewport&&i&&n({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:rp(i.paddingLeft),paddingEnd:rp(i.paddingRight)}})}})}),Cne=_.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...a}=e,s=Ca(Cs,e.__scopeScrollArea),[i,o]=_.useState(),l=_.useRef(null),c=Ke(t,l,s.onScrollbarYChange);return _.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),u.jsx(Zj,{"data-orientation":"vertical",...a,ref:c,sizes:r,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":pm(r)+"px",...e.style},onThumbPointerDown:f=>e.onThumbPointerDown(f.y),onDragScroll:f=>e.onDragScroll(f.y),onWheelScroll:(f,d)=>{if(s.viewport){const h=s.viewport.scrollTop+f.deltaY;e.onWheelScroll(h),aF(h,d)&&f.preventDefault()}},onResize:()=>{l.current&&s.viewport&&i&&n({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:rp(i.paddingTop),paddingEnd:rp(i.paddingBottom)}})}})}),[Tne,Jj]=Kj(Cs),Zj=_.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:s,onThumbPointerUp:i,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:f,onResize:d,...h}=e,p=Ca(Cs,r),[g,m]=_.useState(null),x=Ke(t,N=>m(N)),v=_.useRef(null),y=_.useRef(""),w=p.viewport,E=n.content-n.viewport,b=sr(f),k=sr(l),S=mm(d,10);function T(N){if(v.current){const O=N.clientX-v.current.left,j=N.clientY-v.current.top;c({x:O,y:j})}}return _.useEffect(()=>{const N=O=>{const j=O.target;(g==null?void 0:g.contains(j))&&b(O,E)};return document.addEventListener("wheel",N,{passive:!1}),()=>document.removeEventListener("wheel",N,{passive:!1})},[w,g,E,b]),_.useEffect(k,[n,k]),qc(g,S),qc(p.content,S),u.jsx(Tne,{scope:r,scrollbar:g,hasThumb:a,onThumbChange:sr(s),onThumbPointerUp:sr(i),onThumbPositionChange:k,onThumbPointerDown:sr(o),children:u.jsx(Ae.div,{...h,ref:x,style:{position:"absolute",...h.style},onPointerDown:ge(e.onPointerDown,N=>{N.button===0&&(N.target.setPointerCapture(N.pointerId),v.current=g.getBoundingClientRect(),y.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),T(N))}),onPointerMove:ge(e.onPointerMove,T),onPointerUp:ge(e.onPointerUp,N=>{const O=N.target;O.hasPointerCapture(N.pointerId)&&O.releasePointerCapture(N.pointerId),document.body.style.webkitUserSelect=y.current,p.viewport&&(p.viewport.style.scrollBehavior=""),v.current=null})})})}),tp="ScrollAreaThumb",eF=_.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=Jj(tp,e.__scopeScrollArea);return u.jsx(Vr,{present:r||a.hasThumb,children:u.jsx(Nne,{ref:t,...n})})}),Nne=_.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:n,...a}=e,s=Ca(tp,r),i=Jj(tp,r),{onThumbPositionChange:o}=i,l=Ke(t,d=>i.onThumbChange(d)),c=_.useRef(void 0),f=mm(()=>{c.current&&(c.current(),c.current=void 0)},100);return _.useEffect(()=>{const d=s.viewport;if(d){const h=()=>{if(f(),!c.current){const p=Pne(d,o);c.current=p,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[s.viewport,f,o]),u.jsx(Ae.div,{"data-state":i.hasThumb?"visible":"hidden",...a,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:ge(e.onPointerDownCapture,d=>{const p=d.target.getBoundingClientRect(),g=d.clientX-p.left,m=d.clientY-p.top;i.onThumbPointerDown({x:g,y:m})}),onPointerUp:ge(e.onPointerUp,i.onThumbPointerUp)})});eF.displayName=tp;var Ow="ScrollAreaCorner",tF=_.forwardRef((e,t)=>{const r=Ca(Ow,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?u.jsx(Ane,{...e,ref:t}):null});tF.displayName=Ow;var Ane=_.forwardRef((e,t)=>{const{__scopeScrollArea:r,...n}=e,a=Ca(Ow,r),[s,i]=_.useState(0),[o,l]=_.useState(0),c=!!(s&&o);return qc(a.scrollbarX,()=>{var d;const f=((d=a.scrollbarX)==null?void 0:d.offsetHeight)||0;a.onCornerHeightChange(f),l(f)}),qc(a.scrollbarY,()=>{var d;const f=((d=a.scrollbarY)==null?void 0:d.offsetWidth)||0;a.onCornerWidthChange(f),i(f)}),c?u.jsx(Ae.div,{...n,ref:t,style:{width:s,height:o,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function rp(e){return e?parseInt(e,10):0}function rF(e,t){const r=e/t;return isNaN(r)?0:r}function pm(e){const t=rF(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function Rne(e,t,r,n="ltr"){const a=pm(r),s=a/2,i=t||s,o=a-i,l=r.scrollbar.paddingStart+i,c=r.scrollbar.size-r.scrollbar.paddingEnd-o,f=r.content-r.viewport,d=n==="ltr"?[0,f]:[f*-1,0];return nF([l,c],d)(e)}function Bb(e,t,r="ltr"){const n=pm(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=t.scrollbar.size-a,i=t.content-t.viewport,o=s-n,l=r==="ltr"?[0,i]:[i*-1,0],c=gv(e,l);return nF([0,i],[0,o])(c)}function nF(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function aF(e,t){return e>0&&e<t}var Pne=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return function a(){const s={left:e.scrollLeft,top:e.scrollTop},i=r.left!==s.left,o=r.top!==s.top;(i||o)&&t(),r=s,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function mm(e,t){const r=sr(e),n=_.useRef(0);return _.useEffect(()=>()=>window.clearTimeout(n.current),[]),_.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function qc(e,t){const r=sr(t);Er(()=>{let n=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(n),a.unobserve(e)}}},[e,r])}var sF=qj,jne=Yj,Fne=tF;const Yh=_.forwardRef(({className:e,children:t,...r},n)=>u.jsxs(sF,{ref:n,className:he("relative overflow-hidden",e),...r,children:[u.jsx(jne,{className:"h-full w-full rounded-[inherit]",children:t}),u.jsx(iF,{}),u.jsx(Fne,{})]}));Yh.displayName=sF.displayName;const iF=_.forwardRef(({className:e,orientation:t="vertical",...r},n)=>u.jsx(jw,{ref:n,orientation:t,className:he("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:u.jsx(eF,{className:"relative flex-1 rounded-full bg-border"})}));iF.displayName=jw.displayName;var gm="Collapsible",[One,oF]=rn(gm),[Ine,Iw]=One(gm),lF=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:s,onOpenChange:i,...o}=e,[l,c]=ba({prop:n,defaultProp:a??!1,onChange:i,caller:gm});return u.jsx(Ine,{scope:r,disabled:s,contentId:xa(),open:l,onOpenToggle:_.useCallback(()=>c(f=>!f),[c]),children:u.jsx(Ae.div,{"data-state":Mw(l),"data-disabled":s?"":void 0,...o,ref:t})})});lF.displayName=gm;var cF="CollapsibleTrigger",uF=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,a=Iw(cF,r);return u.jsx(Ae.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":Mw(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:ge(e.onClick,a.onOpenToggle)})});uF.displayName=cF;var Dw="CollapsibleContent",fF=_.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=Iw(Dw,e.__scopeCollapsible);return u.jsx(Vr,{present:r||a.open,children:({present:s})=>u.jsx(Dne,{...n,ref:t,present:s})})});fF.displayName=Dw;var Dne=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:a,...s}=e,i=Iw(Dw,r),[o,l]=_.useState(n),c=_.useRef(null),f=Ke(t,c),d=_.useRef(0),h=d.current,p=_.useRef(0),g=p.current,m=i.open||o,x=_.useRef(m),v=_.useRef(void 0);return _.useEffect(()=>{const y=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(y)},[]),Er(()=>{const y=c.current;if(y){v.current=v.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const w=y.getBoundingClientRect();d.current=w.height,p.current=w.width,x.current||(y.style.transitionDuration=v.current.transitionDuration,y.style.animationName=v.current.animationName),l(n)}},[i.open,n]),u.jsx(Ae.div,{"data-state":Mw(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!m,...s,ref:f,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:m&&a})});function Mw(e){return e?"open":"closed"}var Mne=lF,Lne=uF,Bne=fF,ts="Accordion",Une=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Lw,$ne,Wne]=wd(ts),[xm]=rn(ts,[Wne,oF]),Bw=oF(),dF=de.forwardRef((e,t)=>{const{type:r,...n}=e,a=n,s=n;return u.jsx(Lw.Provider,{scope:e.__scopeAccordion,children:r==="multiple"?u.jsx(Gne,{...s,ref:t}):u.jsx(Hne,{...a,ref:t})})});dF.displayName=ts;var[hF,Vne]=xm(ts),[pF,zne]=xm(ts,{collapsible:!1}),Hne=de.forwardRef((e,t)=>{const{value:r,defaultValue:n,onValueChange:a=()=>{},collapsible:s=!1,...i}=e,[o,l]=ba({prop:r,defaultProp:n??"",onChange:a,caller:ts});return u.jsx(hF,{scope:e.__scopeAccordion,value:de.useMemo(()=>o?[o]:[],[o]),onItemOpen:l,onItemClose:de.useCallback(()=>s&&l(""),[s,l]),children:u.jsx(pF,{scope:e.__scopeAccordion,collapsible:s,children:u.jsx(mF,{...i,ref:t})})})}),Gne=de.forwardRef((e,t)=>{const{value:r,defaultValue:n,onValueChange:a=()=>{},...s}=e,[i,o]=ba({prop:r,defaultProp:n??[],onChange:a,caller:ts}),l=de.useCallback(f=>o((d=[])=>[...d,f]),[o]),c=de.useCallback(f=>o((d=[])=>d.filter(h=>h!==f)),[o]);return u.jsx(hF,{scope:e.__scopeAccordion,value:i,onItemOpen:l,onItemClose:c,children:u.jsx(pF,{scope:e.__scopeAccordion,collapsible:!0,children:u.jsx(mF,{...s,ref:t})})})}),[Kne,vm]=xm(ts),mF=de.forwardRef((e,t)=>{const{__scopeAccordion:r,disabled:n,dir:a,orientation:s="vertical",...i}=e,o=de.useRef(null),l=Ke(o,t),c=$ne(r),d=ou(a)==="ltr",h=ge(e.onKeyDown,p=>{var T;if(!Une.includes(p.key))return;const g=p.target,m=c().filter(N=>{var O;return!((O=N.ref.current)!=null&&O.disabled)}),x=m.findIndex(N=>N.ref.current===g),v=m.length;if(x===-1)return;p.preventDefault();let y=x;const w=0,E=v-1,b=()=>{y=x+1,y>E&&(y=w)},k=()=>{y=x-1,y<w&&(y=E)};switch(p.key){case"Home":y=w;break;case"End":y=E;break;case"ArrowRight":s==="horizontal"&&(d?b():k());break;case"ArrowDown":s==="vertical"&&b();break;case"ArrowLeft":s==="horizontal"&&(d?k():b());break;case"ArrowUp":s==="vertical"&&k();break}const S=y%v;(T=m[S].ref.current)==null||T.focus()});return u.jsx(Kne,{scope:r,disabled:n,direction:a,orientation:s,children:u.jsx(Lw.Slot,{scope:r,children:u.jsx(Ae.div,{...i,"data-orientation":s,ref:l,onKeyDown:n?void 0:h})})})}),np="AccordionItem",[qne,Uw]=xm(np),gF=de.forwardRef((e,t)=>{const{__scopeAccordion:r,value:n,...a}=e,s=vm(np,r),i=Vne(np,r),o=Bw(r),l=xa(),c=n&&i.value.includes(n)||!1,f=s.disabled||e.disabled;return u.jsx(qne,{scope:r,open:c,disabled:f,triggerId:l,children:u.jsx(Mne,{"data-orientation":s.orientation,"data-state":EF(c),...o,...a,ref:t,disabled:f,open:c,onOpenChange:d=>{d?i.onItemOpen(n):i.onItemClose(n)}})})});gF.displayName=np;var xF="AccordionHeader",vF=de.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,a=vm(ts,r),s=Uw(xF,r);return u.jsx(Ae.h3,{"data-orientation":a.orientation,"data-state":EF(s.open),"data-disabled":s.disabled?"":void 0,...n,ref:t})});vF.displayName=xF;var Bv="AccordionTrigger",yF=de.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,a=vm(ts,r),s=Uw(Bv,r),i=zne(Bv,r),o=Bw(r);return u.jsx(Lw.ItemSlot,{scope:r,children:u.jsx(Lne,{"aria-disabled":s.open&&!i.collapsible||void 0,"data-orientation":a.orientation,id:s.triggerId,...o,...n,ref:t})})});yF.displayName=Bv;var wF="AccordionContent",_F=de.forwardRef((e,t)=>{const{__scopeAccordion:r,...n}=e,a=vm(ts,r),s=Uw(wF,r),i=Bw(r);return u.jsx(Bne,{role:"region","aria-labelledby":s.triggerId,"data-orientation":a.orientation,...i,...n,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});_F.displayName=wF;function EF(e){return e?"open":"closed"}var Xne=dF,Yne=gF,Qne=vF,bF=yF,SF=_F;const Jne=Xne,kF=_.forwardRef(({className:e,...t},r)=>u.jsx(Yne,{ref:r,className:he("border-b",e),...t}));kF.displayName="AccordionItem";const CF=_.forwardRef(({className:e,children:t,...r},n)=>u.jsx(Qne,{className:"flex",children:u.jsxs(bF,{ref:n,className:he("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...r,children:[t,u.jsx(Sp,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));CF.displayName=bF.displayName;const TF=_.forwardRef(({className:e,children:t,...r},n)=>u.jsx(SF,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:u.jsx("div",{className:he("pb-4 pt-0",e),children:t})}));TF.displayName=SF.displayName;const Zne=[{key:"name",label:"Producto"},{key:"price_usd",label:"Precio"},{key:"category",label:"Categora"},{key:"category_f1",label:"Categora F1"},{key:"category_f2",label:"Categora F2"},{key:"category_f3",label:"Categora F3"},{key:"supplier",label:"Suministrador"},{key:"warehouse",label:"Almacn"},{key:"store_id",label:"ID Tienda"},{key:"store_name",label:"Tienda"},{key:"image_url",label:"Imagen"},{key:"image_filter",label:"Filtro Imagen"},{key:"states",label:"Estados"},{key:"extra_prices",label:"Precios extra"},{key:"flags",label:"Flags"},{key:"is_selected",label:"Selecto"},{key:"is_active",label:"Activo"}],Ub=e=>Object.keys(e).sort().reduce((r,n)=>(r[n]=e[n],r),{}),eae=(e,t)=>e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"?JSON.stringify(Ub(e))===JSON.stringify(Ub(t)):!1,tae=(e,t)=>{const r=new Map(e.map(l=>[l.code,l])),n=new Map(t.map(l=>[l.code,l])),a=[],s=[],i=[],o=[];return t.forEach(l=>{const c=r.get(l.code);if(!c){a.push({code:l.code,newItem:l});return}const f=[];Zne.forEach(({key:d,label:h})=>{eae(c[d],l[d])||f.push({field:d,label:h,oldValue:c[d],newValue:l[d]})}),f.length>0?s.push({code:l.code,existingItem:c,newItem:l,changes:f}):o.push({code:l.code,existingItem:c,newItem:l,changes:[]})}),e.forEach(l=>{n.has(l.code)||i.push({code:l.code,existingItem:l})}),{summary:{new:a.length,modified:s.length,deleted:i.length,unchanged:o.length},newItems:a,modifiedItems:s,deletedItems:i,unchangedItems:o}},$b=e=>e==null?"":typeof e=="boolean"?e?"S":"No":typeof e=="number"?e.toString():typeof e=="object"?JSON.stringify(e):String(e);function rae({diff:e,onApply:t,onBack:r,isApplying:n}){const[a,s]=_.useState(()=>new Set(e.newItems.map(v=>v.code))),[i,o]=_.useState(()=>new Set(e.modifiedItems.map(v=>v.code))),[l,c]=_.useState(new Set),[f,d]=_.useState("summary"),h=(v,y)=>{const w=new Set(v);return w.has(y)?w.delete(y):w.add(y),w},p=(v,y)=>{y(new Set(v.map(w=>w.code)))},g=v=>{v(new Set)},m=()=>{t({addNew:a.size>0,updateModified:i.size>0,deleteRemoved:l.size>0,selectedNewCodes:a,selectedModifiedCodes:i,selectedDeletedCodes:l})},x=a.size+i.size+l.size;return u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsxs(Lr,{className:"flex items-center justify-between",children:[u.jsx("span",{children:"Vista de diferencias"}),u.jsxs("div",{className:"flex items-center gap-2 text-sm font-normal",children:[u.jsxs(Ct,{variant:"outline",className:"bg-success/10 text-success border-success/30",children:[u.jsx(Lc,{className:"h-3 w-3 mr-1"}),e.summary.new," nuevos"]}),u.jsxs(Ct,{variant:"outline",className:"bg-warning/10 text-warning border-warning/30",children:[u.jsx(s2,{className:"h-3 w-3 mr-1"}),e.summary.modified," modificados"]}),u.jsxs(Ct,{variant:"outline",className:"bg-destructive/10 text-destructive border-destructive/30",children:[u.jsx(Of,{className:"h-3 w-3 mr-1"}),e.summary.deleted," eliminados"]}),u.jsxs(Ct,{variant:"secondary",children:[u.jsx(SD,{className:"h-3 w-3 mr-1"}),e.summary.unchanged," sin cambios"]})]})]}),u.jsx(pn,{children:"Selecciona qu cambios deseas aplicar al catlogo existente"})]}),u.jsxs(ot,{className:"space-y-6",children:[u.jsxs(Lp,{value:f,onValueChange:d,children:[u.jsxs(Nd,{className:"grid grid-cols-4 w-full",children:[u.jsx(mn,{value:"summary",children:"Resumen"}),u.jsxs(mn,{value:"new",className:"gap-2",children:["Nuevos",e.newItems.length>0&&u.jsxs(Ct,{variant:"secondary",className:"ml-1 text-xs",children:[a.size,"/",e.newItems.length]})]}),u.jsxs(mn,{value:"modified",className:"gap-2",children:["Modificados",e.modifiedItems.length>0&&u.jsxs(Ct,{variant:"secondary",className:"ml-1 text-xs",children:[i.size,"/",e.modifiedItems.length]})]}),u.jsxs(mn,{value:"deleted",className:"gap-2",children:["Eliminados",e.deletedItems.length>0&&u.jsxs(Ct,{variant:"secondary",className:"ml-1 text-xs",children:[l.size,"/",e.deletedItems.length]})]})]}),u.jsxs(gn,{value:"summary",className:"space-y-4",children:[u.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[u.jsx(et,{className:"border-success/30 bg-success/5",children:u.jsx(ot,{className:"pt-6",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"h-10 w-10 rounded-full bg-success/20 flex items-center justify-center",children:u.jsx(Lc,{className:"h-5 w-5 text-success"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-success",children:e.summary.new}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Productos nuevos"})]})]})})}),u.jsx(et,{className:"border-warning/30 bg-warning/5",children:u.jsx(ot,{className:"pt-6",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"h-10 w-10 rounded-full bg-warning/20 flex items-center justify-center",children:u.jsx(s2,{className:"h-5 w-5 text-warning"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-warning",children:e.summary.modified}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Modificados"})]})]})})}),u.jsx(et,{className:"border-destructive/30 bg-destructive/5",children:u.jsx(ot,{className:"pt-6",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"h-10 w-10 rounded-full bg-destructive/20 flex items-center justify-center",children:u.jsx(Of,{className:"h-5 w-5 text-destructive"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-destructive",children:e.summary.deleted}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Eliminados"})]})]})})}),u.jsx(et,{children:u.jsx(ot,{className:"pt-6",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center",children:u.jsx(Fi,{className:"h-5 w-5 text-muted-foreground"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold",children:e.summary.unchanged}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Sin cambios"})]})]})})})]}),e.summary.new===0&&e.summary.modified===0&&e.summary.deleted===0&&u.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[u.jsx(Fi,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/50"}),u.jsx("p",{children:"No se detectaron cambios entre el archivo y el catlogo existente."})]})]}),u.jsx(gn,{value:"new",children:e.newItems.length===0?u.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"No hay productos nuevos"}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.size," de ",e.newItems.length," seleccionados para agregar"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(ye,{variant:"outline",size:"sm",onClick:()=>p(e.newItems,s),children:"Seleccionar todos"}),u.jsx(ye,{variant:"outline",size:"sm",onClick:()=>g(s),children:"Ninguno"})]})]}),u.jsx(Yh,{className:"h-80",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsxs(Zt,{children:[u.jsx(Le,{className:"w-12"}),u.jsx(Le,{children:"Cdigo"}),u.jsx(Le,{children:"Producto"}),u.jsx(Le,{className:"text-right",children:"Precio"}),u.jsx(Le,{children:"Categora"})]})}),u.jsx(Ya,{children:e.newItems.map(v=>{var y,w,E;return u.jsxs(Zt,{className:he(!a.has(v.code)&&"opacity-50"),children:[u.jsx(Ie,{children:u.jsx(Xh,{checked:a.has(v.code),onCheckedChange:()=>s(b=>h(b,v.code))})}),u.jsx(Ie,{className:"font-mono text-sm",children:v.code}),u.jsx(Ie,{children:(y=v.newItem)==null?void 0:y.name}),u.jsxs(Ie,{className:"text-right",children:["$",Number(((w=v.newItem)==null?void 0:w.price_usd)||0).toFixed(2)]}),u.jsx(Ie,{children:((E=v.newItem)==null?void 0:E.category)&&u.jsx(Ct,{variant:"secondary",children:v.newItem.category})})]},v.code)})})]})})]})}),u.jsx(gn,{value:"modified",children:e.modifiedItems.length===0?u.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"No hay productos modificados"}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("p",{className:"text-sm text-muted-foreground",children:[i.size," de ",e.modifiedItems.length," seleccionados para actualizar"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(ye,{variant:"outline",size:"sm",onClick:()=>p(e.modifiedItems,o),children:"Seleccionar todos"}),u.jsx(ye,{variant:"outline",size:"sm",onClick:()=>g(o),children:"Ninguno"})]})]}),u.jsx(Yh,{className:"h-80",children:u.jsx(Jne,{type:"multiple",className:"w-full",children:e.modifiedItems.map(v=>{var y,w,E;return u.jsxs(kF,{value:v.code,children:[u.jsxs("div",{className:"flex items-center gap-3 pr-4",children:[u.jsx(Xh,{checked:i.has(v.code),onCheckedChange:()=>o(b=>h(b,v.code)),className:"ml-4"}),u.jsx(CF,{className:he("flex-1",!i.has(v.code)&&"opacity-50"),children:u.jsxs("div",{className:"flex items-center gap-4 text-left",children:[u.jsx("span",{className:"font-mono text-sm",children:v.code}),u.jsx("span",{className:"font-medium",children:(y=v.existingItem)==null?void 0:y.name}),u.jsxs(Ct,{variant:"outline",className:"ml-auto",children:[(w=v.changes)==null?void 0:w.length," cambios"]})]})})]}),u.jsx(TF,{children:u.jsx("div",{className:"pl-12 pr-4 pb-4",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsxs(Zt,{children:[u.jsx(Le,{children:"Campo"}),u.jsx(Le,{children:"Valor actual"}),u.jsx(Le,{className:"w-8"}),u.jsx(Le,{children:"Nuevo valor"})]})}),u.jsx(Ya,{children:(E=v.changes)==null?void 0:E.map(b=>u.jsxs(Zt,{children:[u.jsx(Ie,{className:"font-medium",children:b.label}),u.jsx(Ie,{className:"text-muted-foreground",children:$b(b.oldValue)}),u.jsx(Ie,{children:u.jsx(Hi,{className:"h-4 w-4 text-muted-foreground"})}),u.jsx(Ie,{className:"font-medium text-warning",children:$b(b.newValue)})]},b.field))})]})})})]},v.code)})})})]})}),u.jsx(gn,{value:"deleted",children:e.deletedItems.length===0?u.jsx("p",{className:"text-center py-8 text-muted-foreground",children:"No hay productos eliminados"}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"p-4 bg-destructive/5 border border-destructive/20 rounded-lg",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx(Ff,{className:"h-5 w-5 text-destructive mt-0.5"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-destructive",children:"Atencin"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Estos productos existen en el catlogo pero no estn en el archivo importado. Selecciona los que deseas eliminar del catlogo."})]})]})}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("p",{className:"text-sm text-muted-foreground",children:[l.size," de ",e.deletedItems.length," seleccionados para eliminar"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx(ye,{variant:"outline",size:"sm",onClick:()=>p(e.deletedItems,c),children:"Seleccionar todos"}),u.jsx(ye,{variant:"outline",size:"sm",onClick:()=>g(c),children:"Ninguno"})]})]}),u.jsx(Yh,{className:"h-64",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsxs(Zt,{children:[u.jsx(Le,{className:"w-12"}),u.jsx(Le,{children:"Cdigo"}),u.jsx(Le,{children:"Producto"}),u.jsx(Le,{className:"text-right",children:"Precio"}),u.jsx(Le,{children:"Categora"})]})}),u.jsx(Ya,{children:e.deletedItems.map(v=>{var y,w,E;return u.jsxs(Zt,{className:he(l.has(v.code)&&"bg-destructive/5"),children:[u.jsx(Ie,{children:u.jsx(Xh,{checked:l.has(v.code),onCheckedChange:()=>c(b=>h(b,v.code))})}),u.jsx(Ie,{className:"font-mono text-sm",children:v.code}),u.jsx(Ie,{children:(y=v.existingItem)==null?void 0:y.name}),u.jsxs(Ie,{className:"text-right",children:["$",Number(((w=v.existingItem)==null?void 0:w.price_usd)||0).toFixed(2)]}),u.jsx(Ie,{children:((E=v.existingItem)==null?void 0:E.category)&&u.jsx(Ct,{variant:"secondary",children:v.existingItem.category})})]},v.code)})})]})})]})})]}),u.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[u.jsx(ye,{variant:"outline",onClick:r,disabled:n,children:"Atrs"}),u.jsx(ye,{onClick:m,disabled:x===0||n,children:n?u.jsx(u.Fragment,{children:"Aplicando cambios..."}):x===0?"Selecciona cambios a aplicar":u.jsxs(u.Fragment,{children:["Aplicar ",x," cambios",u.jsx(Hi,{className:"h-4 w-4 ml-2"})]})})]})]})]})}const Fu=[{key:"codigo",label:"Codigo",required:!0,description:"Cdigo nico del producto (SKU)"},{key:"producto",label:"Producto",required:!0,description:"Nombre del producto"},{key:"precio",label:"Precio",required:!0,description:"Precio en USD"},{key:"imagen",label:"Imagen",required:!1,description:"URL de la imagen"},{key:"suministrador",label:"Suministrador",required:!1},{key:"almacen",label:"Almacen",required:!1},{key:"categoria",label:"Categoria",required:!1},{key:"precio_p",label:"Precio P",required:!1,description:"Precio alternativo P"},{key:"precio_m",label:"Precio M.",required:!1,description:"Precio alternativo M"},{key:"filtro_imagenes",label:"Filtro para Imagenes",required:!1},{key:"ef_tkc",label:"EF TKC",required:!1},{key:"id_tienda",label:"ID Tienda",required:!1},{key:"estado_anuncio",label:"Estado Anuncio",required:!1},{key:"estado_tienda",label:"Estado en Tienda",required:!1},{key:"tienda",label:"Tienda",required:!1},{key:"selecto",label:"Selecto",required:!1,description:"Producto seleccionado"},{key:"cat_f1",label:"Cat.F1",required:!1,description:"Categora nivel 1"},{key:"cat_f2",label:"Cat.F2",required:!1,description:"Categora nivel 2"},{key:"cat_f3",label:"Cat.F3",required:!1,description:"Categora nivel 3"}];function nae(){const[e]=vL(),t=e.get("catalogId")||"",r=!!t,[n,a]=_.useState("upload"),[s,i]=_.useState(null),[o,l]=_.useState(!1),[c,f]=_.useState(""),[d,h]=_.useState(0),[p,g]=_.useState(""),[m,x]=_.useState(!1),[v,y]=_.useState(null),[w,E]=_.useState([]),[b,k]=_.useState(null),[S,T]=_.useState("all"),[N,O]=_.useState(!1),[j,D]=_.useState(null),[Y,Q]=_.useState(null),G=mne(),X=gne(),{data:q}=_j(t),{data:K}=Aj(t),A=K==null?void 0:K[0],{data:ne}=Rj(A==null?void 0:A.id);_.useEffect(()=>{q&&r&&f(q.name)},[q,r]);const ce=_.useCallback(fe=>{fe.preventDefault(),l(!0)},[]),R=_.useCallback(fe=>{fe.preventDefault(),l(!1)},[]),z=_.useCallback(fe=>{fe.preventDefault(),l(!1);const Re=fe.dataTransfer.files[0];Re&&(Re.name.endsWith(".xlsx")||Re.name.endsWith(".xls"))?(i(Re),f(Re.name.replace(/\.(xlsx|xls)$/,""))):Pe.error("Por favor, selecciona un archivo Excel (.xlsx o .xls)")},[]),U=fe=>{var lt;const Re=(lt=fe.target.files)==null?void 0:lt[0];Re&&(Re.name.endsWith(".xlsx")||Re.name.endsWith(".xls"))?(i(Re),f(Re.name.replace(/\.(xlsx|xls)$/,""))):Pe.error("Por favor, selecciona un archivo Excel (.xlsx o .xls)")},V=async()=>{if(s){x(!0),h(0),g("Leyendo archivo...");try{h(30),g("Procesando datos...");const fe=await fne(s);h(80),g("Preparando vista previa..."),y(fe),h(100),g("Listo!"),setTimeout(()=>{x(!1),a("mapping")},500)}catch(fe){console.error("Error processing Excel:",fe),x(!1),Pe.error(fe instanceof Error?fe.message:"Error al procesar el archivo")}}},J=()=>{s&&c&&V()},W=fe=>{if(!v)return;E(fe),x(!0),g("Validando datos...");const Re=Mg(v.rows,fe,Fu);k(Re),x(!1),a("validation")},se=()=>{!v||w.length===0||(x(!0),g("Revalidando..."),setTimeout(()=>{const fe=Mg(v.rows,w,Fu);k(fe),x(!1)},300))},ie=()=>{O(!0)},ae=fe=>{y(lt=>lt?{...lt,rows:fe}:null),O(!1);const Re=Mg(fe,w,Fu);k(Re),Pe.success("Correcciones aplicadas. Datos revalidados.")},be=async()=>{if(!(!v||w.length===0)){if(r){Ue();return}a("importing");try{const fe=await G.mutateAsync({catalogName:c,rows:v.rows,mappings:w,onProgress:(Re,lt)=>{h(Re),g(lt)}});D({catalogId:fe.catalogId,itemsImported:fe.itemsImported}),a("complete")}catch(fe){console.error("Import failed:",fe),a("validation")}}},I=()=>v?v.rows.map(fe=>{const Re=Bj(fe,w);return{code:Re.code,name:Re.name,price_usd:Re.price_usd,category:Re.category,category_f1:Re.category_f1,category_f2:Re.category_f2,category_f3:Re.category_f3,supplier:Re.supplier,warehouse:Re.warehouse,store_id:Re.store_id,store_name:Re.store_name,image_url:Re.image_url,image_filter:Re.image_filter,states:Re.states,extra_prices:Re.extra_prices,flags:Re.flags,is_selected:Re.is_selected,is_active:Re.is_active}}):[],He=()=>(ne||[]).map(fe=>({code:fe.code,name:fe.name,price_usd:fe.price_usd,category:fe.category,category_f1:fe.category_f1??null,category_f2:fe.category_f2??null,category_f3:fe.category_f3??null,supplier:fe.supplier??null,warehouse:fe.warehouse??null,store_id:fe.store_id??null,store_name:fe.store_name??null,image_url:fe.image_url??null,image_filter:fe.image_filter??null,states:fe.states??{},extra_prices:fe.extra_prices??{},flags:fe.flags??{},is_selected:fe.is_selected,is_active:fe.is_active})),Ue=()=>{if(!A){Pe.error("No se encontr una versin base del catlogo.");return}const fe=tae(He(),I());Q(fe),a("diff")},at=async fe=>{if(!t||!A||!Y)return;a("importing");const Re=new Map(Y.newItems.map(qe=>[qe.code,qe.newItem])),lt=new Map(Y.modifiedItems.map(qe=>[qe.code,qe.newItem])),pr=new Map(He().map(qe=>[qe.code,qe])),Nt=new Map;pr.forEach((qe,rr)=>{Nt.set(rr,qe)}),fe.selectedModifiedCodes.forEach(qe=>{const rr=lt.get(qe);rr&&Nt.set(qe,rr)}),fe.selectedNewCodes.forEach(qe=>{const rr=Re.get(qe);rr&&Nt.set(qe,rr)}),fe.selectedDeletedCodes.forEach(qe=>{Nt.delete(qe)});try{const qe=await X.mutateAsync({catalogId:t,baseVersionNumber:A.version_number,items:Array.from(Nt.values()),onProgress:(rr,Mt)=>{h(rr),g(Mt)}});D({catalogId:qe.catalogId,itemsImported:qe.itemsImported}),a("complete")}catch(qe){console.error("Update failed:",qe),a("diff")}},Ve=()=>{if(!b)return;const fe=[["Fila","Columna","Campo","Error","Valor","Severidad"].join(","),...b.errors.map(pr=>[pr.row,pr.column,pr.field,`"${pr.error}"`,`"${pr.value||""}"`,pr.severity].join(","))].join(`
`),Re=new Blob([fe],{type:"text/csv;charset=utf-8;"}),lt=document.createElement("a");lt.href=URL.createObjectURL(Re),lt.download=`errores_${c}_${new Date().toISOString().split("T")[0]}.csv`,lt.click()},ve=_.useMemo(()=>{if(!b)return[];switch(S){case"errors":return b.errors.filter(fe=>fe.severity==="error");case"warnings":return b.errors.filter(fe=>fe.severity==="warning");default:return b.errors}},[b,S]),xt=_.useMemo(()=>v?dne(v.rows,5):[],[v]);return u.jsx(ya,{children:u.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:r?"Actualizar catlogo":"Importar Excel"}),u.jsx("p",{className:"text-muted-foreground",children:r?"Sube un archivo .xlsx para comparar y actualizar productos.":"Sube un archivo .xlsx para crear o actualizar un catlogo"})]}),u.jsx("div",{className:"flex items-center justify-between",children:[{key:"upload",label:"Subir archivo"},{key:"mapping",label:"Mapeo de columnas"},{key:"validation",label:"Validacin"},...r?[{key:"diff",label:"Cambios"}]:[],{key:"complete",label:"Completado"}].map((fe,Re)=>{const lt=r?["upload","mapping","validation","diff","complete"]:["upload","mapping","validation","complete"],pr=lt.indexOf(n==="importing"?"validation":n),Nt=fe.key===n||fe.key==="validation"&&n==="importing",qe=lt.indexOf(fe.key)<pr;return u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:he("h-8 w-8 rounded-full flex items-center justify-center text-sm font-medium border-2",qe?"bg-primary border-primary text-primary-foreground":Nt?"border-primary text-primary":"border-muted-foreground/30 text-muted-foreground"),children:qe?u.jsx(Fi,{className:"h-5 w-5"}):Re+1}),u.jsx("span",{className:he("text-sm font-medium hidden sm:inline",Nt?"text-foreground":"text-muted-foreground"),children:fe.label})]}),Re<lt.length-1&&u.jsx("div",{className:he("w-12 h-0.5 mx-2",qe?"bg-primary":"bg-muted-foreground/30")})]},fe.key)})}),n==="upload"&&u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(Lr,{children:"Subir archivo Excel"}),u.jsx(pn,{children:"Arrastra o selecciona un archivo .xlsx con tu catlogo de productos"})]}),u.jsxs(ot,{className:"space-y-6",children:[u.jsx("div",{onDragOver:ce,onDragLeave:R,onDrop:z,className:he("border-2 border-dashed rounded-lg p-12 text-center transition-colors",o?"border-primary bg-primary/5":"border-muted-foreground/30",s?"bg-muted/50":"hover:border-primary/50 hover:bg-muted/30"),children:s?u.jsxs("div",{className:"flex flex-col items-center gap-4",children:[u.jsx("div",{className:"h-16 w-16 rounded-full bg-success/10 flex items-center justify-center",children:u.jsx(Ha,{className:"h-8 w-8 text-success"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium",children:s.name}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:[(s.size/1024/1024).toFixed(2)," MB"]})]}),u.jsxs(ye,{variant:"outline",size:"sm",onClick:()=>i(null),children:[u.jsx(Sd,{className:"h-4 w-4 mr-2"}),"Cambiar archivo"]})]}):u.jsxs("div",{className:"flex flex-col items-center gap-4",children:[u.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center",children:u.jsx(If,{className:"h-8 w-8 text-muted-foreground"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium",children:"Arrastra tu archivo aqu"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"o haz clic para seleccionar"})]}),u.jsx(pt,{htmlFor:"file-upload",children:u.jsx(ye,{variant:"outline",asChild:!0,children:u.jsxs("span",{children:["Seleccionar archivo",u.jsx("input",{id:"file-upload",type:"file",accept:".xlsx,.xls",className:"hidden",onChange:U})]})})}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Solo archivos .xlsx o .xls  Mximo 10,000+ filas soportadas"})]})}),s&&u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"catalog-name",children:"Nombre del catlogo"}),u.jsx(zt,{id:"catalog-name",value:c,onChange:fe=>f(fe.target.value),placeholder:"Ej: Lista de Precios Q1 2024",disabled:r})]}),m&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between text-sm",children:[u.jsx("span",{children:p}),u.jsxs("span",{children:[d,"%"]})]}),u.jsx(Mv,{value:d})]}),u.jsxs("div",{className:"flex justify-end gap-3",children:[u.jsx(ye,{variant:"outline",asChild:!0,children:u.jsx(xr,{to:"/catalogos",children:"Cancelar"})}),u.jsx(ye,{onClick:J,disabled:!s||!c||m,children:m?u.jsxs(u.Fragment,{children:[u.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}),"Procesando..."]}):u.jsxs(u.Fragment,{children:["Continuar",u.jsx(Hi,{className:"h-4 w-4 ml-2"})]})})]})]})]}),n==="mapping"&&v&&u.jsx(cne,{excelColumns:v.columns,systemFields:Fu,previewData:xt,onMappingsChange:E,onValidate:W,onBack:()=>a("upload")}),n==="validation"&&b&&u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(Lr,{children:"Validacin de datos"}),u.jsx(pn,{children:"Revisa los resultados de validacin antes de importar"})]}),u.jsxs(ot,{className:"space-y-6",children:[u.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[u.jsx("div",{className:"p-4 rounded-lg bg-success/10 border border-success/20",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Fi,{className:"h-5 w-5 text-success"}),u.jsxs("span",{className:"font-medium",children:[b.validRows.toLocaleString()," filas vlidas"]})]})}),u.jsx("div",{className:he("p-4 rounded-lg border",b.errorCount>0?"bg-destructive/10 border-destructive/20":"bg-muted"),children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(Ff,{className:he("h-5 w-5",b.errorCount>0?"text-destructive":"text-muted-foreground")}),u.jsxs("span",{className:"font-medium",children:[b.errorCount," errores"]})]})}),u.jsx("div",{className:he("p-4 rounded-lg border",b.warningCount>0?"bg-warning/10 border-warning/20":"bg-muted"),children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx($1,{className:he("h-5 w-5",b.warningCount>0?"text-warning":"text-muted-foreground")}),u.jsxs("span",{className:"font-medium",children:[b.warningCount," advertencias"]})]})})]}),u.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[u.jsx(Ha,{className:"h-4 w-4"}),u.jsxs("span",{children:[b.totalRows.toLocaleString()," filas totales en el archivo"]})]}),b.duplicates.size>0&&u.jsxs("div",{className:"p-4 rounded-lg bg-destructive/5 border border-destructive/20",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(Ff,{className:"h-5 w-5 text-destructive"}),u.jsxs("span",{className:"font-medium",children:["Cdigos duplicados detectados: ",b.duplicates.size]})]}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[Array.from(b.duplicates.keys()).slice(0,10).map(fe=>u.jsx(Ct,{variant:"destructive",className:"text-xs",children:fe},fe)),b.duplicates.size>10&&u.jsxs(Ct,{variant:"outline",className:"text-xs",children:["+",b.duplicates.size-10," ms"]})]})]}),b.errors.length>0&&u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h3",{className:"font-medium",children:"Problemas detectados"}),u.jsxs("div",{className:"flex gap-1",children:[u.jsxs(ye,{variant:S==="all"?"default":"outline",size:"sm",onClick:()=>T("all"),children:["Todos (",b.errors.length,")"]}),u.jsxs(ye,{variant:S==="errors"?"destructive":"outline",size:"sm",onClick:()=>T("errors"),children:["Errores (",b.errorCount,")"]}),u.jsxs(ye,{variant:S==="warnings"?"secondary":"outline",size:"sm",onClick:()=>T("warnings"),children:["Advertencias (",b.warningCount,")"]})]})]}),u.jsxs(ye,{variant:"outline",size:"sm",onClick:Ve,children:[u.jsx(mD,{className:"h-4 w-4 mr-2"}),"Exportar CSV"]}),u.jsxs(ye,{variant:"secondary",size:"sm",onClick:ie,children:[u.jsx(bd,{className:"h-4 w-4 mr-2"}),"Editar errores"]})]}),u.jsx("div",{className:"border rounded-lg overflow-hidden max-h-80 overflow-y-auto",children:u.jsxs(qa,{children:[u.jsx(Xa,{className:"sticky top-0 bg-background",children:u.jsxs(Zt,{className:"bg-table-header",children:[u.jsx(Le,{className:"w-20",children:"Fila"}),u.jsx(Le,{children:"Columna"}),u.jsx(Le,{children:"Error"}),u.jsx(Le,{className:"w-24",children:"Severidad"})]})}),u.jsx(Ya,{children:ve.slice(0,100).map((fe,Re)=>u.jsxs(Zt,{children:[u.jsx(Ie,{className:"font-mono",children:fe.row}),u.jsx(Ie,{className:"font-medium",children:fe.column}),u.jsx(Ie,{className:he(fe.severity==="error"?"text-destructive":"text-warning"),children:fe.error}),u.jsx(Ie,{children:u.jsx(Ct,{variant:fe.severity==="error"?"destructive":"secondary",children:fe.severity==="error"?"Error":"Advertencia"})})]},`${fe.row}-${fe.field}-${Re}`))})]})}),ve.length>100&&u.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Mostrando primeros 100 de ",ve.length," problemas. Exporta el CSV para ver todos."]})]}),b.errorCount===0&&b.warningCount===0&&u.jsxs("div",{className:"p-6 rounded-lg bg-success/10 border border-success/20 text-center",children:[u.jsx(Fi,{className:"h-12 w-12 text-success mx-auto mb-3"}),u.jsx("h3",{className:"font-semibold text-lg mb-1",children:"Validacin exitosa!"}),u.jsx("p",{className:"text-muted-foreground",children:"Todos los datos estn correctos y listos para importar."})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx(ye,{variant:"outline",onClick:()=>a("mapping"),children:"Atrs"}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs(ye,{variant:"outline",onClick:se,disabled:m,children:[u.jsx(kp,{className:he("h-4 w-4 mr-2",m&&"animate-spin")}),"Revalidar"]}),u.jsx(ye,{onClick:be,disabled:b.errorCount>0,children:b.errorCount>0?"Corrige los errores primero":u.jsxs(u.Fragment,{children:[r?"Comparar cambios":"Confirmar importacin",u.jsx(Hi,{className:"h-4 w-4 ml-2"})]})})]})]})]})]}),n==="diff"&&Y&&u.jsx(rae,{diff:Y,onApply:at,onBack:()=>a("validation"),isApplying:X.isPending}),n==="validation"&&N&&v&&b&&u.jsx(une,{rows:v.rows,errors:b.errors,mappings:w,systemFields:Fu,onSave:ae,onCancel:()=>O(!1)}),n==="importing"&&u.jsx(et,{children:u.jsx(ot,{className:"py-12",children:u.jsxs("div",{className:"flex flex-col items-center text-center",children:[u.jsx(ws,{className:"h-16 w-16 text-primary animate-spin mb-6"}),u.jsx("h2",{className:"text-2xl font-bold mb-2",children:r?"Aplicando cambios...":"Importando catlogo..."}),u.jsx("p",{className:"text-muted-foreground mb-6 max-w-md",children:p}),u.jsxs("div",{className:"w-full max-w-md space-y-2",children:[u.jsx(Mv,{value:d}),u.jsxs("p",{className:"text-sm text-muted-foreground",children:[d,"%"]})]})]})})}),n==="complete"&&j&&u.jsx(et,{children:u.jsx(ot,{className:"py-12",children:u.jsxs("div",{className:"flex flex-col items-center text-center",children:[u.jsx("div",{className:"h-16 w-16 rounded-full bg-success/10 flex items-center justify-center mb-6",children:u.jsx(Fi,{className:"h-10 w-10 text-success"})}),u.jsx("h2",{className:"text-2xl font-bold mb-2",children:r?"Actualizacin completada!":"Importacin completada!"}),u.jsxs("p",{className:"text-muted-foreground mb-6 max-w-md",children:[r?`Se han actualizado ${j.itemsImported.toLocaleString()} productos en el catlogo "${c}".`:`Se han importado exitosamente ${j.itemsImported.toLocaleString()} productos al catlogo "${c}".`,"El catlogo est en estado borrador."]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(ye,{variant:"outline",asChild:!0,children:u.jsx(xr,{to:"/catalogos",children:"Ver catlogos"})}),u.jsx(ye,{asChild:!0,children:u.jsxs(xr,{to:`/catalogos/${j.catalogId}`,children:["Ir al catlogo",u.jsx(Hi,{className:"h-4 w-4 ml-2"})]})})]})]})})})]})})}function aae(){const{user:e}=Dt(),{data:t,isLoading:r}=Pj(),n=qre(),a=Xre(),s=Yre(),[i,o]=_.useState(""),[l,c]=_.useState(!1),[f,d]=_.useState(!1),[h,p]=_.useState(!1),[g,m]=_.useState(null),[x,v]=_.useState(""),[y,w]=_.useState(""),E=(t||[]).filter(j=>j.name.toLowerCase().includes(i.toLowerCase())||j.email.toLowerCase().includes(i.toLowerCase())),b=async()=>{!x||!y||(await n.mutateAsync({name:x,email:y}),c(!1),v(""),w(""))},k=async()=>{!g||!x||!y||(await a.mutateAsync({id:g.id,name:x,email:y}),d(!1),m(null),v(""),w(""))},S=async j=>{const D=j.status==="active"?"inactive":"active";await a.mutateAsync({id:j.id,status:D})},T=async()=>{g&&(await s.mutateAsync(g.id),p(!1),m(null))},N=j=>{m(j),v(j.name),w(j.email),d(!0)},O=j=>{m(j),p(!0)};return u.jsx(ya,{children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Clientes"}),u.jsx("p",{className:"text-muted-foreground",children:"Administra los accesos a tus catlogos"})]}),u.jsxs(Kc,{open:l,onOpenChange:c,children:[u.jsx(ej,{asChild:!0,children:u.jsxs(ye,{children:[u.jsx(Lc,{className:"h-4 w-4 mr-2"}),"Nuevo Cliente"]})}),u.jsxs(cl,{children:[u.jsxs(ul,{children:[u.jsx(dl,{children:"Crear nuevo cliente"}),u.jsx(hl,{children:"Agrega un cliente para darle acceso a tus catlogos"})]}),u.jsxs("div",{className:"space-y-4 py-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"create-name",children:"Nombre"}),u.jsx(zt,{id:"create-name",placeholder:"Nombre del cliente o empresa",value:x,onChange:j=>v(j.target.value)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"create-email",children:"Email"}),u.jsx(zt,{id:"create-email",type:"email",placeholder:"correo@ejemplo.com",value:y,onChange:j=>w(j.target.value)})]})]}),u.jsxs(fl,{children:[u.jsx(ye,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),u.jsxs(ye,{onClick:b,disabled:n.isPending,children:[n.isPending?u.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}):null,"Crear cliente"]})]})]})]})]}),u.jsxs("div",{className:"relative max-w-md",children:[u.jsx(Cp,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),u.jsx(zt,{placeholder:"Buscar clientes...",value:i,onChange:j=>o(j.target.value),className:"pl-9"})]}),u.jsx(et,{children:u.jsx(ot,{className:"p-0",children:r?u.jsx("div",{className:"p-6 space-y-4",children:[...Array(5)].map((j,D)=>u.jsx(mt,{className:"h-12 w-full"},D))}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs(qa,{children:[u.jsx(Xa,{children:u.jsxs(Zt,{className:"bg-table-header",children:[u.jsx(Le,{children:"Cliente"}),u.jsx(Le,{children:"Email"}),u.jsx(Le,{children:"Catlogos asignados"}),u.jsx(Le,{children:"ltimo acceso"}),u.jsx(Le,{children:"Estado"}),u.jsx(Le,{className:"w-12"})]})}),u.jsxs(Ya,{children:[E.map(j=>u.jsxs(Zt,{className:"hover:bg-table-row-hover",children:[u.jsx(Ie,{children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"h-9 w-9 rounded-full bg-primary/10 flex items-center justify-center text-primary font-medium",children:j.name.charAt(0)}),u.jsx("span",{className:"font-medium",children:j.name})]})}),u.jsx(Ie,{className:"text-muted-foreground",children:j.email}),u.jsx(Ie,{children:u.jsxs("div",{className:"flex flex-wrap gap-1",children:[j.catalogs.length>0?j.catalogs.slice(0,2).map((D,Y)=>u.jsxs(Ct,{variant:"secondary",className:"text-xs",children:[u.jsx(Ha,{className:"h-3 w-3 mr-1"}),D.name.length>20?D.name.substring(0,20)+"...":D.name]},Y)):u.jsx("span",{className:"text-muted-foreground text-sm",children:"Sin catlogos"}),j.catalogs.length>2&&u.jsxs(Ct,{variant:"outline",className:"text-xs",children:["+",j.catalogs.length-2]})]})}),u.jsx(Ie,{className:"text-muted-foreground",children:j.last_access?new Date(j.last_access).toLocaleDateString():"Nunca"}),u.jsxs(Ie,{children:[j.status==="active"&&u.jsx(Ct,{className:"bg-success/10 text-success border-success/20 hover:bg-success/20",children:"Activo"}),j.status==="pending"&&u.jsx(Ct,{className:"bg-warning/10 text-warning border-warning/20 hover:bg-warning/20",children:"Pendiente"}),j.status==="inactive"&&u.jsx(Ct,{variant:"secondary",children:"Inactivo"})]}),u.jsx(Ie,{children:u.jsxs($c,{children:[u.jsx(Wc,{asChild:!0,children:u.jsx(ye,{variant:"ghost",size:"icon",className:"h-8 w-8",children:u.jsx(B1,{className:"h-4 w-4"})})}),u.jsxs(tl,{align:"end",children:[u.jsxs(Tr,{onClick:()=>N(j),children:[u.jsx(bd,{className:"h-4 w-4 mr-2"}),"Editar"]}),u.jsx(Vc,{}),u.jsx(Tr,{onClick:()=>S(j),children:j.status==="active"?u.jsxs(u.Fragment,{children:[u.jsx(gD,{className:"h-4 w-4 mr-2"}),"Desactivar"]}):u.jsxs(u.Fragment,{children:[u.jsx($C,{className:"h-4 w-4 mr-2"}),"Activar"]})}),u.jsxs(Tr,{className:"text-destructive",onClick:()=>O(j),children:[u.jsx(Of,{className:"h-4 w-4 mr-2"}),"Eliminar"]})]})]})})]},j.id)),E.length===0&&!r&&u.jsx(Zt,{children:u.jsx(Ie,{colSpan:6,className:"h-24 text-center",children:u.jsx("p",{className:"text-muted-foreground",children:i?"No se encontraron clientes":"No hay clientes registrados"})})})]})]})})})}),u.jsx(Kc,{open:f,onOpenChange:d,children:u.jsxs(cl,{children:[u.jsxs(ul,{children:[u.jsx(dl,{children:"Editar cliente"}),u.jsx(hl,{children:"Modifica la informacin del cliente"})]}),u.jsxs("div",{className:"space-y-4 py-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"edit-name",children:"Nombre"}),u.jsx(zt,{id:"edit-name",value:x,onChange:j=>v(j.target.value)})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"edit-email",children:"Email"}),u.jsx(zt,{id:"edit-email",type:"email",value:y,onChange:j=>w(j.target.value)})]})]}),u.jsxs(fl,{children:[u.jsx(ye,{variant:"outline",onClick:()=>d(!1),children:"Cancelar"}),u.jsxs(ye,{onClick:k,disabled:a.isPending,children:[a.isPending?u.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}):null,"Guardar cambios"]})]})]})}),u.jsx(Cw,{open:h,onOpenChange:p,children:u.jsxs(sm,{children:[u.jsxs(im,{children:[u.jsx(lm,{children:"Eliminar cliente?"}),u.jsxs(cm,{children:['Esta accin eliminar al cliente "',g==null?void 0:g.name,'". Esta accin no se puede deshacer.']})]}),u.jsxs(om,{children:[u.jsx(fm,{children:"Cancelar"}),u.jsxs(um,{onClick:T,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[s.isPending?u.jsx(ws,{className:"h-4 w-4 mr-2 animate-spin"}):null,"Eliminar"]})]})]})})]})})}const Ou={general:{company_name:"Mi Empresa",currency:"USD",language:"es"},pdf:{include_images:!1,page_size:"letter",orientation:"portrait"},import:{auto_detect_headers:!0,skip_empty_rows:!0}};function sae(){return Zn({queryKey:["app-config"],queryFn:async()=>{try{const{data:e,error:t}=await Ce.from("app_config").select("key, value");if(t)throw t;const r={...Ou};return(e||[]).forEach(n=>{n.key==="general"&&n.value&&(r.general={...Ou.general,...n.value}),n.key==="pdf"&&n.value&&(r.pdf={...Ou.pdf,...n.value}),n.key==="import"&&n.value&&(r.import={...Ou.import,...n.value})}),r}catch(e){return console.error("Error fetching config:",e),Ou}}})}function iae(){const e=Pr(),{user:t}=Dt();return nn({mutationFn:async({key:r,value:n})=>{const{error:a}=await Ce.from("app_config").upsert({key:r,value:n,updated_by:t==null?void 0:t.id,updated_at:new Date().toISOString()},{onConflict:"key"});if(a)throw a},onSuccess:()=>{e.invalidateQueries({queryKey:["app-config"]}),Pe.success("Configuracin guardada")},onError:r=>{console.error("Error updating config:",r),Pe.error("Error al guardar la configuracin")}})}function oae(){const{user:e}=Dt();return Zn({queryKey:["profile",e==null?void 0:e.id],queryFn:async()=>{if(!e)return null;const{data:t,error:r}=await Ce.from("profiles").select("id, email, full_name, avatar_url").eq("id",e.id).single();if(r)throw r;return t},enabled:!!e})}function lae(){const{user:e}=Dt(),t=Pr();return nn({mutationFn:async r=>{if(!e)throw new Error("Usuario no autenticado");const{data:n,error:a}=await Ce.from("profiles").update(r).eq("id",e.id).select("id, email, full_name, avatar_url").single();if(a)throw a;return n},onSuccess:()=>{t.invalidateQueries({queryKey:["profile",e==null?void 0:e.id]}),Pe.success("Perfil actualizado")},onError:r=>{console.error("Error updating profile:",r),Pe.error("Error al actualizar el perfil")}})}function cae(){const{user:e}=Dt();return Zn({queryKey:["gestor-profile",e==null?void 0:e.id],queryFn:async()=>{if(!e)return null;const{data:t,error:r}=await Ce.from("gestor_profiles").select("user_id, sales_description").eq("user_id",e.id).maybeSingle();if(r)throw r;return t},enabled:!!e})}function uae(){const{user:e}=Dt(),t=Pr();return nn({mutationFn:async r=>{if(!e)throw new Error("Usuario no autenticado");const{data:n,error:a}=await Ce.from("gestor_profiles").upsert({user_id:e.id,sales_description:r.sales_description}).select("user_id, sales_description").single();if(a)throw a;return n},onSuccess:()=>{t.invalidateQueries({queryKey:["gestor-profile",e==null?void 0:e.id]}),t.invalidateQueries({queryKey:["gestors"]}),Pe.success("Perfil comercial actualizado")},onError:r=>{console.error("Error updating gestor profile:",r),Pe.error("Error al actualizar el perfil comercial")}})}function fae(){const{user:e,role:t}=Dt(),{data:r,isLoading:n,error:a}=sae(),s=iae(),{data:i,isLoading:o}=oae(),{data:l,isLoading:c}=cae(),f=uae(),d=lae(),[h,p]=_.useState({company_name:"",currency:"USD",language:"es"}),[g,m]=_.useState({include_images:!1,page_size:"letter",orientation:"portrait"}),[x,v]=_.useState({auto_detect_headers:!0,skip_empty_rows:!0}),[y,w]=_.useState(!1),[E,b]=_.useState({full_name:"",avatar_url:""}),[k,S]=_.useState({sales_description:""}),[T,N]=_.useState(!1),[O,j]=_.useState(!1);r&&!y&&(p(r.general),m(r.pdf),v(r.import),w(!0)),i&&!O&&(b({full_name:i.full_name||"",avatar_url:i.avatar_url||""}),j(!0)),l&&!T&&(S({sales_description:l.sales_description||""}),N(!0));const D=async()=>{await s.mutateAsync({key:"general",value:h})},Y=async()=>{await s.mutateAsync({key:"pdf",value:g})},Q=async()=>{await s.mutateAsync({key:"import",value:x})},G=async()=>{await d.mutateAsync({full_name:E.full_name,avatar_url:E.avatar_url||null})},X=async()=>{await f.mutateAsync({sales_description:k.sales_description||null})};return a?u.jsx(ya,{children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Configuracin"}),u.jsx("p",{className:"text-muted-foreground",children:"Configura las opciones del sistema"})]}),u.jsxs(et,{className:"p-8 text-center",children:[u.jsx("p",{className:"text-destructive",children:"Error al cargar la configuracin."}),u.jsx(ye,{className:"mt-4",onClick:()=>window.location.reload(),children:"Reintentar"})]})]})}):u.jsx(ya,{children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Configuracin"}),u.jsx("p",{className:"text-muted-foreground",children:"Configura las opciones del sistema"})]}),n?u.jsxs("div",{className:"space-y-4",children:[u.jsx(mt,{className:"h-10 w-64"}),u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(mt,{className:"h-6 w-40"}),u.jsx(mt,{className:"h-4 w-60"})]}),u.jsxs(ot,{className:"space-y-4",children:[u.jsx(mt,{className:"h-10 w-full"}),u.jsx(mt,{className:"h-10 w-full"}),u.jsx(mt,{className:"h-10 w-full"})]})]})]}):u.jsxs(Lp,{defaultValue:"perfil",className:"space-y-4",children:[u.jsxs(Nd,{children:[u.jsxs(mn,{value:"perfil",className:"gap-2",children:[u.jsx(AD,{className:"h-4 w-4"}),"Perfil"]}),t==="gestor"&&u.jsxs(mn,{value:"comercial",className:"gap-2",children:[u.jsx(E0,{className:"h-4 w-4"}),"Comercial"]}),u.jsxs(mn,{value:"general",className:"gap-2",children:[u.jsx(uD,{className:"h-4 w-4"}),"General"]}),u.jsxs(mn,{value:"pdf",className:"gap-2",children:[u.jsx(E0,{className:"h-4 w-4"}),"PDF"]}),u.jsxs(mn,{value:"import",className:"gap-2",children:[u.jsx(If,{className:"h-4 w-4"}),"Importacin"]})]}),u.jsx(gn,{value:"perfil",children:u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(Lr,{children:"Perfil"}),u.jsx(pn,{children:"Actualiza tu informacin pblica de usuario."})]}),u.jsx(ot,{className:"space-y-4",children:o?u.jsx(mt,{className:"h-24 w-full"}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"profile-name",children:"Nombre completo"}),u.jsx(zt,{id:"profile-name",value:E.full_name,onChange:q=>b(K=>({...K,full_name:q.target.value})),placeholder:"Tu nombre"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"profile-email",children:"Email"}),u.jsx(zt,{id:"profile-email",value:(i==null?void 0:i.email)||(e==null?void 0:e.email)||"",disabled:!0})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"profile-avatar",children:"URL de avatar"}),u.jsx(zt,{id:"profile-avatar",value:E.avatar_url,onChange:q=>b(K=>({...K,avatar_url:q.target.value})),placeholder:"https://..."})]}),u.jsx("div",{className:"pt-4",children:u.jsxs(ye,{onClick:G,disabled:d.isPending,children:[u.jsx(yo,{className:"h-4 w-4 mr-2"}),d.isPending?"Guardando...":"Guardar perfil"]})})]})})]})}),t==="gestor"&&u.jsx(gn,{value:"comercial",children:u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(Lr,{children:"Perfil comercial"}),u.jsx(pn,{children:"Comparte una descripcin para que los clientes te contacten."})]}),u.jsx(ot,{className:"space-y-4",children:c?u.jsx(mt,{className:"h-24 w-full"}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"sales-description",children:"Descripcin comercial"}),u.jsx(nm,{id:"sales-description",value:k.sales_description,onChange:q=>S({sales_description:q.target.value}),placeholder:"Ej. Ayudo a equipos comerciales a mantener catlogos actualizados.",rows:4})]}),u.jsx("div",{className:"pt-4",children:u.jsxs(ye,{onClick:X,disabled:f.isPending,children:[u.jsx(yo,{className:"h-4 w-4 mr-2"}),f.isPending?"Guardando...":"Guardar descripcin"]})})]})})]})}),u.jsx(gn,{value:"general",children:u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(Lr,{children:"Configuracin General"}),u.jsx(pn,{children:"Informacin bsica de tu empresa"})]}),u.jsxs(ot,{className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"company_name",children:"Nombre de la empresa"}),u.jsx(zt,{id:"company_name",value:h.company_name,onChange:q=>p(K=>({...K,company_name:q.target.value})),placeholder:"Mi Empresa"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"currency",children:"Moneda"}),u.jsxs(Ba,{value:h.currency,onValueChange:q=>p(K=>({...K,currency:q})),children:[u.jsx(pa,{children:u.jsx(Ua,{})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"USD",children:"USD - Dlar estadounidense"}),u.jsx(bt,{value:"EUR",children:"EUR - Euro"}),u.jsx(bt,{value:"MXN",children:"MXN - Peso mexicano"})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"language",children:"Idioma"}),u.jsxs(Ba,{value:h.language,onValueChange:q=>p(K=>({...K,language:q})),children:[u.jsx(pa,{children:u.jsx(Ua,{})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"es",children:"Espaol"}),u.jsx(bt,{value:"en",children:"English"})]})]})]}),u.jsx("div",{className:"pt-4",children:u.jsxs(ye,{onClick:D,disabled:s.isPending,children:[u.jsx(yo,{className:"h-4 w-4 mr-2"}),s.isPending?"Guardando...":"Guardar cambios"]})})]})]})}),u.jsx(gn,{value:"pdf",children:u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(Lr,{children:"Configuracin de PDF"}),u.jsx(pn,{children:"Opciones para la generacin de documentos PDF"})]}),u.jsxs(ot,{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-0.5",children:[u.jsx(pt,{children:"Incluir imgenes"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Mostrar miniaturas de productos en el PDF"})]}),u.jsx(pf,{checked:g.include_images,onCheckedChange:q=>m(K=>({...K,include_images:q}))})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"page_size",children:"Tamao de pgina"}),u.jsxs(Ba,{value:g.page_size,onValueChange:q=>m(K=>({...K,page_size:q})),children:[u.jsx(pa,{children:u.jsx(Ua,{})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"letter",children:"Carta (8.511)"}),u.jsx(bt,{value:"a4",children:"A4"}),u.jsx(bt,{value:"legal",children:"Legal"})]})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(pt,{htmlFor:"orientation",children:"Orientacin"}),u.jsxs(Ba,{value:g.orientation,onValueChange:q=>m(K=>({...K,orientation:q})),children:[u.jsx(pa,{children:u.jsx(Ua,{})}),u.jsxs(ma,{children:[u.jsx(bt,{value:"portrait",children:"Vertical"}),u.jsx(bt,{value:"landscape",children:"Horizontal"})]})]})]}),u.jsx("div",{className:"pt-4",children:u.jsxs(ye,{onClick:Y,disabled:s.isPending,children:[u.jsx(yo,{className:"h-4 w-4 mr-2"}),s.isPending?"Guardando...":"Guardar cambios"]})})]})]})}),u.jsx(gn,{value:"import",children:u.jsxs(et,{children:[u.jsxs(yr,{children:[u.jsx(Lr,{children:"Configuracin de Importacin"}),u.jsx(pn,{children:"Opciones para la importacin de archivos Excel"})]}),u.jsxs(ot,{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-0.5",children:[u.jsx(pt,{children:"Auto-detectar encabezados"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Detectar automticamente las columnas del Excel"})]}),u.jsx(pf,{checked:x.auto_detect_headers,onCheckedChange:q=>v(K=>({...K,auto_detect_headers:q}))})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-0.5",children:[u.jsx(pt,{children:"Saltar filas vacas"}),u.jsx("p",{className:"text-sm text-muted-foreground",children:"Ignorar filas sin datos durante la importacin"})]}),u.jsx(pf,{checked:x.skip_empty_rows,onCheckedChange:q=>v(K=>({...K,skip_empty_rows:q}))})]}),u.jsx("div",{className:"pt-4",children:u.jsxs(ye,{onClick:Q,disabled:s.isPending,children:[u.jsx(yo,{className:"h-4 w-4 mr-2"}),s.isPending?"Guardando...":"Guardar cambios"]})})]})]})})]})]})})}const dae=()=>{const e=ni();return _.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),u.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:u.jsxs("div",{className:"text-center",children:[u.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),u.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),u.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},hae=new t6({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}}),pae=()=>u.jsx(u9,{children:u.jsx(r6,{client:hae,children:u.jsx(e9,{children:u.jsxs(R5,{children:[u.jsx(d8,{}),u.jsx(z8,{}),u.jsx(pL,{children:u.jsxs(iL,{children:[u.jsx(na,{path:"/",element:u.jsx(r$,{})}),u.jsx(na,{path:"/dashboard",element:u.jsx(Rs,{allowedRoles:["gestor"],children:u.jsx(XV,{})})}),u.jsx(na,{path:"/catalogos",element:u.jsx(Rs,{allowedRoles:["gestor"],children:u.jsx(Ob,{})})}),u.jsx(na,{path:"/catalogos/:id",element:u.jsx(Rs,{allowedRoles:["gestor"],children:u.jsx(Ib,{})})}),u.jsx(na,{path:"/catalogos/:id/editar",element:u.jsx(Rs,{allowedRoles:["gestor"],children:u.jsx(Ib,{})})}),u.jsx(na,{path:"/catalogos/importar",element:u.jsx(Rs,{allowedRoles:["gestor"],children:u.jsx(nae,{})})}),u.jsx(na,{path:"/catalogos/nuevo",element:u.jsx(Rs,{allowedRoles:["gestor"],children:u.jsx(Ob,{})})}),u.jsx(na,{path:"/clientes",element:u.jsx(Rs,{allowedRoles:["gestor"],children:u.jsx(aae,{})})}),u.jsx(na,{path:"/configuracion",element:u.jsx(Rs,{allowedRoles:["gestor","cliente"],children:u.jsx(fae,{})})}),u.jsx(na,{path:"/cliente",element:u.jsx(Rs,{allowedRoles:["cliente"],children:u.jsx(rre,{})})}),u.jsx(na,{path:"*",element:u.jsx(dae,{})})]})})]})})})});hC(document.getElementById("root")).render(u.jsx(pae,{}));
